/*! For license information please see main.6d1e7f32.js.LICENSE.txt */
(()=>{var g={540:(g,I)=>{"use strict";var e="function"===typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,C=e?Symbol.for("react.portal"):60106,l=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,A=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,s=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,r=e?Symbol.for("react.suspense_list"):60120,u=e?Symbol.for("react.memo"):60115,b=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,h=e?Symbol.for("react.fundamental"):60117,Z=e?Symbol.for("react.responder"):60118,G=e?Symbol.for("react.scope"):60119;function p(g){if("object"===typeof g&&null!==g){var I=g.$$typeof;switch(I){case t:switch(g=g.type){case A:case c:case l:case o:case n:case d:return g;default:switch(g=g&&g.$$typeof){case i:case s:case b:case u:case a:return g;default:return I}}case C:return I}}}function B(g){return p(g)===c}I.isForwardRef=function(g){return p(g)===s}},904:(g,I,e)=>{"use strict";g.exports=e(540)},172:(g,I,e)=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var t=e(396);e(554);var C=e(43);function l(g){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(g)}function n(g,I){if(!(g instanceof I))throw new TypeError("Cannot call a class as a function")}function o(g,I){for(var e=0;e<I.length;e++){var t=I[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,t.key,t)}}function a(g,I,e){return I&&o(g.prototype,I),e&&o(g,e),g}function i(g,I,e){return I in g?Object.defineProperty(g,I,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[I]=e,g}function A(g,I){if("function"!=typeof I&&null!==I)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(I&&I.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),I&&s(g,I)}function c(g){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(g)}function s(g,I){return(s=Object.setPrototypeOf||function(g,I){return g.__proto__=I,g})(g,I)}function d(g,I){return!I||"object"!=typeof I&&"function"!=typeof I?function(g){if(void 0===g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}(g):I}var r=function(){function g(I){n(this,g),i(this,"handlers",void 0),this.handlers=I.slice(0)}return a(g,[{key:"addHandlers",value:function(I){for(var e=this.handlers.slice(0),t=I.length,C=0;C<t;C+=1)e.push(I[C]);return new g(e)}},{key:"dispatchEvent",value:function(g,I){var e=this.handlers.length-1;if(I){for(var t=e;t>=0;t-=1)this.handlers[t].called||(this.handlers[t].called=!0,this.handlers[t](g));for(var C=e;C>=0;C-=1)this.handlers[C].called=!1}else(0,this.handlers[e])(g)}},{key:"hasHandlers",value:function(){return this.handlers.length>0}},{key:"removeHandlers",value:function(I){for(var e=[],t=this.handlers.length,C=0;C<t;C+=1){var l=this.handlers[C];-1===I.indexOf(l)&&e.push(l)}return new g(e)}}]),g}();function u(g){var I=new Map;return g.forEach((function(g,e){I.set(e,g)})),I}function b(g){return Array.isArray(g)?g:[g]}function m(g){return"document"===g?document:"window"===g?window:function(g){return null!==g&&"object"===l(g)&&g.hasOwnProperty("current")}(g)?g.current||document:g||document}var h=function(){function g(I,e){n(this,g),i(this,"handlerSets",void 0),i(this,"poolName",void 0),this.handlerSets=e,this.poolName=I}return a(g,[{key:"addHandlers",value:function(I,e){var t=u(this.handlerSets);if(t.has(I)){var C=t.get(I);t.set(I,C.addHandlers(e))}else t.set(I,new r(e));return new g(this.poolName,t)}},{key:"dispatchEvent",value:function(g,I){var e=this.handlerSets.get(g),t="default"===this.poolName;e&&e.dispatchEvent(I,t)}},{key:"hasHandlers",value:function(g){if(!g)return this.handlerSets.size>0;var I=this.handlerSets.get(g);return!!I&&I.hasHandlers()}},{key:"removeHandlers",value:function(I,e){var t=u(this.handlerSets);if(!t.has(I))return new g(this.poolName,t);var C=t.get(I).removeHandlers(e);return C.hasHandlers()?t.set(I,C):t.delete(I),new g(this.poolName,t)}}]),g}();i(h,"createByType",(function(g,I,e){var t=new Map;return t.set(I,new r(e)),new h(g,t)}));var Z=function(){function g(I){var e=this;n(this,g),i(this,"handlers",new Map),i(this,"pools",new Map),i(this,"target",void 0),i(this,"createEmitter",(function(g){return function(I){e.pools.forEach((function(e){e.dispatchEvent(g,I)}))}})),this.target=I}return a(g,[{key:"addHandlers",value:function(g,I,e){if(this.pools.has(g)){var t=this.pools.get(g);this.pools.set(g,t.addHandlers(I,e))}else this.pools.set(g,h.createByType(g,I,e));this.handlers.has(I)||this.addTargetHandler(I)}},{key:"hasHandlers",value:function(){return this.handlers.size>0}},{key:"removeHandlers",value:function(g,I,e){if(this.pools.has(g)){var t=this.pools.get(g).removeHandlers(I,e);t.hasHandlers()?this.pools.set(g,t):this.pools.delete(g);var C=!1;this.pools.forEach((function(g){return C=C||g.hasHandlers(I)})),C||this.removeTargetHandler(I)}}},{key:"addTargetHandler",value:function(g){var I=this.createEmitter(g);this.handlers.set(g,I),this.target.addEventListener(g,I,!0)}},{key:"removeTargetHandler",value:function(g){this.handlers.has(g)&&(this.target.removeEventListener(g,this.handlers.get(g),!0),this.handlers.delete(g))}}]),g}(),G=new(function(){function g(){var I=this;n(this,g),i(this,"targets",new Map),i(this,"getTarget",(function(g){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=m(g);if(I.targets.has(t))return I.targets.get(t);if(!e)return null;var C=new Z(t);return I.targets.set(t,C),C})),i(this,"removeTarget",(function(g){I.targets.delete(m(g))}))}return a(g,[{key:"sub",value:function(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.canUseDOM){var C=e.target,l=void 0===C?document:C,n=e.pool,o=void 0===n?"default":n;this.getTarget(l).addHandlers(o,g,b(I))}}},{key:"unsub",value:function(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.canUseDOM){var C=e.target,l=void 0===C?document:C,n=e.pool,o=void 0===n?"default":n,a=this.getTarget(l,!1);a&&(a.removeHandlers(o,g,b(I)),a.hasHandlers()||this.removeTarget(l))}}}]),g}()),p=function(g){function I(){return n(this,I),d(this,c(I).apply(this,arguments))}return A(I,C.PureComponent),a(I,[{key:"componentDidMount",value:function(){this.subscribe(this.props)}},{key:"componentDidUpdate",value:function(g){this.unsubscribe(g),this.subscribe(this.props)}},{key:"componentWillUnmount",value:function(){this.unsubscribe(this.props)}},{key:"subscribe",value:function(g){var I=g.name,e=g.on,t=g.pool,C=g.target;G.sub(I,e,{pool:t,target:C})}},{key:"unsubscribe",value:function(g){var I=g.name,e=g.on,t=g.pool,C=g.target;G.unsub(I,e,{pool:t,target:C})}},{key:"render",value:function(){return null}}]),I}();i(p,"defaultProps",{pool:"default",target:"document"}),p.propTypes={},I.instance=G,I.default=p},173:(g,I,e)=>{"use strict";var t;t=e(172),g.exports=t.default,g.exports.instance=t.instance},396:(g,I,e)=>{var t;!function(){"use strict";var C=!("undefined"===typeof window||!window.document||!window.document.createElement),l={canUseDOM:C,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:C&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:C&&!!window.screen};void 0===(t=function(){return l}.call(I,e,I,g))||(g.exports=t)}()},90:g=>{"use strict";for(var I=function(g){return null!==g&&!Array.isArray(g)&&"object"===typeof g},e={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"},t=0;t<24;t+=1)e[112+t]="F"+(t+1);for(var C=0;C<26;C+=1){var l=C+65;e[l]=[String.fromCharCode(l+32),String.fromCharCode(l)]}var n={codes:e,getCode:function(g){return I(g)?g.keyCode||g.which||this[g.key]:this[g]},getKey:function(g){var t=I(g);if(t&&g.key)return g.key;var C=e[t?g.keyCode||g.which:g];return Array.isArray(C)&&(C=t?C[g.shiftKey?1:0]:C[0]),C},Cancel:3,Help:6,Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Convert:28,NonConvert:29,Accept:30,ModeChange:31," ":32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Select:41,Print:42,Execute:43,PrintScreen:44,Insert:45,Delete:46,0:48,")":48,1:49,"!":49,2:50,"@":50,3:51,"#":51,4:52,$:52,5:53,"%":53,6:54,"^":54,7:55,"&":55,8:56,"*":56,9:57,"(":57,a:65,A:65,b:66,B:66,c:67,C:67,d:68,D:68,e:69,E:69,f:70,F:70,g:71,G:71,h:72,H:72,i:73,I:73,j:74,J:74,k:75,K:75,l:76,L:76,m:77,M:77,n:78,N:78,o:79,O:79,p:80,P:80,q:81,Q:81,r:82,R:82,s:83,S:83,t:84,T:84,u:85,U:85,v:86,V:86,w:87,W:87,x:88,X:88,y:89,Y:89,z:90,Z:90,OS:91,ContextMenu:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,F20:131,F21:132,F22:133,F23:134,F24:135,NumLock:144,ScrollLock:145,VolumeMute:181,VolumeDown:182,VolumeUp:183,";":186,":":186,"=":187,"+":187,",":188,"<":188,"-":189,_:189,".":190,">":190,"/":191,"?":191,"`":192,"~":192,"[":219,"{":219,"\\":220,"|":220,"]":221,"}":221,"'":222,'"':222,Meta:224,AltGraph:225,Attn:246,CrSel:247,ExSel:248,EraseEof:249,Play:250,ZoomOut:251};n.Spacebar=n[" "],n.Digit0=n[0],n.Digit1=n[1],n.Digit2=n[2],n.Digit3=n[3],n.Digit4=n[4],n.Digit5=n[5],n.Digit6=n[6],n.Digit7=n[7],n.Digit8=n[8],n.Digit9=n[9],n.Tilde=n["~"],n.GraveAccent=n["`"],n.ExclamationPoint=n["!"],n.AtSign=n["@"],n.PoundSign=n["#"],n.PercentSign=n["%"],n.Caret=n["^"],n.Ampersand=n["&"],n.PlusSign=n["+"],n.MinusSign=n["-"],n.EqualsSign=n["="],n.DivisionSign=n["/"],n.MultiplicationSign=n["*"],n.Comma=n[","],n.Decimal=n["."],n.Colon=n[":"],n.Semicolon=n[";"],n.Pipe=n["|"],n.BackSlash=n["\\"],n.QuestionMark=n["?"],n.SingleQuote=n["'"],n.DoubleQuote=n['"'],n.LeftCurlyBrace=n["{"],n.RightCurlyBrace=n["}"],n.LeftParenthesis=n["("],n.RightParenthesis=n[")"],n.LeftAngleBracket=n["<"],n.RightAngleBracket=n[">"],n.LeftSquareBracket=n["["],n.RightSquareBracket=n["]"],g.exports=n},497:(g,I,e)=>{"use strict";var t=e(218);function C(){}function l(){}l.resetWarningCache=C,g.exports=function(){function g(g,I,e,C,l,n){if(n!==t){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function I(){return g}g.isRequired=g;var e={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:I,element:g,elementType:g,instanceOf:I,node:g,objectOf:I,oneOf:I,oneOfType:I,shape:I,exact:I,checkPropTypes:l,resetWarningCache:C};return e.PropTypes=e,e}},554:(g,I,e)=>{g.exports=e(497)()},218:g=>{"use strict";g.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},730:(g,I,e)=>{"use strict";var t=e(43),C=e(853);function l(g){for(var I="https://reactjs.org/docs/error-decoder.html?invariant="+g,e=1;e<arguments.length;e++)I+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+g+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,o={};function a(g,I){i(g,I),i(g+"Capture",I)}function i(g,I){for(o[g]=I,g=0;g<I.length;g++)n.add(I[g])}var A=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,s=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},r={};function u(g,I,e,t,C,l,n){this.acceptsBooleans=2===I||3===I||4===I,this.attributeName=t,this.attributeNamespace=C,this.mustUseProperty=e,this.propertyName=g,this.type=I,this.sanitizeURL=l,this.removeEmptyString=n}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(g){b[g]=new u(g,0,!1,g,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(g){var I=g[0];b[I]=new u(I,1,!1,g[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(g){b[g]=new u(g,2,!1,g.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(g){b[g]=new u(g,2,!1,g,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(g){b[g]=new u(g,3,!1,g.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(g){b[g]=new u(g,3,!0,g,null,!1,!1)})),["capture","download"].forEach((function(g){b[g]=new u(g,4,!1,g,null,!1,!1)})),["cols","rows","size","span"].forEach((function(g){b[g]=new u(g,6,!1,g,null,!1,!1)})),["rowSpan","start"].forEach((function(g){b[g]=new u(g,5,!1,g.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function h(g){return g[1].toUpperCase()}function Z(g,I,e,t){var C=b.hasOwnProperty(I)?b[I]:null;(null!==C?0!==C.type:t||!(2<I.length)||"o"!==I[0]&&"O"!==I[0]||"n"!==I[1]&&"N"!==I[1])&&(function(g,I,e,t){if(null===I||"undefined"===typeof I||function(g,I,e,t){if(null!==e&&0===e.type)return!1;switch(typeof I){case"function":case"symbol":return!0;case"boolean":return!t&&(null!==e?!e.acceptsBooleans:"data-"!==(g=g.toLowerCase().slice(0,5))&&"aria-"!==g);default:return!1}}(g,I,e,t))return!0;if(t)return!1;if(null!==e)switch(e.type){case 3:return!I;case 4:return!1===I;case 5:return isNaN(I);case 6:return isNaN(I)||1>I}return!1}(I,e,C,t)&&(e=null),t||null===C?function(g){return!!c.call(r,g)||!c.call(d,g)&&(s.test(g)?r[g]=!0:(d[g]=!0,!1))}(I)&&(null===e?g.removeAttribute(I):g.setAttribute(I,""+e)):C.mustUseProperty?g[C.propertyName]=null===e?3!==C.type&&"":e:(I=C.attributeName,t=C.attributeNamespace,null===e?g.removeAttribute(I):(e=3===(C=C.type)||4===C&&!0===e?"":""+e,t?g.setAttributeNS(t,I,e):g.setAttribute(I,e))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(g){var I=g.replace(m,h);b[I]=new u(I,1,!1,g,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(g){var I=g.replace(m,h);b[I]=new u(I,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(g){var I=g.replace(m,h);b[I]=new u(I,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(g){b[g]=new u(g,1,!1,g.toLowerCase(),null,!1,!1)})),b.xlinkHref=new u("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(g){b[g]=new u(g,1,!1,g.toLowerCase(),null,!0,!0)}));var G=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,p=Symbol.for("react.element"),B=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),R=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),v=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var Y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var H=Symbol.iterator;function N(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=H&&g[H]||g["@@iterator"])?g:null}var K,w=Object.assign;function F(g){if(void 0===K)try{throw Error()}catch(e){var I=e.stack.trim().match(/\n( *(at )?)/);K=I&&I[1]||""}return"\n"+K+g}var x=!1;function z(g,I){if(!g||x)return"";x=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(I)if(I=function(){throw Error()},Object.defineProperty(I.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(I,[])}catch(i){var t=i}Reflect.construct(g,[],I)}else{try{I.call()}catch(i){t=i}g.call(I.prototype)}else{try{throw Error()}catch(i){t=i}g()}}catch(i){if(i&&t&&"string"===typeof i.stack){for(var C=i.stack.split("\n"),l=t.stack.split("\n"),n=C.length-1,o=l.length-1;1<=n&&0<=o&&C[n]!==l[o];)o--;for(;1<=n&&0<=o;n--,o--)if(C[n]!==l[o]){if(1!==n||1!==o)do{if(n--,0>--o||C[n]!==l[o]){var a="\n"+C[n].replace(" at new "," at ");return g.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",g.displayName)),a}}while(1<=n&&0<=o);break}}}finally{x=!1,Error.prepareStackTrace=e}return(g=g?g.displayName||g.name:"")?F(g):""}function M(g){switch(g.tag){case 5:return F(g.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return g=z(g.type,!1);case 11:return g=z(g.type.render,!1);case 1:return g=z(g.type,!0);default:return""}}function E(g){if(null==g)return null;if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g;switch(g){case y:return"Fragment";case B:return"Portal";case V:return"Profiler";case W:return"StrictMode";case J:return"Suspense";case k:return"SuspenseList"}if("object"===typeof g)switch(g.$$typeof){case R:return(g.displayName||"Context")+".Consumer";case S:return(g._context.displayName||"Context")+".Provider";case X:var I=g.render;return(g=g.displayName)||(g=""!==(g=I.displayName||I.name||"")?"ForwardRef("+g+")":"ForwardRef"),g;case f:return null!==(I=g.displayName||null)?I:E(g.type)||"Memo";case v:I=g._payload,g=g._init;try{return E(g(I))}catch(e){}}return null}function U(g){var I=g.type;switch(g.tag){case 24:return"Cache";case 9:return(I.displayName||"Context")+".Consumer";case 10:return(I._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=(g=I.render).displayName||g.name||"",I.displayName||(""!==g?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return I;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(I);case 8:return I===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof I)return I.displayName||I.name||null;if("string"===typeof I)return I}return null}function Q(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":case"object":return g;default:return""}}function L(g){var I=g.type;return(g=g.nodeName)&&"input"===g.toLowerCase()&&("checkbox"===I||"radio"===I)}function D(g){g._valueTracker||(g._valueTracker=function(g){var I=L(g)?"checked":"value",e=Object.getOwnPropertyDescriptor(g.constructor.prototype,I),t=""+g[I];if(!g.hasOwnProperty(I)&&"undefined"!==typeof e&&"function"===typeof e.get&&"function"===typeof e.set){var C=e.get,l=e.set;return Object.defineProperty(g,I,{configurable:!0,get:function(){return C.call(this)},set:function(g){t=""+g,l.call(this,g)}}),Object.defineProperty(g,I,{enumerable:e.enumerable}),{getValue:function(){return t},setValue:function(g){t=""+g},stopTracking:function(){g._valueTracker=null,delete g[I]}}}}(g))}function T(g){if(!g)return!1;var I=g._valueTracker;if(!I)return!0;var e=I.getValue(),t="";return g&&(t=L(g)?g.checked?"true":"false":g.value),(g=t)!==e&&(I.setValue(g),!0)}function j(g){if("undefined"===typeof(g=g||("undefined"!==typeof document?document:void 0)))return null;try{return g.activeElement||g.body}catch(I){return g.body}}function P(g,I){var e=I.checked;return w({},I,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=e?e:g._wrapperState.initialChecked})}function O(g,I){var e=null==I.defaultValue?"":I.defaultValue,t=null!=I.checked?I.checked:I.defaultChecked;e=Q(null!=I.value?I.value:e),g._wrapperState={initialChecked:t,initialValue:e,controlled:"checkbox"===I.type||"radio"===I.type?null!=I.checked:null!=I.value}}function _(g,I){null!=(I=I.checked)&&Z(g,"checked",I,!1)}function q(g,I){_(g,I);var e=Q(I.value),t=I.type;if(null!=e)"number"===t?(0===e&&""===g.value||g.value!=e)&&(g.value=""+e):g.value!==""+e&&(g.value=""+e);else if("submit"===t||"reset"===t)return void g.removeAttribute("value");I.hasOwnProperty("value")?gg(g,I.type,e):I.hasOwnProperty("defaultValue")&&gg(g,I.type,Q(I.defaultValue)),null==I.checked&&null!=I.defaultChecked&&(g.defaultChecked=!!I.defaultChecked)}function $(g,I,e){if(I.hasOwnProperty("value")||I.hasOwnProperty("defaultValue")){var t=I.type;if(!("submit"!==t&&"reset"!==t||void 0!==I.value&&null!==I.value))return;I=""+g._wrapperState.initialValue,e||I===g.value||(g.value=I),g.defaultValue=I}""!==(e=g.name)&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,""!==e&&(g.name=e)}function gg(g,I,e){"number"===I&&j(g.ownerDocument)===g||(null==e?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+e&&(g.defaultValue=""+e))}var Ig=Array.isArray;function eg(g,I,e,t){if(g=g.options,I){I={};for(var C=0;C<e.length;C++)I["$"+e[C]]=!0;for(e=0;e<g.length;e++)C=I.hasOwnProperty("$"+g[e].value),g[e].selected!==C&&(g[e].selected=C),C&&t&&(g[e].defaultSelected=!0)}else{for(e=""+Q(e),I=null,C=0;C<g.length;C++){if(g[C].value===e)return g[C].selected=!0,void(t&&(g[C].defaultSelected=!0));null!==I||g[C].disabled||(I=g[C])}null!==I&&(I.selected=!0)}}function tg(g,I){if(null!=I.dangerouslySetInnerHTML)throw Error(l(91));return w({},I,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function Cg(g,I){var e=I.value;if(null==e){if(e=I.children,I=I.defaultValue,null!=e){if(null!=I)throw Error(l(92));if(Ig(e)){if(1<e.length)throw Error(l(93));e=e[0]}I=e}null==I&&(I=""),e=I}g._wrapperState={initialValue:Q(e)}}function lg(g,I){var e=Q(I.value),t=Q(I.defaultValue);null!=e&&((e=""+e)!==g.value&&(g.value=e),null==I.defaultValue&&g.defaultValue!==e&&(g.defaultValue=e)),null!=t&&(g.defaultValue=""+t)}function ng(g){var I=g.textContent;I===g._wrapperState.initialValue&&""!==I&&null!==I&&(g.value=I)}function og(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ag(g,I){return null==g||"http://www.w3.org/1999/xhtml"===g?og(I):"http://www.w3.org/2000/svg"===g&&"foreignObject"===I?"http://www.w3.org/1999/xhtml":g}var ig,Ag,cg=(Ag=function(g,I){if("http://www.w3.org/2000/svg"!==g.namespaceURI||"innerHTML"in g)g.innerHTML=I;else{for((ig=ig||document.createElement("div")).innerHTML="<svg>"+I.valueOf().toString()+"</svg>",I=ig.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;I.firstChild;)g.appendChild(I.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(g,I,e,t){MSApp.execUnsafeLocalFunction((function(){return Ag(g,I)}))}:Ag);function sg(g,I){if(I){var e=g.firstChild;if(e&&e===g.lastChild&&3===e.nodeType)return void(e.nodeValue=I)}g.textContent=I}var dg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rg=["Webkit","ms","Moz","O"];function ug(g,I,e){return null==I||"boolean"===typeof I||""===I?"":e||"number"!==typeof I||0===I||dg.hasOwnProperty(g)&&dg[g]?(""+I).trim():I+"px"}function bg(g,I){for(var e in g=g.style,I)if(I.hasOwnProperty(e)){var t=0===e.indexOf("--"),C=ug(e,I[e],t);"float"===e&&(e="cssFloat"),t?g.setProperty(e,C):g[e]=C}}Object.keys(dg).forEach((function(g){rg.forEach((function(I){I=I+g.charAt(0).toUpperCase()+g.substring(1),dg[I]=dg[g]}))}));var mg=w({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hg(g,I){if(I){if(mg[g]&&(null!=I.children||null!=I.dangerouslySetInnerHTML))throw Error(l(137,g));if(null!=I.dangerouslySetInnerHTML){if(null!=I.children)throw Error(l(60));if("object"!==typeof I.dangerouslySetInnerHTML||!("__html"in I.dangerouslySetInnerHTML))throw Error(l(61))}if(null!=I.style&&"object"!==typeof I.style)throw Error(l(62))}}function Zg(g,I){if(-1===g.indexOf("-"))return"string"===typeof I.is;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gg=null;function pg(g){return(g=g.target||g.srcElement||window).correspondingUseElement&&(g=g.correspondingUseElement),3===g.nodeType?g.parentNode:g}var Bg=null,yg=null,Wg=null;function Vg(g){if(g=hC(g)){if("function"!==typeof Bg)throw Error(l(280));var I=g.stateNode;I&&(I=GC(I),Bg(g.stateNode,g.type,I))}}function Sg(g){yg?Wg?Wg.push(g):Wg=[g]:yg=g}function Rg(){if(yg){var g=yg,I=Wg;if(Wg=yg=null,Vg(g),I)for(g=0;g<I.length;g++)Vg(I[g])}}function Xg(g,I){return g(I)}function Jg(){}var kg=!1;function fg(g,I,e){if(kg)return g(I,e);kg=!0;try{return Xg(g,I,e)}finally{kg=!1,(null!==yg||null!==Wg)&&(Jg(),Rg())}}function vg(g,I){var e=g.stateNode;if(null===e)return null;var t=GC(e);if(null===t)return null;e=t[I];g:switch(I){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(t=!t.disabled)||(t=!("button"===(g=g.type)||"input"===g||"select"===g||"textarea"===g)),g=!t;break g;default:g=!1}if(g)return null;if(e&&"function"!==typeof e)throw Error(l(231,I,typeof e));return e}var Yg=!1;if(A)try{var Hg={};Object.defineProperty(Hg,"passive",{get:function(){Yg=!0}}),window.addEventListener("test",Hg,Hg),window.removeEventListener("test",Hg,Hg)}catch(Ag){Yg=!1}function Ng(g,I,e,t,C,l,n,o,a){var i=Array.prototype.slice.call(arguments,3);try{I.apply(e,i)}catch(A){this.onError(A)}}var Kg=!1,wg=null,Fg=!1,xg=null,zg={onError:function(g){Kg=!0,wg=g}};function Mg(g,I,e,t,C,l,n,o,a){Kg=!1,wg=null,Ng.apply(zg,arguments)}function Eg(g){var I=g,e=g;if(g.alternate)for(;I.return;)I=I.return;else{g=I;do{0!==(4098&(I=g).flags)&&(e=I.return),g=I.return}while(g)}return 3===I.tag?e:null}function Ug(g){if(13===g.tag){var I=g.memoizedState;if(null===I&&(null!==(g=g.alternate)&&(I=g.memoizedState)),null!==I)return I.dehydrated}return null}function Qg(g){if(Eg(g)!==g)throw Error(l(188))}function Lg(g){return null!==(g=function(g){var I=g.alternate;if(!I){if(null===(I=Eg(g)))throw Error(l(188));return I!==g?null:g}for(var e=g,t=I;;){var C=e.return;if(null===C)break;var n=C.alternate;if(null===n){if(null!==(t=C.return)){e=t;continue}break}if(C.child===n.child){for(n=C.child;n;){if(n===e)return Qg(C),g;if(n===t)return Qg(C),I;n=n.sibling}throw Error(l(188))}if(e.return!==t.return)e=C,t=n;else{for(var o=!1,a=C.child;a;){if(a===e){o=!0,e=C,t=n;break}if(a===t){o=!0,t=C,e=n;break}a=a.sibling}if(!o){for(a=n.child;a;){if(a===e){o=!0,e=n,t=C;break}if(a===t){o=!0,t=n,e=C;break}a=a.sibling}if(!o)throw Error(l(189))}}if(e.alternate!==t)throw Error(l(190))}if(3!==e.tag)throw Error(l(188));return e.stateNode.current===e?g:I}(g))?Dg(g):null}function Dg(g){if(5===g.tag||6===g.tag)return g;for(g=g.child;null!==g;){var I=Dg(g);if(null!==I)return I;g=g.sibling}return null}var Tg=C.unstable_scheduleCallback,jg=C.unstable_cancelCallback,Pg=C.unstable_shouldYield,Og=C.unstable_requestPaint,_g=C.unstable_now,qg=C.unstable_getCurrentPriorityLevel,$g=C.unstable_ImmediatePriority,gI=C.unstable_UserBlockingPriority,II=C.unstable_NormalPriority,eI=C.unstable_LowPriority,tI=C.unstable_IdlePriority,CI=null,lI=null;var nI=Math.clz32?Math.clz32:function(g){return g>>>=0,0===g?32:31-(oI(g)/aI|0)|0},oI=Math.log,aI=Math.LN2;var iI=64,AI=4194304;function cI(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&g;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&g;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function sI(g,I){var e=g.pendingLanes;if(0===e)return 0;var t=0,C=g.suspendedLanes,l=g.pingedLanes,n=268435455&e;if(0!==n){var o=n&~C;0!==o?t=cI(o):0!==(l&=n)&&(t=cI(l))}else 0!==(n=e&~C)?t=cI(n):0!==l&&(t=cI(l));if(0===t)return 0;if(0!==I&&I!==t&&0===(I&C)&&((C=t&-t)>=(l=I&-I)||16===C&&0!==(4194240&l)))return I;if(0!==(4&t)&&(t|=16&e),0!==(I=g.entangledLanes))for(g=g.entanglements,I&=t;0<I;)C=1<<(e=31-nI(I)),t|=g[e],I&=~C;return t}function dI(g,I){switch(g){case 1:case 2:case 4:return I+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return I+5e3;default:return-1}}function rI(g){return 0!==(g=-1073741825&g.pendingLanes)?g:1073741824&g?1073741824:0}function uI(){var g=iI;return 0===(4194240&(iI<<=1))&&(iI=64),g}function bI(g){for(var I=[],e=0;31>e;e++)I.push(g);return I}function mI(g,I,e){g.pendingLanes|=I,536870912!==I&&(g.suspendedLanes=0,g.pingedLanes=0),(g=g.eventTimes)[I=31-nI(I)]=e}function hI(g,I){var e=g.entangledLanes|=I;for(g=g.entanglements;e;){var t=31-nI(e),C=1<<t;C&I|g[t]&I&&(g[t]|=I),e&=~C}}var ZI=0;function GI(g){return 1<(g&=-g)?4<g?0!==(268435455&g)?16:536870912:4:1}var pI,BI,yI,WI,VI,SI=!1,RI=[],XI=null,JI=null,kI=null,fI=new Map,vI=new Map,YI=[],HI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function NI(g,I){switch(g){case"focusin":case"focusout":XI=null;break;case"dragenter":case"dragleave":JI=null;break;case"mouseover":case"mouseout":kI=null;break;case"pointerover":case"pointerout":fI.delete(I.pointerId);break;case"gotpointercapture":case"lostpointercapture":vI.delete(I.pointerId)}}function KI(g,I,e,t,C,l){return null===g||g.nativeEvent!==l?(g={blockedOn:I,domEventName:e,eventSystemFlags:t,nativeEvent:l,targetContainers:[C]},null!==I&&(null!==(I=hC(I))&&BI(I)),g):(g.eventSystemFlags|=t,I=g.targetContainers,null!==C&&-1===I.indexOf(C)&&I.push(C),g)}function wI(g){var I=mC(g.target);if(null!==I){var e=Eg(I);if(null!==e)if(13===(I=e.tag)){if(null!==(I=Ug(e)))return g.blockedOn=I,void VI(g.priority,(function(){yI(e)}))}else if(3===I&&e.stateNode.current.memoizedState.isDehydrated)return void(g.blockedOn=3===e.tag?e.stateNode.containerInfo:null)}g.blockedOn=null}function FI(g){if(null!==g.blockedOn)return!1;for(var I=g.targetContainers;0<I.length;){var e=PI(g.domEventName,g.eventSystemFlags,I[0],g.nativeEvent);if(null!==e)return null!==(I=hC(e))&&BI(I),g.blockedOn=e,!1;var t=new(e=g.nativeEvent).constructor(e.type,e);Gg=t,e.target.dispatchEvent(t),Gg=null,I.shift()}return!0}function xI(g,I,e){FI(g)&&e.delete(I)}function zI(){SI=!1,null!==XI&&FI(XI)&&(XI=null),null!==JI&&FI(JI)&&(JI=null),null!==kI&&FI(kI)&&(kI=null),fI.forEach(xI),vI.forEach(xI)}function MI(g,I){g.blockedOn===I&&(g.blockedOn=null,SI||(SI=!0,C.unstable_scheduleCallback(C.unstable_NormalPriority,zI)))}function EI(g){function I(I){return MI(I,g)}if(0<RI.length){MI(RI[0],g);for(var e=1;e<RI.length;e++){var t=RI[e];t.blockedOn===g&&(t.blockedOn=null)}}for(null!==XI&&MI(XI,g),null!==JI&&MI(JI,g),null!==kI&&MI(kI,g),fI.forEach(I),vI.forEach(I),e=0;e<YI.length;e++)(t=YI[e]).blockedOn===g&&(t.blockedOn=null);for(;0<YI.length&&null===(e=YI[0]).blockedOn;)wI(e),null===e.blockedOn&&YI.shift()}var UI=G.ReactCurrentBatchConfig,QI=!0;function LI(g,I,e,t){var C=ZI,l=UI.transition;UI.transition=null;try{ZI=1,TI(g,I,e,t)}finally{ZI=C,UI.transition=l}}function DI(g,I,e,t){var C=ZI,l=UI.transition;UI.transition=null;try{ZI=4,TI(g,I,e,t)}finally{ZI=C,UI.transition=l}}function TI(g,I,e,t){if(QI){var C=PI(g,I,e,t);if(null===C)Ut(g,I,t,jI,e),NI(g,t);else if(function(g,I,e,t,C){switch(I){case"focusin":return XI=KI(XI,g,I,e,t,C),!0;case"dragenter":return JI=KI(JI,g,I,e,t,C),!0;case"mouseover":return kI=KI(kI,g,I,e,t,C),!0;case"pointerover":var l=C.pointerId;return fI.set(l,KI(fI.get(l)||null,g,I,e,t,C)),!0;case"gotpointercapture":return l=C.pointerId,vI.set(l,KI(vI.get(l)||null,g,I,e,t,C)),!0}return!1}(C,g,I,e,t))t.stopPropagation();else if(NI(g,t),4&I&&-1<HI.indexOf(g)){for(;null!==C;){var l=hC(C);if(null!==l&&pI(l),null===(l=PI(g,I,e,t))&&Ut(g,I,t,jI,e),l===C)break;C=l}null!==C&&t.stopPropagation()}else Ut(g,I,t,null,e)}}var jI=null;function PI(g,I,e,t){if(jI=null,null!==(g=mC(g=pg(t))))if(null===(I=Eg(g)))g=null;else if(13===(e=I.tag)){if(null!==(g=Ug(I)))return g;g=null}else if(3===e){if(I.stateNode.current.memoizedState.isDehydrated)return 3===I.tag?I.stateNode.containerInfo:null;g=null}else I!==g&&(g=null);return jI=g,null}function OI(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qg()){case $g:return 1;case gI:return 4;case II:case eI:return 16;case tI:return 536870912;default:return 16}default:return 16}}var _I=null,qI=null,$I=null;function ge(){if($I)return $I;var g,I,e=qI,t=e.length,C="value"in _I?_I.value:_I.textContent,l=C.length;for(g=0;g<t&&e[g]===C[g];g++);var n=t-g;for(I=1;I<=n&&e[t-I]===C[l-I];I++);return $I=C.slice(g,1<I?1-I:void 0)}function Ie(g){var I=g.keyCode;return"charCode"in g?0===(g=g.charCode)&&13===I&&(g=13):g=I,10===g&&(g=13),32<=g||13===g?g:0}function ee(){return!0}function te(){return!1}function Ce(g){function I(I,e,t,C,l){for(var n in this._reactName=I,this._targetInst=t,this.type=e,this.nativeEvent=C,this.target=l,this.currentTarget=null,g)g.hasOwnProperty(n)&&(I=g[n],this[n]=I?I(C):C[n]);return this.isDefaultPrevented=(null!=C.defaultPrevented?C.defaultPrevented:!1===C.returnValue)?ee:te,this.isPropagationStopped=te,this}return w(I.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():"unknown"!==typeof g.returnValue&&(g.returnValue=!1),this.isDefaultPrevented=ee)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():"unknown"!==typeof g.cancelBubble&&(g.cancelBubble=!0),this.isPropagationStopped=ee)},persist:function(){},isPersistent:ee}),I}var le,ne,oe,ae={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ie=Ce(ae),Ae=w({},ae,{view:0,detail:0}),ce=Ce(Ae),se=w({},Ae,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:We,button:0,buttons:0,relatedTarget:function(g){return void 0===g.relatedTarget?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==oe&&(oe&&"mousemove"===g.type?(le=g.screenX-oe.screenX,ne=g.screenY-oe.screenY):ne=le=0,oe=g),le)},movementY:function(g){return"movementY"in g?g.movementY:ne}}),de=Ce(se),re=Ce(w({},se,{dataTransfer:0})),ue=Ce(w({},Ae,{relatedTarget:0})),be=Ce(w({},ae,{animationName:0,elapsedTime:0,pseudoElement:0})),me=w({},ae,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),he=Ce(me),Ze=Ce(w({},ae,{data:0})),Ge={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Be={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ye(g){var I=this.nativeEvent;return I.getModifierState?I.getModifierState(g):!!(g=Be[g])&&!!I[g]}function We(){return ye}var Ve=w({},Ae,{key:function(g){if(g.key){var I=Ge[g.key]||g.key;if("Unidentified"!==I)return I}return"keypress"===g.type?13===(g=Ie(g))?"Enter":String.fromCharCode(g):"keydown"===g.type||"keyup"===g.type?pe[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:We,charCode:function(g){return"keypress"===g.type?Ie(g):0},keyCode:function(g){return"keydown"===g.type||"keyup"===g.type?g.keyCode:0},which:function(g){return"keypress"===g.type?Ie(g):"keydown"===g.type||"keyup"===g.type?g.keyCode:0}}),Se=Ce(Ve),Re=Ce(w({},se,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Xe=Ce(w({},Ae,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:We})),Je=Ce(w({},ae,{propertyName:0,elapsedTime:0,pseudoElement:0})),ke=w({},se,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=Ce(ke),ve=[9,13,27,32],Ye=A&&"CompositionEvent"in window,He=null;A&&"documentMode"in document&&(He=document.documentMode);var Ne=A&&"TextEvent"in window&&!He,Ke=A&&(!Ye||He&&8<He&&11>=He),we=String.fromCharCode(32),Fe=!1;function xe(g,I){switch(g){case"keyup":return-1!==ve.indexOf(I.keyCode);case"keydown":return 229!==I.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ze(g){return"object"===typeof(g=g.detail)&&"data"in g?g.data:null}var Me=!1;var Ee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ue(g){var I=g&&g.nodeName&&g.nodeName.toLowerCase();return"input"===I?!!Ee[g.type]:"textarea"===I}function Qe(g,I,e,t){Sg(t),0<(I=Lt(I,"onChange")).length&&(e=new ie("onChange","change",null,e,t),g.push({event:e,listeners:I}))}var Le=null,De=null;function Te(g){wt(g,0)}function je(g){if(T(ZC(g)))return g}function Pe(g,I){if("change"===g)return I}var Oe=!1;if(A){var _e;if(A){var qe="oninput"in document;if(!qe){var $e=document.createElement("div");$e.setAttribute("oninput","return;"),qe="function"===typeof $e.oninput}_e=qe}else _e=!1;Oe=_e&&(!document.documentMode||9<document.documentMode)}function gt(){Le&&(Le.detachEvent("onpropertychange",It),De=Le=null)}function It(g){if("value"===g.propertyName&&je(De)){var I=[];Qe(I,De,g,pg(g)),fg(Te,I)}}function et(g,I,e){"focusin"===g?(gt(),De=e,(Le=I).attachEvent("onpropertychange",It)):"focusout"===g&&gt()}function tt(g){if("selectionchange"===g||"keyup"===g||"keydown"===g)return je(De)}function Ct(g,I){if("click"===g)return je(I)}function lt(g,I){if("input"===g||"change"===g)return je(I)}var nt="function"===typeof Object.is?Object.is:function(g,I){return g===I&&(0!==g||1/g===1/I)||g!==g&&I!==I};function ot(g,I){if(nt(g,I))return!0;if("object"!==typeof g||null===g||"object"!==typeof I||null===I)return!1;var e=Object.keys(g),t=Object.keys(I);if(e.length!==t.length)return!1;for(t=0;t<e.length;t++){var C=e[t];if(!c.call(I,C)||!nt(g[C],I[C]))return!1}return!0}function at(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function it(g,I){var e,t=at(g);for(g=0;t;){if(3===t.nodeType){if(e=g+t.textContent.length,g<=I&&e>=I)return{node:t,offset:I-g};g=e}g:{for(;t;){if(t.nextSibling){t=t.nextSibling;break g}t=t.parentNode}t=void 0}t=at(t)}}function At(g,I){return!(!g||!I)&&(g===I||(!g||3!==g.nodeType)&&(I&&3===I.nodeType?At(g,I.parentNode):"contains"in g?g.contains(I):!!g.compareDocumentPosition&&!!(16&g.compareDocumentPosition(I))))}function ct(){for(var g=window,I=j();I instanceof g.HTMLIFrameElement;){try{var e="string"===typeof I.contentWindow.location.href}catch(t){e=!1}if(!e)break;I=j((g=I.contentWindow).document)}return I}function st(g){var I=g&&g.nodeName&&g.nodeName.toLowerCase();return I&&("input"===I&&("text"===g.type||"search"===g.type||"tel"===g.type||"url"===g.type||"password"===g.type)||"textarea"===I||"true"===g.contentEditable)}function dt(g){var I=ct(),e=g.focusedElem,t=g.selectionRange;if(I!==e&&e&&e.ownerDocument&&At(e.ownerDocument.documentElement,e)){if(null!==t&&st(e))if(I=t.start,void 0===(g=t.end)&&(g=I),"selectionStart"in e)e.selectionStart=I,e.selectionEnd=Math.min(g,e.value.length);else if((g=(I=e.ownerDocument||document)&&I.defaultView||window).getSelection){g=g.getSelection();var C=e.textContent.length,l=Math.min(t.start,C);t=void 0===t.end?l:Math.min(t.end,C),!g.extend&&l>t&&(C=t,t=l,l=C),C=it(e,l);var n=it(e,t);C&&n&&(1!==g.rangeCount||g.anchorNode!==C.node||g.anchorOffset!==C.offset||g.focusNode!==n.node||g.focusOffset!==n.offset)&&((I=I.createRange()).setStart(C.node,C.offset),g.removeAllRanges(),l>t?(g.addRange(I),g.extend(n.node,n.offset)):(I.setEnd(n.node,n.offset),g.addRange(I)))}for(I=[],g=e;g=g.parentNode;)1===g.nodeType&&I.push({element:g,left:g.scrollLeft,top:g.scrollTop});for("function"===typeof e.focus&&e.focus(),e=0;e<I.length;e++)(g=I[e]).element.scrollLeft=g.left,g.element.scrollTop=g.top}}var rt=A&&"documentMode"in document&&11>=document.documentMode,ut=null,bt=null,mt=null,ht=!1;function Zt(g,I,e){var t=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;ht||null==ut||ut!==j(t)||("selectionStart"in(t=ut)&&st(t)?t={start:t.selectionStart,end:t.selectionEnd}:t={anchorNode:(t=(t.ownerDocument&&t.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset},mt&&ot(mt,t)||(mt=t,0<(t=Lt(bt,"onSelect")).length&&(I=new ie("onSelect","select",null,I,e),g.push({event:I,listeners:t}),I.target=ut)))}function Gt(g,I){var e={};return e[g.toLowerCase()]=I.toLowerCase(),e["Webkit"+g]="webkit"+I,e["Moz"+g]="moz"+I,e}var pt={animationend:Gt("Animation","AnimationEnd"),animationiteration:Gt("Animation","AnimationIteration"),animationstart:Gt("Animation","AnimationStart"),transitionend:Gt("Transition","TransitionEnd")},Bt={},yt={};function Wt(g){if(Bt[g])return Bt[g];if(!pt[g])return g;var I,e=pt[g];for(I in e)if(e.hasOwnProperty(I)&&I in yt)return Bt[g]=e[I];return g}A&&(yt=document.createElement("div").style,"AnimationEvent"in window||(delete pt.animationend.animation,delete pt.animationiteration.animation,delete pt.animationstart.animation),"TransitionEvent"in window||delete pt.transitionend.transition);var Vt=Wt("animationend"),St=Wt("animationiteration"),Rt=Wt("animationstart"),Xt=Wt("transitionend"),Jt=new Map,kt="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ft(g,I){Jt.set(g,I),a(I,[g])}for(var vt=0;vt<kt.length;vt++){var Yt=kt[vt];ft(Yt.toLowerCase(),"on"+(Yt[0].toUpperCase()+Yt.slice(1)))}ft(Vt,"onAnimationEnd"),ft(St,"onAnimationIteration"),ft(Rt,"onAnimationStart"),ft("dblclick","onDoubleClick"),ft("focusin","onFocus"),ft("focusout","onBlur"),ft(Xt,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ht="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nt=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ht));function Kt(g,I,e){var t=g.type||"unknown-event";g.currentTarget=e,function(g,I,e,t,C,n,o,a,i){if(Mg.apply(this,arguments),Kg){if(!Kg)throw Error(l(198));var A=wg;Kg=!1,wg=null,Fg||(Fg=!0,xg=A)}}(t,I,void 0,g),g.currentTarget=null}function wt(g,I){I=0!==(4&I);for(var e=0;e<g.length;e++){var t=g[e],C=t.event;t=t.listeners;g:{var l=void 0;if(I)for(var n=t.length-1;0<=n;n--){var o=t[n],a=o.instance,i=o.currentTarget;if(o=o.listener,a!==l&&C.isPropagationStopped())break g;Kt(C,o,i),l=a}else for(n=0;n<t.length;n++){if(a=(o=t[n]).instance,i=o.currentTarget,o=o.listener,a!==l&&C.isPropagationStopped())break g;Kt(C,o,i),l=a}}}if(Fg)throw g=xg,Fg=!1,xg=null,g}function Ft(g,I){var e=I[rC];void 0===e&&(e=I[rC]=new Set);var t=g+"__bubble";e.has(t)||(Et(I,g,2,!1),e.add(t))}function xt(g,I,e){var t=0;I&&(t|=4),Et(e,g,t,I)}var zt="_reactListening"+Math.random().toString(36).slice(2);function Mt(g){if(!g[zt]){g[zt]=!0,n.forEach((function(I){"selectionchange"!==I&&(Nt.has(I)||xt(I,!1,g),xt(I,!0,g))}));var I=9===g.nodeType?g:g.ownerDocument;null===I||I[zt]||(I[zt]=!0,xt("selectionchange",!1,I))}}function Et(g,I,e,t){switch(OI(I)){case 1:var C=LI;break;case 4:C=DI;break;default:C=TI}e=C.bind(null,I,e,g),C=void 0,!Yg||"touchstart"!==I&&"touchmove"!==I&&"wheel"!==I||(C=!0),t?void 0!==C?g.addEventListener(I,e,{capture:!0,passive:C}):g.addEventListener(I,e,!0):void 0!==C?g.addEventListener(I,e,{passive:C}):g.addEventListener(I,e,!1)}function Ut(g,I,e,t,C){var l=t;if(0===(1&I)&&0===(2&I)&&null!==t)g:for(;;){if(null===t)return;var n=t.tag;if(3===n||4===n){var o=t.stateNode.containerInfo;if(o===C||8===o.nodeType&&o.parentNode===C)break;if(4===n)for(n=t.return;null!==n;){var a=n.tag;if((3===a||4===a)&&((a=n.stateNode.containerInfo)===C||8===a.nodeType&&a.parentNode===C))return;n=n.return}for(;null!==o;){if(null===(n=mC(o)))return;if(5===(a=n.tag)||6===a){t=l=n;continue g}o=o.parentNode}}t=t.return}fg((function(){var t=l,C=pg(e),n=[];g:{var o=Jt.get(g);if(void 0!==o){var a=ie,i=g;switch(g){case"keypress":if(0===Ie(e))break g;case"keydown":case"keyup":a=Se;break;case"focusin":i="focus",a=ue;break;case"focusout":i="blur",a=ue;break;case"beforeblur":case"afterblur":a=ue;break;case"click":if(2===e.button)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=de;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=re;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=Xe;break;case Vt:case St:case Rt:a=be;break;case Xt:a=Je;break;case"scroll":a=ce;break;case"wheel":a=fe;break;case"copy":case"cut":case"paste":a=he;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=Re}var A=0!==(4&I),c=!A&&"scroll"===g,s=A?null!==o?o+"Capture":null:o;A=[];for(var d,r=t;null!==r;){var u=(d=r).stateNode;if(5===d.tag&&null!==u&&(d=u,null!==s&&(null!=(u=vg(r,s))&&A.push(Qt(r,u,d)))),c)break;r=r.return}0<A.length&&(o=new a(o,i,null,e,C),n.push({event:o,listeners:A}))}}if(0===(7&I)){if(a="mouseout"===g||"pointerout"===g,(!(o="mouseover"===g||"pointerover"===g)||e===Gg||!(i=e.relatedTarget||e.fromElement)||!mC(i)&&!i[dC])&&(a||o)&&(o=C.window===C?C:(o=C.ownerDocument)?o.defaultView||o.parentWindow:window,a?(a=t,null!==(i=(i=e.relatedTarget||e.toElement)?mC(i):null)&&(i!==(c=Eg(i))||5!==i.tag&&6!==i.tag)&&(i=null)):(a=null,i=t),a!==i)){if(A=de,u="onMouseLeave",s="onMouseEnter",r="mouse","pointerout"!==g&&"pointerover"!==g||(A=Re,u="onPointerLeave",s="onPointerEnter",r="pointer"),c=null==a?o:ZC(a),d=null==i?o:ZC(i),(o=new A(u,r+"leave",a,e,C)).target=c,o.relatedTarget=d,u=null,mC(C)===t&&((A=new A(s,r+"enter",i,e,C)).target=d,A.relatedTarget=c,u=A),c=u,a&&i)g:{for(s=i,r=0,d=A=a;d;d=Dt(d))r++;for(d=0,u=s;u;u=Dt(u))d++;for(;0<r-d;)A=Dt(A),r--;for(;0<d-r;)s=Dt(s),d--;for(;r--;){if(A===s||null!==s&&A===s.alternate)break g;A=Dt(A),s=Dt(s)}A=null}else A=null;null!==a&&Tt(n,o,a,A,!1),null!==i&&null!==c&&Tt(n,c,i,A,!0)}if("select"===(a=(o=t?ZC(t):window).nodeName&&o.nodeName.toLowerCase())||"input"===a&&"file"===o.type)var b=Pe;else if(Ue(o))if(Oe)b=lt;else{b=tt;var m=et}else(a=o.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(b=Ct);switch(b&&(b=b(g,t))?Qe(n,b,e,C):(m&&m(g,o,t),"focusout"===g&&(m=o._wrapperState)&&m.controlled&&"number"===o.type&&gg(o,"number",o.value)),m=t?ZC(t):window,g){case"focusin":(Ue(m)||"true"===m.contentEditable)&&(ut=m,bt=t,mt=null);break;case"focusout":mt=bt=ut=null;break;case"mousedown":ht=!0;break;case"contextmenu":case"mouseup":case"dragend":ht=!1,Zt(n,e,C);break;case"selectionchange":if(rt)break;case"keydown":case"keyup":Zt(n,e,C)}var h;if(Ye)g:{switch(g){case"compositionstart":var Z="onCompositionStart";break g;case"compositionend":Z="onCompositionEnd";break g;case"compositionupdate":Z="onCompositionUpdate";break g}Z=void 0}else Me?xe(g,e)&&(Z="onCompositionEnd"):"keydown"===g&&229===e.keyCode&&(Z="onCompositionStart");Z&&(Ke&&"ko"!==e.locale&&(Me||"onCompositionStart"!==Z?"onCompositionEnd"===Z&&Me&&(h=ge()):(qI="value"in(_I=C)?_I.value:_I.textContent,Me=!0)),0<(m=Lt(t,Z)).length&&(Z=new Ze(Z,g,null,e,C),n.push({event:Z,listeners:m}),h?Z.data=h:null!==(h=ze(e))&&(Z.data=h))),(h=Ne?function(g,I){switch(g){case"compositionend":return ze(I);case"keypress":return 32!==I.which?null:(Fe=!0,we);case"textInput":return(g=I.data)===we&&Fe?null:g;default:return null}}(g,e):function(g,I){if(Me)return"compositionend"===g||!Ye&&xe(g,I)?(g=ge(),$I=qI=_I=null,Me=!1,g):null;switch(g){case"paste":default:return null;case"keypress":if(!(I.ctrlKey||I.altKey||I.metaKey)||I.ctrlKey&&I.altKey){if(I.char&&1<I.char.length)return I.char;if(I.which)return String.fromCharCode(I.which)}return null;case"compositionend":return Ke&&"ko"!==I.locale?null:I.data}}(g,e))&&(0<(t=Lt(t,"onBeforeInput")).length&&(C=new Ze("onBeforeInput","beforeinput",null,e,C),n.push({event:C,listeners:t}),C.data=h))}wt(n,I)}))}function Qt(g,I,e){return{instance:g,listener:I,currentTarget:e}}function Lt(g,I){for(var e=I+"Capture",t=[];null!==g;){var C=g,l=C.stateNode;5===C.tag&&null!==l&&(C=l,null!=(l=vg(g,e))&&t.unshift(Qt(g,l,C)),null!=(l=vg(g,I))&&t.push(Qt(g,l,C))),g=g.return}return t}function Dt(g){if(null===g)return null;do{g=g.return}while(g&&5!==g.tag);return g||null}function Tt(g,I,e,t,C){for(var l=I._reactName,n=[];null!==e&&e!==t;){var o=e,a=o.alternate,i=o.stateNode;if(null!==a&&a===t)break;5===o.tag&&null!==i&&(o=i,C?null!=(a=vg(e,l))&&n.unshift(Qt(e,a,o)):C||null!=(a=vg(e,l))&&n.push(Qt(e,a,o))),e=e.return}0!==n.length&&g.push({event:I,listeners:n})}var jt=/\r\n?/g,Pt=/\u0000|\uFFFD/g;function Ot(g){return("string"===typeof g?g:""+g).replace(jt,"\n").replace(Pt,"")}function _t(g,I,e){if(I=Ot(I),Ot(g)!==I&&e)throw Error(l(425))}function qt(){}var $t=null,gC=null;function IC(g,I){return"textarea"===g||"noscript"===g||"string"===typeof I.children||"number"===typeof I.children||"object"===typeof I.dangerouslySetInnerHTML&&null!==I.dangerouslySetInnerHTML&&null!=I.dangerouslySetInnerHTML.__html}var eC="function"===typeof setTimeout?setTimeout:void 0,tC="function"===typeof clearTimeout?clearTimeout:void 0,CC="function"===typeof Promise?Promise:void 0,lC="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof CC?function(g){return CC.resolve(null).then(g).catch(nC)}:eC;function nC(g){setTimeout((function(){throw g}))}function oC(g,I){var e=I,t=0;do{var C=e.nextSibling;if(g.removeChild(e),C&&8===C.nodeType)if("/$"===(e=C.data)){if(0===t)return g.removeChild(C),void EI(I);t--}else"$"!==e&&"$?"!==e&&"$!"!==e||t++;e=C}while(e);EI(I)}function aC(g){for(;null!=g;g=g.nextSibling){var I=g.nodeType;if(1===I||3===I)break;if(8===I){if("$"===(I=g.data)||"$!"===I||"$?"===I)break;if("/$"===I)return null}}return g}function iC(g){g=g.previousSibling;for(var I=0;g;){if(8===g.nodeType){var e=g.data;if("$"===e||"$!"===e||"$?"===e){if(0===I)return g;I--}else"/$"===e&&I++}g=g.previousSibling}return null}var AC=Math.random().toString(36).slice(2),cC="__reactFiber$"+AC,sC="__reactProps$"+AC,dC="__reactContainer$"+AC,rC="__reactEvents$"+AC,uC="__reactListeners$"+AC,bC="__reactHandles$"+AC;function mC(g){var I=g[cC];if(I)return I;for(var e=g.parentNode;e;){if(I=e[dC]||e[cC]){if(e=I.alternate,null!==I.child||null!==e&&null!==e.child)for(g=iC(g);null!==g;){if(e=g[cC])return e;g=iC(g)}return I}e=(g=e).parentNode}return null}function hC(g){return!(g=g[cC]||g[dC])||5!==g.tag&&6!==g.tag&&13!==g.tag&&3!==g.tag?null:g}function ZC(g){if(5===g.tag||6===g.tag)return g.stateNode;throw Error(l(33))}function GC(g){return g[sC]||null}var pC=[],BC=-1;function yC(g){return{current:g}}function WC(g){0>BC||(g.current=pC[BC],pC[BC]=null,BC--)}function VC(g,I){BC++,pC[BC]=g.current,g.current=I}var SC={},RC=yC(SC),XC=yC(!1),JC=SC;function kC(g,I){var e=g.type.contextTypes;if(!e)return SC;var t=g.stateNode;if(t&&t.__reactInternalMemoizedUnmaskedChildContext===I)return t.__reactInternalMemoizedMaskedChildContext;var C,l={};for(C in e)l[C]=I[C];return t&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=I,g.__reactInternalMemoizedMaskedChildContext=l),l}function fC(g){return null!==(g=g.childContextTypes)&&void 0!==g}function vC(){WC(XC),WC(RC)}function YC(g,I,e){if(RC.current!==SC)throw Error(l(168));VC(RC,I),VC(XC,e)}function HC(g,I,e){var t=g.stateNode;if(I=I.childContextTypes,"function"!==typeof t.getChildContext)return e;for(var C in t=t.getChildContext())if(!(C in I))throw Error(l(108,U(g)||"Unknown",C));return w({},e,t)}function NC(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||SC,JC=RC.current,VC(RC,g),VC(XC,XC.current),!0}function KC(g,I,e){var t=g.stateNode;if(!t)throw Error(l(169));e?(g=HC(g,I,JC),t.__reactInternalMemoizedMergedChildContext=g,WC(XC),WC(RC),VC(RC,g)):WC(XC),VC(XC,e)}var wC=null,FC=!1,xC=!1;function zC(g){null===wC?wC=[g]:wC.push(g)}function MC(){if(!xC&&null!==wC){xC=!0;var g=0,I=ZI;try{var e=wC;for(ZI=1;g<e.length;g++){var t=e[g];do{t=t(!0)}while(null!==t)}wC=null,FC=!1}catch(C){throw null!==wC&&(wC=wC.slice(g+1)),Tg($g,MC),C}finally{ZI=I,xC=!1}}return null}var EC=[],UC=0,QC=null,LC=0,DC=[],TC=0,jC=null,PC=1,OC="";function _C(g,I){EC[UC++]=LC,EC[UC++]=QC,QC=g,LC=I}function qC(g,I,e){DC[TC++]=PC,DC[TC++]=OC,DC[TC++]=jC,jC=g;var t=PC;g=OC;var C=32-nI(t)-1;t&=~(1<<C),e+=1;var l=32-nI(I)+C;if(30<l){var n=C-C%5;l=(t&(1<<n)-1).toString(32),t>>=n,C-=n,PC=1<<32-nI(I)+C|e<<C|t,OC=l+g}else PC=1<<l|e<<C|t,OC=g}function $C(g){null!==g.return&&(_C(g,1),qC(g,1,0))}function gl(g){for(;g===QC;)QC=EC[--UC],EC[UC]=null,LC=EC[--UC],EC[UC]=null;for(;g===jC;)jC=DC[--TC],DC[TC]=null,OC=DC[--TC],DC[TC]=null,PC=DC[--TC],DC[TC]=null}var Il=null,el=null,tl=!1,Cl=null;function ll(g,I){var e=fi(5,null,null,0);e.elementType="DELETED",e.stateNode=I,e.return=g,null===(I=g.deletions)?(g.deletions=[e],g.flags|=16):I.push(e)}function nl(g,I){switch(g.tag){case 5:var e=g.type;return null!==(I=1!==I.nodeType||e.toLowerCase()!==I.nodeName.toLowerCase()?null:I)&&(g.stateNode=I,Il=g,el=aC(I.firstChild),!0);case 6:return null!==(I=""===g.pendingProps||3!==I.nodeType?null:I)&&(g.stateNode=I,Il=g,el=null,!0);case 13:return null!==(I=8!==I.nodeType?null:I)&&(e=null!==jC?{id:PC,overflow:OC}:null,g.memoizedState={dehydrated:I,treeContext:e,retryLane:1073741824},(e=fi(18,null,null,0)).stateNode=I,e.return=g,g.child=e,Il=g,el=null,!0);default:return!1}}function ol(g){return 0!==(1&g.mode)&&0===(128&g.flags)}function al(g){if(tl){var I=el;if(I){var e=I;if(!nl(g,I)){if(ol(g))throw Error(l(418));I=aC(e.nextSibling);var t=Il;I&&nl(g,I)?ll(t,e):(g.flags=-4097&g.flags|2,tl=!1,Il=g)}}else{if(ol(g))throw Error(l(418));g.flags=-4097&g.flags|2,tl=!1,Il=g}}}function il(g){for(g=g.return;null!==g&&5!==g.tag&&3!==g.tag&&13!==g.tag;)g=g.return;Il=g}function Al(g){if(g!==Il)return!1;if(!tl)return il(g),tl=!0,!1;var I;if((I=3!==g.tag)&&!(I=5!==g.tag)&&(I="head"!==(I=g.type)&&"body"!==I&&!IC(g.type,g.memoizedProps)),I&&(I=el)){if(ol(g))throw cl(),Error(l(418));for(;I;)ll(g,I),I=aC(I.nextSibling)}if(il(g),13===g.tag){if(!(g=null!==(g=g.memoizedState)?g.dehydrated:null))throw Error(l(317));g:{for(g=g.nextSibling,I=0;g;){if(8===g.nodeType){var e=g.data;if("/$"===e){if(0===I){el=aC(g.nextSibling);break g}I--}else"$"!==e&&"$!"!==e&&"$?"!==e||I++}g=g.nextSibling}el=null}}else el=Il?aC(g.stateNode.nextSibling):null;return!0}function cl(){for(var g=el;g;)g=aC(g.nextSibling)}function sl(){el=Il=null,tl=!1}function dl(g){null===Cl?Cl=[g]:Cl.push(g)}var rl=G.ReactCurrentBatchConfig;function ul(g,I,e){if(null!==(g=e.ref)&&"function"!==typeof g&&"object"!==typeof g){if(e._owner){if(e=e._owner){if(1!==e.tag)throw Error(l(309));var t=e.stateNode}if(!t)throw Error(l(147,g));var C=t,n=""+g;return null!==I&&null!==I.ref&&"function"===typeof I.ref&&I.ref._stringRef===n?I.ref:(I=function(g){var I=C.refs;null===g?delete I[n]:I[n]=g},I._stringRef=n,I)}if("string"!==typeof g)throw Error(l(284));if(!e._owner)throw Error(l(290,g))}return g}function bl(g,I){throw g=Object.prototype.toString.call(I),Error(l(31,"[object Object]"===g?"object with keys {"+Object.keys(I).join(", ")+"}":g))}function ml(g){return(0,g._init)(g._payload)}function hl(g){function I(I,e){if(g){var t=I.deletions;null===t?(I.deletions=[e],I.flags|=16):t.push(e)}}function e(e,t){if(!g)return null;for(;null!==t;)I(e,t),t=t.sibling;return null}function t(g,I){for(g=new Map;null!==I;)null!==I.key?g.set(I.key,I):g.set(I.index,I),I=I.sibling;return g}function C(g,I){return(g=Yi(g,I)).index=0,g.sibling=null,g}function n(I,e,t){return I.index=t,g?null!==(t=I.alternate)?(t=t.index)<e?(I.flags|=2,e):t:(I.flags|=2,e):(I.flags|=1048576,e)}function o(I){return g&&null===I.alternate&&(I.flags|=2),I}function a(g,I,e,t){return null===I||6!==I.tag?((I=wi(e,g.mode,t)).return=g,I):((I=C(I,e)).return=g,I)}function i(g,I,e,t){var l=e.type;return l===y?c(g,I,e.props.children,t,e.key):null!==I&&(I.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===v&&ml(l)===I.type)?((t=C(I,e.props)).ref=ul(g,I,e),t.return=g,t):((t=Hi(e.type,e.key,e.props,null,g.mode,t)).ref=ul(g,I,e),t.return=g,t)}function A(g,I,e,t){return null===I||4!==I.tag||I.stateNode.containerInfo!==e.containerInfo||I.stateNode.implementation!==e.implementation?((I=Fi(e,g.mode,t)).return=g,I):((I=C(I,e.children||[])).return=g,I)}function c(g,I,e,t,l){return null===I||7!==I.tag?((I=Ni(e,g.mode,t,l)).return=g,I):((I=C(I,e)).return=g,I)}function s(g,I,e){if("string"===typeof I&&""!==I||"number"===typeof I)return(I=wi(""+I,g.mode,e)).return=g,I;if("object"===typeof I&&null!==I){switch(I.$$typeof){case p:return(e=Hi(I.type,I.key,I.props,null,g.mode,e)).ref=ul(g,null,I),e.return=g,e;case B:return(I=Fi(I,g.mode,e)).return=g,I;case v:return s(g,(0,I._init)(I._payload),e)}if(Ig(I)||N(I))return(I=Ni(I,g.mode,e,null)).return=g,I;bl(g,I)}return null}function d(g,I,e,t){var C=null!==I?I.key:null;if("string"===typeof e&&""!==e||"number"===typeof e)return null!==C?null:a(g,I,""+e,t);if("object"===typeof e&&null!==e){switch(e.$$typeof){case p:return e.key===C?i(g,I,e,t):null;case B:return e.key===C?A(g,I,e,t):null;case v:return d(g,I,(C=e._init)(e._payload),t)}if(Ig(e)||N(e))return null!==C?null:c(g,I,e,t,null);bl(g,e)}return null}function r(g,I,e,t,C){if("string"===typeof t&&""!==t||"number"===typeof t)return a(I,g=g.get(e)||null,""+t,C);if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return i(I,g=g.get(null===t.key?e:t.key)||null,t,C);case B:return A(I,g=g.get(null===t.key?e:t.key)||null,t,C);case v:return r(g,I,e,(0,t._init)(t._payload),C)}if(Ig(t)||N(t))return c(I,g=g.get(e)||null,t,C,null);bl(I,t)}return null}function u(C,l,o,a){for(var i=null,A=null,c=l,u=l=0,b=null;null!==c&&u<o.length;u++){c.index>u?(b=c,c=null):b=c.sibling;var m=d(C,c,o[u],a);if(null===m){null===c&&(c=b);break}g&&c&&null===m.alternate&&I(C,c),l=n(m,l,u),null===A?i=m:A.sibling=m,A=m,c=b}if(u===o.length)return e(C,c),tl&&_C(C,u),i;if(null===c){for(;u<o.length;u++)null!==(c=s(C,o[u],a))&&(l=n(c,l,u),null===A?i=c:A.sibling=c,A=c);return tl&&_C(C,u),i}for(c=t(C,c);u<o.length;u++)null!==(b=r(c,C,u,o[u],a))&&(g&&null!==b.alternate&&c.delete(null===b.key?u:b.key),l=n(b,l,u),null===A?i=b:A.sibling=b,A=b);return g&&c.forEach((function(g){return I(C,g)})),tl&&_C(C,u),i}function b(C,o,a,i){var A=N(a);if("function"!==typeof A)throw Error(l(150));if(null==(a=A.call(a)))throw Error(l(151));for(var c=A=null,u=o,b=o=0,m=null,h=a.next();null!==u&&!h.done;b++,h=a.next()){u.index>b?(m=u,u=null):m=u.sibling;var Z=d(C,u,h.value,i);if(null===Z){null===u&&(u=m);break}g&&u&&null===Z.alternate&&I(C,u),o=n(Z,o,b),null===c?A=Z:c.sibling=Z,c=Z,u=m}if(h.done)return e(C,u),tl&&_C(C,b),A;if(null===u){for(;!h.done;b++,h=a.next())null!==(h=s(C,h.value,i))&&(o=n(h,o,b),null===c?A=h:c.sibling=h,c=h);return tl&&_C(C,b),A}for(u=t(C,u);!h.done;b++,h=a.next())null!==(h=r(u,C,b,h.value,i))&&(g&&null!==h.alternate&&u.delete(null===h.key?b:h.key),o=n(h,o,b),null===c?A=h:c.sibling=h,c=h);return g&&u.forEach((function(g){return I(C,g)})),tl&&_C(C,b),A}return function g(t,l,n,a){if("object"===typeof n&&null!==n&&n.type===y&&null===n.key&&(n=n.props.children),"object"===typeof n&&null!==n){switch(n.$$typeof){case p:g:{for(var i=n.key,A=l;null!==A;){if(A.key===i){if((i=n.type)===y){if(7===A.tag){e(t,A.sibling),(l=C(A,n.props.children)).return=t,t=l;break g}}else if(A.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===v&&ml(i)===A.type){e(t,A.sibling),(l=C(A,n.props)).ref=ul(t,A,n),l.return=t,t=l;break g}e(t,A);break}I(t,A),A=A.sibling}n.type===y?((l=Ni(n.props.children,t.mode,a,n.key)).return=t,t=l):((a=Hi(n.type,n.key,n.props,null,t.mode,a)).ref=ul(t,l,n),a.return=t,t=a)}return o(t);case B:g:{for(A=n.key;null!==l;){if(l.key===A){if(4===l.tag&&l.stateNode.containerInfo===n.containerInfo&&l.stateNode.implementation===n.implementation){e(t,l.sibling),(l=C(l,n.children||[])).return=t,t=l;break g}e(t,l);break}I(t,l),l=l.sibling}(l=Fi(n,t.mode,a)).return=t,t=l}return o(t);case v:return g(t,l,(A=n._init)(n._payload),a)}if(Ig(n))return u(t,l,n,a);if(N(n))return b(t,l,n,a);bl(t,n)}return"string"===typeof n&&""!==n||"number"===typeof n?(n=""+n,null!==l&&6===l.tag?(e(t,l.sibling),(l=C(l,n)).return=t,t=l):(e(t,l),(l=wi(n,t.mode,a)).return=t,t=l),o(t)):e(t,l)}}var Zl=hl(!0),Gl=hl(!1),pl=yC(null),Bl=null,yl=null,Wl=null;function Vl(){Wl=yl=Bl=null}function Sl(g){var I=pl.current;WC(pl),g._currentValue=I}function Rl(g,I,e){for(;null!==g;){var t=g.alternate;if((g.childLanes&I)!==I?(g.childLanes|=I,null!==t&&(t.childLanes|=I)):null!==t&&(t.childLanes&I)!==I&&(t.childLanes|=I),g===e)break;g=g.return}}function Xl(g,I){Bl=g,Wl=yl=null,null!==(g=g.dependencies)&&null!==g.firstContext&&(0!==(g.lanes&I)&&(Zo=!0),g.firstContext=null)}function Jl(g){var I=g._currentValue;if(Wl!==g)if(g={context:g,memoizedValue:I,next:null},null===yl){if(null===Bl)throw Error(l(308));yl=g,Bl.dependencies={lanes:0,firstContext:g}}else yl=yl.next=g;return I}var kl=null;function fl(g){null===kl?kl=[g]:kl.push(g)}function vl(g,I,e,t){var C=I.interleaved;return null===C?(e.next=e,fl(I)):(e.next=C.next,C.next=e),I.interleaved=e,Yl(g,t)}function Yl(g,I){g.lanes|=I;var e=g.alternate;for(null!==e&&(e.lanes|=I),e=g,g=g.return;null!==g;)g.childLanes|=I,null!==(e=g.alternate)&&(e.childLanes|=I),e=g,g=g.return;return 3===e.tag?e.stateNode:null}var Hl=!1;function Nl(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kl(g,I){g=g.updateQueue,I.updateQueue===g&&(I.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function wl(g,I){return{eventTime:g,lane:I,tag:0,payload:null,callback:null,next:null}}function Fl(g,I,e){var t=g.updateQueue;if(null===t)return null;if(t=t.shared,0!==(2&Xa)){var C=t.pending;return null===C?I.next=I:(I.next=C.next,C.next=I),t.pending=I,Yl(g,e)}return null===(C=t.interleaved)?(I.next=I,fl(t)):(I.next=C.next,C.next=I),t.interleaved=I,Yl(g,e)}function xl(g,I,e){if(null!==(I=I.updateQueue)&&(I=I.shared,0!==(4194240&e))){var t=I.lanes;e|=t&=g.pendingLanes,I.lanes=e,hI(g,e)}}function zl(g,I){var e=g.updateQueue,t=g.alternate;if(null!==t&&e===(t=t.updateQueue)){var C=null,l=null;if(null!==(e=e.firstBaseUpdate)){do{var n={eventTime:e.eventTime,lane:e.lane,tag:e.tag,payload:e.payload,callback:e.callback,next:null};null===l?C=l=n:l=l.next=n,e=e.next}while(null!==e);null===l?C=l=I:l=l.next=I}else C=l=I;return e={baseState:t.baseState,firstBaseUpdate:C,lastBaseUpdate:l,shared:t.shared,effects:t.effects},void(g.updateQueue=e)}null===(g=e.lastBaseUpdate)?e.firstBaseUpdate=I:g.next=I,e.lastBaseUpdate=I}function Ml(g,I,e,t){var C=g.updateQueue;Hl=!1;var l=C.firstBaseUpdate,n=C.lastBaseUpdate,o=C.shared.pending;if(null!==o){C.shared.pending=null;var a=o,i=a.next;a.next=null,null===n?l=i:n.next=i,n=a;var A=g.alternate;null!==A&&((o=(A=A.updateQueue).lastBaseUpdate)!==n&&(null===o?A.firstBaseUpdate=i:o.next=i,A.lastBaseUpdate=a))}if(null!==l){var c=C.baseState;for(n=0,A=i=a=null,o=l;;){var s=o.lane,d=o.eventTime;if((t&s)===s){null!==A&&(A=A.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});g:{var r=g,u=o;switch(s=I,d=e,u.tag){case 1:if("function"===typeof(r=u.payload)){c=r.call(d,c,s);break g}c=r;break g;case 3:r.flags=-65537&r.flags|128;case 0:if(null===(s="function"===typeof(r=u.payload)?r.call(d,c,s):r)||void 0===s)break g;c=w({},c,s);break g;case 2:Hl=!0}}null!==o.callback&&0!==o.lane&&(g.flags|=64,null===(s=C.effects)?C.effects=[o]:s.push(o))}else d={eventTime:d,lane:s,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===A?(i=A=d,a=c):A=A.next=d,n|=s;if(null===(o=o.next)){if(null===(o=C.shared.pending))break;o=(s=o).next,s.next=null,C.lastBaseUpdate=s,C.shared.pending=null}}if(null===A&&(a=c),C.baseState=a,C.firstBaseUpdate=i,C.lastBaseUpdate=A,null!==(I=C.shared.interleaved)){C=I;do{n|=C.lane,C=C.next}while(C!==I)}else null===l&&(C.shared.lanes=0);Ka|=n,g.lanes=n,g.memoizedState=c}}function El(g,I,e){if(g=I.effects,I.effects=null,null!==g)for(I=0;I<g.length;I++){var t=g[I],C=t.callback;if(null!==C){if(t.callback=null,t=e,"function"!==typeof C)throw Error(l(191,C));C.call(t)}}}var Ul={},Ql=yC(Ul),Ll=yC(Ul),Dl=yC(Ul);function Tl(g){if(g===Ul)throw Error(l(174));return g}function jl(g,I){switch(VC(Dl,I),VC(Ll,g),VC(Ql,Ul),g=I.nodeType){case 9:case 11:I=(I=I.documentElement)?I.namespaceURI:ag(null,"");break;default:I=ag(I=(g=8===g?I.parentNode:I).namespaceURI||null,g=g.tagName)}WC(Ql),VC(Ql,I)}function Pl(){WC(Ql),WC(Ll),WC(Dl)}function Ol(g){Tl(Dl.current);var I=Tl(Ql.current),e=ag(I,g.type);I!==e&&(VC(Ll,g),VC(Ql,e))}function _l(g){Ll.current===g&&(WC(Ql),WC(Ll))}var ql=yC(0);function $l(g){for(var I=g;null!==I;){if(13===I.tag){var e=I.memoizedState;if(null!==e&&(null===(e=e.dehydrated)||"$?"===e.data||"$!"===e.data))return I}else if(19===I.tag&&void 0!==I.memoizedProps.revealOrder){if(0!==(128&I.flags))return I}else if(null!==I.child){I.child.return=I,I=I.child;continue}if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return null;I=I.return}I.sibling.return=I.return,I=I.sibling}return null}var gn=[];function In(){for(var g=0;g<gn.length;g++)gn[g]._workInProgressVersionPrimary=null;gn.length=0}var en=G.ReactCurrentDispatcher,tn=G.ReactCurrentBatchConfig,Cn=0,ln=null,nn=null,on=null,an=!1,An=!1,cn=0,sn=0;function dn(){throw Error(l(321))}function rn(g,I){if(null===I)return!1;for(var e=0;e<I.length&&e<g.length;e++)if(!nt(g[e],I[e]))return!1;return!0}function un(g,I,e,t,C,n){if(Cn=n,ln=I,I.memoizedState=null,I.updateQueue=null,I.lanes=0,en.current=null===g||null===g.memoizedState?qn:$n,g=e(t,C),An){n=0;do{if(An=!1,cn=0,25<=n)throw Error(l(301));n+=1,on=nn=null,I.updateQueue=null,en.current=go,g=e(t,C)}while(An)}if(en.current=_n,I=null!==nn&&null!==nn.next,Cn=0,on=nn=ln=null,an=!1,I)throw Error(l(300));return g}function bn(){var g=0!==cn;return cn=0,g}function mn(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===on?ln.memoizedState=on=g:on=on.next=g,on}function hn(){if(null===nn){var g=ln.alternate;g=null!==g?g.memoizedState:null}else g=nn.next;var I=null===on?ln.memoizedState:on.next;if(null!==I)on=I,nn=g;else{if(null===g)throw Error(l(310));g={memoizedState:(nn=g).memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},null===on?ln.memoizedState=on=g:on=on.next=g}return on}function Zn(g,I){return"function"===typeof I?I(g):I}function Gn(g){var I=hn(),e=I.queue;if(null===e)throw Error(l(311));e.lastRenderedReducer=g;var t=nn,C=t.baseQueue,n=e.pending;if(null!==n){if(null!==C){var o=C.next;C.next=n.next,n.next=o}t.baseQueue=C=n,e.pending=null}if(null!==C){n=C.next,t=t.baseState;var a=o=null,i=null,A=n;do{var c=A.lane;if((Cn&c)===c)null!==i&&(i=i.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),t=A.hasEagerState?A.eagerState:g(t,A.action);else{var s={lane:c,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};null===i?(a=i=s,o=t):i=i.next=s,ln.lanes|=c,Ka|=c}A=A.next}while(null!==A&&A!==n);null===i?o=t:i.next=a,nt(t,I.memoizedState)||(Zo=!0),I.memoizedState=t,I.baseState=o,I.baseQueue=i,e.lastRenderedState=t}if(null!==(g=e.interleaved)){C=g;do{n=C.lane,ln.lanes|=n,Ka|=n,C=C.next}while(C!==g)}else null===C&&(e.lanes=0);return[I.memoizedState,e.dispatch]}function pn(g){var I=hn(),e=I.queue;if(null===e)throw Error(l(311));e.lastRenderedReducer=g;var t=e.dispatch,C=e.pending,n=I.memoizedState;if(null!==C){e.pending=null;var o=C=C.next;do{n=g(n,o.action),o=o.next}while(o!==C);nt(n,I.memoizedState)||(Zo=!0),I.memoizedState=n,null===I.baseQueue&&(I.baseState=n),e.lastRenderedState=n}return[n,t]}function Bn(){}function yn(g,I){var e=ln,t=hn(),C=I(),n=!nt(t.memoizedState,C);if(n&&(t.memoizedState=C,Zo=!0),t=t.queue,Nn(Sn.bind(null,e,t,g),[g]),t.getSnapshot!==I||n||null!==on&&1&on.memoizedState.tag){if(e.flags|=2048,kn(9,Vn.bind(null,e,t,C,I),void 0,null),null===Ja)throw Error(l(349));0!==(30&Cn)||Wn(e,I,C)}return C}function Wn(g,I,e){g.flags|=16384,g={getSnapshot:I,value:e},null===(I=ln.updateQueue)?(I={lastEffect:null,stores:null},ln.updateQueue=I,I.stores=[g]):null===(e=I.stores)?I.stores=[g]:e.push(g)}function Vn(g,I,e,t){I.value=e,I.getSnapshot=t,Rn(I)&&Xn(g)}function Sn(g,I,e){return e((function(){Rn(I)&&Xn(g)}))}function Rn(g){var I=g.getSnapshot;g=g.value;try{var e=I();return!nt(g,e)}catch(t){return!0}}function Xn(g){var I=Yl(g,1);null!==I&&ei(I,g,1,-1)}function Jn(g){var I=mn();return"function"===typeof g&&(g=g()),I.memoizedState=I.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:g},I.queue=g,g=g.dispatch=Tn.bind(null,ln,g),[I.memoizedState,g]}function kn(g,I,e,t){return g={tag:g,create:I,destroy:e,deps:t,next:null},null===(I=ln.updateQueue)?(I={lastEffect:null,stores:null},ln.updateQueue=I,I.lastEffect=g.next=g):null===(e=I.lastEffect)?I.lastEffect=g.next=g:(t=e.next,e.next=g,g.next=t,I.lastEffect=g),g}function fn(){return hn().memoizedState}function vn(g,I,e,t){var C=mn();ln.flags|=g,C.memoizedState=kn(1|I,e,void 0,void 0===t?null:t)}function Yn(g,I,e,t){var C=hn();t=void 0===t?null:t;var l=void 0;if(null!==nn){var n=nn.memoizedState;if(l=n.destroy,null!==t&&rn(t,n.deps))return void(C.memoizedState=kn(I,e,l,t))}ln.flags|=g,C.memoizedState=kn(1|I,e,l,t)}function Hn(g,I){return vn(8390656,8,g,I)}function Nn(g,I){return Yn(2048,8,g,I)}function Kn(g,I){return Yn(4,2,g,I)}function wn(g,I){return Yn(4,4,g,I)}function Fn(g,I){return"function"===typeof I?(g=g(),I(g),function(){I(null)}):null!==I&&void 0!==I?(g=g(),I.current=g,function(){I.current=null}):void 0}function xn(g,I,e){return e=null!==e&&void 0!==e?e.concat([g]):null,Yn(4,4,Fn.bind(null,I,g),e)}function zn(){}function Mn(g,I){var e=hn();I=void 0===I?null:I;var t=e.memoizedState;return null!==t&&null!==I&&rn(I,t[1])?t[0]:(e.memoizedState=[g,I],g)}function En(g,I){var e=hn();I=void 0===I?null:I;var t=e.memoizedState;return null!==t&&null!==I&&rn(I,t[1])?t[0]:(g=g(),e.memoizedState=[g,I],g)}function Un(g,I,e){return 0===(21&Cn)?(g.baseState&&(g.baseState=!1,Zo=!0),g.memoizedState=e):(nt(e,I)||(e=uI(),ln.lanes|=e,Ka|=e,g.baseState=!0),I)}function Qn(g,I){var e=ZI;ZI=0!==e&&4>e?e:4,g(!0);var t=tn.transition;tn.transition={};try{g(!1),I()}finally{ZI=e,tn.transition=t}}function Ln(){return hn().memoizedState}function Dn(g,I,e){var t=Ii(g);if(e={lane:t,action:e,hasEagerState:!1,eagerState:null,next:null},jn(g))Pn(I,e);else if(null!==(e=vl(g,I,e,t))){ei(e,g,t,gi()),On(e,I,t)}}function Tn(g,I,e){var t=Ii(g),C={lane:t,action:e,hasEagerState:!1,eagerState:null,next:null};if(jn(g))Pn(I,C);else{var l=g.alternate;if(0===g.lanes&&(null===l||0===l.lanes)&&null!==(l=I.lastRenderedReducer))try{var n=I.lastRenderedState,o=l(n,e);if(C.hasEagerState=!0,C.eagerState=o,nt(o,n)){var a=I.interleaved;return null===a?(C.next=C,fl(I)):(C.next=a.next,a.next=C),void(I.interleaved=C)}}catch(i){}null!==(e=vl(g,I,C,t))&&(ei(e,g,t,C=gi()),On(e,I,t))}}function jn(g){var I=g.alternate;return g===ln||null!==I&&I===ln}function Pn(g,I){An=an=!0;var e=g.pending;null===e?I.next=I:(I.next=e.next,e.next=I),g.pending=I}function On(g,I,e){if(0!==(4194240&e)){var t=I.lanes;e|=t&=g.pendingLanes,I.lanes=e,hI(g,e)}}var _n={readContext:Jl,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useInsertionEffect:dn,useLayoutEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useMutableSource:dn,useSyncExternalStore:dn,useId:dn,unstable_isNewReconciler:!1},qn={readContext:Jl,useCallback:function(g,I){return mn().memoizedState=[g,void 0===I?null:I],g},useContext:Jl,useEffect:Hn,useImperativeHandle:function(g,I,e){return e=null!==e&&void 0!==e?e.concat([g]):null,vn(4194308,4,Fn.bind(null,I,g),e)},useLayoutEffect:function(g,I){return vn(4194308,4,g,I)},useInsertionEffect:function(g,I){return vn(4,2,g,I)},useMemo:function(g,I){var e=mn();return I=void 0===I?null:I,g=g(),e.memoizedState=[g,I],g},useReducer:function(g,I,e){var t=mn();return I=void 0!==e?e(I):I,t.memoizedState=t.baseState=I,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:I},t.queue=g,g=g.dispatch=Dn.bind(null,ln,g),[t.memoizedState,g]},useRef:function(g){return g={current:g},mn().memoizedState=g},useState:Jn,useDebugValue:zn,useDeferredValue:function(g){return mn().memoizedState=g},useTransition:function(){var g=Jn(!1),I=g[0];return g=Qn.bind(null,g[1]),mn().memoizedState=g,[I,g]},useMutableSource:function(){},useSyncExternalStore:function(g,I,e){var t=ln,C=mn();if(tl){if(void 0===e)throw Error(l(407));e=e()}else{if(e=I(),null===Ja)throw Error(l(349));0!==(30&Cn)||Wn(t,I,e)}C.memoizedState=e;var n={value:e,getSnapshot:I};return C.queue=n,Hn(Sn.bind(null,t,n,g),[g]),t.flags|=2048,kn(9,Vn.bind(null,t,n,e,I),void 0,null),e},useId:function(){var g=mn(),I=Ja.identifierPrefix;if(tl){var e=OC;I=":"+I+"R"+(e=(PC&~(1<<32-nI(PC)-1)).toString(32)+e),0<(e=cn++)&&(I+="H"+e.toString(32)),I+=":"}else I=":"+I+"r"+(e=sn++).toString(32)+":";return g.memoizedState=I},unstable_isNewReconciler:!1},$n={readContext:Jl,useCallback:Mn,useContext:Jl,useEffect:Nn,useImperativeHandle:xn,useInsertionEffect:Kn,useLayoutEffect:wn,useMemo:En,useReducer:Gn,useRef:fn,useState:function(){return Gn(Zn)},useDebugValue:zn,useDeferredValue:function(g){return Un(hn(),nn.memoizedState,g)},useTransition:function(){return[Gn(Zn)[0],hn().memoizedState]},useMutableSource:Bn,useSyncExternalStore:yn,useId:Ln,unstable_isNewReconciler:!1},go={readContext:Jl,useCallback:Mn,useContext:Jl,useEffect:Nn,useImperativeHandle:xn,useInsertionEffect:Kn,useLayoutEffect:wn,useMemo:En,useReducer:pn,useRef:fn,useState:function(){return pn(Zn)},useDebugValue:zn,useDeferredValue:function(g){var I=hn();return null===nn?I.memoizedState=g:Un(I,nn.memoizedState,g)},useTransition:function(){return[pn(Zn)[0],hn().memoizedState]},useMutableSource:Bn,useSyncExternalStore:yn,useId:Ln,unstable_isNewReconciler:!1};function Io(g,I){if(g&&g.defaultProps){for(var e in I=w({},I),g=g.defaultProps)void 0===I[e]&&(I[e]=g[e]);return I}return I}function eo(g,I,e,t){e=null===(e=e(t,I=g.memoizedState))||void 0===e?I:w({},I,e),g.memoizedState=e,0===g.lanes&&(g.updateQueue.baseState=e)}var to={isMounted:function(g){return!!(g=g._reactInternals)&&Eg(g)===g},enqueueSetState:function(g,I,e){g=g._reactInternals;var t=gi(),C=Ii(g),l=wl(t,C);l.payload=I,void 0!==e&&null!==e&&(l.callback=e),null!==(I=Fl(g,l,C))&&(ei(I,g,C,t),xl(I,g,C))},enqueueReplaceState:function(g,I,e){g=g._reactInternals;var t=gi(),C=Ii(g),l=wl(t,C);l.tag=1,l.payload=I,void 0!==e&&null!==e&&(l.callback=e),null!==(I=Fl(g,l,C))&&(ei(I,g,C,t),xl(I,g,C))},enqueueForceUpdate:function(g,I){g=g._reactInternals;var e=gi(),t=Ii(g),C=wl(e,t);C.tag=2,void 0!==I&&null!==I&&(C.callback=I),null!==(I=Fl(g,C,t))&&(ei(I,g,t,e),xl(I,g,t))}};function Co(g,I,e,t,C,l,n){return"function"===typeof(g=g.stateNode).shouldComponentUpdate?g.shouldComponentUpdate(t,l,n):!I.prototype||!I.prototype.isPureReactComponent||(!ot(e,t)||!ot(C,l))}function lo(g,I,e){var t=!1,C=SC,l=I.contextType;return"object"===typeof l&&null!==l?l=Jl(l):(C=fC(I)?JC:RC.current,l=(t=null!==(t=I.contextTypes)&&void 0!==t)?kC(g,C):SC),I=new I(e,l),g.memoizedState=null!==I.state&&void 0!==I.state?I.state:null,I.updater=to,g.stateNode=I,I._reactInternals=g,t&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=C,g.__reactInternalMemoizedMaskedChildContext=l),I}function no(g,I,e,t){g=I.state,"function"===typeof I.componentWillReceiveProps&&I.componentWillReceiveProps(e,t),"function"===typeof I.UNSAFE_componentWillReceiveProps&&I.UNSAFE_componentWillReceiveProps(e,t),I.state!==g&&to.enqueueReplaceState(I,I.state,null)}function oo(g,I,e,t){var C=g.stateNode;C.props=e,C.state=g.memoizedState,C.refs={},Nl(g);var l=I.contextType;"object"===typeof l&&null!==l?C.context=Jl(l):(l=fC(I)?JC:RC.current,C.context=kC(g,l)),C.state=g.memoizedState,"function"===typeof(l=I.getDerivedStateFromProps)&&(eo(g,I,l,e),C.state=g.memoizedState),"function"===typeof I.getDerivedStateFromProps||"function"===typeof C.getSnapshotBeforeUpdate||"function"!==typeof C.UNSAFE_componentWillMount&&"function"!==typeof C.componentWillMount||(I=C.state,"function"===typeof C.componentWillMount&&C.componentWillMount(),"function"===typeof C.UNSAFE_componentWillMount&&C.UNSAFE_componentWillMount(),I!==C.state&&to.enqueueReplaceState(C,C.state,null),Ml(g,e,C,t),C.state=g.memoizedState),"function"===typeof C.componentDidMount&&(g.flags|=4194308)}function ao(g,I){try{var e="",t=I;do{e+=M(t),t=t.return}while(t);var C=e}catch(l){C="\nError generating stack: "+l.message+"\n"+l.stack}return{value:g,source:I,stack:C,digest:null}}function io(g,I,e){return{value:g,source:null,stack:null!=e?e:null,digest:null!=I?I:null}}function Ao(g,I){try{console.error(I.value)}catch(e){setTimeout((function(){throw e}))}}var co="function"===typeof WeakMap?WeakMap:Map;function so(g,I,e){(e=wl(-1,e)).tag=3,e.payload={element:null};var t=I.value;return e.callback=function(){Qa||(Qa=!0,La=t),Ao(0,I)},e}function ro(g,I,e){(e=wl(-1,e)).tag=3;var t=g.type.getDerivedStateFromError;if("function"===typeof t){var C=I.value;e.payload=function(){return t(C)},e.callback=function(){Ao(0,I)}}var l=g.stateNode;return null!==l&&"function"===typeof l.componentDidCatch&&(e.callback=function(){Ao(0,I),"function"!==typeof t&&(null===Da?Da=new Set([this]):Da.add(this));var g=I.stack;this.componentDidCatch(I.value,{componentStack:null!==g?g:""})}),e}function uo(g,I,e){var t=g.pingCache;if(null===t){t=g.pingCache=new co;var C=new Set;t.set(I,C)}else void 0===(C=t.get(I))&&(C=new Set,t.set(I,C));C.has(e)||(C.add(e),g=Vi.bind(null,g,I,e),I.then(g,g))}function bo(g){do{var I;if((I=13===g.tag)&&(I=null===(I=g.memoizedState)||null!==I.dehydrated),I)return g;g=g.return}while(null!==g);return null}function mo(g,I,e,t,C){return 0===(1&g.mode)?(g===I?g.flags|=65536:(g.flags|=128,e.flags|=131072,e.flags&=-52805,1===e.tag&&(null===e.alternate?e.tag=17:((I=wl(-1,1)).tag=2,Fl(e,I,1))),e.lanes|=1),g):(g.flags|=65536,g.lanes=C,g)}var ho=G.ReactCurrentOwner,Zo=!1;function Go(g,I,e,t){I.child=null===g?Gl(I,null,e,t):Zl(I,g.child,e,t)}function po(g,I,e,t,C){e=e.render;var l=I.ref;return Xl(I,C),t=un(g,I,e,t,l,C),e=bn(),null===g||Zo?(tl&&e&&$C(I),I.flags|=1,Go(g,I,t,C),I.child):(I.updateQueue=g.updateQueue,I.flags&=-2053,g.lanes&=~C,Qo(g,I,C))}function Bo(g,I,e,t,C){if(null===g){var l=e.type;return"function"!==typeof l||vi(l)||void 0!==l.defaultProps||null!==e.compare||void 0!==e.defaultProps?((g=Hi(e.type,null,t,I,I.mode,C)).ref=I.ref,g.return=I,I.child=g):(I.tag=15,I.type=l,yo(g,I,l,t,C))}if(l=g.child,0===(g.lanes&C)){var n=l.memoizedProps;if((e=null!==(e=e.compare)?e:ot)(n,t)&&g.ref===I.ref)return Qo(g,I,C)}return I.flags|=1,(g=Yi(l,t)).ref=I.ref,g.return=I,I.child=g}function yo(g,I,e,t,C){if(null!==g){var l=g.memoizedProps;if(ot(l,t)&&g.ref===I.ref){if(Zo=!1,I.pendingProps=t=l,0===(g.lanes&C))return I.lanes=g.lanes,Qo(g,I,C);0!==(131072&g.flags)&&(Zo=!0)}}return So(g,I,e,t,C)}function Wo(g,I,e){var t=I.pendingProps,C=t.children,l=null!==g?g.memoizedState:null;if("hidden"===t.mode)if(0===(1&I.mode))I.memoizedState={baseLanes:0,cachePool:null,transitions:null},VC(Ya,va),va|=e;else{if(0===(1073741824&e))return g=null!==l?l.baseLanes|e:e,I.lanes=I.childLanes=1073741824,I.memoizedState={baseLanes:g,cachePool:null,transitions:null},I.updateQueue=null,VC(Ya,va),va|=g,null;I.memoizedState={baseLanes:0,cachePool:null,transitions:null},t=null!==l?l.baseLanes:e,VC(Ya,va),va|=t}else null!==l?(t=l.baseLanes|e,I.memoizedState=null):t=e,VC(Ya,va),va|=t;return Go(g,I,C,e),I.child}function Vo(g,I){var e=I.ref;(null===g&&null!==e||null!==g&&g.ref!==e)&&(I.flags|=512,I.flags|=2097152)}function So(g,I,e,t,C){var l=fC(e)?JC:RC.current;return l=kC(I,l),Xl(I,C),e=un(g,I,e,t,l,C),t=bn(),null===g||Zo?(tl&&t&&$C(I),I.flags|=1,Go(g,I,e,C),I.child):(I.updateQueue=g.updateQueue,I.flags&=-2053,g.lanes&=~C,Qo(g,I,C))}function Ro(g,I,e,t,C){if(fC(e)){var l=!0;NC(I)}else l=!1;if(Xl(I,C),null===I.stateNode)Uo(g,I),lo(I,e,t),oo(I,e,t,C),t=!0;else if(null===g){var n=I.stateNode,o=I.memoizedProps;n.props=o;var a=n.context,i=e.contextType;"object"===typeof i&&null!==i?i=Jl(i):i=kC(I,i=fC(e)?JC:RC.current);var A=e.getDerivedStateFromProps,c="function"===typeof A||"function"===typeof n.getSnapshotBeforeUpdate;c||"function"!==typeof n.UNSAFE_componentWillReceiveProps&&"function"!==typeof n.componentWillReceiveProps||(o!==t||a!==i)&&no(I,n,t,i),Hl=!1;var s=I.memoizedState;n.state=s,Ml(I,t,n,C),a=I.memoizedState,o!==t||s!==a||XC.current||Hl?("function"===typeof A&&(eo(I,e,A,t),a=I.memoizedState),(o=Hl||Co(I,e,o,t,s,a,i))?(c||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||("function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount()),"function"===typeof n.componentDidMount&&(I.flags|=4194308)):("function"===typeof n.componentDidMount&&(I.flags|=4194308),I.memoizedProps=t,I.memoizedState=a),n.props=t,n.state=a,n.context=i,t=o):("function"===typeof n.componentDidMount&&(I.flags|=4194308),t=!1)}else{n=I.stateNode,Kl(g,I),o=I.memoizedProps,i=I.type===I.elementType?o:Io(I.type,o),n.props=i,c=I.pendingProps,s=n.context,"object"===typeof(a=e.contextType)&&null!==a?a=Jl(a):a=kC(I,a=fC(e)?JC:RC.current);var d=e.getDerivedStateFromProps;(A="function"===typeof d||"function"===typeof n.getSnapshotBeforeUpdate)||"function"!==typeof n.UNSAFE_componentWillReceiveProps&&"function"!==typeof n.componentWillReceiveProps||(o!==c||s!==a)&&no(I,n,t,a),Hl=!1,s=I.memoizedState,n.state=s,Ml(I,t,n,C);var r=I.memoizedState;o!==c||s!==r||XC.current||Hl?("function"===typeof d&&(eo(I,e,d,t),r=I.memoizedState),(i=Hl||Co(I,e,i,t,s,r,a)||!1)?(A||"function"!==typeof n.UNSAFE_componentWillUpdate&&"function"!==typeof n.componentWillUpdate||("function"===typeof n.componentWillUpdate&&n.componentWillUpdate(t,r,a),"function"===typeof n.UNSAFE_componentWillUpdate&&n.UNSAFE_componentWillUpdate(t,r,a)),"function"===typeof n.componentDidUpdate&&(I.flags|=4),"function"===typeof n.getSnapshotBeforeUpdate&&(I.flags|=1024)):("function"!==typeof n.componentDidUpdate||o===g.memoizedProps&&s===g.memoizedState||(I.flags|=4),"function"!==typeof n.getSnapshotBeforeUpdate||o===g.memoizedProps&&s===g.memoizedState||(I.flags|=1024),I.memoizedProps=t,I.memoizedState=r),n.props=t,n.state=r,n.context=a,t=i):("function"!==typeof n.componentDidUpdate||o===g.memoizedProps&&s===g.memoizedState||(I.flags|=4),"function"!==typeof n.getSnapshotBeforeUpdate||o===g.memoizedProps&&s===g.memoizedState||(I.flags|=1024),t=!1)}return Xo(g,I,e,t,l,C)}function Xo(g,I,e,t,C,l){Vo(g,I);var n=0!==(128&I.flags);if(!t&&!n)return C&&KC(I,e,!1),Qo(g,I,l);t=I.stateNode,ho.current=I;var o=n&&"function"!==typeof e.getDerivedStateFromError?null:t.render();return I.flags|=1,null!==g&&n?(I.child=Zl(I,g.child,null,l),I.child=Zl(I,null,o,l)):Go(g,I,o,l),I.memoizedState=t.state,C&&KC(I,e,!0),I.child}function Jo(g){var I=g.stateNode;I.pendingContext?YC(0,I.pendingContext,I.pendingContext!==I.context):I.context&&YC(0,I.context,!1),jl(g,I.containerInfo)}function ko(g,I,e,t,C){return sl(),dl(C),I.flags|=256,Go(g,I,e,t),I.child}var fo,vo,Yo,Ho,No={dehydrated:null,treeContext:null,retryLane:0};function Ko(g){return{baseLanes:g,cachePool:null,transitions:null}}function wo(g,I,e){var t,C=I.pendingProps,n=ql.current,o=!1,a=0!==(128&I.flags);if((t=a)||(t=(null===g||null!==g.memoizedState)&&0!==(2&n)),t?(o=!0,I.flags&=-129):null!==g&&null===g.memoizedState||(n|=1),VC(ql,1&n),null===g)return al(I),null!==(g=I.memoizedState)&&null!==(g=g.dehydrated)?(0===(1&I.mode)?I.lanes=1:"$!"===g.data?I.lanes=8:I.lanes=1073741824,null):(a=C.children,g=C.fallback,o?(C=I.mode,o=I.child,a={mode:"hidden",children:a},0===(1&C)&&null!==o?(o.childLanes=0,o.pendingProps=a):o=Ki(a,C,0,null),g=Ni(g,C,e,null),o.return=I,g.return=I,o.sibling=g,I.child=o,I.child.memoizedState=Ko(e),I.memoizedState=No,g):Fo(I,a));if(null!==(n=g.memoizedState)&&null!==(t=n.dehydrated))return function(g,I,e,t,C,n,o){if(e)return 256&I.flags?(I.flags&=-257,xo(g,I,o,t=io(Error(l(422))))):null!==I.memoizedState?(I.child=g.child,I.flags|=128,null):(n=t.fallback,C=I.mode,t=Ki({mode:"visible",children:t.children},C,0,null),(n=Ni(n,C,o,null)).flags|=2,t.return=I,n.return=I,t.sibling=n,I.child=t,0!==(1&I.mode)&&Zl(I,g.child,null,o),I.child.memoizedState=Ko(o),I.memoizedState=No,n);if(0===(1&I.mode))return xo(g,I,o,null);if("$!"===C.data){if(t=C.nextSibling&&C.nextSibling.dataset)var a=t.dgst;return t=a,xo(g,I,o,t=io(n=Error(l(419)),t,void 0))}if(a=0!==(o&g.childLanes),Zo||a){if(null!==(t=Ja)){switch(o&-o){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}0!==(C=0!==(C&(t.suspendedLanes|o))?0:C)&&C!==n.retryLane&&(n.retryLane=C,Yl(g,C),ei(t,g,C,-1))}return ui(),xo(g,I,o,t=io(Error(l(421))))}return"$?"===C.data?(I.flags|=128,I.child=g.child,I=Ri.bind(null,g),C._reactRetry=I,null):(g=n.treeContext,el=aC(C.nextSibling),Il=I,tl=!0,Cl=null,null!==g&&(DC[TC++]=PC,DC[TC++]=OC,DC[TC++]=jC,PC=g.id,OC=g.overflow,jC=I),I=Fo(I,t.children),I.flags|=4096,I)}(g,I,a,C,t,n,e);if(o){o=C.fallback,a=I.mode,t=(n=g.child).sibling;var i={mode:"hidden",children:C.children};return 0===(1&a)&&I.child!==n?((C=I.child).childLanes=0,C.pendingProps=i,I.deletions=null):(C=Yi(n,i)).subtreeFlags=14680064&n.subtreeFlags,null!==t?o=Yi(t,o):(o=Ni(o,a,e,null)).flags|=2,o.return=I,C.return=I,C.sibling=o,I.child=C,C=o,o=I.child,a=null===(a=g.child.memoizedState)?Ko(e):{baseLanes:a.baseLanes|e,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=g.childLanes&~e,I.memoizedState=No,C}return g=(o=g.child).sibling,C=Yi(o,{mode:"visible",children:C.children}),0===(1&I.mode)&&(C.lanes=e),C.return=I,C.sibling=null,null!==g&&(null===(e=I.deletions)?(I.deletions=[g],I.flags|=16):e.push(g)),I.child=C,I.memoizedState=null,C}function Fo(g,I){return(I=Ki({mode:"visible",children:I},g.mode,0,null)).return=g,g.child=I}function xo(g,I,e,t){return null!==t&&dl(t),Zl(I,g.child,null,e),(g=Fo(I,I.pendingProps.children)).flags|=2,I.memoizedState=null,g}function zo(g,I,e){g.lanes|=I;var t=g.alternate;null!==t&&(t.lanes|=I),Rl(g.return,I,e)}function Mo(g,I,e,t,C){var l=g.memoizedState;null===l?g.memoizedState={isBackwards:I,rendering:null,renderingStartTime:0,last:t,tail:e,tailMode:C}:(l.isBackwards=I,l.rendering=null,l.renderingStartTime=0,l.last=t,l.tail=e,l.tailMode=C)}function Eo(g,I,e){var t=I.pendingProps,C=t.revealOrder,l=t.tail;if(Go(g,I,t.children,e),0!==(2&(t=ql.current)))t=1&t|2,I.flags|=128;else{if(null!==g&&0!==(128&g.flags))g:for(g=I.child;null!==g;){if(13===g.tag)null!==g.memoizedState&&zo(g,e,I);else if(19===g.tag)zo(g,e,I);else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===I)break g;for(;null===g.sibling;){if(null===g.return||g.return===I)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}t&=1}if(VC(ql,t),0===(1&I.mode))I.memoizedState=null;else switch(C){case"forwards":for(e=I.child,C=null;null!==e;)null!==(g=e.alternate)&&null===$l(g)&&(C=e),e=e.sibling;null===(e=C)?(C=I.child,I.child=null):(C=e.sibling,e.sibling=null),Mo(I,!1,C,e,l);break;case"backwards":for(e=null,C=I.child,I.child=null;null!==C;){if(null!==(g=C.alternate)&&null===$l(g)){I.child=C;break}g=C.sibling,C.sibling=e,e=C,C=g}Mo(I,!0,e,null,l);break;case"together":Mo(I,!1,null,null,void 0);break;default:I.memoizedState=null}return I.child}function Uo(g,I){0===(1&I.mode)&&null!==g&&(g.alternate=null,I.alternate=null,I.flags|=2)}function Qo(g,I,e){if(null!==g&&(I.dependencies=g.dependencies),Ka|=I.lanes,0===(e&I.childLanes))return null;if(null!==g&&I.child!==g.child)throw Error(l(153));if(null!==I.child){for(e=Yi(g=I.child,g.pendingProps),I.child=e,e.return=I;null!==g.sibling;)g=g.sibling,(e=e.sibling=Yi(g,g.pendingProps)).return=I;e.sibling=null}return I.child}function Lo(g,I){if(!tl)switch(g.tailMode){case"hidden":I=g.tail;for(var e=null;null!==I;)null!==I.alternate&&(e=I),I=I.sibling;null===e?g.tail=null:e.sibling=null;break;case"collapsed":e=g.tail;for(var t=null;null!==e;)null!==e.alternate&&(t=e),e=e.sibling;null===t?I||null===g.tail?g.tail=null:g.tail.sibling=null:t.sibling=null}}function Do(g){var I=null!==g.alternate&&g.alternate.child===g.child,e=0,t=0;if(I)for(var C=g.child;null!==C;)e|=C.lanes|C.childLanes,t|=14680064&C.subtreeFlags,t|=14680064&C.flags,C.return=g,C=C.sibling;else for(C=g.child;null!==C;)e|=C.lanes|C.childLanes,t|=C.subtreeFlags,t|=C.flags,C.return=g,C=C.sibling;return g.subtreeFlags|=t,g.childLanes=e,I}function To(g,I,e){var t=I.pendingProps;switch(gl(I),I.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Do(I),null;case 1:case 17:return fC(I.type)&&vC(),Do(I),null;case 3:return t=I.stateNode,Pl(),WC(XC),WC(RC),In(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),null!==g&&null!==g.child||(Al(I)?I.flags|=4:null===g||g.memoizedState.isDehydrated&&0===(256&I.flags)||(I.flags|=1024,null!==Cl&&(ni(Cl),Cl=null))),vo(g,I),Do(I),null;case 5:_l(I);var C=Tl(Dl.current);if(e=I.type,null!==g&&null!=I.stateNode)Yo(g,I,e,t,C),g.ref!==I.ref&&(I.flags|=512,I.flags|=2097152);else{if(!t){if(null===I.stateNode)throw Error(l(166));return Do(I),null}if(g=Tl(Ql.current),Al(I)){t=I.stateNode,e=I.type;var n=I.memoizedProps;switch(t[cC]=I,t[sC]=n,g=0!==(1&I.mode),e){case"dialog":Ft("cancel",t),Ft("close",t);break;case"iframe":case"object":case"embed":Ft("load",t);break;case"video":case"audio":for(C=0;C<Ht.length;C++)Ft(Ht[C],t);break;case"source":Ft("error",t);break;case"img":case"image":case"link":Ft("error",t),Ft("load",t);break;case"details":Ft("toggle",t);break;case"input":O(t,n),Ft("invalid",t);break;case"select":t._wrapperState={wasMultiple:!!n.multiple},Ft("invalid",t);break;case"textarea":Cg(t,n),Ft("invalid",t)}for(var a in hg(e,n),C=null,n)if(n.hasOwnProperty(a)){var i=n[a];"children"===a?"string"===typeof i?t.textContent!==i&&(!0!==n.suppressHydrationWarning&&_t(t.textContent,i,g),C=["children",i]):"number"===typeof i&&t.textContent!==""+i&&(!0!==n.suppressHydrationWarning&&_t(t.textContent,i,g),C=["children",""+i]):o.hasOwnProperty(a)&&null!=i&&"onScroll"===a&&Ft("scroll",t)}switch(e){case"input":D(t),$(t,n,!0);break;case"textarea":D(t),ng(t);break;case"select":case"option":break;default:"function"===typeof n.onClick&&(t.onclick=qt)}t=C,I.updateQueue=t,null!==t&&(I.flags|=4)}else{a=9===C.nodeType?C:C.ownerDocument,"http://www.w3.org/1999/xhtml"===g&&(g=og(e)),"http://www.w3.org/1999/xhtml"===g?"script"===e?((g=a.createElement("div")).innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):"string"===typeof t.is?g=a.createElement(e,{is:t.is}):(g=a.createElement(e),"select"===e&&(a=g,t.multiple?a.multiple=!0:t.size&&(a.size=t.size))):g=a.createElementNS(g,e),g[cC]=I,g[sC]=t,fo(g,I,!1,!1),I.stateNode=g;g:{switch(a=Zg(e,t),e){case"dialog":Ft("cancel",g),Ft("close",g),C=t;break;case"iframe":case"object":case"embed":Ft("load",g),C=t;break;case"video":case"audio":for(C=0;C<Ht.length;C++)Ft(Ht[C],g);C=t;break;case"source":Ft("error",g),C=t;break;case"img":case"image":case"link":Ft("error",g),Ft("load",g),C=t;break;case"details":Ft("toggle",g),C=t;break;case"input":O(g,t),C=P(g,t),Ft("invalid",g);break;case"option":default:C=t;break;case"select":g._wrapperState={wasMultiple:!!t.multiple},C=w({},t,{value:void 0}),Ft("invalid",g);break;case"textarea":Cg(g,t),C=tg(g,t),Ft("invalid",g)}for(n in hg(e,C),i=C)if(i.hasOwnProperty(n)){var A=i[n];"style"===n?bg(g,A):"dangerouslySetInnerHTML"===n?null!=(A=A?A.__html:void 0)&&cg(g,A):"children"===n?"string"===typeof A?("textarea"!==e||""!==A)&&sg(g,A):"number"===typeof A&&sg(g,""+A):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(o.hasOwnProperty(n)?null!=A&&"onScroll"===n&&Ft("scroll",g):null!=A&&Z(g,n,A,a))}switch(e){case"input":D(g),$(g,t,!1);break;case"textarea":D(g),ng(g);break;case"option":null!=t.value&&g.setAttribute("value",""+Q(t.value));break;case"select":g.multiple=!!t.multiple,null!=(n=t.value)?eg(g,!!t.multiple,n,!1):null!=t.defaultValue&&eg(g,!!t.multiple,t.defaultValue,!0);break;default:"function"===typeof C.onClick&&(g.onclick=qt)}switch(e){case"button":case"input":case"select":case"textarea":t=!!t.autoFocus;break g;case"img":t=!0;break g;default:t=!1}}t&&(I.flags|=4)}null!==I.ref&&(I.flags|=512,I.flags|=2097152)}return Do(I),null;case 6:if(g&&null!=I.stateNode)Ho(g,I,g.memoizedProps,t);else{if("string"!==typeof t&&null===I.stateNode)throw Error(l(166));if(e=Tl(Dl.current),Tl(Ql.current),Al(I)){if(t=I.stateNode,e=I.memoizedProps,t[cC]=I,(n=t.nodeValue!==e)&&null!==(g=Il))switch(g.tag){case 3:_t(t.nodeValue,e,0!==(1&g.mode));break;case 5:!0!==g.memoizedProps.suppressHydrationWarning&&_t(t.nodeValue,e,0!==(1&g.mode))}n&&(I.flags|=4)}else(t=(9===e.nodeType?e:e.ownerDocument).createTextNode(t))[cC]=I,I.stateNode=t}return Do(I),null;case 13:if(WC(ql),t=I.memoizedState,null===g||null!==g.memoizedState&&null!==g.memoizedState.dehydrated){if(tl&&null!==el&&0!==(1&I.mode)&&0===(128&I.flags))cl(),sl(),I.flags|=98560,n=!1;else if(n=Al(I),null!==t&&null!==t.dehydrated){if(null===g){if(!n)throw Error(l(318));if(!(n=null!==(n=I.memoizedState)?n.dehydrated:null))throw Error(l(317));n[cC]=I}else sl(),0===(128&I.flags)&&(I.memoizedState=null),I.flags|=4;Do(I),n=!1}else null!==Cl&&(ni(Cl),Cl=null),n=!0;if(!n)return 65536&I.flags?I:null}return 0!==(128&I.flags)?(I.lanes=e,I):((t=null!==t)!==(null!==g&&null!==g.memoizedState)&&t&&(I.child.flags|=8192,0!==(1&I.mode)&&(null===g||0!==(1&ql.current)?0===Ha&&(Ha=3):ui())),null!==I.updateQueue&&(I.flags|=4),Do(I),null);case 4:return Pl(),vo(g,I),null===g&&Mt(I.stateNode.containerInfo),Do(I),null;case 10:return Sl(I.type._context),Do(I),null;case 19:if(WC(ql),null===(n=I.memoizedState))return Do(I),null;if(t=0!==(128&I.flags),null===(a=n.rendering))if(t)Lo(n,!1);else{if(0!==Ha||null!==g&&0!==(128&g.flags))for(g=I.child;null!==g;){if(null!==(a=$l(g))){for(I.flags|=128,Lo(n,!1),null!==(t=a.updateQueue)&&(I.updateQueue=t,I.flags|=4),I.subtreeFlags=0,t=e,e=I.child;null!==e;)g=t,(n=e).flags&=14680066,null===(a=n.alternate)?(n.childLanes=0,n.lanes=g,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=a.childLanes,n.lanes=a.lanes,n.child=a.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=a.memoizedProps,n.memoizedState=a.memoizedState,n.updateQueue=a.updateQueue,n.type=a.type,g=a.dependencies,n.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext}),e=e.sibling;return VC(ql,1&ql.current|2),I.child}g=g.sibling}null!==n.tail&&_g()>Ea&&(I.flags|=128,t=!0,Lo(n,!1),I.lanes=4194304)}else{if(!t)if(null!==(g=$l(a))){if(I.flags|=128,t=!0,null!==(e=g.updateQueue)&&(I.updateQueue=e,I.flags|=4),Lo(n,!0),null===n.tail&&"hidden"===n.tailMode&&!a.alternate&&!tl)return Do(I),null}else 2*_g()-n.renderingStartTime>Ea&&1073741824!==e&&(I.flags|=128,t=!0,Lo(n,!1),I.lanes=4194304);n.isBackwards?(a.sibling=I.child,I.child=a):(null!==(e=n.last)?e.sibling=a:I.child=a,n.last=a)}return null!==n.tail?(I=n.tail,n.rendering=I,n.tail=I.sibling,n.renderingStartTime=_g(),I.sibling=null,e=ql.current,VC(ql,t?1&e|2:1&e),I):(Do(I),null);case 22:case 23:return ci(),t=null!==I.memoizedState,null!==g&&null!==g.memoizedState!==t&&(I.flags|=8192),t&&0!==(1&I.mode)?0!==(1073741824&va)&&(Do(I),6&I.subtreeFlags&&(I.flags|=8192)):Do(I),null;case 24:case 25:return null}throw Error(l(156,I.tag))}function jo(g,I){switch(gl(I),I.tag){case 1:return fC(I.type)&&vC(),65536&(g=I.flags)?(I.flags=-65537&g|128,I):null;case 3:return Pl(),WC(XC),WC(RC),In(),0!==(65536&(g=I.flags))&&0===(128&g)?(I.flags=-65537&g|128,I):null;case 5:return _l(I),null;case 13:if(WC(ql),null!==(g=I.memoizedState)&&null!==g.dehydrated){if(null===I.alternate)throw Error(l(340));sl()}return 65536&(g=I.flags)?(I.flags=-65537&g|128,I):null;case 19:return WC(ql),null;case 4:return Pl(),null;case 10:return Sl(I.type._context),null;case 22:case 23:return ci(),null;default:return null}}fo=function(g,I){for(var e=I.child;null!==e;){if(5===e.tag||6===e.tag)g.appendChild(e.stateNode);else if(4!==e.tag&&null!==e.child){e.child.return=e,e=e.child;continue}if(e===I)break;for(;null===e.sibling;){if(null===e.return||e.return===I)return;e=e.return}e.sibling.return=e.return,e=e.sibling}},vo=function(){},Yo=function(g,I,e,t){var C=g.memoizedProps;if(C!==t){g=I.stateNode,Tl(Ql.current);var l,n=null;switch(e){case"input":C=P(g,C),t=P(g,t),n=[];break;case"select":C=w({},C,{value:void 0}),t=w({},t,{value:void 0}),n=[];break;case"textarea":C=tg(g,C),t=tg(g,t),n=[];break;default:"function"!==typeof C.onClick&&"function"===typeof t.onClick&&(g.onclick=qt)}for(A in hg(e,t),e=null,C)if(!t.hasOwnProperty(A)&&C.hasOwnProperty(A)&&null!=C[A])if("style"===A){var a=C[A];for(l in a)a.hasOwnProperty(l)&&(e||(e={}),e[l]="")}else"dangerouslySetInnerHTML"!==A&&"children"!==A&&"suppressContentEditableWarning"!==A&&"suppressHydrationWarning"!==A&&"autoFocus"!==A&&(o.hasOwnProperty(A)?n||(n=[]):(n=n||[]).push(A,null));for(A in t){var i=t[A];if(a=null!=C?C[A]:void 0,t.hasOwnProperty(A)&&i!==a&&(null!=i||null!=a))if("style"===A)if(a){for(l in a)!a.hasOwnProperty(l)||i&&i.hasOwnProperty(l)||(e||(e={}),e[l]="");for(l in i)i.hasOwnProperty(l)&&a[l]!==i[l]&&(e||(e={}),e[l]=i[l])}else e||(n||(n=[]),n.push(A,e)),e=i;else"dangerouslySetInnerHTML"===A?(i=i?i.__html:void 0,a=a?a.__html:void 0,null!=i&&a!==i&&(n=n||[]).push(A,i)):"children"===A?"string"!==typeof i&&"number"!==typeof i||(n=n||[]).push(A,""+i):"suppressContentEditableWarning"!==A&&"suppressHydrationWarning"!==A&&(o.hasOwnProperty(A)?(null!=i&&"onScroll"===A&&Ft("scroll",g),n||a===i||(n=[])):(n=n||[]).push(A,i))}e&&(n=n||[]).push("style",e);var A=n;(I.updateQueue=A)&&(I.flags|=4)}},Ho=function(g,I,e,t){e!==t&&(I.flags|=4)};var Po=!1,Oo=!1,_o="function"===typeof WeakSet?WeakSet:Set,qo=null;function $o(g,I){var e=g.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(t){Wi(g,I,t)}else e.current=null}function ga(g,I,e){try{e()}catch(t){Wi(g,I,t)}}var Ia=!1;function ea(g,I,e){var t=I.updateQueue;if(null!==(t=null!==t?t.lastEffect:null)){var C=t=t.next;do{if((C.tag&g)===g){var l=C.destroy;C.destroy=void 0,void 0!==l&&ga(I,e,l)}C=C.next}while(C!==t)}}function ta(g,I){if(null!==(I=null!==(I=I.updateQueue)?I.lastEffect:null)){var e=I=I.next;do{if((e.tag&g)===g){var t=e.create;e.destroy=t()}e=e.next}while(e!==I)}}function Ca(g){var I=g.ref;if(null!==I){var e=g.stateNode;g.tag,g=e,"function"===typeof I?I(g):I.current=g}}function la(g){var I=g.alternate;null!==I&&(g.alternate=null,la(I)),g.child=null,g.deletions=null,g.sibling=null,5===g.tag&&(null!==(I=g.stateNode)&&(delete I[cC],delete I[sC],delete I[rC],delete I[uC],delete I[bC])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function na(g){return 5===g.tag||3===g.tag||4===g.tag}function oa(g){g:for(;;){for(;null===g.sibling;){if(null===g.return||na(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;5!==g.tag&&6!==g.tag&&18!==g.tag;){if(2&g.flags)continue g;if(null===g.child||4===g.tag)continue g;g.child.return=g,g=g.child}if(!(2&g.flags))return g.stateNode}}function aa(g,I,e){var t=g.tag;if(5===t||6===t)g=g.stateNode,I?8===e.nodeType?e.parentNode.insertBefore(g,I):e.insertBefore(g,I):(8===e.nodeType?(I=e.parentNode).insertBefore(g,e):(I=e).appendChild(g),null!==(e=e._reactRootContainer)&&void 0!==e||null!==I.onclick||(I.onclick=qt));else if(4!==t&&null!==(g=g.child))for(aa(g,I,e),g=g.sibling;null!==g;)aa(g,I,e),g=g.sibling}function ia(g,I,e){var t=g.tag;if(5===t||6===t)g=g.stateNode,I?e.insertBefore(g,I):e.appendChild(g);else if(4!==t&&null!==(g=g.child))for(ia(g,I,e),g=g.sibling;null!==g;)ia(g,I,e),g=g.sibling}var Aa=null,ca=!1;function sa(g,I,e){for(e=e.child;null!==e;)da(g,I,e),e=e.sibling}function da(g,I,e){if(lI&&"function"===typeof lI.onCommitFiberUnmount)try{lI.onCommitFiberUnmount(CI,e)}catch(o){}switch(e.tag){case 5:Oo||$o(e,I);case 6:var t=Aa,C=ca;Aa=null,sa(g,I,e),ca=C,null!==(Aa=t)&&(ca?(g=Aa,e=e.stateNode,8===g.nodeType?g.parentNode.removeChild(e):g.removeChild(e)):Aa.removeChild(e.stateNode));break;case 18:null!==Aa&&(ca?(g=Aa,e=e.stateNode,8===g.nodeType?oC(g.parentNode,e):1===g.nodeType&&oC(g,e),EI(g)):oC(Aa,e.stateNode));break;case 4:t=Aa,C=ca,Aa=e.stateNode.containerInfo,ca=!0,sa(g,I,e),Aa=t,ca=C;break;case 0:case 11:case 14:case 15:if(!Oo&&(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect))){C=t=t.next;do{var l=C,n=l.destroy;l=l.tag,void 0!==n&&(0!==(2&l)||0!==(4&l))&&ga(e,I,n),C=C.next}while(C!==t)}sa(g,I,e);break;case 1:if(!Oo&&($o(e,I),"function"===typeof(t=e.stateNode).componentWillUnmount))try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(o){Wi(e,I,o)}sa(g,I,e);break;case 21:sa(g,I,e);break;case 22:1&e.mode?(Oo=(t=Oo)||null!==e.memoizedState,sa(g,I,e),Oo=t):sa(g,I,e);break;default:sa(g,I,e)}}function ra(g){var I=g.updateQueue;if(null!==I){g.updateQueue=null;var e=g.stateNode;null===e&&(e=g.stateNode=new _o),I.forEach((function(I){var t=Xi.bind(null,g,I);e.has(I)||(e.add(I),I.then(t,t))}))}}function ua(g,I){var e=I.deletions;if(null!==e)for(var t=0;t<e.length;t++){var C=e[t];try{var n=g,o=I,a=o;g:for(;null!==a;){switch(a.tag){case 5:Aa=a.stateNode,ca=!1;break g;case 3:case 4:Aa=a.stateNode.containerInfo,ca=!0;break g}a=a.return}if(null===Aa)throw Error(l(160));da(n,o,C),Aa=null,ca=!1;var i=C.alternate;null!==i&&(i.return=null),C.return=null}catch(A){Wi(C,I,A)}}if(12854&I.subtreeFlags)for(I=I.child;null!==I;)ba(I,g),I=I.sibling}function ba(g,I){var e=g.alternate,t=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(ua(I,g),ma(g),4&t){try{ea(3,g,g.return),ta(3,g)}catch(b){Wi(g,g.return,b)}try{ea(5,g,g.return)}catch(b){Wi(g,g.return,b)}}break;case 1:ua(I,g),ma(g),512&t&&null!==e&&$o(e,e.return);break;case 5:if(ua(I,g),ma(g),512&t&&null!==e&&$o(e,e.return),32&g.flags){var C=g.stateNode;try{sg(C,"")}catch(b){Wi(g,g.return,b)}}if(4&t&&null!=(C=g.stateNode)){var n=g.memoizedProps,o=null!==e?e.memoizedProps:n,a=g.type,i=g.updateQueue;if(g.updateQueue=null,null!==i)try{"input"===a&&"radio"===n.type&&null!=n.name&&_(C,n),Zg(a,o);var A=Zg(a,n);for(o=0;o<i.length;o+=2){var c=i[o],s=i[o+1];"style"===c?bg(C,s):"dangerouslySetInnerHTML"===c?cg(C,s):"children"===c?sg(C,s):Z(C,c,s,A)}switch(a){case"input":q(C,n);break;case"textarea":lg(C,n);break;case"select":var d=C._wrapperState.wasMultiple;C._wrapperState.wasMultiple=!!n.multiple;var r=n.value;null!=r?eg(C,!!n.multiple,r,!1):d!==!!n.multiple&&(null!=n.defaultValue?eg(C,!!n.multiple,n.defaultValue,!0):eg(C,!!n.multiple,n.multiple?[]:"",!1))}C[sC]=n}catch(b){Wi(g,g.return,b)}}break;case 6:if(ua(I,g),ma(g),4&t){if(null===g.stateNode)throw Error(l(162));C=g.stateNode,n=g.memoizedProps;try{C.nodeValue=n}catch(b){Wi(g,g.return,b)}}break;case 3:if(ua(I,g),ma(g),4&t&&null!==e&&e.memoizedState.isDehydrated)try{EI(I.containerInfo)}catch(b){Wi(g,g.return,b)}break;case 4:default:ua(I,g),ma(g);break;case 13:ua(I,g),ma(g),8192&(C=g.child).flags&&(n=null!==C.memoizedState,C.stateNode.isHidden=n,!n||null!==C.alternate&&null!==C.alternate.memoizedState||(Ma=_g())),4&t&&ra(g);break;case 22:if(c=null!==e&&null!==e.memoizedState,1&g.mode?(Oo=(A=Oo)||c,ua(I,g),Oo=A):ua(I,g),ma(g),8192&t){if(A=null!==g.memoizedState,(g.stateNode.isHidden=A)&&!c&&0!==(1&g.mode))for(qo=g,c=g.child;null!==c;){for(s=qo=c;null!==qo;){switch(r=(d=qo).child,d.tag){case 0:case 11:case 14:case 15:ea(4,d,d.return);break;case 1:$o(d,d.return);var u=d.stateNode;if("function"===typeof u.componentWillUnmount){t=d,e=d.return;try{I=t,u.props=I.memoizedProps,u.state=I.memoizedState,u.componentWillUnmount()}catch(b){Wi(t,e,b)}}break;case 5:$o(d,d.return);break;case 22:if(null!==d.memoizedState){pa(s);continue}}null!==r?(r.return=d,qo=r):pa(s)}c=c.sibling}g:for(c=null,s=g;;){if(5===s.tag){if(null===c){c=s;try{C=s.stateNode,A?"function"===typeof(n=C.style).setProperty?n.setProperty("display","none","important"):n.display="none":(a=s.stateNode,o=void 0!==(i=s.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,a.style.display=ug("display",o))}catch(b){Wi(g,g.return,b)}}}else if(6===s.tag){if(null===c)try{s.stateNode.nodeValue=A?"":s.memoizedProps}catch(b){Wi(g,g.return,b)}}else if((22!==s.tag&&23!==s.tag||null===s.memoizedState||s===g)&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===g)break g;for(;null===s.sibling;){if(null===s.return||s.return===g)break g;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}}break;case 19:ua(I,g),ma(g),4&t&&ra(g);case 21:}}function ma(g){var I=g.flags;if(2&I){try{g:{for(var e=g.return;null!==e;){if(na(e)){var t=e;break g}e=e.return}throw Error(l(160))}switch(t.tag){case 5:var C=t.stateNode;32&t.flags&&(sg(C,""),t.flags&=-33),ia(g,oa(g),C);break;case 3:case 4:var n=t.stateNode.containerInfo;aa(g,oa(g),n);break;default:throw Error(l(161))}}catch(o){Wi(g,g.return,o)}g.flags&=-3}4096&I&&(g.flags&=-4097)}function ha(g,I,e){qo=g,Za(g,I,e)}function Za(g,I,e){for(var t=0!==(1&g.mode);null!==qo;){var C=qo,l=C.child;if(22===C.tag&&t){var n=null!==C.memoizedState||Po;if(!n){var o=C.alternate,a=null!==o&&null!==o.memoizedState||Oo;o=Po;var i=Oo;if(Po=n,(Oo=a)&&!i)for(qo=C;null!==qo;)a=(n=qo).child,22===n.tag&&null!==n.memoizedState?Ba(C):null!==a?(a.return=n,qo=a):Ba(C);for(;null!==l;)qo=l,Za(l,I,e),l=l.sibling;qo=C,Po=o,Oo=i}Ga(g)}else 0!==(8772&C.subtreeFlags)&&null!==l?(l.return=C,qo=l):Ga(g)}}function Ga(g){for(;null!==qo;){var I=qo;if(0!==(8772&I.flags)){var e=I.alternate;try{if(0!==(8772&I.flags))switch(I.tag){case 0:case 11:case 15:Oo||ta(5,I);break;case 1:var t=I.stateNode;if(4&I.flags&&!Oo)if(null===e)t.componentDidMount();else{var C=I.elementType===I.type?e.memoizedProps:Io(I.type,e.memoizedProps);t.componentDidUpdate(C,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}var n=I.updateQueue;null!==n&&El(I,n,t);break;case 3:var o=I.updateQueue;if(null!==o){if(e=null,null!==I.child)switch(I.child.tag){case 5:case 1:e=I.child.stateNode}El(I,o,e)}break;case 5:var a=I.stateNode;if(null===e&&4&I.flags){e=a;var i=I.memoizedProps;switch(I.type){case"button":case"input":case"select":case"textarea":i.autoFocus&&e.focus();break;case"img":i.src&&(e.src=i.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===I.memoizedState){var A=I.alternate;if(null!==A){var c=A.memoizedState;if(null!==c){var s=c.dehydrated;null!==s&&EI(s)}}}break;default:throw Error(l(163))}Oo||512&I.flags&&Ca(I)}catch(d){Wi(I,I.return,d)}}if(I===g){qo=null;break}if(null!==(e=I.sibling)){e.return=I.return,qo=e;break}qo=I.return}}function pa(g){for(;null!==qo;){var I=qo;if(I===g){qo=null;break}var e=I.sibling;if(null!==e){e.return=I.return,qo=e;break}qo=I.return}}function Ba(g){for(;null!==qo;){var I=qo;try{switch(I.tag){case 0:case 11:case 15:var e=I.return;try{ta(4,I)}catch(a){Wi(I,e,a)}break;case 1:var t=I.stateNode;if("function"===typeof t.componentDidMount){var C=I.return;try{t.componentDidMount()}catch(a){Wi(I,C,a)}}var l=I.return;try{Ca(I)}catch(a){Wi(I,l,a)}break;case 5:var n=I.return;try{Ca(I)}catch(a){Wi(I,n,a)}}}catch(a){Wi(I,I.return,a)}if(I===g){qo=null;break}var o=I.sibling;if(null!==o){o.return=I.return,qo=o;break}qo=I.return}}var ya,Wa=Math.ceil,Va=G.ReactCurrentDispatcher,Sa=G.ReactCurrentOwner,Ra=G.ReactCurrentBatchConfig,Xa=0,Ja=null,ka=null,fa=0,va=0,Ya=yC(0),Ha=0,Na=null,Ka=0,wa=0,Fa=0,xa=null,za=null,Ma=0,Ea=1/0,Ua=null,Qa=!1,La=null,Da=null,Ta=!1,ja=null,Pa=0,Oa=0,_a=null,qa=-1,$a=0;function gi(){return 0!==(6&Xa)?_g():-1!==qa?qa:qa=_g()}function Ii(g){return 0===(1&g.mode)?1:0!==(2&Xa)&&0!==fa?fa&-fa:null!==rl.transition?(0===$a&&($a=uI()),$a):0!==(g=ZI)?g:g=void 0===(g=window.event)?16:OI(g.type)}function ei(g,I,e,t){if(50<Oa)throw Oa=0,_a=null,Error(l(185));mI(g,e,t),0!==(2&Xa)&&g===Ja||(g===Ja&&(0===(2&Xa)&&(wa|=e),4===Ha&&oi(g,fa)),ti(g,t),1===e&&0===Xa&&0===(1&I.mode)&&(Ea=_g()+500,FC&&MC()))}function ti(g,I){var e=g.callbackNode;!function(g,I){for(var e=g.suspendedLanes,t=g.pingedLanes,C=g.expirationTimes,l=g.pendingLanes;0<l;){var n=31-nI(l),o=1<<n,a=C[n];-1===a?0!==(o&e)&&0===(o&t)||(C[n]=dI(o,I)):a<=I&&(g.expiredLanes|=o),l&=~o}}(g,I);var t=sI(g,g===Ja?fa:0);if(0===t)null!==e&&jg(e),g.callbackNode=null,g.callbackPriority=0;else if(I=t&-t,g.callbackPriority!==I){if(null!=e&&jg(e),1===I)0===g.tag?function(g){FC=!0,zC(g)}(ai.bind(null,g)):zC(ai.bind(null,g)),lC((function(){0===(6&Xa)&&MC()})),e=null;else{switch(GI(t)){case 1:e=$g;break;case 4:e=gI;break;case 16:default:e=II;break;case 536870912:e=tI}e=Ji(e,Ci.bind(null,g))}g.callbackPriority=I,g.callbackNode=e}}function Ci(g,I){if(qa=-1,$a=0,0!==(6&Xa))throw Error(l(327));var e=g.callbackNode;if(Bi()&&g.callbackNode!==e)return null;var t=sI(g,g===Ja?fa:0);if(0===t)return null;if(0!==(30&t)||0!==(t&g.expiredLanes)||I)I=bi(g,t);else{I=t;var C=Xa;Xa|=2;var n=ri();for(Ja===g&&fa===I||(Ua=null,Ea=_g()+500,si(g,I));;)try{hi();break}catch(a){di(g,a)}Vl(),Va.current=n,Xa=C,null!==ka?I=0:(Ja=null,fa=0,I=Ha)}if(0!==I){if(2===I&&(0!==(C=rI(g))&&(t=C,I=li(g,C))),1===I)throw e=Na,si(g,0),oi(g,t),ti(g,_g()),e;if(6===I)oi(g,t);else{if(C=g.current.alternate,0===(30&t)&&!function(g){for(var I=g;;){if(16384&I.flags){var e=I.updateQueue;if(null!==e&&null!==(e=e.stores))for(var t=0;t<e.length;t++){var C=e[t],l=C.getSnapshot;C=C.value;try{if(!nt(l(),C))return!1}catch(o){return!1}}}if(e=I.child,16384&I.subtreeFlags&&null!==e)e.return=I,I=e;else{if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return!0;I=I.return}I.sibling.return=I.return,I=I.sibling}}return!0}(C)&&(2===(I=bi(g,t))&&(0!==(n=rI(g))&&(t=n,I=li(g,n))),1===I))throw e=Na,si(g,0),oi(g,t),ti(g,_g()),e;switch(g.finishedWork=C,g.finishedLanes=t,I){case 0:case 1:throw Error(l(345));case 2:case 5:pi(g,za,Ua);break;case 3:if(oi(g,t),(130023424&t)===t&&10<(I=Ma+500-_g())){if(0!==sI(g,0))break;if(((C=g.suspendedLanes)&t)!==t){gi(),g.pingedLanes|=g.suspendedLanes&C;break}g.timeoutHandle=eC(pi.bind(null,g,za,Ua),I);break}pi(g,za,Ua);break;case 4:if(oi(g,t),(4194240&t)===t)break;for(I=g.eventTimes,C=-1;0<t;){var o=31-nI(t);n=1<<o,(o=I[o])>C&&(C=o),t&=~n}if(t=C,10<(t=(120>(t=_g()-t)?120:480>t?480:1080>t?1080:1920>t?1920:3e3>t?3e3:4320>t?4320:1960*Wa(t/1960))-t)){g.timeoutHandle=eC(pi.bind(null,g,za,Ua),t);break}pi(g,za,Ua);break;default:throw Error(l(329))}}}return ti(g,_g()),g.callbackNode===e?Ci.bind(null,g):null}function li(g,I){var e=xa;return g.current.memoizedState.isDehydrated&&(si(g,I).flags|=256),2!==(g=bi(g,I))&&(I=za,za=e,null!==I&&ni(I)),g}function ni(g){null===za?za=g:za.push.apply(za,g)}function oi(g,I){for(I&=~Fa,I&=~wa,g.suspendedLanes|=I,g.pingedLanes&=~I,g=g.expirationTimes;0<I;){var e=31-nI(I),t=1<<e;g[e]=-1,I&=~t}}function ai(g){if(0!==(6&Xa))throw Error(l(327));Bi();var I=sI(g,0);if(0===(1&I))return ti(g,_g()),null;var e=bi(g,I);if(0!==g.tag&&2===e){var t=rI(g);0!==t&&(I=t,e=li(g,t))}if(1===e)throw e=Na,si(g,0),oi(g,I),ti(g,_g()),e;if(6===e)throw Error(l(345));return g.finishedWork=g.current.alternate,g.finishedLanes=I,pi(g,za,Ua),ti(g,_g()),null}function ii(g,I){var e=Xa;Xa|=1;try{return g(I)}finally{0===(Xa=e)&&(Ea=_g()+500,FC&&MC())}}function Ai(g){null!==ja&&0===ja.tag&&0===(6&Xa)&&Bi();var I=Xa;Xa|=1;var e=Ra.transition,t=ZI;try{if(Ra.transition=null,ZI=1,g)return g()}finally{ZI=t,Ra.transition=e,0===(6&(Xa=I))&&MC()}}function ci(){va=Ya.current,WC(Ya)}function si(g,I){g.finishedWork=null,g.finishedLanes=0;var e=g.timeoutHandle;if(-1!==e&&(g.timeoutHandle=-1,tC(e)),null!==ka)for(e=ka.return;null!==e;){var t=e;switch(gl(t),t.tag){case 1:null!==(t=t.type.childContextTypes)&&void 0!==t&&vC();break;case 3:Pl(),WC(XC),WC(RC),In();break;case 5:_l(t);break;case 4:Pl();break;case 13:case 19:WC(ql);break;case 10:Sl(t.type._context);break;case 22:case 23:ci()}e=e.return}if(Ja=g,ka=g=Yi(g.current,null),fa=va=I,Ha=0,Na=null,Fa=wa=Ka=0,za=xa=null,null!==kl){for(I=0;I<kl.length;I++)if(null!==(t=(e=kl[I]).interleaved)){e.interleaved=null;var C=t.next,l=e.pending;if(null!==l){var n=l.next;l.next=C,t.next=n}e.pending=t}kl=null}return g}function di(g,I){for(;;){var e=ka;try{if(Vl(),en.current=_n,an){for(var t=ln.memoizedState;null!==t;){var C=t.queue;null!==C&&(C.pending=null),t=t.next}an=!1}if(Cn=0,on=nn=ln=null,An=!1,cn=0,Sa.current=null,null===e||null===e.return){Ha=1,Na=I,ka=null;break}g:{var n=g,o=e.return,a=e,i=I;if(I=fa,a.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){var A=i,c=a,s=c.tag;if(0===(1&c.mode)&&(0===s||11===s||15===s)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var r=bo(o);if(null!==r){r.flags&=-257,mo(r,o,a,0,I),1&r.mode&&uo(n,A,I),i=A;var u=(I=r).updateQueue;if(null===u){var b=new Set;b.add(i),I.updateQueue=b}else u.add(i);break g}if(0===(1&I)){uo(n,A,I),ui();break g}i=Error(l(426))}else if(tl&&1&a.mode){var m=bo(o);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),mo(m,o,a,0,I),dl(ao(i,a));break g}}n=i=ao(i,a),4!==Ha&&(Ha=2),null===xa?xa=[n]:xa.push(n),n=o;do{switch(n.tag){case 3:n.flags|=65536,I&=-I,n.lanes|=I,zl(n,so(0,i,I));break g;case 1:a=i;var h=n.type,Z=n.stateNode;if(0===(128&n.flags)&&("function"===typeof h.getDerivedStateFromError||null!==Z&&"function"===typeof Z.componentDidCatch&&(null===Da||!Da.has(Z)))){n.flags|=65536,I&=-I,n.lanes|=I,zl(n,ro(n,a,I));break g}}n=n.return}while(null!==n)}Gi(e)}catch(G){I=G,ka===e&&null!==e&&(ka=e=e.return);continue}break}}function ri(){var g=Va.current;return Va.current=_n,null===g?_n:g}function ui(){0!==Ha&&3!==Ha&&2!==Ha||(Ha=4),null===Ja||0===(268435455&Ka)&&0===(268435455&wa)||oi(Ja,fa)}function bi(g,I){var e=Xa;Xa|=2;var t=ri();for(Ja===g&&fa===I||(Ua=null,si(g,I));;)try{mi();break}catch(C){di(g,C)}if(Vl(),Xa=e,Va.current=t,null!==ka)throw Error(l(261));return Ja=null,fa=0,Ha}function mi(){for(;null!==ka;)Zi(ka)}function hi(){for(;null!==ka&&!Pg();)Zi(ka)}function Zi(g){var I=ya(g.alternate,g,va);g.memoizedProps=g.pendingProps,null===I?Gi(g):ka=I,Sa.current=null}function Gi(g){var I=g;do{var e=I.alternate;if(g=I.return,0===(32768&I.flags)){if(null!==(e=To(e,I,va)))return void(ka=e)}else{if(null!==(e=jo(e,I)))return e.flags&=32767,void(ka=e);if(null===g)return Ha=6,void(ka=null);g.flags|=32768,g.subtreeFlags=0,g.deletions=null}if(null!==(I=I.sibling))return void(ka=I);ka=I=g}while(null!==I);0===Ha&&(Ha=5)}function pi(g,I,e){var t=ZI,C=Ra.transition;try{Ra.transition=null,ZI=1,function(g,I,e,t){do{Bi()}while(null!==ja);if(0!==(6&Xa))throw Error(l(327));e=g.finishedWork;var C=g.finishedLanes;if(null===e)return null;if(g.finishedWork=null,g.finishedLanes=0,e===g.current)throw Error(l(177));g.callbackNode=null,g.callbackPriority=0;var n=e.lanes|e.childLanes;if(function(g,I){var e=g.pendingLanes&~I;g.pendingLanes=I,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=I,g.mutableReadLanes&=I,g.entangledLanes&=I,I=g.entanglements;var t=g.eventTimes;for(g=g.expirationTimes;0<e;){var C=31-nI(e),l=1<<C;I[C]=0,t[C]=-1,g[C]=-1,e&=~l}}(g,n),g===Ja&&(ka=Ja=null,fa=0),0===(2064&e.subtreeFlags)&&0===(2064&e.flags)||Ta||(Ta=!0,Ji(II,(function(){return Bi(),null}))),n=0!==(15990&e.flags),0!==(15990&e.subtreeFlags)||n){n=Ra.transition,Ra.transition=null;var o=ZI;ZI=1;var a=Xa;Xa|=4,Sa.current=null,function(g,I){if($t=QI,st(g=ct())){if("selectionStart"in g)var e={start:g.selectionStart,end:g.selectionEnd};else g:{var t=(e=(e=g.ownerDocument)&&e.defaultView||window).getSelection&&e.getSelection();if(t&&0!==t.rangeCount){e=t.anchorNode;var C=t.anchorOffset,n=t.focusNode;t=t.focusOffset;try{e.nodeType,n.nodeType}catch(p){e=null;break g}var o=0,a=-1,i=-1,A=0,c=0,s=g,d=null;I:for(;;){for(var r;s!==e||0!==C&&3!==s.nodeType||(a=o+C),s!==n||0!==t&&3!==s.nodeType||(i=o+t),3===s.nodeType&&(o+=s.nodeValue.length),null!==(r=s.firstChild);)d=s,s=r;for(;;){if(s===g)break I;if(d===e&&++A===C&&(a=o),d===n&&++c===t&&(i=o),null!==(r=s.nextSibling))break;d=(s=d).parentNode}s=r}e=-1===a||-1===i?null:{start:a,end:i}}else e=null}e=e||{start:0,end:0}}else e=null;for(gC={focusedElem:g,selectionRange:e},QI=!1,qo=I;null!==qo;)if(g=(I=qo).child,0!==(1028&I.subtreeFlags)&&null!==g)g.return=I,qo=g;else for(;null!==qo;){I=qo;try{var u=I.alternate;if(0!==(1024&I.flags))switch(I.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==u){var b=u.memoizedProps,m=u.memoizedState,h=I.stateNode,Z=h.getSnapshotBeforeUpdate(I.elementType===I.type?b:Io(I.type,b),m);h.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var G=I.stateNode.containerInfo;1===G.nodeType?G.textContent="":9===G.nodeType&&G.documentElement&&G.removeChild(G.documentElement);break;default:throw Error(l(163))}}catch(p){Wi(I,I.return,p)}if(null!==(g=I.sibling)){g.return=I.return,qo=g;break}qo=I.return}u=Ia,Ia=!1}(g,e),ba(e,g),dt(gC),QI=!!$t,gC=$t=null,g.current=e,ha(e,g,C),Og(),Xa=a,ZI=o,Ra.transition=n}else g.current=e;if(Ta&&(Ta=!1,ja=g,Pa=C),n=g.pendingLanes,0===n&&(Da=null),function(g){if(lI&&"function"===typeof lI.onCommitFiberRoot)try{lI.onCommitFiberRoot(CI,g,void 0,128===(128&g.current.flags))}catch(I){}}(e.stateNode),ti(g,_g()),null!==I)for(t=g.onRecoverableError,e=0;e<I.length;e++)C=I[e],t(C.value,{componentStack:C.stack,digest:C.digest});if(Qa)throw Qa=!1,g=La,La=null,g;0!==(1&Pa)&&0!==g.tag&&Bi(),n=g.pendingLanes,0!==(1&n)?g===_a?Oa++:(Oa=0,_a=g):Oa=0,MC()}(g,I,e,t)}finally{Ra.transition=C,ZI=t}return null}function Bi(){if(null!==ja){var g=GI(Pa),I=Ra.transition,e=ZI;try{if(Ra.transition=null,ZI=16>g?16:g,null===ja)var t=!1;else{if(g=ja,ja=null,Pa=0,0!==(6&Xa))throw Error(l(331));var C=Xa;for(Xa|=4,qo=g.current;null!==qo;){var n=qo,o=n.child;if(0!==(16&qo.flags)){var a=n.deletions;if(null!==a){for(var i=0;i<a.length;i++){var A=a[i];for(qo=A;null!==qo;){var c=qo;switch(c.tag){case 0:case 11:case 15:ea(8,c,n)}var s=c.child;if(null!==s)s.return=c,qo=s;else for(;null!==qo;){var d=(c=qo).sibling,r=c.return;if(la(c),c===A){qo=null;break}if(null!==d){d.return=r,qo=d;break}qo=r}}}var u=n.alternate;if(null!==u){var b=u.child;if(null!==b){u.child=null;do{var m=b.sibling;b.sibling=null,b=m}while(null!==b)}}qo=n}}if(0!==(2064&n.subtreeFlags)&&null!==o)o.return=n,qo=o;else g:for(;null!==qo;){if(0!==(2048&(n=qo).flags))switch(n.tag){case 0:case 11:case 15:ea(9,n,n.return)}var h=n.sibling;if(null!==h){h.return=n.return,qo=h;break g}qo=n.return}}var Z=g.current;for(qo=Z;null!==qo;){var G=(o=qo).child;if(0!==(2064&o.subtreeFlags)&&null!==G)G.return=o,qo=G;else g:for(o=Z;null!==qo;){if(0!==(2048&(a=qo).flags))try{switch(a.tag){case 0:case 11:case 15:ta(9,a)}}catch(B){Wi(a,a.return,B)}if(a===o){qo=null;break g}var p=a.sibling;if(null!==p){p.return=a.return,qo=p;break g}qo=a.return}}if(Xa=C,MC(),lI&&"function"===typeof lI.onPostCommitFiberRoot)try{lI.onPostCommitFiberRoot(CI,g)}catch(B){}t=!0}return t}finally{ZI=e,Ra.transition=I}}return!1}function yi(g,I,e){g=Fl(g,I=so(0,I=ao(e,I),1),1),I=gi(),null!==g&&(mI(g,1,I),ti(g,I))}function Wi(g,I,e){if(3===g.tag)yi(g,g,e);else for(;null!==I;){if(3===I.tag){yi(I,g,e);break}if(1===I.tag){var t=I.stateNode;if("function"===typeof I.type.getDerivedStateFromError||"function"===typeof t.componentDidCatch&&(null===Da||!Da.has(t))){I=Fl(I,g=ro(I,g=ao(e,g),1),1),g=gi(),null!==I&&(mI(I,1,g),ti(I,g));break}}I=I.return}}function Vi(g,I,e){var t=g.pingCache;null!==t&&t.delete(I),I=gi(),g.pingedLanes|=g.suspendedLanes&e,Ja===g&&(fa&e)===e&&(4===Ha||3===Ha&&(130023424&fa)===fa&&500>_g()-Ma?si(g,0):Fa|=e),ti(g,I)}function Si(g,I){0===I&&(0===(1&g.mode)?I=1:(I=AI,0===(130023424&(AI<<=1))&&(AI=4194304)));var e=gi();null!==(g=Yl(g,I))&&(mI(g,I,e),ti(g,e))}function Ri(g){var I=g.memoizedState,e=0;null!==I&&(e=I.retryLane),Si(g,e)}function Xi(g,I){var e=0;switch(g.tag){case 13:var t=g.stateNode,C=g.memoizedState;null!==C&&(e=C.retryLane);break;case 19:t=g.stateNode;break;default:throw Error(l(314))}null!==t&&t.delete(I),Si(g,e)}function Ji(g,I){return Tg(g,I)}function ki(g,I,e,t){this.tag=g,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=I,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=t,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(g,I,e,t){return new ki(g,I,e,t)}function vi(g){return!(!(g=g.prototype)||!g.isReactComponent)}function Yi(g,I){var e=g.alternate;return null===e?((e=fi(g.tag,I,g.key,g.mode)).elementType=g.elementType,e.type=g.type,e.stateNode=g.stateNode,e.alternate=g,g.alternate=e):(e.pendingProps=I,e.type=g.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=14680064&g.flags,e.childLanes=g.childLanes,e.lanes=g.lanes,e.child=g.child,e.memoizedProps=g.memoizedProps,e.memoizedState=g.memoizedState,e.updateQueue=g.updateQueue,I=g.dependencies,e.dependencies=null===I?null:{lanes:I.lanes,firstContext:I.firstContext},e.sibling=g.sibling,e.index=g.index,e.ref=g.ref,e}function Hi(g,I,e,t,C,n){var o=2;if(t=g,"function"===typeof g)vi(g)&&(o=1);else if("string"===typeof g)o=5;else g:switch(g){case y:return Ni(e.children,C,n,I);case W:o=8,C|=8;break;case V:return(g=fi(12,e,I,2|C)).elementType=V,g.lanes=n,g;case J:return(g=fi(13,e,I,C)).elementType=J,g.lanes=n,g;case k:return(g=fi(19,e,I,C)).elementType=k,g.lanes=n,g;case Y:return Ki(e,C,n,I);default:if("object"===typeof g&&null!==g)switch(g.$$typeof){case S:o=10;break g;case R:o=9;break g;case X:o=11;break g;case f:o=14;break g;case v:o=16,t=null;break g}throw Error(l(130,null==g?g:typeof g,""))}return(I=fi(o,e,I,C)).elementType=g,I.type=t,I.lanes=n,I}function Ni(g,I,e,t){return(g=fi(7,g,t,I)).lanes=e,g}function Ki(g,I,e,t){return(g=fi(22,g,t,I)).elementType=Y,g.lanes=e,g.stateNode={isHidden:!1},g}function wi(g,I,e){return(g=fi(6,g,null,I)).lanes=e,g}function Fi(g,I,e){return(I=fi(4,null!==g.children?g.children:[],g.key,I)).lanes=e,I.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},I}function xi(g,I,e,t,C){this.tag=I,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bI(0),this.expirationTimes=bI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bI(0),this.identifierPrefix=t,this.onRecoverableError=C,this.mutableSourceEagerHydrationData=null}function zi(g,I,e,t,C,l,n,o,a){return g=new xi(g,I,e,o,a),1===I?(I=1,!0===l&&(I|=8)):I=0,l=fi(3,null,null,I),g.current=l,l.stateNode=g,l.memoizedState={element:t,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nl(l),g}function Mi(g){if(!g)return SC;g:{if(Eg(g=g._reactInternals)!==g||1!==g.tag)throw Error(l(170));var I=g;do{switch(I.tag){case 3:I=I.stateNode.context;break g;case 1:if(fC(I.type)){I=I.stateNode.__reactInternalMemoizedMergedChildContext;break g}}I=I.return}while(null!==I);throw Error(l(171))}if(1===g.tag){var e=g.type;if(fC(e))return HC(g,e,I)}return I}function Ei(g,I,e,t,C,l,n,o,a){return(g=zi(e,t,!0,g,0,l,0,o,a)).context=Mi(null),e=g.current,(l=wl(t=gi(),C=Ii(e))).callback=void 0!==I&&null!==I?I:null,Fl(e,l,C),g.current.lanes=C,mI(g,C,t),ti(g,t),g}function Ui(g,I,e,t){var C=I.current,l=gi(),n=Ii(C);return e=Mi(e),null===I.context?I.context=e:I.pendingContext=e,(I=wl(l,n)).payload={element:g},null!==(t=void 0===t?null:t)&&(I.callback=t),null!==(g=Fl(C,I,n))&&(ei(g,C,n,l),xl(g,C,n)),n}function Qi(g){return(g=g.current).child?(g.child.tag,g.child.stateNode):null}function Li(g,I){if(null!==(g=g.memoizedState)&&null!==g.dehydrated){var e=g.retryLane;g.retryLane=0!==e&&e<I?e:I}}function Di(g,I){Li(g,I),(g=g.alternate)&&Li(g,I)}ya=function(g,I,e){if(null!==g)if(g.memoizedProps!==I.pendingProps||XC.current)Zo=!0;else{if(0===(g.lanes&e)&&0===(128&I.flags))return Zo=!1,function(g,I,e){switch(I.tag){case 3:Jo(I),sl();break;case 5:Ol(I);break;case 1:fC(I.type)&&NC(I);break;case 4:jl(I,I.stateNode.containerInfo);break;case 10:var t=I.type._context,C=I.memoizedProps.value;VC(pl,t._currentValue),t._currentValue=C;break;case 13:if(null!==(t=I.memoizedState))return null!==t.dehydrated?(VC(ql,1&ql.current),I.flags|=128,null):0!==(e&I.child.childLanes)?wo(g,I,e):(VC(ql,1&ql.current),null!==(g=Qo(g,I,e))?g.sibling:null);VC(ql,1&ql.current);break;case 19:if(t=0!==(e&I.childLanes),0!==(128&g.flags)){if(t)return Eo(g,I,e);I.flags|=128}if(null!==(C=I.memoizedState)&&(C.rendering=null,C.tail=null,C.lastEffect=null),VC(ql,ql.current),t)break;return null;case 22:case 23:return I.lanes=0,Wo(g,I,e)}return Qo(g,I,e)}(g,I,e);Zo=0!==(131072&g.flags)}else Zo=!1,tl&&0!==(1048576&I.flags)&&qC(I,LC,I.index);switch(I.lanes=0,I.tag){case 2:var t=I.type;Uo(g,I),g=I.pendingProps;var C=kC(I,RC.current);Xl(I,e),C=un(null,I,t,g,C,e);var n=bn();return I.flags|=1,"object"===typeof C&&null!==C&&"function"===typeof C.render&&void 0===C.$$typeof?(I.tag=1,I.memoizedState=null,I.updateQueue=null,fC(t)?(n=!0,NC(I)):n=!1,I.memoizedState=null!==C.state&&void 0!==C.state?C.state:null,Nl(I),C.updater=to,I.stateNode=C,C._reactInternals=I,oo(I,t,g,e),I=Xo(null,I,t,!0,n,e)):(I.tag=0,tl&&n&&$C(I),Go(null,I,C,e),I=I.child),I;case 16:t=I.elementType;g:{switch(Uo(g,I),g=I.pendingProps,t=(C=t._init)(t._payload),I.type=t,C=I.tag=function(g){if("function"===typeof g)return vi(g)?1:0;if(void 0!==g&&null!==g){if((g=g.$$typeof)===X)return 11;if(g===f)return 14}return 2}(t),g=Io(t,g),C){case 0:I=So(null,I,t,g,e);break g;case 1:I=Ro(null,I,t,g,e);break g;case 11:I=po(null,I,t,g,e);break g;case 14:I=Bo(null,I,t,Io(t.type,g),e);break g}throw Error(l(306,t,""))}return I;case 0:return t=I.type,C=I.pendingProps,So(g,I,t,C=I.elementType===t?C:Io(t,C),e);case 1:return t=I.type,C=I.pendingProps,Ro(g,I,t,C=I.elementType===t?C:Io(t,C),e);case 3:g:{if(Jo(I),null===g)throw Error(l(387));t=I.pendingProps,C=(n=I.memoizedState).element,Kl(g,I),Ml(I,t,null,e);var o=I.memoizedState;if(t=o.element,n.isDehydrated){if(n={element:t,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},I.updateQueue.baseState=n,I.memoizedState=n,256&I.flags){I=ko(g,I,t,e,C=ao(Error(l(423)),I));break g}if(t!==C){I=ko(g,I,t,e,C=ao(Error(l(424)),I));break g}for(el=aC(I.stateNode.containerInfo.firstChild),Il=I,tl=!0,Cl=null,e=Gl(I,null,t,e),I.child=e;e;)e.flags=-3&e.flags|4096,e=e.sibling}else{if(sl(),t===C){I=Qo(g,I,e);break g}Go(g,I,t,e)}I=I.child}return I;case 5:return Ol(I),null===g&&al(I),t=I.type,C=I.pendingProps,n=null!==g?g.memoizedProps:null,o=C.children,IC(t,C)?o=null:null!==n&&IC(t,n)&&(I.flags|=32),Vo(g,I),Go(g,I,o,e),I.child;case 6:return null===g&&al(I),null;case 13:return wo(g,I,e);case 4:return jl(I,I.stateNode.containerInfo),t=I.pendingProps,null===g?I.child=Zl(I,null,t,e):Go(g,I,t,e),I.child;case 11:return t=I.type,C=I.pendingProps,po(g,I,t,C=I.elementType===t?C:Io(t,C),e);case 7:return Go(g,I,I.pendingProps,e),I.child;case 8:case 12:return Go(g,I,I.pendingProps.children,e),I.child;case 10:g:{if(t=I.type._context,C=I.pendingProps,n=I.memoizedProps,o=C.value,VC(pl,t._currentValue),t._currentValue=o,null!==n)if(nt(n.value,o)){if(n.children===C.children&&!XC.current){I=Qo(g,I,e);break g}}else for(null!==(n=I.child)&&(n.return=I);null!==n;){var a=n.dependencies;if(null!==a){o=n.child;for(var i=a.firstContext;null!==i;){if(i.context===t){if(1===n.tag){(i=wl(-1,e&-e)).tag=2;var A=n.updateQueue;if(null!==A){var c=(A=A.shared).pending;null===c?i.next=i:(i.next=c.next,c.next=i),A.pending=i}}n.lanes|=e,null!==(i=n.alternate)&&(i.lanes|=e),Rl(n.return,e,I),a.lanes|=e;break}i=i.next}}else if(10===n.tag)o=n.type===I.type?null:n.child;else if(18===n.tag){if(null===(o=n.return))throw Error(l(341));o.lanes|=e,null!==(a=o.alternate)&&(a.lanes|=e),Rl(o,e,I),o=n.sibling}else o=n.child;if(null!==o)o.return=n;else for(o=n;null!==o;){if(o===I){o=null;break}if(null!==(n=o.sibling)){n.return=o.return,o=n;break}o=o.return}n=o}Go(g,I,C.children,e),I=I.child}return I;case 9:return C=I.type,t=I.pendingProps.children,Xl(I,e),t=t(C=Jl(C)),I.flags|=1,Go(g,I,t,e),I.child;case 14:return C=Io(t=I.type,I.pendingProps),Bo(g,I,t,C=Io(t.type,C),e);case 15:return yo(g,I,I.type,I.pendingProps,e);case 17:return t=I.type,C=I.pendingProps,C=I.elementType===t?C:Io(t,C),Uo(g,I),I.tag=1,fC(t)?(g=!0,NC(I)):g=!1,Xl(I,e),lo(I,t,C),oo(I,t,C,e),Xo(null,I,t,!0,g,e);case 19:return Eo(g,I,e);case 22:return Wo(g,I,e)}throw Error(l(156,I.tag))};var Ti="function"===typeof reportError?reportError:function(g){console.error(g)};function ji(g){this._internalRoot=g}function Pi(g){this._internalRoot=g}function Oi(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType)}function _i(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType&&(8!==g.nodeType||" react-mount-point-unstable "!==g.nodeValue))}function qi(){}function $i(g,I,e,t,C){var l=e._reactRootContainer;if(l){var n=l;if("function"===typeof C){var o=C;C=function(){var g=Qi(n);o.call(g)}}Ui(I,n,g,C)}else n=function(g,I,e,t,C){if(C){if("function"===typeof t){var l=t;t=function(){var g=Qi(n);l.call(g)}}var n=Ei(I,t,g,0,null,!1,0,"",qi);return g._reactRootContainer=n,g[dC]=n.current,Mt(8===g.nodeType?g.parentNode:g),Ai(),n}for(;C=g.lastChild;)g.removeChild(C);if("function"===typeof t){var o=t;t=function(){var g=Qi(a);o.call(g)}}var a=zi(g,0,!1,null,0,!1,0,"",qi);return g._reactRootContainer=a,g[dC]=a.current,Mt(8===g.nodeType?g.parentNode:g),Ai((function(){Ui(I,a,e,t)})),a}(e,I,g,C,t);return Qi(n)}Pi.prototype.render=ji.prototype.render=function(g){var I=this._internalRoot;if(null===I)throw Error(l(409));Ui(g,I,null,null)},Pi.prototype.unmount=ji.prototype.unmount=function(){var g=this._internalRoot;if(null!==g){this._internalRoot=null;var I=g.containerInfo;Ai((function(){Ui(null,g,null,null)})),I[dC]=null}},Pi.prototype.unstable_scheduleHydration=function(g){if(g){var I=WI();g={blockedOn:null,target:g,priority:I};for(var e=0;e<YI.length&&0!==I&&I<YI[e].priority;e++);YI.splice(e,0,g),0===e&&wI(g)}},pI=function(g){switch(g.tag){case 3:var I=g.stateNode;if(I.current.memoizedState.isDehydrated){var e=cI(I.pendingLanes);0!==e&&(hI(I,1|e),ti(I,_g()),0===(6&Xa)&&(Ea=_g()+500,MC()))}break;case 13:Ai((function(){var I=Yl(g,1);if(null!==I){var e=gi();ei(I,g,1,e)}})),Di(g,1)}},BI=function(g){if(13===g.tag){var I=Yl(g,134217728);if(null!==I)ei(I,g,134217728,gi());Di(g,134217728)}},yI=function(g){if(13===g.tag){var I=Ii(g),e=Yl(g,I);if(null!==e)ei(e,g,I,gi());Di(g,I)}},WI=function(){return ZI},VI=function(g,I){var e=ZI;try{return ZI=g,I()}finally{ZI=e}},Bg=function(g,I,e){switch(I){case"input":if(q(g,e),I=e.name,"radio"===e.type&&null!=I){for(e=g;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll("input[name="+JSON.stringify(""+I)+'][type="radio"]'),I=0;I<e.length;I++){var t=e[I];if(t!==g&&t.form===g.form){var C=GC(t);if(!C)throw Error(l(90));T(t),q(t,C)}}}break;case"textarea":lg(g,e);break;case"select":null!=(I=e.value)&&eg(g,!!e.multiple,I,!1)}},Xg=ii,Jg=Ai;var gA={usingClientEntryPoint:!1,Events:[hC,ZC,GC,Sg,Rg,ii]},IA={findFiberByHostInstance:mC,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eA={bundleType:IA.bundleType,version:IA.version,rendererPackageName:IA.rendererPackageName,rendererConfig:IA.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:G.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return null===(g=Lg(g))?null:g.stateNode},findFiberByHostInstance:IA.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var tA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tA.isDisabled&&tA.supportsFiber)try{CI=tA.inject(eA),lI=tA}catch(Ag){}}I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gA,I.createPortal=function(g,I){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Oi(I))throw Error(l(200));return function(g,I,e){var t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:B,key:null==t?null:""+t,children:g,containerInfo:I,implementation:e}}(g,I,null,e)},I.createRoot=function(g,I){if(!Oi(g))throw Error(l(299));var e=!1,t="",C=Ti;return null!==I&&void 0!==I&&(!0===I.unstable_strictMode&&(e=!0),void 0!==I.identifierPrefix&&(t=I.identifierPrefix),void 0!==I.onRecoverableError&&(C=I.onRecoverableError)),I=zi(g,1,!1,null,0,e,0,t,C),g[dC]=I.current,Mt(8===g.nodeType?g.parentNode:g),new ji(I)},I.findDOMNode=function(g){if(null==g)return null;if(1===g.nodeType)return g;var I=g._reactInternals;if(void 0===I){if("function"===typeof g.render)throw Error(l(188));throw g=Object.keys(g).join(","),Error(l(268,g))}return g=null===(g=Lg(I))?null:g.stateNode},I.flushSync=function(g){return Ai(g)},I.hydrate=function(g,I,e){if(!_i(I))throw Error(l(200));return $i(null,g,I,!0,e)},I.hydrateRoot=function(g,I,e){if(!Oi(g))throw Error(l(405));var t=null!=e&&e.hydratedSources||null,C=!1,n="",o=Ti;if(null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(C=!0),void 0!==e.identifierPrefix&&(n=e.identifierPrefix),void 0!==e.onRecoverableError&&(o=e.onRecoverableError)),I=Ei(I,null,g,1,null!=e?e:null,C,0,n,o),g[dC]=I.current,Mt(g),t)for(g=0;g<t.length;g++)C=(C=(e=t[g])._getVersion)(e._source),null==I.mutableSourceEagerHydrationData?I.mutableSourceEagerHydrationData=[e,C]:I.mutableSourceEagerHydrationData.push(e,C);return new Pi(I)},I.render=function(g,I,e){if(!_i(I))throw Error(l(200));return $i(null,g,I,!1,e)},I.unmountComponentAtNode=function(g){if(!_i(g))throw Error(l(40));return!!g._reactRootContainer&&(Ai((function(){$i(null,null,g,!1,(function(){g._reactRootContainer=null,g[dC]=null}))})),!0)},I.unstable_batchedUpdates=ii,I.unstable_renderSubtreeIntoContainer=function(g,I,e,t){if(!_i(e))throw Error(l(200));if(null==g||void 0===g._reactInternals)throw Error(l(38));return $i(g,I,e,!1,t)},I.version="18.3.1-next-f1338f8080-20240426"},391:(g,I,e)=>{"use strict";var t=e(950);I.createRoot=t.createRoot,I.hydrateRoot=t.hydrateRoot},950:(g,I,e)=>{"use strict";!function g(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(I){console.error(I)}}(),g.exports=e(730)},309:function(g,I,e){g.exports=function(g){"use strict";function I(g){if(g&&g.__esModule)return g;var I=Object.create(null);return g&&Object.keys(g).forEach((function(e){if("default"!==e){var t=Object.getOwnPropertyDescriptor(g,e);Object.defineProperty(I,e,t.get?t:{enumerable:!0,get:function(){return g[e]}})}})),I.default=g,Object.freeze(I)}var e=I(g);function t(){return t=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(g[t]=e[t])}return g},t.apply(this,arguments)}function C(g,I,e){return I in g?Object.defineProperty(g,I,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[I]=e,g}function l(g){if(Array.isArray(g))return g}function n(g,I){var e=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=e){var t,C,l=[],n=!0,o=!1;try{for(e=e.call(g);!(n=(t=e.next()).done)&&(l.push(t.value),!I||l.length!==I);n=!0);}catch(a){o=!0,C=a}finally{try{n||null==e.return||e.return()}finally{if(o)throw C}}return l}}function o(g,I){(null==I||I>g.length)&&(I=g.length);for(var e=0,t=new Array(I);e<I;e++)t[e]=g[e];return t}function a(g,I){if(g){if("string"===typeof g)return o(g,I);var e=Object.prototype.toString.call(g).slice(8,-1);return"Object"===e&&g.constructor&&(e=g.constructor.name),"Map"===e||"Set"===e?Array.from(g):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(g,I):void 0}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(g,I){return l(g)||n(g,I)||a(g,I)||i()}function c(g,I){if(null==g)return{};var e,t,C={},l=Object.keys(g);for(t=0;t<l.length;t++)e=l[t],I.indexOf(e)>=0||(C[e]=g[e]);return C}function s(g,I){if(null==g)return{};var e,t,C=c(g,I);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(g);for(t=0;t<l.length;t++)e=l[t],I.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(g,e)&&(C[e]=g[e])}return C}var d={exports:{}},r={exports:{}},u={},b="function"===typeof Symbol&&Symbol.for,m=b?Symbol.for("react.element"):60103,h=b?Symbol.for("react.portal"):60106,Z=b?Symbol.for("react.fragment"):60107,G=b?Symbol.for("react.strict_mode"):60108,p=b?Symbol.for("react.profiler"):60114,B=b?Symbol.for("react.provider"):60109,y=b?Symbol.for("react.context"):60110,W=b?Symbol.for("react.async_mode"):60111,V=b?Symbol.for("react.concurrent_mode"):60111,S=b?Symbol.for("react.forward_ref"):60112,R=b?Symbol.for("react.suspense"):60113,X=b?Symbol.for("react.suspense_list"):60120,J=b?Symbol.for("react.memo"):60115,k=b?Symbol.for("react.lazy"):60116,f=b?Symbol.for("react.block"):60121,v=b?Symbol.for("react.fundamental"):60117,Y=b?Symbol.for("react.responder"):60118,H=b?Symbol.for("react.scope"):60119;function N(g){if("object"===typeof g&&null!==g){var I=g.$$typeof;switch(I){case m:switch(g=g.type){case W:case V:case Z:case p:case G:case R:return g;default:switch(g=g&&g.$$typeof){case y:case S:case k:case J:case B:return g;default:return I}}case h:return I}}}function K(g){return N(g)===V}u.AsyncMode=W,u.ConcurrentMode=V,u.ContextConsumer=y,u.ContextProvider=B,u.Element=m,u.ForwardRef=S,u.Fragment=Z,u.Lazy=k,u.Memo=J,u.Portal=h,u.Profiler=p,u.StrictMode=G,u.Suspense=R,u.isAsyncMode=function(g){return K(g)||N(g)===W},u.isConcurrentMode=K,u.isContextConsumer=function(g){return N(g)===y},u.isContextProvider=function(g){return N(g)===B},u.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===m},u.isForwardRef=function(g){return N(g)===S},u.isFragment=function(g){return N(g)===Z},u.isLazy=function(g){return N(g)===k},u.isMemo=function(g){return N(g)===J},u.isPortal=function(g){return N(g)===h},u.isProfiler=function(g){return N(g)===p},u.isStrictMode=function(g){return N(g)===G},u.isSuspense=function(g){return N(g)===R},u.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===Z||g===V||g===p||g===G||g===R||g===X||"object"===typeof g&&null!==g&&(g.$$typeof===k||g.$$typeof===J||g.$$typeof===B||g.$$typeof===y||g.$$typeof===S||g.$$typeof===v||g.$$typeof===Y||g.$$typeof===H||g.$$typeof===f)},u.typeOf=N,r.exports=u;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function w(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de","5"===Object.getOwnPropertyNames(g)[0])return!1;for(var I={},e=0;e<10;e++)I["_"+String.fromCharCode(e)]=e;var t=Object.getOwnPropertyNames(I).map((function(g){return I[g]}));if("0123456789"!==t.join(""))return!1;var C={};return"abcdefghijklmnopqrst".split("").forEach((function(g){C[g]=g})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},C)).join("")}catch(l){return!1}}w()&&Object.assign;var F="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function x(g,I,e,t,C){}Function.call.bind(Object.prototype.hasOwnProperty),x.resetWarningCache=function(){},r.exports;var z=F;function M(){}function E(){}E.resetWarningCache=M;var U=function(){function g(g,I,e,t,C,l){if(l!==z){var n=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw n.name="Invariant Violation",n}}function I(){return g}g.isRequired=g;var e={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:I,element:g,elementType:g,instanceOf:I,node:g,objectOf:I,oneOf:I,oneOfType:I,shape:I,exact:I,checkPropTypes:E,resetWarningCache:M};return e.PropTypes=e,e};d.exports=U();var Q=d.exports;function L(g,I){var e=atob(g);if(I){for(var t=new Uint8Array(e.length),C=0,l=e.length;C<l;++C)t[C]=e.charCodeAt(C);return String.fromCharCode.apply(null,new Uint16Array(t.buffer))}return e}function D(g,I,e){var t=void 0===I?null:I,C=L(g,void 0!==e&&e),l=C.indexOf("\n",10)+1,n=C.substring(l)+(t?"//# sourceMappingURL="+t:""),o=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(o)}function T(g,I,e){var t;return function(C){return t=t||D(g,I,e),new Worker(t,C)}}var j=T("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),P=["constraints","onError","onLoad","onScan","resolution","qrArea"];function O(g,I){var e=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);I&&(t=t.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),e.push.apply(e,t)}return e}function _(g){for(var I=1;I<arguments.length;I++){var e=null!=arguments[I]?arguments[I]:{};I%2?O(Object(e),!0).forEach((function(I){C(g,I,e[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(e)):O(Object(e)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(e,I))}))}return g}var q=function(){return new j},$=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach((function(I){g.removeTrack(I),I.stop()})),g.getAudioTracks().forEach((function(I){g.removeTrack(I),I.stop()}))):g.stop())},gg=function(g){var I=g.constraints,C=g.onError,l=g.onLoad,n=g.onScan,o=g.resolution,a=g.qrArea,i=s(g,P),c=e.useRef(null),d=e.useRef(null),r=e.useRef(document.createElement("canvas")),u=e.useRef(null),b=e.useRef(),m=A(e.useState(null),2),h=m[0],Z=m[1],G=e.useRef(!1),p=e.useRef();e.useEffect((function(){p.current=q();var g=p.current;return g.onmessage=function(g){n&&n(g.data?_(_({},g.data),{},{canvas:r.current}):null),G.current=!1},function(){g.terminate()}}),[n]);var B=JSON.stringify(a),y=e.useCallback((function(){var g=JSON.parse(B),I=p.current,e=d.current&&d.current.readyState===d.current.HAVE_ENOUGH_DATA;if(!G.current&&e){G.current=!0;var t,C=d.current.videoWidth,l=d.current.videoHeight,n=C>l?C:l,a=Math.floor(o/n*100)/100;l=Math.floor(a*l),C=Math.floor(a*C),r.current.width=C,r.current.height=l,u.current=r.current.getContext("2d"),u.current.drawImage(d.current,0,0,C,l),t=g&&2===g.length&&g[0]>0&&g[1]>0?u.current.getImageData(Math.floor((C-g[0])/2),Math.floor((l-g[1])/2),g[0],g[1]):u.current.getImageData(0,0,C,l),I.postMessage(t)}b.current=requestAnimationFrame(y)}),[o,B]),W=JSON.stringify(I);return e.useEffect((function(){var g=JSON.parse(W),I=!0;return navigator.mediaDevices.getUserMedia(g).then((function(g){if(I){c.current=g;try{d.current&&(d.current.srcObject=g,d.current.setAttribute("playsinline",!0))}catch(e){Z(window.URL.createObjectURL(g))}l&&l(),b.current=requestAnimationFrame(y)}else $(g)})).catch((function(g){return I?C(g):null})),function(){cancelAnimationFrame(b.current),I=!1,$(c.current),h&&window.URL.revokeObjectURL(h)}}),[y,W,C,l,h]),e.createElement("video",t({autoPlay:!0,playsInline:!0,src:h,ref:d},i))};return gg.propTypes={constraints:Q.object,onError:Q.func.isRequired,onLoad:Q.func,onScan:Q.func.isRequired,resolution:Q.number,qrArea:Q.array},gg.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]},gg}(e(43))},153:(g,I,e)=>{"use strict";var t=e(43),C=Symbol.for("react.element"),l=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(g,I,e){var t,l={},i=null,A=null;for(t in void 0!==e&&(i=""+e),void 0!==I.key&&(i=""+I.key),void 0!==I.ref&&(A=I.ref),I)n.call(I,t)&&!a.hasOwnProperty(t)&&(l[t]=I[t]);if(g&&g.defaultProps)for(t in I=g.defaultProps)void 0===l[t]&&(l[t]=I[t]);return{$$typeof:C,type:g,key:i,ref:A,props:l,_owner:o.current}}I.jsx=i,I.jsxs=i},202:(g,I)=>{"use strict";var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),s=Symbol.for("react.lazy"),d=Symbol.iterator;var r={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u=Object.assign,b={};function m(g,I,e){this.props=g,this.context=I,this.refs=b,this.updater=e||r}function h(){}function Z(g,I,e){this.props=g,this.context=I,this.refs=b,this.updater=e||r}m.prototype.isReactComponent={},m.prototype.setState=function(g,I){if("object"!==typeof g&&"function"!==typeof g&&null!=g)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,I,"setState")},m.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")},h.prototype=m.prototype;var G=Z.prototype=new h;G.constructor=Z,u(G,m.prototype),G.isPureReactComponent=!0;var p=Array.isArray,B=Object.prototype.hasOwnProperty,y={current:null},W={key:!0,ref:!0,__self:!0,__source:!0};function V(g,I,t){var C,l={},n=null,o=null;if(null!=I)for(C in void 0!==I.ref&&(o=I.ref),void 0!==I.key&&(n=""+I.key),I)B.call(I,C)&&!W.hasOwnProperty(C)&&(l[C]=I[C]);var a=arguments.length-2;if(1===a)l.children=t;else if(1<a){for(var i=Array(a),A=0;A<a;A++)i[A]=arguments[A+2];l.children=i}if(g&&g.defaultProps)for(C in a=g.defaultProps)void 0===l[C]&&(l[C]=a[C]);return{$$typeof:e,type:g,key:n,ref:o,props:l,_owner:y.current}}function S(g){return"object"===typeof g&&null!==g&&g.$$typeof===e}var R=/\/+/g;function X(g,I){return"object"===typeof g&&null!==g&&null!=g.key?function(g){var I={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,(function(g){return I[g]}))}(""+g.key):I.toString(36)}function J(g,I,C,l,n){var o=typeof g;"undefined"!==o&&"boolean"!==o||(g=null);var a=!1;if(null===g)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(g.$$typeof){case e:case t:a=!0}}if(a)return n=n(a=g),g=""===l?"."+X(a,0):l,p(n)?(C="",null!=g&&(C=g.replace(R,"$&/")+"/"),J(n,I,C,"",(function(g){return g}))):null!=n&&(S(n)&&(n=function(g,I){return{$$typeof:e,type:g.type,key:I,ref:g.ref,props:g.props,_owner:g._owner}}(n,C+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(R,"$&/")+"/")+g)),I.push(n)),1;if(a=0,l=""===l?".":l+":",p(g))for(var i=0;i<g.length;i++){var A=l+X(o=g[i],i);a+=J(o,I,C,A,n)}else if(A=function(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=d&&g[d]||g["@@iterator"])?g:null}(g),"function"===typeof A)for(g=A.call(g),i=0;!(o=g.next()).done;)a+=J(o=o.value,I,C,A=l+X(o,i++),n);else if("object"===o)throw I=String(g),Error("Objects are not valid as a React child (found: "+("[object Object]"===I?"object with keys {"+Object.keys(g).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return a}function k(g,I,e){if(null==g)return g;var t=[],C=0;return J(g,t,"","",(function(g){return I.call(e,g,C++)})),t}function f(g){if(-1===g._status){var I=g._result;(I=I()).then((function(I){0!==g._status&&-1!==g._status||(g._status=1,g._result=I)}),(function(I){0!==g._status&&-1!==g._status||(g._status=2,g._result=I)})),-1===g._status&&(g._status=0,g._result=I)}if(1===g._status)return g._result.default;throw g._result}var v={current:null},Y={transition:null},H={ReactCurrentDispatcher:v,ReactCurrentBatchConfig:Y,ReactCurrentOwner:y};function N(){throw Error("act(...) is not supported in production builds of React.")}I.Children={map:k,forEach:function(g,I,e){k(g,(function(){I.apply(this,arguments)}),e)},count:function(g){var I=0;return k(g,(function(){I++})),I},toArray:function(g){return k(g,(function(g){return g}))||[]},only:function(g){if(!S(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},I.Component=m,I.Fragment=C,I.Profiler=n,I.PureComponent=Z,I.StrictMode=l,I.Suspense=A,I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,I.act=N,I.cloneElement=function(g,I,t){if(null===g||void 0===g)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var C=u({},g.props),l=g.key,n=g.ref,o=g._owner;if(null!=I){if(void 0!==I.ref&&(n=I.ref,o=y.current),void 0!==I.key&&(l=""+I.key),g.type&&g.type.defaultProps)var a=g.type.defaultProps;for(i in I)B.call(I,i)&&!W.hasOwnProperty(i)&&(C[i]=void 0===I[i]&&void 0!==a?a[i]:I[i])}var i=arguments.length-2;if(1===i)C.children=t;else if(1<i){a=Array(i);for(var A=0;A<i;A++)a[A]=arguments[A+2];C.children=a}return{$$typeof:e,type:g.type,key:l,ref:n,props:C,_owner:o}},I.createContext=function(g){return(g={$$typeof:a,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:g},g.Consumer=g},I.createElement=V,I.createFactory=function(g){var I=V.bind(null,g);return I.type=g,I},I.createRef=function(){return{current:null}},I.forwardRef=function(g){return{$$typeof:i,render:g}},I.isValidElement=S,I.lazy=function(g){return{$$typeof:s,_payload:{_status:-1,_result:g},_init:f}},I.memo=function(g,I){return{$$typeof:c,type:g,compare:void 0===I?null:I}},I.startTransition=function(g){var I=Y.transition;Y.transition={};try{g()}finally{Y.transition=I}},I.unstable_act=N,I.useCallback=function(g,I){return v.current.useCallback(g,I)},I.useContext=function(g){return v.current.useContext(g)},I.useDebugValue=function(){},I.useDeferredValue=function(g){return v.current.useDeferredValue(g)},I.useEffect=function(g,I){return v.current.useEffect(g,I)},I.useId=function(){return v.current.useId()},I.useImperativeHandle=function(g,I,e){return v.current.useImperativeHandle(g,I,e)},I.useInsertionEffect=function(g,I){return v.current.useInsertionEffect(g,I)},I.useLayoutEffect=function(g,I){return v.current.useLayoutEffect(g,I)},I.useMemo=function(g,I){return v.current.useMemo(g,I)},I.useReducer=function(g,I,e){return v.current.useReducer(g,I,e)},I.useRef=function(g){return v.current.useRef(g)},I.useState=function(g){return v.current.useState(g)},I.useSyncExternalStore=function(g,I,e){return v.current.useSyncExternalStore(g,I,e)},I.useTransition=function(){return v.current.useTransition()},I.version="18.3.1"},43:(g,I,e)=>{"use strict";g.exports=e(202)},579:(g,I,e)=>{"use strict";g.exports=e(153)},234:(g,I)=>{"use strict";function e(g,I){var e=g.length;g.push(I);g:for(;0<e;){var t=e-1>>>1,C=g[t];if(!(0<l(C,I)))break g;g[t]=I,g[e]=C,e=t}}function t(g){return 0===g.length?null:g[0]}function C(g){if(0===g.length)return null;var I=g[0],e=g.pop();if(e!==I){g[0]=e;g:for(var t=0,C=g.length,n=C>>>1;t<n;){var o=2*(t+1)-1,a=g[o],i=o+1,A=g[i];if(0>l(a,e))i<C&&0>l(A,a)?(g[t]=A,g[i]=e,t=i):(g[t]=a,g[o]=e,t=o);else{if(!(i<C&&0>l(A,e)))break g;g[t]=A,g[i]=e,t=i}}}return I}function l(g,I){var e=g.sortIndex-I.sortIndex;return 0!==e?e:g.id-I.id}if("object"===typeof performance&&"function"===typeof performance.now){var n=performance;I.unstable_now=function(){return n.now()}}else{var o=Date,a=o.now();I.unstable_now=function(){return o.now()-a}}var i=[],A=[],c=1,s=null,d=3,r=!1,u=!1,b=!1,m="function"===typeof setTimeout?setTimeout:null,h="function"===typeof clearTimeout?clearTimeout:null,Z="undefined"!==typeof setImmediate?setImmediate:null;function G(g){for(var I=t(A);null!==I;){if(null===I.callback)C(A);else{if(!(I.startTime<=g))break;C(A),I.sortIndex=I.expirationTime,e(i,I)}I=t(A)}}function p(g){if(b=!1,G(g),!u)if(null!==t(i))u=!0,Y(B);else{var I=t(A);null!==I&&H(p,I.startTime-g)}}function B(g,e){u=!1,b&&(b=!1,h(S),S=-1),r=!0;var l=d;try{for(G(e),s=t(i);null!==s&&(!(s.expirationTime>e)||g&&!J());){var n=s.callback;if("function"===typeof n){s.callback=null,d=s.priorityLevel;var o=n(s.expirationTime<=e);e=I.unstable_now(),"function"===typeof o?s.callback=o:s===t(i)&&C(i),G(e)}else C(i);s=t(i)}if(null!==s)var a=!0;else{var c=t(A);null!==c&&H(p,c.startTime-e),a=!1}return a}finally{s=null,d=l,r=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var y,W=!1,V=null,S=-1,R=5,X=-1;function J(){return!(I.unstable_now()-X<R)}function k(){if(null!==V){var g=I.unstable_now();X=g;var e=!0;try{e=V(!0,g)}finally{e?y():(W=!1,V=null)}}else W=!1}if("function"===typeof Z)y=function(){Z(k)};else if("undefined"!==typeof MessageChannel){var f=new MessageChannel,v=f.port2;f.port1.onmessage=k,y=function(){v.postMessage(null)}}else y=function(){m(k,0)};function Y(g){V=g,W||(W=!0,y())}function H(g,e){S=m((function(){g(I.unstable_now())}),e)}I.unstable_IdlePriority=5,I.unstable_ImmediatePriority=1,I.unstable_LowPriority=4,I.unstable_NormalPriority=3,I.unstable_Profiling=null,I.unstable_UserBlockingPriority=2,I.unstable_cancelCallback=function(g){g.callback=null},I.unstable_continueExecution=function(){u||r||(u=!0,Y(B))},I.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<g?Math.floor(1e3/g):5},I.unstable_getCurrentPriorityLevel=function(){return d},I.unstable_getFirstCallbackNode=function(){return t(i)},I.unstable_next=function(g){switch(d){case 1:case 2:case 3:var I=3;break;default:I=d}var e=d;d=I;try{return g()}finally{d=e}},I.unstable_pauseExecution=function(){},I.unstable_requestPaint=function(){},I.unstable_runWithPriority=function(g,I){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var e=d;d=g;try{return I()}finally{d=e}},I.unstable_scheduleCallback=function(g,C,l){var n=I.unstable_now();switch("object"===typeof l&&null!==l?l="number"===typeof(l=l.delay)&&0<l?n+l:n:l=n,g){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return g={id:c++,callback:C,priorityLevel:g,startTime:l,expirationTime:o=l+o,sortIndex:-1},l>n?(g.sortIndex=l,e(A,g),null===t(i)&&g===t(A)&&(b?(h(S),S=-1):b=!0,H(p,l-n))):(g.sortIndex=o,e(i,g),u||r||(u=!0,Y(B))),g},I.unstable_shouldYield=J,I.unstable_wrapCallback=function(g){var I=d;return function(){var e=d;d=I;try{return g.apply(this,arguments)}finally{d=e}}}},853:(g,I,e)=>{"use strict";g.exports=e(234)},324:g=>{g.exports=function(g,I,e,t){var C=e?e.call(t,g,I):void 0;if(void 0!==C)return!!C;if(g===I)return!0;if("object"!==typeof g||!g||"object"!==typeof I||!I)return!1;var l=Object.keys(g),n=Object.keys(I);if(l.length!==n.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(I),a=0;a<l.length;a++){var i=l[a];if(!o(i))return!1;var A=g[i],c=I[i];if(!1===(C=e?e.call(t,A,c,i):void 0)||void 0===C&&A!==c)return!1}return!0}}},I={};function e(t){var C=I[t];if(void 0!==C)return C.exports;var l=I[t]={exports:{}};return g[t].call(l.exports,l,l.exports,e),l.exports}e.m=g,e.n=g=>{var I=g&&g.__esModule?()=>g.default:()=>g;return e.d(I,{a:I}),I},(()=>{var g,I=Object.getPrototypeOf?g=>Object.getPrototypeOf(g):g=>g.__proto__;e.t=function(t,C){if(1&C&&(t=this(t)),8&C)return t;if("object"===typeof t&&t){if(4&C&&t.__esModule)return t;if(16&C&&"function"===typeof t.then)return t}var l=Object.create(null);e.r(l);var n={};g=g||[null,I({}),I([]),I(I)];for(var o=2&C&&t;"object"==typeof o&&!~g.indexOf(o);o=I(o))Object.getOwnPropertyNames(o).forEach((g=>n[g]=()=>t[g]));return n.default=()=>t,e.d(l,n),l}})(),e.d=(g,I)=>{for(var t in I)e.o(I,t)&&!e.o(g,t)&&Object.defineProperty(g,t,{enumerable:!0,get:I[t]})},e.f={},e.e=g=>Promise.all(Object.keys(e.f).reduce(((I,t)=>(e.f[t](g,I),I)),[])),e.u=g=>"static/js/"+g+".180113f2.chunk.js",e.miniCssF=g=>{},e.o=(g,I)=>Object.prototype.hasOwnProperty.call(g,I),(()=>{var g={},I="order-ui:";e.l=(t,C,l,n)=>{if(g[t])g[t].push(C);else{var o,a;if(void 0!==l)for(var i=document.getElementsByTagName("script"),A=0;A<i.length;A++){var c=i[A];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==I+l){o=c;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,e.nc&&o.setAttribute("nonce",e.nc),o.setAttribute("data-webpack",I+l),o.src=t),g[t]=[C];var s=(I,e)=>{o.onerror=o.onload=null,clearTimeout(d);var C=g[t];if(delete g[t],o.parentNode&&o.parentNode.removeChild(o),C&&C.forEach((g=>g(e))),I)return I(e)},d=setTimeout(s.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=s.bind(null,o.onerror),o.onload=s.bind(null,o.onload),a&&document.head.appendChild(o)}}})(),e.r=g=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},e.p="/",(()=>{var g={792:0};e.f.j=(I,t)=>{var C=e.o(g,I)?g[I]:void 0;if(0!==C)if(C)t.push(C[2]);else{var l=new Promise(((e,t)=>C=g[I]=[e,t]));t.push(C[2]=l);var n=e.p+e.u(I),o=new Error;e.l(n,(t=>{if(e.o(g,I)&&(0!==(C=g[I])&&(g[I]=void 0),C)){var l=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;o.message="Loading chunk "+I+" failed.\n("+l+": "+n+")",o.name="ChunkLoadError",o.type=l,o.request=n,C[1](o)}}),"chunk-"+I,I)}};var I=(I,t)=>{var C,l,n=t[0],o=t[1],a=t[2],i=0;if(n.some((I=>0!==g[I]))){for(C in o)e.o(o,C)&&(e.m[C]=o[C]);if(a)a(e)}for(I&&I(t);i<n.length;i++)l=n[i],e.o(g,l)&&g[l]&&g[l][0](),g[l]=0},t=self.webpackChunkorder_ui=self.webpackChunkorder_ui||[];t.forEach(I.bind(null,0)),t.push=I.bind(null,t.push.bind(t))})(),(()=>{"use strict";var g={};e.r(g),e.d(g,{hasBrowserEnv:()=>ib,hasStandardBrowserEnv:()=>Ab,hasStandardBrowserWebWorkerEnv:()=>sb});var I,t=e(43),C=e.t(t,2),l=e(391),n=e(950),o=e.t(n,2);function a(){return a=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(g[t]=e[t])}return g},a.apply(this,arguments)}!function(g){g.Pop="POP",g.Push="PUSH",g.Replace="REPLACE"}(I||(I={}));const i="popstate";function A(g,I){if(!1===g||null===g||"undefined"===typeof g)throw new Error(I)}function c(g,I){if(!g){"undefined"!==typeof console&&console.warn(I);try{throw new Error(I)}catch(e){}}}function s(g,I){return{usr:g.state,key:g.key,idx:I}}function d(g,I,e,t){return void 0===e&&(e=null),a({pathname:"string"===typeof g?g:g.pathname,search:"",hash:""},"string"===typeof I?u(I):I,{state:e,key:I&&I.key||t||Math.random().toString(36).substr(2,8)})}function r(g){let{pathname:I="/",search:e="",hash:t=""}=g;return e&&"?"!==e&&(I+="?"===e.charAt(0)?e:"?"+e),t&&"#"!==t&&(I+="#"===t.charAt(0)?t:"#"+t),I}function u(g){let I={};if(g){let e=g.indexOf("#");e>=0&&(I.hash=g.substr(e),g=g.substr(0,e));let t=g.indexOf("?");t>=0&&(I.search=g.substr(t),g=g.substr(0,t)),g&&(I.pathname=g)}return I}function b(g,e,t,C){void 0===C&&(C={});let{window:l=document.defaultView,v5Compat:n=!1}=C,o=l.history,c=I.Pop,u=null,b=m();function m(){return(o.state||{idx:null}).idx}function h(){c=I.Pop;let g=m(),e=null==g?null:g-b;b=g,u&&u({action:c,location:G.location,delta:e})}function Z(g){let I="null"!==l.location.origin?l.location.origin:l.location.href,e="string"===typeof g?g:r(g);return e=e.replace(/ $/,"%20"),A(I,"No window.location.(origin|href) available to create URL for href: "+e),new URL(e,I)}null==b&&(b=0,o.replaceState(a({},o.state,{idx:b}),""));let G={get action(){return c},get location(){return g(l,o)},listen(g){if(u)throw new Error("A history only accepts one active listener");return l.addEventListener(i,h),u=g,()=>{l.removeEventListener(i,h),u=null}},createHref:g=>e(l,g),createURL:Z,encodeLocation(g){let I=Z(g);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:function(g,e){c=I.Push;let C=d(G.location,g,e);t&&t(C,g),b=m()+1;let a=s(C,b),i=G.createHref(C);try{o.pushState(a,"",i)}catch(A){if(A instanceof DOMException&&"DataCloneError"===A.name)throw A;l.location.assign(i)}n&&u&&u({action:c,location:G.location,delta:1})},replace:function(g,e){c=I.Replace;let C=d(G.location,g,e);t&&t(C,g),b=m();let l=s(C,b),a=G.createHref(C);o.replaceState(l,"",a),n&&u&&u({action:c,location:G.location,delta:0})},go:g=>o.go(g)};return G}var m;!function(g){g.data="data",g.deferred="deferred",g.redirect="redirect",g.error="error"}(m||(m={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function h(g,I,e){void 0===e&&(e="/");let t=v(("string"===typeof I?u(I):I).pathname||"/",e);if(null==t)return null;let C=Z(g);!function(g){g.sort(((g,I)=>g.score!==I.score?I.score-g.score:function(g,I){let e=g.length===I.length&&g.slice(0,-1).every(((g,e)=>g===I[e]));return e?g[g.length-1]-I[I.length-1]:0}(g.routesMeta.map((g=>g.childrenIndex)),I.routesMeta.map((g=>g.childrenIndex)))))}(C);let l=null;for(let n=0;null==l&&n<C.length;++n){let g=f(t);l=J(C[n],g)}return l}function Z(g,I,e,t){void 0===I&&(I=[]),void 0===e&&(e=[]),void 0===t&&(t="");let C=(g,C,l)=>{let n={relativePath:void 0===l?g.path||"":l,caseSensitive:!0===g.caseSensitive,childrenIndex:C,route:g};n.relativePath.startsWith("/")&&(A(n.relativePath.startsWith(t),'Absolute route path "'+n.relativePath+'" nested under path "'+t+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),n.relativePath=n.relativePath.slice(t.length));let o=w([t,n.relativePath]),a=e.concat(n);g.children&&g.children.length>0&&(A(!0!==g.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),Z(g.children,I,a,o)),(null!=g.path||g.index)&&I.push({path:o,score:X(o,g.index),routesMeta:a})};return g.forEach(((g,I)=>{var e;if(""!==g.path&&null!=(e=g.path)&&e.includes("?"))for(let t of G(g.path))C(g,I,t);else C(g,I)})),I}function G(g){let I=g.split("/");if(0===I.length)return[];let[e,...t]=I,C=e.endsWith("?"),l=e.replace(/\?$/,"");if(0===t.length)return C?[l,""]:[l];let n=G(t.join("/")),o=[];return o.push(...n.map((g=>""===g?l:[l,g].join("/")))),C&&o.push(...n),o.map((I=>g.startsWith("/")&&""===I?"/":I))}const p=/^:[\w-]+$/,B=3,y=2,W=1,V=10,S=-2,R=g=>"*"===g;function X(g,I){let e=g.split("/"),t=e.length;return e.some(R)&&(t+=S),I&&(t+=y),e.filter((g=>!R(g))).reduce(((g,I)=>g+(p.test(I)?B:""===I?W:V)),t)}function J(g,I){let{routesMeta:e}=g,t={},C="/",l=[];for(let n=0;n<e.length;++n){let g=e[n],o=n===e.length-1,a="/"===C?I:I.slice(C.length)||"/",i=k({path:g.relativePath,caseSensitive:g.caseSensitive,end:o},a);if(!i)return null;Object.assign(t,i.params);let A=g.route;l.push({params:t,pathname:w([C,i.pathname]),pathnameBase:F(w([C,i.pathnameBase])),route:A}),"/"!==i.pathnameBase&&(C=w([C,i.pathnameBase]))}return l}function k(g,I){"string"===typeof g&&(g={path:g,caseSensitive:!1,end:!0});let[e,t]=function(g,I,e){void 0===I&&(I=!1);void 0===e&&(e=!0);c("*"===g||!g.endsWith("*")||g.endsWith("/*"),'Route path "'+g+'" will be treated as if it were "'+g.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+g.replace(/\*$/,"/*")+'".');let t=[],C="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((g,I,e)=>(t.push({paramName:I,isOptional:null!=e}),e?"/?([^\\/]+)?":"/([^\\/]+)")));g.endsWith("*")?(t.push({paramName:"*"}),C+="*"===g||"/*"===g?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?C+="\\/*$":""!==g&&"/"!==g&&(C+="(?:(?=\\/|$))");let l=new RegExp(C,I?void 0:"i");return[l,t]}(g.path,g.caseSensitive,g.end),C=I.match(e);if(!C)return null;let l=C[0],n=l.replace(/(.)\/+$/,"$1"),o=C.slice(1),a=t.reduce(((g,I,e)=>{let{paramName:t,isOptional:C}=I;if("*"===t){let g=o[e]||"";n=l.slice(0,l.length-g.length).replace(/(.)\/+$/,"$1")}const a=o[e];return g[t]=C&&!a?void 0:(a||"").replace(/%2F/g,"/"),g}),{});return{params:a,pathname:l,pathnameBase:n,pattern:g}}function f(g){try{return g.split("/").map((g=>decodeURIComponent(g).replace(/\//g,"%2F"))).join("/")}catch(I){return c(!1,'The URL path "'+g+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+I+")."),g}}function v(g,I){if("/"===I)return g;if(!g.toLowerCase().startsWith(I.toLowerCase()))return null;let e=I.endsWith("/")?I.length-1:I.length,t=g.charAt(e);return t&&"/"!==t?null:g.slice(e)||"/"}function Y(g,I,e,t){return"Cannot include a '"+g+"' character in a manually specified `to."+I+"` field ["+JSON.stringify(t)+"].  Please separate it out to the `to."+e+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function H(g){return g.filter(((g,I)=>0===I||g.route.path&&g.route.path.length>0))}function N(g,I){let e=H(g);return I?e.map(((I,e)=>e===g.length-1?I.pathname:I.pathnameBase)):e.map((g=>g.pathnameBase))}function K(g,I,e,t){let C;void 0===t&&(t=!1),"string"===typeof g?C=u(g):(C=a({},g),A(!C.pathname||!C.pathname.includes("?"),Y("?","pathname","search",C)),A(!C.pathname||!C.pathname.includes("#"),Y("#","pathname","hash",C)),A(!C.search||!C.search.includes("#"),Y("#","search","hash",C)));let l,n=""===g||""===C.pathname,o=n?"/":C.pathname;if(null==o)l=e;else{let g=I.length-1;if(!t&&o.startsWith("..")){let I=o.split("/");for(;".."===I[0];)I.shift(),g-=1;C.pathname=I.join("/")}l=g>=0?I[g]:"/"}let i=function(g,I){void 0===I&&(I="/");let{pathname:e,search:t="",hash:C=""}="string"===typeof g?u(g):g,l=e?e.startsWith("/")?e:function(g,I){let e=I.replace(/\/+$/,"").split("/");return g.split("/").forEach((g=>{".."===g?e.length>1&&e.pop():"."!==g&&e.push(g)})),e.length>1?e.join("/"):"/"}(e,I):I;return{pathname:l,search:x(t),hash:z(C)}}(C,l),c=o&&"/"!==o&&o.endsWith("/"),s=(n||"."===o)&&e.endsWith("/");return i.pathname.endsWith("/")||!c&&!s||(i.pathname+="/"),i}const w=g=>g.join("/").replace(/\/\/+/g,"/"),F=g=>g.replace(/\/+$/,"").replace(/^\/*/,"/"),x=g=>g&&"?"!==g?g.startsWith("?")?g:"?"+g:"",z=g=>g&&"#"!==g?g.startsWith("#")?g:"#"+g:"";Error;function M(g){return null!=g&&"number"===typeof g.status&&"string"===typeof g.statusText&&"boolean"===typeof g.internal&&"data"in g}const E=["post","put","patch","delete"],U=(new Set(E),["get",...E]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Q(){return Q=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(g[t]=e[t])}return g},Q.apply(this,arguments)}const L=t.createContext(null);const D=t.createContext(null);const T=t.createContext(null);const j=t.createContext(null);const P=t.createContext({outlet:null,matches:[],isDataRoute:!1});const O=t.createContext(null);function _(){return null!=t.useContext(j)}function q(){return _()||A(!1),t.useContext(j).location}function $(g){t.useContext(T).static||t.useLayoutEffect(g)}function gg(){let{isDataRoute:g}=t.useContext(P);return g?function(){let{router:g}=Ag(ag.UseNavigateStable),I=sg(ig.UseNavigateStable),e=t.useRef(!1);$((()=>{e.current=!0}));let C=t.useCallback((function(t,C){void 0===C&&(C={}),e.current&&("number"===typeof t?g.navigate(t):g.navigate(t,Q({fromRouteId:I},C)))}),[g,I]);return C}():function(){_()||A(!1);let g=t.useContext(L),{basename:I,future:e,navigator:C}=t.useContext(T),{matches:l}=t.useContext(P),{pathname:n}=q(),o=JSON.stringify(N(l,e.v7_relativeSplatPath)),a=t.useRef(!1);$((()=>{a.current=!0}));let i=t.useCallback((function(e,t){if(void 0===t&&(t={}),!a.current)return;if("number"===typeof e)return void C.go(e);let l=K(e,JSON.parse(o),n,"path"===t.relative);null==g&&"/"!==I&&(l.pathname="/"===l.pathname?I:w([I,l.pathname])),(t.replace?C.replace:C.push)(l,t.state,t)}),[I,C,o,n,g]);return i}()}function Ig(g,I){let{relative:e}=void 0===I?{}:I,{future:C}=t.useContext(T),{matches:l}=t.useContext(P),{pathname:n}=q(),o=JSON.stringify(N(l,C.v7_relativeSplatPath));return t.useMemo((()=>K(g,JSON.parse(o),n,"path"===e)),[g,o,n,e])}function eg(g,e,C,l){_()||A(!1);let{navigator:n}=t.useContext(T),{matches:o}=t.useContext(P),a=o[o.length-1],i=a?a.params:{},c=(a&&a.pathname,a?a.pathnameBase:"/");a&&a.route;let s,d=q();if(e){var r;let g="string"===typeof e?u(e):e;"/"===c||(null==(r=g.pathname)?void 0:r.startsWith(c))||A(!1),s=g}else s=d;let b=s.pathname||"/",m=b;if("/"!==c){let g=c.replace(/^\//,"").split("/");m="/"+b.replace(/^\//,"").split("/").slice(g.length).join("/")}let Z=h(g,{pathname:m});let G=og(Z&&Z.map((g=>Object.assign({},g,{params:Object.assign({},i,g.params),pathname:w([c,n.encodeLocation?n.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:"/"===g.pathnameBase?c:w([c,n.encodeLocation?n.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])}))),o,C,l);return e&&G?t.createElement(j.Provider,{value:{location:Q({pathname:"/",search:"",hash:"",state:null,key:"default"},s),navigationType:I.Pop}},G):G}function tg(){let g=function(){var g;let I=t.useContext(O),e=cg(ig.UseRouteError),C=sg(ig.UseRouteError);if(void 0!==I)return I;return null==(g=e.errors)?void 0:g[C]}(),I=M(g)?g.status+" "+g.statusText:g instanceof Error?g.message:JSON.stringify(g),e=g instanceof Error?g.stack:null,C="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:C};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},I),e?t.createElement("pre",{style:l},e):null,null)}const Cg=t.createElement(tg,null);class lg extends t.Component{constructor(g){super(g),this.state={location:g.location,revalidation:g.revalidation,error:g.error}}static getDerivedStateFromError(g){return{error:g}}static getDerivedStateFromProps(g,I){return I.location!==g.location||"idle"!==I.revalidation&&"idle"===g.revalidation?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:void 0!==g.error?g.error:I.error,location:I.location,revalidation:g.revalidation||I.revalidation}}componentDidCatch(g,I){console.error("React Router caught the following error during render",g,I)}render(){return void 0!==this.state.error?t.createElement(P.Provider,{value:this.props.routeContext},t.createElement(O.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ng(g){let{routeContext:I,match:e,children:C}=g,l=t.useContext(L);return l&&l.static&&l.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=e.route.id),t.createElement(P.Provider,{value:I},C)}function og(g,I,e,C){var l;if(void 0===I&&(I=[]),void 0===e&&(e=null),void 0===C&&(C=null),null==g){var n;if(null==(n=e)||!n.errors)return null;g=e.matches}let o=g,a=null==(l=e)?void 0:l.errors;if(null!=a){let g=o.findIndex((g=>g.route.id&&void 0!==(null==a?void 0:a[g.route.id])));g>=0||A(!1),o=o.slice(0,Math.min(o.length,g+1))}let i=!1,c=-1;if(e&&C&&C.v7_partialHydration)for(let t=0;t<o.length;t++){let g=o[t];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(c=t),g.route.id){let{loaderData:I,errors:t}=e,C=g.route.loader&&void 0===I[g.route.id]&&(!t||void 0===t[g.route.id]);if(g.route.lazy||C){i=!0,o=c>=0?o.slice(0,c+1):[o[0]];break}}}return o.reduceRight(((g,C,l)=>{let n,A=!1,s=null,d=null;var r;e&&(n=a&&C.route.id?a[C.route.id]:void 0,s=C.route.errorElement||Cg,i&&(c<0&&0===l?(r="route-fallback",!1||dg[r]||(dg[r]=!0),A=!0,d=null):c===l&&(A=!0,d=C.route.hydrateFallbackElement||null)));let u=I.concat(o.slice(0,l+1)),b=()=>{let I;return I=n?s:A?d:C.route.Component?t.createElement(C.route.Component,null):C.route.element?C.route.element:g,t.createElement(ng,{match:C,routeContext:{outlet:g,matches:u,isDataRoute:null!=e},children:I})};return e&&(C.route.ErrorBoundary||C.route.errorElement||0===l)?t.createElement(lg,{location:e.location,revalidation:e.revalidation,component:s,error:n,children:b(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):b()}),null)}var ag=function(g){return g.UseBlocker="useBlocker",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g}(ag||{}),ig=function(g){return g.UseBlocker="useBlocker",g.UseLoaderData="useLoaderData",g.UseActionData="useActionData",g.UseRouteError="useRouteError",g.UseNavigation="useNavigation",g.UseRouteLoaderData="useRouteLoaderData",g.UseMatches="useMatches",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g.UseRouteId="useRouteId",g}(ig||{});function Ag(g){let I=t.useContext(L);return I||A(!1),I}function cg(g){let I=t.useContext(D);return I||A(!1),I}function sg(g){let I=function(g){let I=t.useContext(P);return I||A(!1),I}(),e=I.matches[I.matches.length-1];return e.route.id||A(!1),e.route.id}const dg={};C.startTransition;function rg(g){let{to:I,replace:e,state:C,relative:l}=g;_()||A(!1);let{future:n,static:o}=t.useContext(T),{matches:a}=t.useContext(P),{pathname:i}=q(),c=gg(),s=K(I,N(a,n.v7_relativeSplatPath),i,"path"===l),d=JSON.stringify(s);return t.useEffect((()=>c(JSON.parse(d),{replace:e,state:C,relative:l})),[c,d,l,e,C]),null}function ug(g){A(!1)}function bg(g){let{basename:e="/",children:C=null,location:l,navigationType:n=I.Pop,navigator:o,static:a=!1,future:i}=g;_()&&A(!1);let c=e.replace(/^\/*/,"/"),s=t.useMemo((()=>({basename:c,navigator:o,static:a,future:Q({v7_relativeSplatPath:!1},i)})),[c,i,o,a]);"string"===typeof l&&(l=u(l));let{pathname:d="/",search:r="",hash:b="",state:m=null,key:h="default"}=l,Z=t.useMemo((()=>{let g=v(d,c);return null==g?null:{location:{pathname:g,search:r,hash:b,state:m,key:h},navigationType:n}}),[c,d,r,b,m,h,n]);return null==Z?null:t.createElement(T.Provider,{value:s},t.createElement(j.Provider,{children:C,value:Z}))}function mg(g){let{children:I,location:e}=g;return eg(hg(I),e)}new Promise((()=>{}));t.Component;function hg(g,I){void 0===I&&(I=[]);let e=[];return t.Children.forEach(g,((g,C)=>{if(!t.isValidElement(g))return;let l=[...I,C];if(g.type===t.Fragment)return void e.push.apply(e,hg(g.props.children,l));g.type!==ug&&A(!1),g.props.index&&g.props.children&&A(!1);let n={id:g.props.id||l.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:null!=g.props.ErrorBoundary||null!=g.props.errorElement,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(n.children=hg(g.props.children,l)),e.push(n)})),e}function Zg(){return Zg=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(g[t]=e[t])}return g},Zg.apply(this,arguments)}function Gg(g,I){if(null==g)return{};var e,t,C={},l=Object.keys(g);for(t=0;t<l.length;t++)e=l[t],I.indexOf(e)>=0||(C[e]=g[e]);return C}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const pg=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],Bg=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"];try{window.__reactRouterVersion="6"}catch(xG){}const yg=t.createContext({isTransitioning:!1});new Map;const Wg=C.startTransition;o.flushSync,C.useId;function Vg(g){let{basename:I,children:e,future:C,window:l}=g,n=t.useRef();var o;null==n.current&&(n.current=(void 0===(o={window:l,v5Compat:!0})&&(o={}),b((function(g,I){let{pathname:e,search:t,hash:C}=g.location;return d("",{pathname:e,search:t,hash:C},I.state&&I.state.usr||null,I.state&&I.state.key||"default")}),(function(g,I){return"string"===typeof I?I:r(I)}),null,o)));let a=n.current,[i,A]=t.useState({action:a.action,location:a.location}),{v7_startTransition:c}=C||{},s=t.useCallback((g=>{c&&Wg?Wg((()=>A(g))):A(g)}),[A,c]);return t.useLayoutEffect((()=>a.listen(s)),[a,s]),t.createElement(bg,{basename:I,children:e,location:i.location,navigationType:i.action,navigator:a,future:C})}const Sg="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Rg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xg=t.forwardRef((function(g,I){let e,{onClick:C,relative:l,reloadDocument:n,replace:o,state:a,target:i,to:c,preventScrollReset:s,unstable_viewTransition:d}=g,u=Gg(g,pg),{basename:b}=t.useContext(T),m=!1;if("string"===typeof c&&Rg.test(c)&&(e=c,Sg))try{let g=new URL(window.location.href),I=c.startsWith("//")?new URL(g.protocol+c):new URL(c),e=v(I.pathname,b);I.origin===g.origin&&null!=e?c=e+I.search+I.hash:m=!0}catch(xG){}let h=function(g,I){let{relative:e}=void 0===I?{}:I;_()||A(!1);let{basename:C,navigator:l}=t.useContext(T),{hash:n,pathname:o,search:a}=Ig(g,{relative:e}),i=o;return"/"!==C&&(i="/"===o?C:w([C,o])),l.createHref({pathname:i,search:a,hash:n})}(c,{relative:l}),Z=function(g,I){let{target:e,replace:C,state:l,preventScrollReset:n,relative:o,unstable_viewTransition:a}=void 0===I?{}:I,i=gg(),A=q(),c=Ig(g,{relative:o});return t.useCallback((I=>{if(function(g,I){return 0===g.button&&(!I||"_self"===I)&&!function(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}(g)}(I,e)){I.preventDefault();let e=void 0!==C?C:r(A)===r(c);i(g,{replace:e,state:l,preventScrollReset:n,relative:o,unstable_viewTransition:a})}}),[A,i,c,C,l,e,g,n,o,a])}(c,{replace:o,state:a,target:i,preventScrollReset:s,relative:l,unstable_viewTransition:d});return t.createElement("a",Zg({},u,{href:e||h,onClick:m||n?C:function(g){C&&C(g),g.defaultPrevented||Z(g)},ref:I,target:i}))}));const Jg=t.forwardRef((function(g,I){let{"aria-current":e="page",caseSensitive:C=!1,className:l="",end:n=!1,style:o,to:a,unstable_viewTransition:i,children:c}=g,s=Gg(g,Bg),d=Ig(a,{relative:s.relative}),r=q(),u=t.useContext(D),{navigator:b,basename:m}=t.useContext(T),h=null!=u&&function(g,I){void 0===I&&(I={});let e=t.useContext(yg);null==e&&A(!1);let{basename:C}=vg(kg.useViewTransitionState),l=Ig(g,{relative:I.relative});if(!e.isTransitioning)return!1;let n=v(e.currentLocation.pathname,C)||e.currentLocation.pathname,o=v(e.nextLocation.pathname,C)||e.nextLocation.pathname;return null!=k(l.pathname,o)||null!=k(l.pathname,n)}(d)&&!0===i,Z=b.encodeLocation?b.encodeLocation(d).pathname:d.pathname,G=r.pathname,p=u&&u.navigation&&u.navigation.location?u.navigation.location.pathname:null;C||(G=G.toLowerCase(),p=p?p.toLowerCase():null,Z=Z.toLowerCase()),p&&m&&(p=v(p,m)||p);const B="/"!==Z&&Z.endsWith("/")?Z.length-1:Z.length;let y,W=G===Z||!n&&G.startsWith(Z)&&"/"===G.charAt(B),V=null!=p&&(p===Z||!n&&p.startsWith(Z)&&"/"===p.charAt(Z.length)),S={isActive:W,isPending:V,isTransitioning:h},R=W?e:void 0;y="function"===typeof l?l(S):[l,W?"active":null,V?"pending":null,h?"transitioning":null].filter(Boolean).join(" ");let X="function"===typeof o?o(S):o;return t.createElement(Xg,Zg({},s,{"aria-current":R,className:y,ref:I,style:X,to:a,unstable_viewTransition:i}),"function"===typeof c?c(S):c)}));var kg,fg;function vg(g){let I=t.useContext(L);return I||A(!1),I}(function(g){g.UseScrollRestoration="useScrollRestoration",g.UseSubmit="useSubmit",g.UseSubmitFetcher="useSubmitFetcher",g.UseFetcher="useFetcher",g.useViewTransitionState="useViewTransitionState"})(kg||(kg={})),function(g){g.UseFetcher="useFetcher",g.UseFetchers="useFetchers",g.UseScrollRestoration="useScrollRestoration"}(fg||(fg={}));var Yg=e(579);const Hg=(0,t.createContext)();function Ng(g){let{children:I}=g;const[e,C]=(0,t.useState)(null);(0,t.useEffect)((()=>{const g=JSON.parse(localStorage.getItem("user"));C(g)}),[]);const l=()=>{localStorage.removeItem("user"),C(null)},n={user:e,getUser:()=>JSON.parse(localStorage.getItem("user")),userIsAuthenticated:()=>{let g=localStorage.getItem("user");return!!g&&(g=JSON.parse(g),!(Date.now()>1e3*g.data.exp)||(l(),!1))},userLogin:g=>{g.data.username=g.data.preferred_username||g.data.username,localStorage.setItem("user",JSON.stringify(g)),C(g)},userLogout:l};return(0,Yg.jsx)(Hg.Provider,{value:n,children:I})}function Kg(){return(0,t.useContext)(Hg)}const wg=function(g){let{children:I}=g;const{userIsAuthenticated:e}=Kg();return e()?I:(0,Yg.jsx)(rg,{to:"/login"})};function Fg(){return Fg=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(g[t]=e[t])}return g},Fg.apply(this,arguments)}function xg(g,I){return xg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,I){return g.__proto__=I,g},xg(g,I)}function zg(g,I){g.prototype=Object.create(I.prototype),g.prototype.constructor=g,xg(g,I)}const Mg=function(g,I){for(var e=-1,t=null==g?0:g.length,C=Array(t);++e<t;)C[e]=I(g[e],e,g);return C};const Eg=function(){this.__data__=[],this.size=0};const Ug=function(g,I){return g===I||g!==g&&I!==I};const Qg=function(g,I){for(var e=g.length;e--;)if(Ug(g[e][0],I))return e;return-1};var Lg=Array.prototype.splice;const Dg=function(g){var I=this.__data__,e=Qg(I,g);return!(e<0)&&(e==I.length-1?I.pop():Lg.call(I,e,1),--this.size,!0)};const Tg=function(g){var I=this.__data__,e=Qg(I,g);return e<0?void 0:I[e][1]};const jg=function(g){return Qg(this.__data__,g)>-1};const Pg=function(g,I){var e=this.__data__,t=Qg(e,g);return t<0?(++this.size,e.push([g,I])):e[t][1]=I,this};function Og(g){var I=-1,e=null==g?0:g.length;for(this.clear();++I<e;){var t=g[I];this.set(t[0],t[1])}}Og.prototype.clear=Eg,Og.prototype.delete=Dg,Og.prototype.get=Tg,Og.prototype.has=jg,Og.prototype.set=Pg;const _g=Og;const qg=function(){this.__data__=new _g,this.size=0};const $g=function(g){var I=this.__data__,e=I.delete(g);return this.size=I.size,e};const gI=function(g){return this.__data__.get(g)};const II=function(g){return this.__data__.has(g)};const eI="object"==typeof global&&global&&global.Object===Object&&global;var tI="object"==typeof self&&self&&self.Object===Object&&self;const CI=eI||tI||Function("return this")();const lI=CI.Symbol;var nI=Object.prototype,oI=nI.hasOwnProperty,aI=nI.toString,iI=lI?lI.toStringTag:void 0;const AI=function(g){var I=oI.call(g,iI),e=g[iI];try{g[iI]=void 0;var t=!0}catch(xG){}var C=aI.call(g);return t&&(I?g[iI]=e:delete g[iI]),C};var cI=Object.prototype.toString;const sI=function(g){return cI.call(g)};var dI=lI?lI.toStringTag:void 0;const rI=function(g){return null==g?void 0===g?"[object Undefined]":"[object Null]":dI&&dI in Object(g)?AI(g):sI(g)};const uI=function(g){var I=typeof g;return null!=g&&("object"==I||"function"==I)};const bI=function(g){if(!uI(g))return!1;var I=rI(g);return"[object Function]"==I||"[object GeneratorFunction]"==I||"[object AsyncFunction]"==I||"[object Proxy]"==I};const mI=CI["__core-js_shared__"];var hI=function(){var g=/[^.]+$/.exec(mI&&mI.keys&&mI.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}();const ZI=function(g){return!!hI&&hI in g};var GI=Function.prototype.toString;const pI=function(g){if(null!=g){try{return GI.call(g)}catch(xG){}try{return g+""}catch(xG){}}return""};var BI=/^\[object .+?Constructor\]$/,yI=Function.prototype,WI=Object.prototype,VI=yI.toString,SI=WI.hasOwnProperty,RI=RegExp("^"+VI.call(SI).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const XI=function(g){return!(!uI(g)||ZI(g))&&(bI(g)?RI:BI).test(pI(g))};const JI=function(g,I){return null==g?void 0:g[I]};const kI=function(g,I){var e=JI(g,I);return XI(e)?e:void 0};const fI=kI(CI,"Map");const vI=kI(Object,"create");const YI=function(){this.__data__=vI?vI(null):{},this.size=0};const HI=function(g){var I=this.has(g)&&delete this.__data__[g];return this.size-=I?1:0,I};var NI=Object.prototype.hasOwnProperty;const KI=function(g){var I=this.__data__;if(vI){var e=I[g];return"__lodash_hash_undefined__"===e?void 0:e}return NI.call(I,g)?I[g]:void 0};var wI=Object.prototype.hasOwnProperty;const FI=function(g){var I=this.__data__;return vI?void 0!==I[g]:wI.call(I,g)};const xI=function(g,I){var e=this.__data__;return this.size+=this.has(g)?0:1,e[g]=vI&&void 0===I?"__lodash_hash_undefined__":I,this};function zI(g){var I=-1,e=null==g?0:g.length;for(this.clear();++I<e;){var t=g[I];this.set(t[0],t[1])}}zI.prototype.clear=YI,zI.prototype.delete=HI,zI.prototype.get=KI,zI.prototype.has=FI,zI.prototype.set=xI;const MI=zI;const EI=function(){this.size=0,this.__data__={hash:new MI,map:new(fI||_g),string:new MI}};const UI=function(g){var I=typeof g;return"string"==I||"number"==I||"symbol"==I||"boolean"==I?"__proto__"!==g:null===g};const QI=function(g,I){var e=g.__data__;return UI(I)?e["string"==typeof I?"string":"hash"]:e.map};const LI=function(g){var I=QI(this,g).delete(g);return this.size-=I?1:0,I};const DI=function(g){return QI(this,g).get(g)};const TI=function(g){return QI(this,g).has(g)};const jI=function(g,I){var e=QI(this,g),t=e.size;return e.set(g,I),this.size+=e.size==t?0:1,this};function PI(g){var I=-1,e=null==g?0:g.length;for(this.clear();++I<e;){var t=g[I];this.set(t[0],t[1])}}PI.prototype.clear=EI,PI.prototype.delete=LI,PI.prototype.get=DI,PI.prototype.has=TI,PI.prototype.set=jI;const OI=PI;const _I=function(g,I){var e=this.__data__;if(e instanceof _g){var t=e.__data__;if(!fI||t.length<199)return t.push([g,I]),this.size=++e.size,this;e=this.__data__=new OI(t)}return e.set(g,I),this.size=e.size,this};function qI(g){var I=this.__data__=new _g(g);this.size=I.size}qI.prototype.clear=qg,qI.prototype.delete=$g,qI.prototype.get=gI,qI.prototype.has=II,qI.prototype.set=_I;const $I=qI;const ge=function(g){return this.__data__.set(g,"__lodash_hash_undefined__"),this};const Ie=function(g){return this.__data__.has(g)};function ee(g){var I=-1,e=null==g?0:g.length;for(this.__data__=new OI;++I<e;)this.add(g[I])}ee.prototype.add=ee.prototype.push=ge,ee.prototype.has=Ie;const te=ee;const Ce=function(g,I){for(var e=-1,t=null==g?0:g.length;++e<t;)if(I(g[e],e,g))return!0;return!1};const le=function(g,I){return g.has(I)};const ne=function(g,I,e,t,C,l){var n=1&e,o=g.length,a=I.length;if(o!=a&&!(n&&a>o))return!1;var i=l.get(g),A=l.get(I);if(i&&A)return i==I&&A==g;var c=-1,s=!0,d=2&e?new te:void 0;for(l.set(g,I),l.set(I,g);++c<o;){var r=g[c],u=I[c];if(t)var b=n?t(u,r,c,I,g,l):t(r,u,c,g,I,l);if(void 0!==b){if(b)continue;s=!1;break}if(d){if(!Ce(I,(function(g,I){if(!le(d,I)&&(r===g||C(r,g,e,t,l)))return d.push(I)}))){s=!1;break}}else if(r!==u&&!C(r,u,e,t,l)){s=!1;break}}return l.delete(g),l.delete(I),s};const oe=CI.Uint8Array;const ae=function(g){var I=-1,e=Array(g.size);return g.forEach((function(g,t){e[++I]=[t,g]})),e};const ie=function(g){var I=-1,e=Array(g.size);return g.forEach((function(g){e[++I]=g})),e};var Ae=lI?lI.prototype:void 0,ce=Ae?Ae.valueOf:void 0;const se=function(g,I,e,t,C,l,n){switch(e){case"[object DataView]":if(g.byteLength!=I.byteLength||g.byteOffset!=I.byteOffset)return!1;g=g.buffer,I=I.buffer;case"[object ArrayBuffer]":return!(g.byteLength!=I.byteLength||!l(new oe(g),new oe(I)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ug(+g,+I);case"[object Error]":return g.name==I.name&&g.message==I.message;case"[object RegExp]":case"[object String]":return g==I+"";case"[object Map]":var o=ae;case"[object Set]":var a=1&t;if(o||(o=ie),g.size!=I.size&&!a)return!1;var i=n.get(g);if(i)return i==I;t|=2,n.set(g,I);var A=ne(o(g),o(I),t,C,l,n);return n.delete(g),A;case"[object Symbol]":if(ce)return ce.call(g)==ce.call(I)}return!1};const de=function(g,I){for(var e=-1,t=I.length,C=g.length;++e<t;)g[C+e]=I[e];return g};const re=Array.isArray;const ue=function(g,I,e){var t=I(g);return re(g)?t:de(t,e(g))};const be=function(g,I){for(var e=-1,t=null==g?0:g.length,C=0,l=[];++e<t;){var n=g[e];I(n,e,g)&&(l[C++]=n)}return l};const me=function(){return[]};var he=Object.prototype.propertyIsEnumerable,Ze=Object.getOwnPropertySymbols;const Ge=Ze?function(g){return null==g?[]:(g=Object(g),be(Ze(g),(function(I){return he.call(g,I)})))}:me;const pe=function(g,I){for(var e=-1,t=Array(g);++e<g;)t[e]=I(e);return t};const Be=function(g){return null!=g&&"object"==typeof g};const ye=function(g){return Be(g)&&"[object Arguments]"==rI(g)};var We=Object.prototype,Ve=We.hasOwnProperty,Se=We.propertyIsEnumerable;const Re=ye(function(){return arguments}())?ye:function(g){return Be(g)&&Ve.call(g,"callee")&&!Se.call(g,"callee")};const Xe=function(){return!1};var Je="object"==typeof exports&&exports&&!exports.nodeType&&exports,ke=Je&&"object"==typeof module&&module&&!module.nodeType&&module,fe=ke&&ke.exports===Je?CI.Buffer:void 0;const ve=(fe?fe.isBuffer:void 0)||Xe;var Ye=/^(?:0|[1-9]\d*)$/;const He=function(g,I){var e=typeof g;return!!(I=null==I?9007199254740991:I)&&("number"==e||"symbol"!=e&&Ye.test(g))&&g>-1&&g%1==0&&g<I};const Ne=function(g){return"number"==typeof g&&g>-1&&g%1==0&&g<=9007199254740991};var Ke={};Ke["[object Float32Array]"]=Ke["[object Float64Array]"]=Ke["[object Int8Array]"]=Ke["[object Int16Array]"]=Ke["[object Int32Array]"]=Ke["[object Uint8Array]"]=Ke["[object Uint8ClampedArray]"]=Ke["[object Uint16Array]"]=Ke["[object Uint32Array]"]=!0,Ke["[object Arguments]"]=Ke["[object Array]"]=Ke["[object ArrayBuffer]"]=Ke["[object Boolean]"]=Ke["[object DataView]"]=Ke["[object Date]"]=Ke["[object Error]"]=Ke["[object Function]"]=Ke["[object Map]"]=Ke["[object Number]"]=Ke["[object Object]"]=Ke["[object RegExp]"]=Ke["[object Set]"]=Ke["[object String]"]=Ke["[object WeakMap]"]=!1;const we=function(g){return Be(g)&&Ne(g.length)&&!!Ke[rI(g)]};const Fe=function(g){return function(I){return g(I)}};var xe="object"==typeof exports&&exports&&!exports.nodeType&&exports,ze=xe&&"object"==typeof module&&module&&!module.nodeType&&module,Me=ze&&ze.exports===xe&&eI.process,Ee=function(){try{var g=ze&&ze.require&&ze.require("util").types;return g||Me&&Me.binding&&Me.binding("util")}catch(xG){}}();var Ue=Ee&&Ee.isTypedArray;const Qe=Ue?Fe(Ue):we;var Le=Object.prototype.hasOwnProperty;const De=function(g,I){var e=re(g),t=!e&&Re(g),C=!e&&!t&&ve(g),l=!e&&!t&&!C&&Qe(g),n=e||t||C||l,o=n?pe(g.length,String):[],a=o.length;for(var i in g)!I&&!Le.call(g,i)||n&&("length"==i||C&&("offset"==i||"parent"==i)||l&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||He(i,a))||o.push(i);return o};var Te=Object.prototype;const je=function(g){var I=g&&g.constructor;return g===("function"==typeof I&&I.prototype||Te)};const Pe=function(g,I){return function(e){return g(I(e))}};const Oe=Pe(Object.keys,Object);var _e=Object.prototype.hasOwnProperty;const qe=function(g){if(!je(g))return Oe(g);var I=[];for(var e in Object(g))_e.call(g,e)&&"constructor"!=e&&I.push(e);return I};const $e=function(g){return null!=g&&Ne(g.length)&&!bI(g)};const gt=function(g){return $e(g)?De(g):qe(g)};const It=function(g){return ue(g,gt,Ge)};var et=Object.prototype.hasOwnProperty;const tt=function(g,I,e,t,C,l){var n=1&e,o=It(g),a=o.length;if(a!=It(I).length&&!n)return!1;for(var i=a;i--;){var A=o[i];if(!(n?A in I:et.call(I,A)))return!1}var c=l.get(g),s=l.get(I);if(c&&s)return c==I&&s==g;var d=!0;l.set(g,I),l.set(I,g);for(var r=n;++i<a;){var u=g[A=o[i]],b=I[A];if(t)var m=n?t(b,u,A,I,g,l):t(u,b,A,g,I,l);if(!(void 0===m?u===b||C(u,b,e,t,l):m)){d=!1;break}r||(r="constructor"==A)}if(d&&!r){var h=g.constructor,Z=I.constructor;h==Z||!("constructor"in g)||!("constructor"in I)||"function"==typeof h&&h instanceof h&&"function"==typeof Z&&Z instanceof Z||(d=!1)}return l.delete(g),l.delete(I),d};const Ct=kI(CI,"DataView");const lt=kI(CI,"Promise");const nt=kI(CI,"Set");const ot=kI(CI,"WeakMap");var at="[object Map]",it="[object Promise]",At="[object Set]",ct="[object WeakMap]",st="[object DataView]",dt=pI(Ct),rt=pI(fI),ut=pI(lt),bt=pI(nt),mt=pI(ot),ht=rI;(Ct&&ht(new Ct(new ArrayBuffer(1)))!=st||fI&&ht(new fI)!=at||lt&&ht(lt.resolve())!=it||nt&&ht(new nt)!=At||ot&&ht(new ot)!=ct)&&(ht=function(g){var I=rI(g),e="[object Object]"==I?g.constructor:void 0,t=e?pI(e):"";if(t)switch(t){case dt:return st;case rt:return at;case ut:return it;case bt:return At;case mt:return ct}return I});const Zt=ht;var Gt="[object Arguments]",pt="[object Array]",Bt="[object Object]",yt=Object.prototype.hasOwnProperty;const Wt=function(g,I,e,t,C,l){var n=re(g),o=re(I),a=n?pt:Zt(g),i=o?pt:Zt(I),A=(a=a==Gt?Bt:a)==Bt,c=(i=i==Gt?Bt:i)==Bt,s=a==i;if(s&&ve(g)){if(!ve(I))return!1;n=!0,A=!1}if(s&&!A)return l||(l=new $I),n||Qe(g)?ne(g,I,e,t,C,l):se(g,I,a,e,t,C,l);if(!(1&e)){var d=A&&yt.call(g,"__wrapped__"),r=c&&yt.call(I,"__wrapped__");if(d||r){var u=d?g.value():g,b=r?I.value():I;return l||(l=new $I),C(u,b,e,t,l)}}return!!s&&(l||(l=new $I),tt(g,I,e,t,C,l))};const Vt=function g(I,e,t,C,l){return I===e||(null==I||null==e||!Be(I)&&!Be(e)?I!==I&&e!==e:Wt(I,e,t,C,g,l))};const St=function(g,I,e,t){var C=e.length,l=C,n=!t;if(null==g)return!l;for(g=Object(g);C--;){var o=e[C];if(n&&o[2]?o[1]!==g[o[0]]:!(o[0]in g))return!1}for(;++C<l;){var a=(o=e[C])[0],i=g[a],A=o[1];if(n&&o[2]){if(void 0===i&&!(a in g))return!1}else{var c=new $I;if(t)var s=t(i,A,a,g,I,c);if(!(void 0===s?Vt(A,i,3,t,c):s))return!1}}return!0};const Rt=function(g){return g===g&&!uI(g)};const Xt=function(g){for(var I=gt(g),e=I.length;e--;){var t=I[e],C=g[t];I[e]=[t,C,Rt(C)]}return I};const Jt=function(g,I){return function(e){return null!=e&&(e[g]===I&&(void 0!==I||g in Object(e)))}};const kt=function(g){var I=Xt(g);return 1==I.length&&I[0][2]?Jt(I[0][0],I[0][1]):function(e){return e===g||St(e,g,I)}};const ft=function(g){return"symbol"==typeof g||Be(g)&&"[object Symbol]"==rI(g)};var vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yt=/^\w*$/;const Ht=function(g,I){if(re(g))return!1;var e=typeof g;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=g&&!ft(g))||(Yt.test(g)||!vt.test(g)||null!=I&&g in Object(I))};function Nt(g,I){if("function"!=typeof g||null!=I&&"function"!=typeof I)throw new TypeError("Expected a function");var e=function(){var t=arguments,C=I?I.apply(this,t):t[0],l=e.cache;if(l.has(C))return l.get(C);var n=g.apply(this,t);return e.cache=l.set(C,n)||l,n};return e.cache=new(Nt.Cache||OI),e}Nt.Cache=OI;const Kt=Nt;const wt=function(g){var I=Kt(g,(function(g){return 500===e.size&&e.clear(),g})),e=I.cache;return I};var Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/\\(\\)?/g;const zt=wt((function(g){var I=[];return 46===g.charCodeAt(0)&&I.push(""),g.replace(Ft,(function(g,e,t,C){I.push(t?C.replace(xt,"$1"):e||g)})),I}));var Mt=lI?lI.prototype:void 0,Et=Mt?Mt.toString:void 0;const Ut=function g(I){if("string"==typeof I)return I;if(re(I))return Mg(I,g)+"";if(ft(I))return Et?Et.call(I):"";var e=I+"";return"0"==e&&1/I==-1/0?"-0":e};const Qt=function(g){return null==g?"":Ut(g)};const Lt=function(g,I){return re(g)?g:Ht(g,I)?[g]:zt(Qt(g))};const Dt=function(g){if("string"==typeof g||ft(g))return g;var I=g+"";return"0"==I&&1/g==-1/0?"-0":I};const Tt=function(g,I){for(var e=0,t=(I=Lt(I,g)).length;null!=g&&e<t;)g=g[Dt(I[e++])];return e&&e==t?g:void 0};const jt=function(g,I,e){var t=null==g?void 0:Tt(g,I);return void 0===t?e:t};const Pt=function(g,I){return null!=g&&I in Object(g)};const Ot=function(g,I,e){for(var t=-1,C=(I=Lt(I,g)).length,l=!1;++t<C;){var n=Dt(I[t]);if(!(l=null!=g&&e(g,n)))break;g=g[n]}return l||++t!=C?l:!!(C=null==g?0:g.length)&&Ne(C)&&He(n,C)&&(re(g)||Re(g))};const _t=function(g,I){return null!=g&&Ot(g,I,Pt)};const qt=function(g,I){return Ht(g)&&Rt(I)?Jt(Dt(g),I):function(e){var t=jt(e,g);return void 0===t&&t===I?_t(e,g):Vt(I,t,3)}};const $t=function(g){return g};const gC=function(g){return function(I){return null==I?void 0:I[g]}};const IC=function(g){return function(I){return Tt(I,g)}};const eC=function(g){return Ht(g)?gC(Dt(g)):IC(g)};const tC=function(g){return"function"==typeof g?g:null==g?$t:"object"==typeof g?re(g)?qt(g[0],g[1]):kt(g):eC(g)};const CC=function(g){return function(I,e,t){for(var C=-1,l=Object(I),n=t(I),o=n.length;o--;){var a=n[g?o:++C];if(!1===e(l[a],a,l))break}return I}};const lC=CC();const nC=function(g,I){return function(e,t){if(null==e)return e;if(!$e(e))return g(e,t);for(var C=e.length,l=I?C:-1,n=Object(e);(I?l--:++l<C)&&!1!==t(n[l],l,n););return e}};const oC=nC((function(g,I){return g&&lC(g,I,gt)}));const aC=function(g,I){var e=-1,t=$e(g)?Array(g.length):[];return oC(g,(function(g,C,l){t[++e]=I(g,C,l)})),t};const iC=function(g,I){return(re(g)?Mg:aC)(g,tC(I,3))};const AC=function(g,I,e){switch(e.length){case 0:return g.call(I);case 1:return g.call(I,e[0]);case 2:return g.call(I,e[0],e[1]);case 3:return g.call(I,e[0],e[1],e[2])}return g.apply(I,e)};const cC=function(g){var I=null==g?0:g.length;return I?g[I-1]:void 0};const sC=function(g,I,e){var t=-1,C=g.length;I<0&&(I=-I>C?0:C+I),(e=e>C?C:e)<0&&(e+=C),C=I>e?0:e-I>>>0,I>>>=0;for(var l=Array(C);++t<C;)l[t]=g[t+I];return l};const dC=function(g,I){return I.length<2?g:Tt(g,sC(I,0,-1))};const rC=function(g,I,e){I=Lt(I,g);var t=null==(g=dC(g,I))?g:g[Dt(cC(I))];return null==t?void 0:AC(t,g,e)};var uC=Math.max;const bC=function(g,I,e){return I=uC(void 0===I?g.length-1:I,0),function(){for(var t=arguments,C=-1,l=uC(t.length-I,0),n=Array(l);++C<l;)n[C]=t[I+C];C=-1;for(var o=Array(I+1);++C<I;)o[C]=t[C];return o[I]=e(n),AC(g,this,o)}};const mC=function(g){return function(){return g}};const hC=function(){try{var g=kI(Object,"defineProperty");return g({},"",{}),g}catch(xG){}}();const ZC=hC?function(g,I){return hC(g,"toString",{configurable:!0,enumerable:!1,value:mC(I),writable:!0})}:$t;var GC=Date.now;const pC=function(g){var I=0,e=0;return function(){var t=GC(),C=16-(t-e);if(e=t,C>0){if(++I>=800)return arguments[0]}else I=0;return g.apply(void 0,arguments)}}(ZC);const BC=function(g,I){return pC(bC(g,I,$t),g+"")};const yC=BC(rC);function WC(g){var I,e,t="";if("string"==typeof g||"number"==typeof g)t+=g;else if("object"==typeof g)if(Array.isArray(g))for(I=0;I<g.length;I++)g[I]&&(e=WC(g[I]))&&(t&&(t+=" "),t+=e);else for(I in g)g[I]&&(t&&(t+=" "),t+=I);return t}const VC=function(){for(var g,I,e=0,t="";e<arguments.length;)(g=arguments[e++])&&(I=WC(g))&&(t&&(t+=" "),t+=I);return t};var SC={1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine",10:"ten",11:"eleven",12:"twelve",13:"thirteen",14:"fourteen",15:"fifteen",16:"sixteen"};function RC(g){var I=typeof g;return"string"===I||"number"===I?SC[g]||g:""}var XC=function(g,I){return g&&I},JC=function(g,I){return g&&!0!==g&&g+" "+I},kC=function(g,I){return g&&(!0===g?I:g+" "+I)},fC=function(g,I){return g&&!0!==g?g.replace("large screen","large-screen").replace(/ vertically/g,"-vertically").split(" ").map((function(g){return g.replace("-"," ")+" "+I})).join(" "):null},vC=function(g){return"justified"===g?"justified":JC(g,"aligned")},YC=function(g){return JC(g,"aligned")},HC=function(g,I,e){if(void 0===I&&(I=""),void 0===e&&(e=!1),e&&"equal"===g)return"equal width";var t=typeof g;return"string"!==t&&"number"!==t||!I?RC(g):RC(g)+" "+I};const NC=function(g,I){var e=g.handledProps,t=void 0===e?[]:e;return Object.keys(I).reduce((function(g,e){return"childKey"===e||-1===t.indexOf(e)&&(g[e]=I[e]),g}),{})};const KC=function(g,I,e){var t=g.defaultProps,C=void 0===t?{}:t;if(I.as&&I.as!==C.as)return I.as;if(e){var l=e();if(l)return l}return I.href?"a":C.as||"div"};const wC=function(g,I){var e;return oC(g,(function(g,t,C){return!(e=I(g,t,C))})),!!e};const FC=function(g,I,e){if(!uI(e))return!1;var t=typeof I;return!!("number"==t?$e(e)&&He(I,e.length):"string"==t&&I in e)&&Ug(e[I],g)};const xC=function(g,I,e){var t=re(g)?Ce:wC;return e&&FC(g,I,e)&&(I=void 0),t(g,tC(I,3))};var zC=function(g){return null===g||void 0===g||Array.isArray(g)&&0===g.length};const MC=function(g){return void 0===g};var EC=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];var l=(I=g.call.apply(g,[this].concat(t))||this).constructor,n=l.autoControlledProps,o=l.getAutoControlledStateFromProps,a=yC(function(g){if(void 0===g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}(I),"getInitialAutoControlledState",I.props)||{},i=n.reduce((function(g,e){return g[e]=function(g,I,e,t){void 0===t&&(t=!1);var C,l=I[g];if(void 0!==l)return l;if(t){var n=I[(C=g,"default"+(C[0].toUpperCase()+C.slice(1)))];if(void 0!==n)return n;if(e){var o=e[g];if(void 0!==o)return o}}return"checked"!==g&&("value"===g?I.multiple?[]:"":void 0)}(e,I.props,a,!0),g}),{});return I.state=Fg({},a,i,{autoControlledProps:n,getAutoControlledStateFromProps:o}),I}return zg(I,g),I.getDerivedStateFromProps=function(g,I){var e=I.autoControlledProps,t=I.getAutoControlledStateFromProps,C=e.reduce((function(I,e){return!MC(g[e])&&(I[e]=g[e]),I}),{});if(t){var l=t(g,Fg({},I,C),I);return Fg({},C,l)}return C},I.getAutoControlledStateFromProps=function(){return null},I}(t.Component);const UC=function(g,I,e,t){for(var C=g.length,l=e+(t?1:-1);t?l--:++l<C;)if(I(g[l],l,g))return l;return-1};const QC=function(g){return g!==g};const LC=function(g,I,e){for(var t=e-1,C=g.length;++t<C;)if(g[t]===I)return t;return-1};const DC=function(g,I,e){return I===I?LC(g,I,e):UC(g,QC,e)};const TC=function(g,I){return!!(null==g?0:g.length)&&DC(g,I,0)>-1};const jC=function(g,I,e){for(var t=-1,C=null==g?0:g.length;++t<C;)if(e(I,g[t]))return!0;return!1};const PC=function(){};var OC=nt&&1/ie(new nt([,-0]))[1]==1/0?function(g){return new nt(g)}:PC;const _C=OC;const qC=function(g,I,e){var t=-1,C=TC,l=g.length,n=!0,o=[],a=o;if(e)n=!1,C=jC;else if(l>=200){var i=I?null:_C(g);if(i)return ie(i);n=!1,C=le,a=new te}else a=I?[]:o;g:for(;++t<l;){var A=g[t],c=I?I(A):A;if(A=e||0!==A?A:0,n&&c===c){for(var s=a.length;s--;)if(a[s]===c)continue g;I&&a.push(c),o.push(A)}else C(a,c,e)||(a!==o&&a.push(c),o.push(A))}return o};const $C=function(g){return g&&g.length?qC(g):[]};const gl=Pe(Object.getPrototypeOf,Object);var Il=Function.prototype,el=Object.prototype,tl=Il.toString,Cl=el.hasOwnProperty,ll=tl.call(Object);const nl=function(g){if(!Be(g)||"[object Object]"!=rI(g))return!1;var I=gl(g);if(null===I)return!0;var e=Cl.call(I,"constructor")&&I.constructor;return"function"==typeof e&&e instanceof e&&tl.call(e)==ll};const ol=function(g){return"number"==typeof g||Be(g)&&"[object Number]"==rI(g)};const al=function(g){return"string"==typeof g||!re(g)&&Be(g)&&"[object String]"==rI(g)};const il=function(g){return!0===g||!1===g||Be(g)&&"[object Boolean]"==rI(g)};const Al=function(g){return null==g};function cl(g,I,e,C){if(void 0===C&&(C={}),"function"!==typeof g&&"string"!==typeof g)throw new Error("createShorthand() Component must be a string or function.");if(Al(e)||il(e))return null;var l=al(e),n=ol(e),o=bI(e),a=t.isValidElement(e),i=nl(e),A=l||n||re(e);if(!o&&!a&&!i&&!A)return null;var c=C.defaultProps,s=void 0===c?{}:c,d=a&&e.props||i&&e||A&&I(e),r=C.overrideProps,u=void 0===r?{}:r;u=bI(u)?u(Fg({},s,d)):u;var b=Fg({},s,d,u);if(s.className||u.className||d.className){var m=VC(s.className,u.className,d.className);b.className=$C(m.split(" ")).join(" ")}if((s.style||u.style||d.style)&&(b.style=Fg({},s.style,d.style,u.style)),Al(b.key)){var h=b.childKey,Z=C.autoGenerateKey,G=void 0===Z||Z;Al(h)?G&&(l||n)&&(b.key=e):(b.key="function"===typeof h?h(b):h,delete b.childKey)}return a?t.cloneElement(e,b):"function"===typeof b.children?b.children(g,Fg({},b,{children:void 0})):A||i?t.createElement(g,b):o?e(g,b,b.children):void 0}function sl(g,I){if("function"!==typeof g&&"string"!==typeof g)throw new Error("createShorthandFactory() Component must be a string or function.");return function(e,t){return cl(g,I,e,t)}}var dl=sl("input",(function(g){return{type:g}})),rl=sl("label",(function(g){return{children:g}})),ul=sl("p",(function(g){return{children:g}}));function bl(g){var I=g.children,e=g.className,C=g.content,l=VC("header",e),n=NC(bl,g),o=KC(bl,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}bl.handledProps=["as","children","className","content"],bl.propTypes={};const ml=bl;const hl=function(g,I,e,t){var C=-1,l=null==g?0:g.length;for(t&&l&&(e=g[++C]);++C<l;)e=I(e,g[C],C,g);return e};const Zl=function(g){return function(I){return null==g?void 0:g[I]}}({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"});var Gl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,pl=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");const Bl=function(g){return(g=Qt(g))&&g.replace(Gl,Zl).replace(pl,"")};var yl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;const Wl=function(g){return g.match(yl)||[]};var Vl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;const Sl=function(g){return Vl.test(g)};var Rl="\\ud800-\\udfff",Xl="\\u2700-\\u27bf",Jl="a-z\\xdf-\\xf6\\xf8-\\xff",kl="A-Z\\xc0-\\xd6\\xd8-\\xde",fl="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vl="["+fl+"]",Yl="\\d+",Hl="["+Xl+"]",Nl="["+Jl+"]",Kl="[^"+Rl+fl+Yl+Xl+Jl+kl+"]",wl="(?:\\ud83c[\\udde6-\\uddff]){2}",Fl="[\\ud800-\\udbff][\\udc00-\\udfff]",xl="["+kl+"]",zl="(?:"+Nl+"|"+Kl+")",Ml="(?:"+xl+"|"+Kl+")",El="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ul="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Ql="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Ll="[\\ufe0e\\ufe0f]?",Dl=Ll+Ql+("(?:\\u200d(?:"+["[^"+Rl+"]",wl,Fl].join("|")+")"+Ll+Ql+")*"),Tl="(?:"+[Hl,wl,Fl].join("|")+")"+Dl,jl=RegExp([xl+"?"+Nl+"+"+El+"(?="+[vl,xl,"$"].join("|")+")",Ml+"+"+Ul+"(?="+[vl,xl+zl,"$"].join("|")+")",xl+"?"+zl+"+"+El,xl+"+"+Ul,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Yl,Tl].join("|"),"g");const Pl=function(g){return g.match(jl)||[]};const Ol=function(g,I,e){return g=Qt(g),void 0===(I=e?void 0:I)?Sl(g)?Pl(g):Wl(g):g.match(I)||[]};var _l=RegExp("['\u2019]","g");const ql=function(g){return function(I){return hl(Ol(Bl(I).replace(_l,"")),g,"")}};const $l=function(g,I,e){var t=g.length;return e=void 0===e?t:e,!I&&e>=t?g:sC(g,I,e)};var gn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");const In=function(g){return gn.test(g)};const en=function(g){return g.split("")};var tn="\\ud800-\\udfff",Cn="["+tn+"]",ln="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",nn="\\ud83c[\\udffb-\\udfff]",on="[^"+tn+"]",an="(?:\\ud83c[\\udde6-\\uddff]){2}",An="[\\ud800-\\udbff][\\udc00-\\udfff]",cn="(?:"+ln+"|"+nn+")"+"?",sn="[\\ufe0e\\ufe0f]?",dn=sn+cn+("(?:\\u200d(?:"+[on,an,An].join("|")+")"+sn+cn+")*"),rn="(?:"+[on+ln+"?",ln,an,An,Cn].join("|")+")",un=RegExp(nn+"(?="+nn+")|"+rn+dn,"g");const bn=function(g){return g.match(un)||[]};const mn=function(g){return In(g)?bn(g):en(g)};const hn=function(g){return function(I){I=Qt(I);var e=In(I)?mn(I):void 0,t=e?e[0]:I.charAt(0),C=e?$l(e,1).join(""):I.slice(1);return t[g]()+C}}("toUpperCase");var Zn=ql((function(g,I,e){return g+(e?" ":"")+hn(I)}));const Gn=Zn;function pn(g){var I=g.children,e=g.className,C=g.content,l=g.size,n=VC(l,"icons",e),o=NC(pn,g),a=KC(pn,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}pn.handledProps=["as","children","className","content","size"],pn.propTypes={},pn.defaultProps={as:"i"};const Bn=pn;var yn=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleClick=function(g){I.props.disabled?g.preventDefault():yC(I.props,"onClick",g,I.props)},I}zg(I,g);var e=I.prototype;return e.getIconAriaOptions=function(){var g={},I=this.props,e=I["aria-label"],t=I["aria-hidden"];return Al(e)?g["aria-hidden"]="true":g["aria-label"]=e,Al(t)||(g["aria-hidden"]=t),g},e.render=function(){var g=this.props,e=g.bordered,C=g.circular,l=g.className,n=g.color,o=g.corner,a=g.disabled,i=g.fitted,A=g.flipped,c=g.inverted,s=g.link,d=g.loading,r=g.name,u=g.rotated,b=g.size,m=VC(n,r,b,XC(e,"bordered"),XC(C,"circular"),XC(a,"disabled"),XC(i,"fitted"),XC(c,"inverted"),XC(s,"link"),XC(d,"loading"),kC(o,"corner"),JC(A,"flipped"),JC(u,"rotated"),"icon",l),h=NC(I,this.props),Z=KC(I,this.props),G=this.getIconAriaOptions();return t.createElement(Z,Fg({},h,G,{className:m,onClick:this.handleClick}))},I}(t.PureComponent);yn.handledProps=["aria-hidden","aria-label","as","bordered","circular","className","color","corner","disabled","fitted","flipped","inverted","link","loading","name","rotated","size"],yn.propTypes={},yn.defaultProps={as:"i"},yn.Group=Bn,yn.create=sl(yn,(function(g){return{name:g}}));const Wn=yn;var Vn=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleClick=function(g){I.props.disabled||yC(I.props,"onClick",g,I.props)},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.active,C=g.children,l=g.className,n=g.color,o=g.content,a=g.disabled,i=g.fitted,A=g.header,c=g.icon,s=g.link,d=g.name,r=g.onClick,u=g.position,b=VC(n,u,XC(e,"active"),XC(a,"disabled"),XC(!0===c||c&&!(d||o),"icon"),XC(A,"header"),XC(s,"link"),kC(i,"fitted"),"item",l),m=KC(I,this.props,(function(){if(r)return"a"})),h=NC(I,this.props);return zC(C)?t.createElement(m,Fg({},h,{className:b,onClick:this.handleClick}),Wn.create(c,{autoGenerateKey:!1}),zC(o)?Gn(d):o):t.createElement(m,Fg({},h,{className:b,onClick:this.handleClick}),C)},I}(t.Component);function Sn(g){var I=g.children,e=g.className,C=g.content,l=g.position,n=VC(l,"menu",e),o=NC(Sn,g),a=KC(Sn,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}Vn.handledProps=["active","as","children","className","color","content","disabled","fitted","header","icon","index","link","name","onClick","position"],Vn.propTypes={},Vn.create=sl(Vn,(function(g){return{content:g,name:g}})),Sn.handledProps=["as","children","className","content","position"],Sn.propTypes={};const Rn=Sn;var Xn=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleItemOverrides=function(g){return{onClick:function(e,t){var C=t.index;I.setState({activeIndex:C}),yC(g,"onClick",e,t),yC(I.props,"onItemClick",e,t)}}},I}zg(I,g);var e=I.prototype;return e.renderItems=function(){var g=this,I=this.props.items,e=this.state.activeIndex;return iC(I,(function(I,t){return Vn.create(I,{defaultProps:{active:parseInt(e,10)===t,index:t},overrideProps:g.handleItemOverrides})}))},e.render=function(){var g=this.props,e=g.attached,C=g.borderless,l=g.children,n=g.className,o=g.color,a=g.compact,i=g.fixed,A=g.floated,c=g.fluid,s=g.icon,d=g.inverted,r=g.pagination,u=g.pointing,b=g.secondary,m=g.size,h=g.stackable,Z=g.tabular,G=g.text,p=g.vertical,B=g.widths,y=VC("ui",o,m,XC(C,"borderless"),XC(a,"compact"),XC(c,"fluid"),XC(d,"inverted"),XC(r,"pagination"),XC(u,"pointing"),XC(b,"secondary"),XC(h,"stackable"),XC(G,"text"),XC(p,"vertical"),kC(e,"attached"),kC(A,"floated"),kC(s,"icon"),kC(Z,"tabular"),JC(i,"fixed"),HC(B,"item"),n,"menu"),W=NC(I,this.props),V=KC(I,this.props);return t.createElement(V,Fg({},W,{className:y}),zC(l)?this.renderItems():l)},I}(EC);Xn.handledProps=["activeIndex","as","attached","borderless","children","className","color","compact","defaultActiveIndex","fixed","floated","fluid","icon","inverted","items","onItemClick","pagination","pointing","secondary","size","stackable","tabular","text","vertical","widths"],Xn.propTypes={},Xn.autoControlledProps=["activeIndex"],Xn.Header=ml,Xn.Item=Vn,Xn.Menu=Rn,Xn.create=sl(Xn,(function(g){return{items:g}}));const Jn=Xn;function kn(g){var I=g.children,e=g.className,C=g.content,l=g.fluid,n=g.text,o=g.textAlign,a=VC("ui",XC(n,"text"),XC(l,"fluid"),vC(o),"container",e),i=NC(kn,g),A=KC(kn,g);return t.createElement(A,Fg({},i,{className:a}),zC(I)?C:I)}kn.handledProps=["as","children","className","content","fluid","text","textAlign"],kn.propTypes={};const fn=kn;const vn=function(){const{getUser:g,userIsAuthenticated:I,userLogout:e}=Kg(),t=()=>I()?{display:"none"}:{display:"block"},C=()=>I()?{display:"block"}:{display:"none"},l=()=>{const I=g();return I&&"USER"===I.data.rol[0]?{display:"block"}:{display:"none"}};return(0,Yg.jsx)(Jn,{inverted:!0,color:"white",stackable:!0,size:"massive",style:{borderRadius:0},children:(0,Yg.jsxs)(fn,{children:[(0,Yg.jsx)(Jn.Item,{header:!0,children:"Crypto-UI"}),(0,Yg.jsx)(Jn.Item,{as:Xg,exact:"true",to:"/",children:"Home"}),(0,Yg.jsx)(Jn.Item,{as:Xg,exact:"true",to:"/exchange-rates",children:"RATES"}),(0,Yg.jsx)(Jn.Item,{as:Xg,to:"/wallet",style:l(),children:"Wallet"}),(0,Yg.jsx)(Jn.Item,{as:Xg,to:"/transactions",style:l(),children:"Transactions"}),(0,Yg.jsxs)(Jn.Menu,{position:"right",children:[(0,Yg.jsx)(Jn.Item,{as:Xg,to:"/login",style:t(),children:"Login"}),(0,Yg.jsx)(Jn.Item,{as:Xg,to:"/signup",style:t(),children:"Sign Up"}),(0,Yg.jsx)(Jn.Item,{header:!0,style:C(),children:"Hi ".concat((()=>{const I=g();return I?I.data.name:""})())}),(0,Yg.jsx)(Jn.Item,{as:Xg,to:"/",style:C(),onClick:()=>{e()},children:"Logout"})]})]})})};function Yn(g){var I=g.children,e=g.className,C=g.compact,l=g.content,n=g.horizontal,o=g.piled,a=g.raised,i=g.size,A=g.stacked,c=VC("ui",i,XC(C,"compact"),XC(n,"horizontal"),XC(o,"piled"),XC(a,"raised"),XC(A,"stacked"),"segments",e),s=NC(Yn,g),d=KC(Yn,g);return t.createElement(d,Fg({},s,{className:c}),zC(I)?l:I)}Yn.handledProps=["as","children","className","compact","content","horizontal","piled","raised","size","stacked"],Yn.propTypes={};const Hn=Yn;function Nn(g){var I=g.children,e=g.className,C=g.content,l=VC("inline",e),n=NC(Nn,g),o=KC(Nn,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}Nn.handledProps=["as","children","className","content"],Nn.propTypes={};const Kn=Nn;function wn(g){var I=g.attached,e=g.basic,C=g.children,l=g.circular,n=g.className,o=g.clearing,a=g.color,i=g.compact,A=g.content,c=g.disabled,s=g.floated,d=g.inverted,r=g.loading,u=g.placeholder,b=g.padded,m=g.piled,h=g.raised,Z=g.secondary,G=g.size,p=g.stacked,B=g.tertiary,y=g.textAlign,W=g.vertical,V=VC("ui",a,G,XC(e,"basic"),XC(l,"circular"),XC(o,"clearing"),XC(i,"compact"),XC(c,"disabled"),XC(d,"inverted"),XC(r,"loading"),XC(u,"placeholder"),XC(m,"piled"),XC(h,"raised"),XC(Z,"secondary"),XC(p,"stacked"),XC(B,"tertiary"),XC(W,"vertical"),kC(I,"attached"),kC(b,"padded"),vC(y),JC(s,"floated"),"segment",n),S=NC(wn,g),R=KC(wn,g);return t.createElement(R,Fg({},S,{className:V}),zC(C)?A:C)}wn.handledProps=["as","attached","basic","children","circular","className","clearing","color","compact","content","disabled","floated","inverted","loading","padded","piled","placeholder","raised","secondary","size","stacked","tertiary","textAlign","vertical"],wn.Group=Hn,wn.Inline=Kn,wn.propTypes={};const Fn=wn;var xn="object"===typeof document&&null!==document,zn="object"===typeof window&&null!==window&&window.self===window;const Mn=function g(){return Al(g.override)?xn&&zn:g.override};var En=e(173),Un=e.n(En),Qn=function(g,I){"function"!==typeof g?null!==g&&"object"===typeof g&&(g.current=I):g(I)};var Ln=e(904);var Dn=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).prevNode=void 0,I}zg(I,g);var e=I.prototype;return e.componentDidMount=function(){var g=n.findDOMNode(this);this.prevNode=g,Qn(this.props.innerRef,g)},e.componentDidUpdate=function(g){var I=n.findDOMNode(this);this.prevNode!==I&&(this.prevNode=I,Qn(this.props.innerRef,I)),g.innerRef!==this.props.innerRef&&Qn(this.props.innerRef,I)},e.componentWillUnmount=function(){Qn(this.props.innerRef,null),delete this.prevNode},e.render=function(){return this.props.children},I}(t.Component),Tn=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).currentNode=void 0,I.handleRefOverride=function(g){var e=I.props,t=e.children,C=e.innerRef;Qn(t.ref,g),Qn(C,g),I.currentNode=g},I}zg(I,g);var e=I.prototype;return e.componentDidUpdate=function(g){g.innerRef!==this.props.innerRef&&Qn(this.props.innerRef,this.currentNode)},e.componentWillUnmount=function(){delete this.currentNode},e.render=function(){var g=this.props.children;return t.cloneElement(g,{ref:this.handleRefOverride})},I}(t.Component),jn=["children","innerRef"],Pn=function(g){var I=g.children,e=g.innerRef,C=function(g,I){if(null==g)return{};var e={};for(var t in g)if(Object.prototype.hasOwnProperty.call(g,t)){if(I.indexOf(t)>=0)continue;e[t]=g[t]}return e}(g,jn),l=t.Children.only(I),n=Ln.isForwardRef(l)?Tn:Dn,o=l&&C&&Object.keys(C).length>0?t.cloneElement(l,C):l;return t.createElement(n,{innerRef:e},o)},On=e(90),_n=e.n(On),qn=Math.max,$n=Math.min;const go=function(g,I,e){return g>=$n(I,e)&&g<qn(I,e)};var Io=/\s/;const eo=function(g){for(var I=g.length;I--&&Io.test(g.charAt(I)););return I};var to=/^\s+/;const Co=function(g){return g?g.slice(0,eo(g)+1).replace(to,""):g};var lo=/^[-+]0x[0-9a-f]+$/i,no=/^0b[01]+$/i,oo=/^0o[0-7]+$/i,ao=parseInt;const io=function(g){if("number"==typeof g)return g;if(ft(g))return NaN;if(uI(g)){var I="function"==typeof g.valueOf?g.valueOf():g;g=uI(I)?I+"":I}if("string"!=typeof g)return 0===g?g:+g;g=Co(g);var e=no.test(g);return e||oo.test(g)?ao(g.slice(2),e?2:8):lo.test(g)?NaN:+g};var Ao=1/0;const co=function(g){return g?(g=io(g))===Ao||g===-1/0?17976931348623157e292*(g<0?-1:1):g===g?g:0:0===g?g:0};const so=function(g,I,e){return I=co(I),void 0===e?(e=I,I=0):e=co(e),g=io(g),go(g,I,e)};const ro=function(g){return g&&g.length?g[0]:void 0};const uo=function(g,I){if(xC([I,g],Al))return!1;if(I.target&&(yC(I.target,"setAttribute","data-suir-click-target",!0),document.querySelector("[data-suir-click-target=true]")))return yC(I.target,"removeAttribute","data-suir-click-target"),g.contains(I.target);var e=I.clientX,t=I.clientY;if(xC([e,t],Al))return!1;var C=g.getClientRects();if(!g.offsetWidth||!g.offsetHeight||!C||!C.length)return!1;var l=ro(C),n=l.top,o=l.bottom,a=l.left,i=l.right;return!xC([n,o,a,i],Al)&&(so(t,n,o+.001)&&so(e,a,i+.001))};var bo=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleRef=function(g){Qn(I.props.innerRef,g)},I}zg(I,g);var e=I.prototype;return e.componentDidMount=function(){yC(this.props,"onMount",null,this.props)},e.componentWillUnmount=function(){yC(this.props,"onUnmount",null,this.props)},e.render=function(){if(!Mn())return null;var g=this.props,I=g.children,e=g.mountNode,C=void 0===e?document.body:e;return(0,n.createPortal)(t.createElement(Pn,{innerRef:this.handleRef},I),C)},I}(t.Component);bo.handledProps=["children","innerRef","mountNode","onMount","onUnmount"],bo.propTypes={};const mo=bo;var ho=function(g){function I(){for(var I,e=arguments.length,C=new Array(e),l=0;l<e;l++)C[l]=arguments[l];return(I=g.call.apply(g,[this].concat(C))||this).contentRef=t.createRef(),I.triggerRef=t.createRef(),I.latestDocumentMouseDownEvent=null,I.handleDocumentMouseDown=function(g){I.latestDocumentMouseDownEvent=g},I.handleDocumentClick=function(g){var e=I.props.closeOnDocumentClick,t=I.latestDocumentMouseDownEvent;I.latestDocumentMouseDownEvent=null,!I.contentRef.current||uo(I.triggerRef.current,g)||t&&uo(I.contentRef.current,t)||uo(I.contentRef.current,g)||e&&I.close(g)},I.handleEscape=function(g){I.props.closeOnEscape&&_n().getCode(g)===_n().Escape&&I.close(g)},I.handlePortalMouseLeave=function(g){var e=I.props,t=e.closeOnPortalMouseLeave,C=e.mouseLeaveDelay;t&&g.target===I.contentRef.current&&(I.mouseLeaveTimer=I.closeWithTimeout(g,C))},I.handlePortalMouseEnter=function(){I.props.closeOnPortalMouseLeave&&clearTimeout(I.mouseLeaveTimer)},I.handleTriggerBlur=function(g){for(var e=I.props,t=e.trigger,C=e.closeOnTriggerBlur,l=arguments.length,n=new Array(l>1?l-1:0),o=1;o<l;o++)n[o-1]=arguments[o];yC.apply(void 0,[t,"props.onBlur",g].concat(n));var a=g.relatedTarget||document.activeElement,i=yC(I.contentRef.current,"contains",a);C&&!i&&I.close(g)},I.handleTriggerClick=function(g){for(var e=I.props,t=e.trigger,C=e.closeOnTriggerClick,l=e.openOnTriggerClick,n=I.state.open,o=arguments.length,a=new Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];yC.apply(void 0,[t,"props.onClick",g].concat(a)),n&&C?I.close(g):!n&&l&&I.open(g)},I.handleTriggerFocus=function(g){for(var e=I.props,t=e.trigger,C=e.openOnTriggerFocus,l=arguments.length,n=new Array(l>1?l-1:0),o=1;o<l;o++)n[o-1]=arguments[o];yC.apply(void 0,[t,"props.onFocus",g].concat(n)),C&&I.open(g)},I.handleTriggerMouseLeave=function(g){clearTimeout(I.mouseEnterTimer);for(var e=I.props,t=e.trigger,C=e.closeOnTriggerMouseLeave,l=e.mouseLeaveDelay,n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];yC.apply(void 0,[t,"props.onMouseLeave",g].concat(o)),C&&(I.mouseLeaveTimer=I.closeWithTimeout(g,l))},I.handleTriggerMouseEnter=function(g){clearTimeout(I.mouseLeaveTimer);for(var e=I.props,t=e.trigger,C=e.mouseEnterDelay,l=e.openOnTriggerMouseEnter,n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];yC.apply(void 0,[t,"props.onMouseEnter",g].concat(o)),l&&(I.mouseEnterTimer=I.openWithTimeout(g,C))},I.open=function(g){yC(I.props,"onOpen",g,Fg({},I.props,{open:!0})),I.setState({open:!0})},I.openWithTimeout=function(g,e){var t=Fg({},g);return setTimeout((function(){return I.open(t)}),e||0)},I.close=function(g){I.setState({open:!1}),yC(I.props,"onClose",g,Fg({},I.props,{open:!1}))},I.closeWithTimeout=function(g,e){var t=Fg({},g);return setTimeout((function(){return I.close(t)}),e||0)},I.handleMount=function(){yC(I.props,"onMount",null,I.props)},I.handleUnmount=function(){yC(I.props,"onUnmount",null,I.props)},I.handleTriggerRef=function(g){I.triggerRef.current=g,Qn(I.props.triggerRef,g)},I}zg(I,g);var e=I.prototype;return e.componentWillUnmount=function(){clearTimeout(this.mouseEnterTimer),clearTimeout(this.mouseLeaveTimer)},e.render=function(){var g=this.props,I=g.children,e=g.eventPool,C=g.mountNode,l=g.trigger,n=this.state.open;return t.createElement(t.Fragment,null,n&&t.createElement(t.Fragment,null,t.createElement(mo,{innerRef:this.contentRef,mountNode:C,onMount:this.handleMount,onUnmount:this.handleUnmount},I),t.createElement(Un(),{name:"mouseleave",on:this.handlePortalMouseLeave,pool:e,target:this.contentRef}),t.createElement(Un(),{name:"mouseenter",on:this.handlePortalMouseEnter,pool:e,target:this.contentRef}),t.createElement(Un(),{name:"mousedown",on:this.handleDocumentMouseDown,pool:e}),t.createElement(Un(),{name:"click",on:this.handleDocumentClick,pool:e}),t.createElement(Un(),{name:"keydown",on:this.handleEscape,pool:e})),l&&t.createElement(Pn,{innerRef:this.handleTriggerRef},t.cloneElement(l,{onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onMouseLeave:this.handleTriggerMouseLeave,onMouseEnter:this.handleTriggerMouseEnter})))},I}(EC);ho.handledProps=["children","closeOnDocumentClick","closeOnEscape","closeOnPortalMouseLeave","closeOnTriggerBlur","closeOnTriggerClick","closeOnTriggerMouseLeave","defaultOpen","eventPool","mountNode","mouseEnterDelay","mouseLeaveDelay","onClose","onMount","onOpen","onUnmount","open","openOnTriggerClick","openOnTriggerFocus","openOnTriggerMouseEnter","trigger","triggerRef"],ho.propTypes={},ho.defaultProps={closeOnDocumentClick:!0,closeOnEscape:!0,eventPool:"default",openOnTriggerClick:!0},ho.autoControlledProps=["open"],ho.Inner=mo;const Zo=ho;function Go(g){var I=g.blurring,e=g.className,C=g.children,l=g.content,n=g.dimmed,o=VC(XC(I,"blurring"),XC(n,"dimmed"),"dimmable",e),a=NC(Go,g),i=KC(Go,g);return t.createElement(i,Fg({},a,{className:o}),zC(C)?l:C)}Go.handledProps=["as","blurring","children","className","content","dimmed"],Go.propTypes={};const po=Go;var Bo=function(g){function I(){for(var I,e=arguments.length,C=new Array(e),l=0;l<e;l++)C[l]=arguments[l];return(I=g.call.apply(g,[this].concat(C))||this).containerRef=(0,t.createRef)(),I.contentRef=(0,t.createRef)(),I.handleClick=function(g){var e=I.contentRef.current;yC(I.props,"onClick",g,I.props),e&&e!==g.target&&uo(e,g)||yC(I.props,"onClickOutside",g,I.props)},I}zg(I,g);var e=I.prototype;return e.componentDidMount=function(){var g=this.props.active;this.toggleStyles(g)},e.componentDidUpdate=function(g){var I=this.props.active;g.active!==I&&this.toggleStyles(I)},e.toggleStyles=function(g){var I=this.containerRef.current;I&&I.style&&(g?I.style.setProperty("display","flex","important"):I.style.removeProperty("display"))},e.render=function(){var g=this.props,e=g.active,C=g.children,l=g.className,n=g.content,o=g.disabled,a=g.inverted,i=g.page,A=g.simple,c=g.verticalAlign,s=VC("ui",XC(e,"active transition visible"),XC(o,"disabled"),XC(a,"inverted"),XC(i,"page"),XC(A,"simple"),YC(c),"dimmer",l),d=NC(I,this.props),r=KC(I,this.props),u=zC(C)?n:C;return t.createElement(Pn,{innerRef:this.containerRef},t.createElement(r,Fg({},d,{className:s,onClick:this.handleClick}),u&&t.createElement("div",{className:"content",ref:this.contentRef},u)))},I}(t.Component);Bo.handledProps=["active","as","children","className","content","disabled","inverted","onClick","onClickOutside","page","simple","verticalAlign"],Bo.propTypes={};var yo=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handlePortalMount=function(){Mn()&&(document.body.classList.add("dimmed"),document.body.classList.add("dimmable"))},I.handlePortalUnmount=function(){Mn()&&(document.body.classList.remove("dimmed"),document.body.classList.remove("dimmable"))},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.active,C=g.page,l=NC(I,this.props);return C?t.createElement(Zo,{closeOnEscape:!1,closeOnDocumentClick:!1,onMount:this.handlePortalMount,onUnmount:this.handlePortalUnmount,open:e,openOnTriggerClick:!1},t.createElement(Bo,Fg({},l,{active:e,page:C}))):t.createElement(Bo,Fg({},l,{active:e,page:C}))},I}(t.Component);function Wo(g){var I=g.active,e=g.children,C=g.className,l=g.content,n=g.disabled,o=g.indeterminate,a=g.inline,i=g.inverted,A=g.size,c=VC("ui",A,XC(I,"active"),XC(n,"disabled"),XC(o,"indeterminate"),XC(i,"inverted"),XC(e||l,"text"),kC(a,"inline"),"loader",C),s=NC(Wo,g),d=KC(Wo,g);return t.createElement(d,Fg({},s,{className:c}),zC(e)?l:e)}yo.handledProps=["active","page"],yo.propTypes={},yo.Dimmable=po,yo.Inner=Bo,yo.create=sl(yo,(function(g){return{content:g}})),Wo.handledProps=["active","as","children","className","content","disabled","indeterminate","inline","inverted","size"],Wo.propTypes={};const Vo=Wo;function So(g){var I=g.children,e=g.className,C=g.computer,l=g.color,n=g.floated,o=g.largeScreen,a=g.mobile,i=g.only,A=g.stretched,c=g.tablet,s=g.textAlign,d=g.verticalAlign,r=g.widescreen,u=g.width,b=VC(l,XC(A,"stretched"),fC(i,"only"),vC(s),JC(n,"floated"),YC(d),HC(C,"wide computer"),HC(o,"wide large screen"),HC(a,"wide mobile"),HC(c,"wide tablet"),HC(r,"wide widescreen"),HC(u,"wide"),"column",e),m=NC(So,g),h=KC(So,g);return t.createElement(h,Fg({},m,{className:b}),I)}So.handledProps=["as","children","className","color","computer","floated","largeScreen","mobile","only","stretched","tablet","textAlign","verticalAlign","widescreen","width"],So.propTypes={},So.create=sl(So,(function(g){return{children:g}}));const Ro=So;function Xo(g){var I=g.centered,e=g.children,C=g.className,l=g.color,n=g.columns,o=g.divided,a=g.only,i=g.reversed,A=g.stretched,c=g.textAlign,s=g.verticalAlign,d=VC(l,XC(I,"centered"),XC(o,"divided"),XC(A,"stretched"),fC(a,"only"),fC(i,"reversed"),vC(c),YC(s),HC(n,"column",!0),"row",C),r=NC(Xo,g),u=KC(Xo,g);return t.createElement(u,Fg({},r,{className:d}),e)}Xo.handledProps=["as","centered","children","className","color","columns","divided","only","reversed","stretched","textAlign","verticalAlign"],Xo.propTypes={};const Jo=Xo;function ko(g){var I=g.celled,e=g.centered,C=g.children,l=g.className,n=g.columns,o=g.container,a=g.divided,i=g.doubling,A=g.inverted,c=g.padded,s=g.relaxed,d=g.reversed,r=g.stackable,u=g.stretched,b=g.textAlign,m=g.verticalAlign,h=VC("ui",XC(e,"centered"),XC(o,"container"),XC(i,"doubling"),XC(A,"inverted"),XC(r,"stackable"),XC(u,"stretched"),kC(I,"celled"),kC(a,"divided"),kC(c,"padded"),kC(s,"relaxed"),fC(d,"reversed"),vC(b),YC(m),HC(n,"column",!0),"grid",l),Z=NC(ko,g),G=KC(ko,g);return t.createElement(G,Fg({},Z,{className:h}),C)}ko.handledProps=["as","celled","centered","children","className","columns","container","divided","doubling","inverted","padded","relaxed","reversed","stackable","stretched","textAlign","verticalAlign"],ko.Column=Ro,ko.Row=Jo,ko.propTypes={};const fo=ko;function vo(g){var I=g.children,e=g.className,C=g.color,l=g.content,n=g.horizontal,o=g.inverted,a=g.items,i=g.size,A=g.widths,c=VC("ui",C,i,XC(n,"horizontal"),XC(o,"inverted"),HC(A),"statistics",e),s=NC(vo,g),d=KC(vo,g);return zC(I)?zC(l)?t.createElement(d,Fg({},s,{className:c}),iC(a,(function(g){return xo.create(g)}))):t.createElement(d,Fg({},s,{className:c}),l):t.createElement(d,Fg({},s,{className:c}),I)}vo.handledProps=["as","children","className","color","content","horizontal","inverted","items","size","widths"],vo.propTypes={};const Yo=vo;function Ho(g){var I=g.children,e=g.className,C=g.content,l=VC("label",e),n=NC(Ho,g),o=KC(Ho,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}Ho.handledProps=["as","children","className","content"],Ho.propTypes={},Ho.create=sl(Ho,(function(g){return{content:g}}));const No=Ho;function Ko(g){var I=g.children,e=g.className,C=g.content,l=g.text,n=VC(XC(l,"text"),"value",e),o=NC(Ko,g),a=KC(Ko,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}Ko.handledProps=["as","children","className","content","text"],Ko.propTypes={},Ko.create=sl(Ko,(function(g){return{content:g}}));const wo=Ko;function Fo(g){var I=g.children,e=g.className,C=g.color,l=g.content,n=g.floated,o=g.horizontal,a=g.inverted,i=g.label,A=g.size,c=g.text,s=g.value,d=VC("ui",C,A,JC(n,"floated"),XC(o,"horizontal"),XC(a,"inverted"),"statistic",e),r=NC(Fo,g),u=KC(Fo,g);return zC(I)?zC(l)?t.createElement(u,Fg({},r,{className:d}),wo.create(s,{defaultProps:{text:c},autoGenerateKey:!1}),No.create(i,{autoGenerateKey:!1})):t.createElement(u,Fg({},r,{className:d}),l):t.createElement(u,Fg({},r,{className:d}),I)}Fo.handledProps=["as","children","className","color","content","floated","horizontal","inverted","label","size","text","value"],Fo.propTypes={},Fo.Group=Yo,Fo.Label=No,Fo.Value=wo,Fo.create=sl(Fo,(function(g){return{content:g}}));const xo=Fo;const zo=function(g){var I=co(g),e=I%1;return I===I?e?I-e:I:0};const Mo=function(g,I){return Mg(I,(function(I){return g[I]}))};const Eo=function(g){return null==g?[]:Mo(g,gt(g))};var Uo=Math.max;const Qo=function(g,I,e,t){g=$e(g)?g:Eo(g),e=e&&!t?zo(e):0;var C=g.length;return e<0&&(e=Uo(C+e,0)),al(g)?e<=C&&g.indexOf(I,e)>-1:!!C&&DC(g,I,e)>-1};const Lo=function(g,I){for(var e=-1,t=null==g?0:g.length;++e<t&&!1!==I(g[e],e,g););return g};const Do=function(g){return"function"==typeof g?g:$t};const To=function(g,I){return(re(g)?Lo:oC)(g,Do(I))};var jo=["selected","defaultValue","defaultChecked","accept","autoCapitalize","autoComplete","autoCorrect","autoFocus","checked","disabled","enterKeyHint","form","id","inputMode","lang","list","max","maxLength","min","minLength","multiple","name","pattern","placeholder","readOnly","required","step","title","type","value"],Po=[].concat(jo,["onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onClick","onContextMenu","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"]),Oo=["alt","height","src","srcSet","width","loading"],_o=function(g,I){void 0===I&&(I={});var e=I,t=e.htmlProps,C=void 0===t?Po:t,l=e.includeAria,n=void 0===l||l,o={},a={};return To(g,(function(g,I){var e=n&&(/^aria-.*$/.test(I)||"role"===I);(Qo(C,I)||e?o:a)[I]=g})),[o,a]};function qo(g){var I=g.children,e=g.className,C=g.content,l=VC("detail",e),n=NC(qo,g),o=KC(qo,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}qo.handledProps=["as","children","className","content"],qo.propTypes={},qo.create=sl(qo,(function(g){return{content:g}}));const $o=qo;function ga(g){var I=g.children,e=g.circular,C=g.className,l=g.color,n=g.content,o=g.size,a=g.tag,i=VC("ui",l,o,XC(e,"circular"),XC(a,"tag"),"labels",C),A=NC(ga,g),c=KC(ga,g);return t.createElement(c,Fg({},A,{className:i}),zC(I)?n:I)}ga.handledProps=["as","children","circular","className","color","content","size","tag"],ga.propTypes={};const Ia=ga;var ea=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleClick=function(g){var e=I.props.onClick;e&&e(g,I.props)},I.handleIconOverrides=function(g){return{onClick:function(e){yC(g,"onClick",e),yC(I.props,"onRemove",e,I.props)}}},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.active,C=g.attached,l=g.basic,n=g.children,o=g.circular,a=g.className,i=g.color,A=g.content,c=g.corner,s=g.detail,d=g.empty,r=g.floating,u=g.horizontal,b=g.icon,m=g.image,h=g.onRemove,Z=g.pointing,G=g.prompt,p=g.removeIcon,B=g.ribbon,y=g.size,W=g.tag,V=VC("ui",i,(!0===Z?"pointing":("left"===Z||"right"===Z)&&Z+" pointing")||("above"===Z||"below"===Z)&&"pointing "+Z,y,XC(e,"active"),XC(l,"basic"),XC(o,"circular"),XC(d,"empty"),XC(r,"floating"),XC(u,"horizontal"),XC(!0===m,"image"),XC(G,"prompt"),XC(W,"tag"),kC(c,"corner"),kC(B,"ribbon"),JC(C,"attached"),"label",a),S=NC(I,this.props),R=KC(I,this.props);if(!zC(n))return t.createElement(R,Fg({},S,{className:V,onClick:this.handleClick}),n);var X=MC(p)?"delete":p;return t.createElement(R,Fg({className:V,onClick:this.handleClick},S),Wn.create(b,{autoGenerateKey:!1}),"boolean"!==typeof m&&na.create(m,{autoGenerateKey:!1}),A,$o.create(s,{autoGenerateKey:!1}),h&&Wn.create(X,{autoGenerateKey:!1,overrideProps:this.handleIconOverrides}))},I}(t.Component);function ta(g){var I=g.children,e=g.className,C=g.content,l=g.size,n=VC("ui",l,e,"images"),o=NC(ta,g),a=KC(ta,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}ea.handledProps=["active","as","attached","basic","children","circular","className","color","content","corner","detail","empty","floating","horizontal","icon","image","onClick","onRemove","pointing","prompt","removeIcon","ribbon","size","tag"],ea.propTypes={},ea.Detail=$o,ea.Group=Ia,ea.create=sl(ea,(function(g){return{content:g}})),ta.handledProps=["as","children","className","content","size"],ta.propTypes={};const Ca=ta;function la(g){var I=g.avatar,e=g.bordered,C=g.centered,l=g.children,n=g.circular,o=g.className,a=g.content,i=g.dimmer,A=g.disabled,c=g.floated,s=g.fluid,d=g.hidden,r=g.href,u=g.inline,b=g.label,m=g.rounded,h=g.size,Z=g.spaced,G=g.verticalAlign,p=g.wrapped,B=g.ui,y=VC(XC(B,"ui"),h,XC(I,"avatar"),XC(e,"bordered"),XC(n,"circular"),XC(C,"centered"),XC(A,"disabled"),XC(s,"fluid"),XC(d,"hidden"),XC(u,"inline"),XC(m,"rounded"),kC(Z,"spaced"),JC(c,"floated"),YC(G),"image",o),W=NC(la,g),V=_o(W,{htmlProps:Oo}),S=V[0],R=V[1],X=KC(la,g,(function(){if(!Al(i)||!Al(b)||!Al(p)||!zC(l))return"div"}));return zC(l)?zC(a)?"img"===X?t.createElement(X,Fg({},R,S,{className:y})):t.createElement(X,Fg({},R,{className:y,href:r}),yo.create(i,{autoGenerateKey:!1}),ea.create(b,{autoGenerateKey:!1}),t.createElement("img",S)):t.createElement(X,Fg({},W,{className:y}),a):t.createElement(X,Fg({},W,{className:y}),l)}la.handledProps=["as","avatar","bordered","centered","children","circular","className","content","dimmer","disabled","floated","fluid","hidden","href","inline","label","rounded","size","spaced","ui","verticalAlign","wrapped"],la.Group=Ca,la.propTypes={},la.defaultProps={as:"img",ui:!0},la.create=sl(la,(function(g){return{src:g}}));const na=la;function oa(g){return oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},oa(g)}function aa(g){var I=function(g,I){if("object"!=oa(g)||!g)return g;var e=g[Symbol.toPrimitive];if(void 0!==e){var t=e.call(g,I||"default");if("object"!=oa(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"==oa(I)?I:I+""}function ia(g,I,e){return(I=aa(I))in g?Object.defineProperty(g,I,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[I]=e,g}function Aa(g){return g+.5|0}const ca=(g,I,e)=>Math.max(Math.min(g,e),I);function sa(g){return ca(Aa(2.55*g),0,255)}function da(g){return ca(Aa(255*g),0,255)}function ra(g){return ca(Aa(g/2.55)/100,0,1)}function ua(g){return ca(Aa(100*g),0,100)}const ba={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ma=[..."0123456789ABCDEF"],ha=g=>ma[15&g],Za=g=>ma[(240&g)>>4]+ma[15&g],Ga=g=>(240&g)>>4===(15&g);function pa(g){var I=(g=>Ga(g.r)&&Ga(g.g)&&Ga(g.b)&&Ga(g.a))(g)?ha:Za;return g?"#"+I(g.r)+I(g.g)+I(g.b)+((g,I)=>g<255?I(g):"")(g.a,I):void 0}const Ba=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function ya(g,I,e){const t=I*Math.min(e,1-e),C=function(I){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(I+g/30)%12;return e-t*Math.max(Math.min(C-3,9-C,1),-1)};return[C(0),C(8),C(4)]}function Wa(g,I,e){const t=function(t){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+g/60)%6;return e-e*I*Math.max(Math.min(C,4-C,1),0)};return[t(5),t(3),t(1)]}function Va(g,I,e){const t=ya(g,1,.5);let C;for(I+e>1&&(C=1/(I+e),I*=C,e*=C),C=0;C<3;C++)t[C]*=1-I-e,t[C]+=I;return t}function Sa(g){const I=g.r/255,e=g.g/255,t=g.b/255,C=Math.max(I,e,t),l=Math.min(I,e,t),n=(C+l)/2;let o,a,i;return C!==l&&(i=C-l,a=n>.5?i/(2-C-l):i/(C+l),o=function(g,I,e,t,C){return g===C?(I-e)/t+(I<e?6:0):I===C?(e-g)/t+2:(g-I)/t+4}(I,e,t,i,C),o=60*o+.5),[0|o,a||0,n]}function Ra(g,I,e,t){return(Array.isArray(I)?g(I[0],I[1],I[2]):g(I,e,t)).map(da)}function Xa(g,I,e){return Ra(ya,g,I,e)}function Ja(g){return(g%360+360)%360}function ka(g){const I=Ba.exec(g);let e,t=255;if(!I)return;I[5]!==e&&(t=I[6]?sa(+I[5]):da(+I[5]));const C=Ja(+I[2]),l=+I[3]/100,n=+I[4]/100;return e="hwb"===I[1]?function(g,I,e){return Ra(Va,g,I,e)}(C,l,n):"hsv"===I[1]?function(g,I,e){return Ra(Wa,g,I,e)}(C,l,n):Xa(C,l,n),{r:e[0],g:e[1],b:e[2],a:t}}const fa={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},va={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Ya;function Ha(g){Ya||(Ya=function(){const g={},I=Object.keys(va),e=Object.keys(fa);let t,C,l,n,o;for(t=0;t<I.length;t++){for(n=o=I[t],C=0;C<e.length;C++)l=e[C],o=o.replace(l,fa[l]);l=parseInt(va[n],16),g[o]=[l>>16&255,l>>8&255,255&l]}return g}(),Ya.transparent=[0,0,0,0]);const I=Ya[g.toLowerCase()];return I&&{r:I[0],g:I[1],b:I[2],a:4===I.length?I[3]:255}}const Na=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Ka=g=>g<=.0031308?12.92*g:1.055*Math.pow(g,1/2.4)-.055,wa=g=>g<=.04045?g/12.92:Math.pow((g+.055)/1.055,2.4);function Fa(g,I,e){if(g){let t=Sa(g);t[I]=Math.max(0,Math.min(t[I]+t[I]*e,0===I?360:1)),t=Xa(t),g.r=t[0],g.g=t[1],g.b=t[2]}}function xa(g,I){return g?Object.assign(I||{},g):g}function za(g){var I={r:0,g:0,b:0,a:255};return Array.isArray(g)?g.length>=3&&(I={r:g[0],g:g[1],b:g[2],a:255},g.length>3&&(I.a=da(g[3]))):(I=xa(g,{r:0,g:0,b:0,a:1})).a=da(I.a),I}function Ma(g){return"r"===g.charAt(0)?function(g){const I=Na.exec(g);let e,t,C,l=255;if(I){if(I[7]!==e){const g=+I[7];l=I[8]?sa(g):ca(255*g,0,255)}return e=+I[1],t=+I[3],C=+I[5],e=255&(I[2]?sa(e):ca(e,0,255)),t=255&(I[4]?sa(t):ca(t,0,255)),C=255&(I[6]?sa(C):ca(C,0,255)),{r:e,g:t,b:C,a:l}}}(g):ka(g)}class Ea{constructor(g){if(g instanceof Ea)return g;const I=typeof g;let e;"object"===I?e=za(g):"string"===I&&(e=function(g){var I,e=g.length;return"#"===g[0]&&(4===e||5===e?I={r:255&17*ba[g[1]],g:255&17*ba[g[2]],b:255&17*ba[g[3]],a:5===e?17*ba[g[4]]:255}:7!==e&&9!==e||(I={r:ba[g[1]]<<4|ba[g[2]],g:ba[g[3]]<<4|ba[g[4]],b:ba[g[5]]<<4|ba[g[6]],a:9===e?ba[g[7]]<<4|ba[g[8]]:255})),I}(g)||Ha(g)||Ma(g)),this._rgb=e,this._valid=!!e}get valid(){return this._valid}get rgb(){var g=xa(this._rgb);return g&&(g.a=ra(g.a)),g}set rgb(g){this._rgb=za(g)}rgbString(){return this._valid?(g=this._rgb)&&(g.a<255?"rgba(".concat(g.r,", ").concat(g.g,", ").concat(g.b,", ").concat(ra(g.a),")"):"rgb(".concat(g.r,", ").concat(g.g,", ").concat(g.b,")")):void 0;var g}hexString(){return this._valid?pa(this._rgb):void 0}hslString(){return this._valid?function(g){if(!g)return;const I=Sa(g),e=I[0],t=ua(I[1]),C=ua(I[2]);return g.a<255?"hsla(".concat(e,", ").concat(t,"%, ").concat(C,"%, ").concat(ra(g.a),")"):"hsl(".concat(e,", ").concat(t,"%, ").concat(C,"%)")}(this._rgb):void 0}mix(g,I){if(g){const e=this.rgb,t=g.rgb;let C;const l=I===C?.5:I,n=2*l-1,o=e.a-t.a,a=((n*o===-1?n:(n+o)/(1+n*o))+1)/2;C=1-a,e.r=255&a*e.r+C*t.r+.5,e.g=255&a*e.g+C*t.g+.5,e.b=255&a*e.b+C*t.b+.5,e.a=l*e.a+(1-l)*t.a,this.rgb=e}return this}interpolate(g,I){return g&&(this._rgb=function(g,I,e){const t=wa(ra(g.r)),C=wa(ra(g.g)),l=wa(ra(g.b));return{r:da(Ka(t+e*(wa(ra(I.r))-t))),g:da(Ka(C+e*(wa(ra(I.g))-C))),b:da(Ka(l+e*(wa(ra(I.b))-l))),a:g.a+e*(I.a-g.a)}}(this._rgb,g._rgb,I)),this}clone(){return new Ea(this.rgb)}alpha(g){return this._rgb.a=da(g),this}clearer(g){return this._rgb.a*=1-g,this}greyscale(){const g=this._rgb,I=Aa(.3*g.r+.59*g.g+.11*g.b);return g.r=g.g=g.b=I,this}opaquer(g){return this._rgb.a*=1+g,this}negate(){const g=this._rgb;return g.r=255-g.r,g.g=255-g.g,g.b=255-g.b,this}lighten(g){return Fa(this._rgb,2,g),this}darken(g){return Fa(this._rgb,2,-g),this}saturate(g){return Fa(this._rgb,1,g),this}desaturate(g){return Fa(this._rgb,1,-g),this}rotate(g){return function(g,I){var e=Sa(g);e[0]=Ja(e[0]+I),e=Xa(e),g.r=e[0],g.g=e[1],g.b=e[2]}(this._rgb,g),this}}function Ua(){}const Qa=(()=>{let g=0;return()=>g++})();function La(g){return null===g||"undefined"===typeof g}function Da(g){if(Array.isArray&&Array.isArray(g))return!0;const I=Object.prototype.toString.call(g);return"[object"===I.slice(0,7)&&"Array]"===I.slice(-6)}function Ta(g){return null!==g&&"[object Object]"===Object.prototype.toString.call(g)}function ja(g){return("number"===typeof g||g instanceof Number)&&isFinite(+g)}function Pa(g,I){return ja(g)?g:I}function Oa(g,I){return"undefined"===typeof g?I:g}const _a=(g,I)=>"string"===typeof g&&g.endsWith("%")?parseFloat(g)/100*I:+g;function qa(g,I,e){if(g&&"function"===typeof g.call)return g.apply(e,I)}function $a(g,I,e,t){let C,l,n;if(Da(g))if(l=g.length,t)for(C=l-1;C>=0;C--)I.call(e,g[C],C);else for(C=0;C<l;C++)I.call(e,g[C],C);else if(Ta(g))for(n=Object.keys(g),l=n.length,C=0;C<l;C++)I.call(e,g[n[C]],n[C])}function gi(g,I){let e,t,C,l;if(!g||!I||g.length!==I.length)return!1;for(e=0,t=g.length;e<t;++e)if(C=g[e],l=I[e],C.datasetIndex!==l.datasetIndex||C.index!==l.index)return!1;return!0}function Ii(g){if(Da(g))return g.map(Ii);if(Ta(g)){const I=Object.create(null),e=Object.keys(g),t=e.length;let C=0;for(;C<t;++C)I[e[C]]=Ii(g[e[C]]);return I}return g}function ei(g){return-1===["__proto__","prototype","constructor"].indexOf(g)}function ti(g,I,e,t){if(!ei(g))return;const C=I[g],l=e[g];Ta(C)&&Ta(l)?Ci(C,l,t):I[g]=Ii(l)}function Ci(g,I,e){const t=Da(I)?I:[I],C=t.length;if(!Ta(g))return g;const l=(e=e||{}).merger||ti;let n;for(let o=0;o<C;++o){if(n=t[o],!Ta(n))continue;const I=Object.keys(n);for(let t=0,C=I.length;t<C;++t)l(I[t],g,n,e)}return g}function li(g,I){return Ci(g,I,{merger:ni})}function ni(g,I,e){if(!ei(g))return;const t=I[g],C=e[g];Ta(t)&&Ta(C)?li(t,C):Object.prototype.hasOwnProperty.call(I,g)||(I[g]=Ii(C))}const oi={"":g=>g,x:g=>g.x,y:g=>g.y};function ai(g,I){const e=oi[I]||(oi[I]=function(g){const I=function(g){const I=g.split("."),e=[];let t="";for(const C of I)t+=C,t.endsWith("\\")?t=t.slice(0,-1)+".":(e.push(t),t="");return e}(g);return g=>{for(const e of I){if(""===e)break;g=g&&g[e]}return g}}(I));return e(g)}function ii(g){return g.charAt(0).toUpperCase()+g.slice(1)}const Ai=g=>"undefined"!==typeof g,ci=g=>"function"===typeof g,si=(g,I)=>{if(g.size!==I.size)return!1;for(const e of g)if(!I.has(e))return!1;return!0};const di=Math.PI,ri=2*di,ui=ri+di,bi=Number.POSITIVE_INFINITY,mi=di/180,hi=di/2,Zi=di/4,Gi=2*di/3,pi=Math.log10,Bi=Math.sign;function yi(g,I,e){return Math.abs(g-I)<e}function Wi(g){const I=Math.round(g);g=yi(g,I,g/1e3)?I:g;const e=Math.pow(10,Math.floor(pi(g))),t=g/e;return(t<=1?1:t<=2?2:t<=5?5:10)*e}function Vi(g){return!isNaN(parseFloat(g))&&isFinite(g)}function Si(g,I,e){let t,C,l;for(t=0,C=g.length;t<C;t++)l=g[t][e],isNaN(l)||(I.min=Math.min(I.min,l),I.max=Math.max(I.max,l))}function Ri(g){return g*(di/180)}function Xi(g){return g*(180/di)}function Ji(g){if(!ja(g))return;let I=1,e=0;for(;Math.round(g*I)/I!==g;)I*=10,e++;return e}function ki(g,I){const e=I.x-g.x,t=I.y-g.y,C=Math.sqrt(e*e+t*t);let l=Math.atan2(t,e);return l<-.5*di&&(l+=ri),{angle:l,distance:C}}function fi(g,I){return Math.sqrt(Math.pow(I.x-g.x,2)+Math.pow(I.y-g.y,2))}function vi(g,I){return(g-I+ui)%ri-di}function Yi(g){return(g%ri+ri)%ri}function Hi(g,I,e,t){const C=Yi(g),l=Yi(I),n=Yi(e),o=Yi(l-C),a=Yi(n-C),i=Yi(C-l),A=Yi(C-n);return C===l||C===n||t&&l===n||o>a&&i<A}function Ni(g,I,e){return Math.max(I,Math.min(e,g))}function Ki(g,I,e){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return g>=Math.min(I,e)-t&&g<=Math.max(I,e)+t}function wi(g,I,e){e=e||(e=>g[e]<I);let t,C=g.length-1,l=0;for(;C-l>1;)t=l+C>>1,e(t)?l=t:C=t;return{lo:l,hi:C}}const Fi=(g,I,e,t)=>wi(g,e,t?t=>{const C=g[t][I];return C<e||C===e&&g[t+1][I]===e}:t=>g[t][I]<e),xi=(g,I,e)=>wi(g,e,(t=>g[t][I]>=e));const zi=["push","pop","shift","splice","unshift"];function Mi(g,I){const e=g._chartjs;if(!e)return;const t=e.listeners,C=t.indexOf(I);-1!==C&&t.splice(C,1),t.length>0||(zi.forEach((I=>{delete g[I]})),delete g._chartjs)}function Ei(g){const I=new Set(g);return I.size===g.length?g:Array.from(I)}const Ui="undefined"===typeof window?function(g){return g()}:window.requestAnimationFrame;function Qi(g,I){let e=[],t=!1;return function(){for(var C=arguments.length,l=new Array(C),n=0;n<C;n++)l[n]=arguments[n];e=l,t||(t=!0,Ui.call(window,(()=>{t=!1,g.apply(I,e)})))}}const Li=g=>"start"===g?"left":"end"===g?"right":"center",Di=(g,I,e)=>"start"===g?I:"end"===g?e:(I+e)/2;function Ti(g,I,e){const t=I.length;let C=0,l=t;if(g._sorted){const{iScale:n,_parsed:o}=g,a=n.axis,{min:i,max:A,minDefined:c,maxDefined:s}=n.getUserBounds();c&&(C=Ni(Math.min(Fi(o,a,i).lo,e?t:Fi(I,a,n.getPixelForValue(i)).lo),0,t-1)),l=s?Ni(Math.max(Fi(o,n.axis,A,!0).hi+1,e?0:Fi(I,a,n.getPixelForValue(A),!0).hi+1),C,t)-C:t-C}return{start:C,count:l}}function ji(g){const{xScale:I,yScale:e,_scaleRanges:t}=g,C={xmin:I.min,xmax:I.max,ymin:e.min,ymax:e.max};if(!t)return g._scaleRanges=C,!0;const l=t.xmin!==I.min||t.xmax!==I.max||t.ymin!==e.min||t.ymax!==e.max;return Object.assign(t,C),l}const Pi=g=>0===g||1===g,Oi=(g,I,e)=>-Math.pow(2,10*(g-=1))*Math.sin((g-I)*ri/e),_i=(g,I,e)=>Math.pow(2,-10*g)*Math.sin((g-I)*ri/e)+1,qi={linear:g=>g,easeInQuad:g=>g*g,easeOutQuad:g=>-g*(g-2),easeInOutQuad:g=>(g/=.5)<1?.5*g*g:-.5*(--g*(g-2)-1),easeInCubic:g=>g*g*g,easeOutCubic:g=>(g-=1)*g*g+1,easeInOutCubic:g=>(g/=.5)<1?.5*g*g*g:.5*((g-=2)*g*g+2),easeInQuart:g=>g*g*g*g,easeOutQuart:g=>-((g-=1)*g*g*g-1),easeInOutQuart:g=>(g/=.5)<1?.5*g*g*g*g:-.5*((g-=2)*g*g*g-2),easeInQuint:g=>g*g*g*g*g,easeOutQuint:g=>(g-=1)*g*g*g*g+1,easeInOutQuint:g=>(g/=.5)<1?.5*g*g*g*g*g:.5*((g-=2)*g*g*g*g+2),easeInSine:g=>1-Math.cos(g*hi),easeOutSine:g=>Math.sin(g*hi),easeInOutSine:g=>-.5*(Math.cos(di*g)-1),easeInExpo:g=>0===g?0:Math.pow(2,10*(g-1)),easeOutExpo:g=>1===g?1:1-Math.pow(2,-10*g),easeInOutExpo:g=>Pi(g)?g:g<.5?.5*Math.pow(2,10*(2*g-1)):.5*(2-Math.pow(2,-10*(2*g-1))),easeInCirc:g=>g>=1?g:-(Math.sqrt(1-g*g)-1),easeOutCirc:g=>Math.sqrt(1-(g-=1)*g),easeInOutCirc:g=>(g/=.5)<1?-.5*(Math.sqrt(1-g*g)-1):.5*(Math.sqrt(1-(g-=2)*g)+1),easeInElastic:g=>Pi(g)?g:Oi(g,.075,.3),easeOutElastic:g=>Pi(g)?g:_i(g,.075,.3),easeInOutElastic(g){const I=.1125;return Pi(g)?g:g<.5?.5*Oi(2*g,I,.45):.5+.5*_i(2*g-1,I,.45)},easeInBack(g){const I=1.70158;return g*g*((I+1)*g-I)},easeOutBack(g){const I=1.70158;return(g-=1)*g*((I+1)*g+I)+1},easeInOutBack(g){let I=1.70158;return(g/=.5)<1?g*g*((1+(I*=1.525))*g-I)*.5:.5*((g-=2)*g*((1+(I*=1.525))*g+I)+2)},easeInBounce:g=>1-qi.easeOutBounce(1-g),easeOutBounce(g){const I=7.5625,e=2.75;return g<1/e?I*g*g:g<2/e?I*(g-=1.5/e)*g+.75:g<2.5/e?I*(g-=2.25/e)*g+.9375:I*(g-=2.625/e)*g+.984375},easeInOutBounce:g=>g<.5?.5*qi.easeInBounce(2*g):.5*qi.easeOutBounce(2*g-1)+.5};function $i(g){if(g&&"object"===typeof g){const I=g.toString();return"[object CanvasPattern]"===I||"[object CanvasGradient]"===I}return!1}function gA(g){return $i(g)?g:new Ea(g)}function IA(g){return $i(g)?g:new Ea(g).saturate(.5).darken(.1).hexString()}const eA=["x","y","borderWidth","radius","tension"],tA=["color","borderColor","backgroundColor"];const CA=new Map;function lA(g,I,e){return function(g,I){I=I||{};const e=g+JSON.stringify(I);let t=CA.get(e);return t||(t=new Intl.NumberFormat(g,I),CA.set(e,t)),t}(I,e).format(g)}const nA={values:g=>Da(g)?g:""+g,numeric(g,I,e){if(0===g)return"0";const t=this.chart.options.locale;let C,l=g;if(e.length>1){const I=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(I<1e-4||I>1e15)&&(C="scientific"),l=function(g,I){let e=I.length>3?I[2].value-I[1].value:I[1].value-I[0].value;Math.abs(e)>=1&&g!==Math.floor(g)&&(e=g-Math.floor(g));return e}(g,e)}const n=pi(Math.abs(l)),o=isNaN(n)?1:Math.max(Math.min(-1*Math.floor(n),20),0),a={notation:C,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(a,this.options.ticks.format),lA(g,t,a)},logarithmic(g,I,e){if(0===g)return"0";const t=e[I].significand||g/Math.pow(10,Math.floor(pi(g)));return[1,2,3,5,10,15].includes(t)||I>.8*e.length?nA.numeric.call(this,g,I,e):""}};var oA={formatters:nA};const aA=Object.create(null),iA=Object.create(null);function AA(g,I){if(!I)return g;const e=I.split(".");for(let t=0,C=e.length;t<C;++t){const I=e[t];g=g[I]||(g[I]=Object.create(null))}return g}function cA(g,I,e){return"string"===typeof I?Ci(AA(g,I),e):Ci(AA(g,""),I)}class sA{constructor(g,I){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=g=>g.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(g,I)=>IA(I.backgroundColor),this.hoverBorderColor=(g,I)=>IA(I.borderColor),this.hoverColor=(g,I)=>IA(I.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(g),this.apply(I)}set(g,I){return cA(this,g,I)}get(g){return AA(this,g)}describe(g,I){return cA(iA,g,I)}override(g,I){return cA(aA,g,I)}route(g,I,e,t){const C=AA(this,g),l=AA(this,e),n="_"+I;Object.defineProperties(C,{[n]:{value:C[I],writable:!0},[I]:{enumerable:!0,get(){const g=this[n],I=l[t];return Ta(g)?Object.assign({},I,g):Oa(g,I)},set(g){this[n]=g}}})}apply(g){g.forEach((g=>g(this)))}}var dA=new sA({_scriptable:g=>!g.startsWith("on"),_indexable:g=>"events"!==g,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(g){g.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),g.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:g=>"onProgress"!==g&&"onComplete"!==g&&"fn"!==g}),g.set("animations",{colors:{type:"color",properties:tA},numbers:{type:"number",properties:eA}}),g.describe("animations",{_fallback:"animation"}),g.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:g=>0|g}}}})},function(g){g.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(g){g.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(g,I)=>I.lineWidth,tickColor:(g,I)=>I.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:oA.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),g.route("scale.ticks","color","","color"),g.route("scale.grid","color","","borderColor"),g.route("scale.border","color","","borderColor"),g.route("scale.title","color","","color"),g.describe("scale",{_fallback:!1,_scriptable:g=>!g.startsWith("before")&&!g.startsWith("after")&&"callback"!==g&&"parser"!==g,_indexable:g=>"borderDash"!==g&&"tickBorderDash"!==g&&"dash"!==g}),g.describe("scales",{_fallback:"scale"}),g.describe("scale.ticks",{_scriptable:g=>"backdropPadding"!==g&&"callback"!==g,_indexable:g=>"backdropPadding"!==g})}]);function rA(g,I,e,t,C){let l=I[C];return l||(l=I[C]=g.measureText(C).width,e.push(C)),l>t&&(t=l),t}function uA(g,I,e,t){let C=(t=t||{}).data=t.data||{},l=t.garbageCollect=t.garbageCollect||[];t.font!==I&&(C=t.data={},l=t.garbageCollect=[],t.font=I),g.save(),g.font=I;let n=0;const o=e.length;let a,i,A,c,s;for(a=0;a<o;a++)if(c=e[a],void 0===c||null===c||Da(c)){if(Da(c))for(i=0,A=c.length;i<A;i++)s=c[i],void 0===s||null===s||Da(s)||(n=rA(g,C,l,n,s))}else n=rA(g,C,l,n,c);g.restore();const d=l.length/2;if(d>e.length){for(a=0;a<d;a++)delete C[l[a]];l.splice(0,d)}return n}function bA(g,I,e){const t=g.currentDevicePixelRatio,C=0!==e?Math.max(e/2,.5):0;return Math.round((I-C)*t)/t+C}function mA(g,I){(I||g)&&((I=I||g.getContext("2d")).save(),I.resetTransform(),I.clearRect(0,0,g.width,g.height),I.restore())}function hA(g,I,e,t){ZA(g,I,e,t,null)}function ZA(g,I,e,t,C){let l,n,o,a,i,A,c,s;const d=I.pointStyle,r=I.rotation,u=I.radius;let b=(r||0)*mi;if(d&&"object"===typeof d&&(l=d.toString(),"[object HTMLImageElement]"===l||"[object HTMLCanvasElement]"===l))return g.save(),g.translate(e,t),g.rotate(b),g.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),void g.restore();if(!(isNaN(u)||u<=0)){switch(g.beginPath(),d){default:C?g.ellipse(e,t,C/2,u,0,0,ri):g.arc(e,t,u,0,ri),g.closePath();break;case"triangle":A=C?C/2:u,g.moveTo(e+Math.sin(b)*A,t-Math.cos(b)*u),b+=Gi,g.lineTo(e+Math.sin(b)*A,t-Math.cos(b)*u),b+=Gi,g.lineTo(e+Math.sin(b)*A,t-Math.cos(b)*u),g.closePath();break;case"rectRounded":i=.516*u,a=u-i,n=Math.cos(b+Zi)*a,c=Math.cos(b+Zi)*(C?C/2-i:a),o=Math.sin(b+Zi)*a,s=Math.sin(b+Zi)*(C?C/2-i:a),g.arc(e-c,t-o,i,b-di,b-hi),g.arc(e+s,t-n,i,b-hi,b),g.arc(e+c,t+o,i,b,b+hi),g.arc(e-s,t+n,i,b+hi,b+di),g.closePath();break;case"rect":if(!r){a=Math.SQRT1_2*u,A=C?C/2:a,g.rect(e-A,t-a,2*A,2*a);break}b+=Zi;case"rectRot":c=Math.cos(b)*(C?C/2:u),n=Math.cos(b)*u,o=Math.sin(b)*u,s=Math.sin(b)*(C?C/2:u),g.moveTo(e-c,t-o),g.lineTo(e+s,t-n),g.lineTo(e+c,t+o),g.lineTo(e-s,t+n),g.closePath();break;case"crossRot":b+=Zi;case"cross":c=Math.cos(b)*(C?C/2:u),n=Math.cos(b)*u,o=Math.sin(b)*u,s=Math.sin(b)*(C?C/2:u),g.moveTo(e-c,t-o),g.lineTo(e+c,t+o),g.moveTo(e+s,t-n),g.lineTo(e-s,t+n);break;case"star":c=Math.cos(b)*(C?C/2:u),n=Math.cos(b)*u,o=Math.sin(b)*u,s=Math.sin(b)*(C?C/2:u),g.moveTo(e-c,t-o),g.lineTo(e+c,t+o),g.moveTo(e+s,t-n),g.lineTo(e-s,t+n),b+=Zi,c=Math.cos(b)*(C?C/2:u),n=Math.cos(b)*u,o=Math.sin(b)*u,s=Math.sin(b)*(C?C/2:u),g.moveTo(e-c,t-o),g.lineTo(e+c,t+o),g.moveTo(e+s,t-n),g.lineTo(e-s,t+n);break;case"line":n=C?C/2:Math.cos(b)*u,o=Math.sin(b)*u,g.moveTo(e-n,t-o),g.lineTo(e+n,t+o);break;case"dash":g.moveTo(e,t),g.lineTo(e+Math.cos(b)*(C?C/2:u),t+Math.sin(b)*u);break;case!1:g.closePath()}g.fill(),I.borderWidth>0&&g.stroke()}}function GA(g,I,e){return e=e||.5,!I||g&&g.x>I.left-e&&g.x<I.right+e&&g.y>I.top-e&&g.y<I.bottom+e}function pA(g,I){g.save(),g.beginPath(),g.rect(I.left,I.top,I.right-I.left,I.bottom-I.top),g.clip()}function BA(g){g.restore()}function yA(g,I,e,t,C){if(!I)return g.lineTo(e.x,e.y);if("middle"===C){const t=(I.x+e.x)/2;g.lineTo(t,I.y),g.lineTo(t,e.y)}else"after"===C!==!!t?g.lineTo(I.x,e.y):g.lineTo(e.x,I.y);g.lineTo(e.x,e.y)}function WA(g,I,e,t){if(!I)return g.lineTo(e.x,e.y);g.bezierCurveTo(t?I.cp1x:I.cp2x,t?I.cp1y:I.cp2y,t?e.cp2x:e.cp1x,t?e.cp2y:e.cp1y,e.x,e.y)}function VA(g,I,e,t,C){if(C.strikethrough||C.underline){const l=g.measureText(t),n=I-l.actualBoundingBoxLeft,o=I+l.actualBoundingBoxRight,a=e-l.actualBoundingBoxAscent,i=e+l.actualBoundingBoxDescent,A=C.strikethrough?(a+i)/2:i;g.strokeStyle=g.fillStyle,g.beginPath(),g.lineWidth=C.decorationWidth||2,g.moveTo(n,A),g.lineTo(o,A),g.stroke()}}function SA(g,I){const e=g.fillStyle;g.fillStyle=I.color,g.fillRect(I.left,I.top,I.width,I.height),g.fillStyle=e}function RA(g,I,e,t,C){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const n=Da(I)?I:[I],o=l.strokeWidth>0&&""!==l.strokeColor;let a,i;for(g.save(),g.font=C.string,function(g,I){I.translation&&g.translate(I.translation[0],I.translation[1]),La(I.rotation)||g.rotate(I.rotation),I.color&&(g.fillStyle=I.color),I.textAlign&&(g.textAlign=I.textAlign),I.textBaseline&&(g.textBaseline=I.textBaseline)}(g,l),a=0;a<n.length;++a)i=n[a],l.backdrop&&SA(g,l.backdrop),o&&(l.strokeColor&&(g.strokeStyle=l.strokeColor),La(l.strokeWidth)||(g.lineWidth=l.strokeWidth),g.strokeText(i,e,t,l.maxWidth)),g.fillText(i,e,t,l.maxWidth),VA(g,e,t,i,l),t+=Number(C.lineHeight);g.restore()}function XA(g,I){const{x:e,y:t,w:C,h:l,radius:n}=I;g.arc(e+n.topLeft,t+n.topLeft,n.topLeft,1.5*di,di,!0),g.lineTo(e,t+l-n.bottomLeft),g.arc(e+n.bottomLeft,t+l-n.bottomLeft,n.bottomLeft,di,hi,!0),g.lineTo(e+C-n.bottomRight,t+l),g.arc(e+C-n.bottomRight,t+l-n.bottomRight,n.bottomRight,hi,0,!0),g.lineTo(e+C,t+n.topRight),g.arc(e+C-n.topRight,t+n.topRight,n.topRight,0,-hi,!0),g.lineTo(e+n.topLeft,t)}const JA=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,kA=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function fA(g,I){const e=(""+g).match(JA);if(!e||"normal"===e[1])return 1.2*I;switch(g=+e[2],e[3]){case"px":return g;case"%":g/=100}return I*g}const vA=g=>+g||0;function YA(g,I){const e={},t=Ta(I),C=t?Object.keys(I):I,l=Ta(g)?t?e=>Oa(g[e],g[I[e]]):I=>g[I]:()=>g;for(const n of C)e[n]=vA(l(n));return e}function HA(g){return YA(g,{top:"y",right:"x",bottom:"y",left:"x"})}function NA(g){return YA(g,["topLeft","topRight","bottomLeft","bottomRight"])}function KA(g){const I=HA(g);return I.width=I.left+I.right,I.height=I.top+I.bottom,I}function wA(g,I){g=g||{},I=I||dA.font;let e=Oa(g.size,I.size);"string"===typeof e&&(e=parseInt(e,10));let t=Oa(g.style,I.style);t&&!(""+t).match(kA)&&(console.warn('Invalid font style specified: "'+t+'"'),t=void 0);const C={family:Oa(g.family,I.family),lineHeight:fA(Oa(g.lineHeight,I.lineHeight),e),size:e,style:t,weight:Oa(g.weight,I.weight),string:""};return C.string=function(g){return!g||La(g.size)||La(g.family)?null:(g.style?g.style+" ":"")+(g.weight?g.weight+" ":"")+g.size+"px "+g.family}(C),C}function FA(g,I,e,t){let C,l,n,o=!0;for(C=0,l=g.length;C<l;++C)if(n=g[C],void 0!==n&&(void 0!==I&&"function"===typeof n&&(n=n(I),o=!1),void 0!==e&&Da(n)&&(n=n[e%n.length],o=!1),void 0!==n))return t&&!o&&(t.cacheable=!1),n}function xA(g,I){return Object.assign(Object.create(g),I)}function zA(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],e=arguments.length>3?arguments[3]:void 0,t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>g[0];const C=(arguments.length>2?arguments[2]:void 0)||g;"undefined"===typeof e&&(e=_A("_fallback",g));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:g,_rootScopes:C,_fallback:e,_getTarget:t,override:t=>zA([t,...g],I,C,e)};return new Proxy(l,{deleteProperty:(I,e)=>(delete I[e],delete I._keys,delete g[0][e],!0),get:(e,t)=>LA(e,t,(()=>function(g,I,e,t){let C;for(const l of I)if(C=_A(UA(l,g),e),"undefined"!==typeof C)return QA(g,C)?PA(e,t,g,C):C}(t,I,g,e))),getOwnPropertyDescriptor:(g,I)=>Reflect.getOwnPropertyDescriptor(g._scopes[0],I),getPrototypeOf:()=>Reflect.getPrototypeOf(g[0]),has:(g,I)=>qA(g).includes(I),ownKeys:g=>qA(g),set(g,I,e){const C=g._storage||(g._storage=t());return g[I]=C[I]=e,delete g._keys,!0}})}function MA(g,I,e,t){const C={_cacheable:!1,_proxy:g,_context:I,_subProxy:e,_stack:new Set,_descriptors:EA(g,t),setContext:I=>MA(g,I,e,t),override:C=>MA(g.override(C),I,e,t)};return new Proxy(C,{deleteProperty:(I,e)=>(delete I[e],delete g[e],!0),get:(g,I,e)=>LA(g,I,(()=>function(g,I,e){const{_proxy:t,_context:C,_subProxy:l,_descriptors:n}=g;let o=t[I];ci(o)&&n.isScriptable(I)&&(o=function(g,I,e,t){const{_proxy:C,_context:l,_subProxy:n,_stack:o}=e;if(o.has(g))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+g);o.add(g);let a=I(l,n||t);o.delete(g),QA(g,a)&&(a=PA(C._scopes,C,g,a));return a}(I,o,g,e));Da(o)&&o.length&&(o=function(g,I,e,t){const{_proxy:C,_context:l,_subProxy:n,_descriptors:o}=e;if("undefined"!==typeof l.index&&t(g))return I[l.index%I.length];if(Ta(I[0])){const e=I,t=C._scopes.filter((g=>g!==e));I=[];for(const a of e){const e=PA(t,C,g,a);I.push(MA(e,l,n&&n[g],o))}}return I}(I,o,g,n.isIndexable));QA(I,o)&&(o=MA(o,C,l&&l[I],n));return o}(g,I,e))),getOwnPropertyDescriptor:(I,e)=>I._descriptors.allKeys?Reflect.has(g,e)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(g,e),getPrototypeOf:()=>Reflect.getPrototypeOf(g),has:(I,e)=>Reflect.has(g,e),ownKeys:()=>Reflect.ownKeys(g),set:(I,e,t)=>(g[e]=t,delete I[e],!0)})}function EA(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:e=I.scriptable,_indexable:t=I.indexable,_allKeys:C=I.allKeys}=g;return{allKeys:C,scriptable:e,indexable:t,isScriptable:ci(e)?e:()=>e,isIndexable:ci(t)?t:()=>t}}const UA=(g,I)=>g?g+ii(I):I,QA=(g,I)=>Ta(I)&&"adapters"!==g&&(null===Object.getPrototypeOf(I)||I.constructor===Object);function LA(g,I,e){if(Object.prototype.hasOwnProperty.call(g,I)||"constructor"===I)return g[I];const t=e();return g[I]=t,t}function DA(g,I,e){return ci(g)?g(I,e):g}const TA=(g,I)=>!0===g?I:"string"===typeof g?ai(I,g):void 0;function jA(g,I,e,t,C){for(const l of I){const I=TA(e,l);if(I){g.add(I);const l=DA(I._fallback,e,C);if("undefined"!==typeof l&&l!==e&&l!==t)return l}else if(!1===I&&"undefined"!==typeof t&&e!==t)return null}return!1}function PA(g,I,e,t){const C=I._rootScopes,l=DA(I._fallback,e,t),n=[...g,...C],o=new Set;o.add(t);let a=OA(o,n,e,l||e,t);return null!==a&&(("undefined"===typeof l||l===e||(a=OA(o,n,l,a,t),null!==a))&&zA(Array.from(o),[""],C,l,(()=>function(g,I,e){const t=g._getTarget();I in t||(t[I]={});const C=t[I];if(Da(C)&&Ta(e))return e;return C||{}}(I,e,t))))}function OA(g,I,e,t,C){for(;e;)e=jA(g,I,e,t,C);return e}function _A(g,I){for(const e of I){if(!e)continue;const I=e[g];if("undefined"!==typeof I)return I}}function qA(g){let I=g._keys;return I||(I=g._keys=function(g){const I=new Set;for(const e of g)for(const g of Object.keys(e).filter((g=>!g.startsWith("_"))))I.add(g);return Array.from(I)}(g._scopes)),I}function $A(g,I,e,t){const{iScale:C}=g,{key:l="r"}=this._parsing,n=new Array(t);let o,a,i,A;for(o=0,a=t;o<a;++o)i=o+e,A=I[i],n[o]={r:C.parse(ai(A,l),i)};return n}const gc=Number.EPSILON||1e-14,Ic=(g,I)=>I<g.length&&!g[I].skip&&g[I],ec=g=>"x"===g?"y":"x";function tc(g,I,e,t){const C=g.skip?I:g,l=I,n=e.skip?I:e,o=fi(l,C),a=fi(n,l);let i=o/(o+a),A=a/(o+a);i=isNaN(i)?0:i,A=isNaN(A)?0:A;const c=t*i,s=t*A;return{previous:{x:l.x-c*(n.x-C.x),y:l.y-c*(n.y-C.y)},next:{x:l.x+s*(n.x-C.x),y:l.y+s*(n.y-C.y)}}}function Cc(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const e=ec(I),t=g.length,C=Array(t).fill(0),l=Array(t);let n,o,a,i=Ic(g,0);for(n=0;n<t;++n)if(o=a,a=i,i=Ic(g,n+1),a){if(i){const g=i[I]-a[I];C[n]=0!==g?(i[e]-a[e])/g:0}l[n]=o?i?Bi(C[n-1])!==Bi(C[n])?0:(C[n-1]+C[n])/2:C[n-1]:C[n]}!function(g,I,e){const t=g.length;let C,l,n,o,a,i=Ic(g,0);for(let A=0;A<t-1;++A)a=i,i=Ic(g,A+1),a&&i&&(yi(I[A],0,gc)?e[A]=e[A+1]=0:(C=e[A]/I[A],l=e[A+1]/I[A],o=Math.pow(C,2)+Math.pow(l,2),o<=9||(n=3/Math.sqrt(o),e[A]=C*n*I[A],e[A+1]=l*n*I[A])))}(g,C,l),function(g,I){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const t=ec(e),C=g.length;let l,n,o,a=Ic(g,0);for(let i=0;i<C;++i){if(n=o,o=a,a=Ic(g,i+1),!o)continue;const C=o[e],A=o[t];n&&(l=(C-n[e])/3,o["cp1".concat(e)]=C-l,o["cp1".concat(t)]=A-l*I[i]),a&&(l=(a[e]-C)/3,o["cp2".concat(e)]=C+l,o["cp2".concat(t)]=A+l*I[i])}}(g,l,I)}function lc(g,I,e){return Math.max(Math.min(g,e),I)}function nc(g,I,e,t,C){let l,n,o,a;if(I.spanGaps&&(g=g.filter((g=>!g.skip))),"monotone"===I.cubicInterpolationMode)Cc(g,C);else{let e=t?g[g.length-1]:g[0];for(l=0,n=g.length;l<n;++l)o=g[l],a=tc(e,o,g[Math.min(l+1,n-(t?0:1))%n],I.tension),o.cp1x=a.previous.x,o.cp1y=a.previous.y,o.cp2x=a.next.x,o.cp2y=a.next.y,e=o}I.capBezierPoints&&function(g,I){let e,t,C,l,n,o=GA(g[0],I);for(e=0,t=g.length;e<t;++e)n=l,l=o,o=e<t-1&&GA(g[e+1],I),l&&(C=g[e],n&&(C.cp1x=lc(C.cp1x,I.left,I.right),C.cp1y=lc(C.cp1y,I.top,I.bottom)),o&&(C.cp2x=lc(C.cp2x,I.left,I.right),C.cp2y=lc(C.cp2y,I.top,I.bottom)))}(g,e)}function oc(){return"undefined"!==typeof window&&"undefined"!==typeof document}function ac(g){let I=g.parentNode;return I&&"[object ShadowRoot]"===I.toString()&&(I=I.host),I}function ic(g,I,e){let t;return"string"===typeof g?(t=parseInt(g,10),-1!==g.indexOf("%")&&(t=t/100*I.parentNode[e])):t=g,t}const Ac=g=>g.ownerDocument.defaultView.getComputedStyle(g,null);const cc=["top","right","bottom","left"];function sc(g,I,e){const t={};e=e?"-"+e:"";for(let C=0;C<4;C++){const l=cc[C];t[l]=parseFloat(g[I+"-"+l+e])||0}return t.width=t.left+t.right,t.height=t.top+t.bottom,t}const dc=(g,I,e)=>(g>0||I>0)&&(!e||!e.shadowRoot);function rc(g,I){if("native"in g)return g;const{canvas:e,currentDevicePixelRatio:t}=I,C=Ac(e),l="border-box"===C.boxSizing,n=sc(C,"padding"),o=sc(C,"border","width"),{x:a,y:i,box:A}=function(g,I){const e=g.touches,t=e&&e.length?e[0]:g,{offsetX:C,offsetY:l}=t;let n,o,a=!1;if(dc(C,l,g.target))n=C,o=l;else{const g=I.getBoundingClientRect();n=t.clientX-g.left,o=t.clientY-g.top,a=!0}return{x:n,y:o,box:a}}(g,e),c=n.left+(A&&o.left),s=n.top+(A&&o.top);let{width:d,height:r}=I;return l&&(d-=n.width+o.width,r-=n.height+o.height),{x:Math.round((a-c)/d*e.width/t),y:Math.round((i-s)/r*e.height/t)}}const uc=g=>Math.round(10*g)/10;function bc(g,I,e,t){const C=Ac(g),l=sc(C,"margin"),n=ic(C.maxWidth,g,"clientWidth")||bi,o=ic(C.maxHeight,g,"clientHeight")||bi,a=function(g,I,e){let t,C;if(void 0===I||void 0===e){const l=g&&ac(g);if(l){const g=l.getBoundingClientRect(),n=Ac(l),o=sc(n,"border","width"),a=sc(n,"padding");I=g.width-a.width-o.width,e=g.height-a.height-o.height,t=ic(n.maxWidth,l,"clientWidth"),C=ic(n.maxHeight,l,"clientHeight")}else I=g.clientWidth,e=g.clientHeight}return{width:I,height:e,maxWidth:t||bi,maxHeight:C||bi}}(g,I,e);let{width:i,height:A}=a;if("content-box"===C.boxSizing){const g=sc(C,"border","width"),I=sc(C,"padding");i-=I.width+g.width,A-=I.height+g.height}i=Math.max(0,i-l.width),A=Math.max(0,t?i/t:A-l.height),i=uc(Math.min(i,n,a.maxWidth)),A=uc(Math.min(A,o,a.maxHeight)),i&&!A&&(A=uc(i/2));return(void 0!==I||void 0!==e)&&t&&a.height&&A>a.height&&(A=a.height,i=uc(Math.floor(A*t))),{width:i,height:A}}function mc(g,I,e){const t=I||1,C=Math.floor(g.height*t),l=Math.floor(g.width*t);g.height=Math.floor(g.height),g.width=Math.floor(g.width);const n=g.canvas;return n.style&&(e||!n.style.height&&!n.style.width)&&(n.style.height="".concat(g.height,"px"),n.style.width="".concat(g.width,"px")),(g.currentDevicePixelRatio!==t||n.height!==C||n.width!==l)&&(g.currentDevicePixelRatio=t,n.height=C,n.width=l,g.ctx.setTransform(t,0,0,t,0,0),!0)}const hc=function(){let g=!1;try{const I={get passive(){return g=!0,!1}};oc()&&(window.addEventListener("test",null,I),window.removeEventListener("test",null,I))}catch(xG){}return g}();function Zc(g,I){const e=function(g,I){return Ac(g).getPropertyValue(I)}(g,I),t=e&&e.match(/^(\d+)(\.\d+)?px$/);return t?+t[1]:void 0}function Gc(g,I,e,t){return{x:g.x+e*(I.x-g.x),y:g.y+e*(I.y-g.y)}}function pc(g,I,e,t){return{x:g.x+e*(I.x-g.x),y:"middle"===t?e<.5?g.y:I.y:"after"===t?e<1?g.y:I.y:e>0?I.y:g.y}}function Bc(g,I,e,t){const C={x:g.cp2x,y:g.cp2y},l={x:I.cp1x,y:I.cp1y},n=Gc(g,C,e),o=Gc(C,l,e),a=Gc(l,I,e),i=Gc(n,o,e),A=Gc(o,a,e);return Gc(i,A,e)}function yc(g,I,e){return g?function(g,I){return{x:e=>g+g+I-e,setWidth(g){I=g},textAlign:g=>"center"===g?g:"right"===g?"left":"right",xPlus:(g,I)=>g-I,leftForLtr:(g,I)=>g-I}}(I,e):{x:g=>g,setWidth(g){},textAlign:g=>g,xPlus:(g,I)=>g+I,leftForLtr:(g,I)=>g}}function Wc(g,I){let e,t;"ltr"!==I&&"rtl"!==I||(e=g.canvas.style,t=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",I,"important"),g.prevTextDirection=t)}function Vc(g,I){void 0!==I&&(delete g.prevTextDirection,g.canvas.style.setProperty("direction",I[0],I[1]))}function Sc(g){return"angle"===g?{between:Hi,compare:vi,normalize:Yi}:{between:Ki,compare:(g,I)=>g-I,normalize:g=>g}}function Rc(g){let{start:I,end:e,count:t,loop:C,style:l}=g;return{start:I%t,end:e%t,loop:C&&(e-I+1)%t===0,style:l}}function Xc(g,I,e){if(!e)return[g];const{property:t,start:C,end:l}=e,n=I.length,{compare:o,between:a,normalize:i}=Sc(t),{start:A,end:c,loop:s,style:d}=function(g,I,e){const{property:t,start:C,end:l}=e,{between:n,normalize:o}=Sc(t),a=I.length;let i,A,{start:c,end:s,loop:d}=g;if(d){for(c+=a,s+=a,i=0,A=a;i<A&&n(o(I[c%a][t]),C,l);++i)c--,s--;c%=a,s%=a}return s<c&&(s+=a),{start:c,end:s,loop:d,style:g.style}}(g,I,e),r=[];let u,b,m,h=!1,Z=null;const G=()=>h||a(C,m,u)&&0!==o(C,m),p=()=>!h||0===o(l,u)||a(l,m,u);for(let B=A,y=A;B<=c;++B)b=I[B%n],b.skip||(u=i(b[t]),u!==m&&(h=a(u,C,l),null===Z&&G()&&(Z=0===o(u,C)?B:y),null!==Z&&p()&&(r.push(Rc({start:Z,end:B,loop:s,count:n,style:d})),Z=null),y=B,m=u));return null!==Z&&r.push(Rc({start:Z,end:c,loop:s,count:n,style:d})),r}function Jc(g,I){const e=[],t=g.segments;for(let C=0;C<t.length;C++){const l=Xc(t[C],g.points,I);l.length&&e.push(...l)}return e}function kc(g,I,e,t){return t&&t.setContext&&e?function(g,I,e,t){const C=g._chart.getContext(),l=fc(g.options),{_datasetIndex:n,options:{spanGaps:o}}=g,a=e.length,i=[];let A=l,c=I[0].start,s=c;function d(g,I,t,C){const l=o?-1:1;if(g!==I){for(g+=a;e[g%a].skip;)g-=l;for(;e[I%a].skip;)I+=l;g%a!==I%a&&(i.push({start:g%a,end:I%a,loop:t,style:C}),A=C,c=I%a)}}for(const r of I){c=o?c:r.start;let g,I=e[c%a];for(s=c+1;s<=r.end;s++){const l=e[s%a];g=fc(t.setContext(xA(C,{type:"segment",p0:I,p1:l,p0DataIndex:(s-1)%a,p1DataIndex:s%a,datasetIndex:n}))),vc(g,A)&&d(c,s-1,r.loop,A),I=l,A=g}c<s-1&&d(c,s-1,r.loop,A)}return i}(g,I,e,t):I}function fc(g){return{backgroundColor:g.backgroundColor,borderCapStyle:g.borderCapStyle,borderDash:g.borderDash,borderDashOffset:g.borderDashOffset,borderJoinStyle:g.borderJoinStyle,borderWidth:g.borderWidth,borderColor:g.borderColor}}function vc(g,I){if(!I)return!1;const e=[],t=function(g,I){return $i(I)?(e.includes(I)||e.push(I),e.indexOf(I)):I};return JSON.stringify(g,t)!==JSON.stringify(I,t)}class Yc{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(g,I,e,t){const C=I.listeners[t],l=I.duration;C.forEach((t=>t({chart:g,initial:I.initial,numSteps:l,currentStep:Math.min(e-I.start,l)})))}_refresh(){this._request||(this._running=!0,this._request=Ui.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),I=0;this._charts.forEach(((e,t)=>{if(!e.running||!e.items.length)return;const C=e.items;let l,n=C.length-1,o=!1;for(;n>=0;--n)l=C[n],l._active?(l._total>e.duration&&(e.duration=l._total),l.tick(g),o=!0):(C[n]=C[C.length-1],C.pop());o&&(t.draw(),this._notify(t,e,g,"progress")),C.length||(e.running=!1,this._notify(t,e,g,"complete"),e.initial=!1),I+=C.length})),this._lastDate=g,0===I&&(this._running=!1)}_getAnims(g){const I=this._charts;let e=I.get(g);return e||(e={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},I.set(g,e)),e}listen(g,I,e){this._getAnims(g).listeners[I].push(e)}add(g,I){I&&I.length&&this._getAnims(g).items.push(...I)}has(g){return this._getAnims(g).items.length>0}start(g){const I=this._charts.get(g);I&&(I.running=!0,I.start=Date.now(),I.duration=I.items.reduce(((g,I)=>Math.max(g,I._duration)),0),this._refresh())}running(g){if(!this._running)return!1;const I=this._charts.get(g);return!!(I&&I.running&&I.items.length)}stop(g){const I=this._charts.get(g);if(!I||!I.items.length)return;const e=I.items;let t=e.length-1;for(;t>=0;--t)e[t].cancel();I.items=[],this._notify(g,I,Date.now(),"complete")}remove(g){return this._charts.delete(g)}}var Hc=new Yc;const Nc="transparent",Kc={boolean:(g,I,e)=>e>.5?I:g,color(g,I,e){const t=gA(g||Nc),C=t.valid&&gA(I||Nc);return C&&C.valid?C.mix(t,e).hexString():I},number:(g,I,e)=>g+(I-g)*e};class wc{constructor(g,I,e,t){const C=I[e];t=FA([g.to,t,C,g.from]);const l=FA([g.from,C,t]);this._active=!0,this._fn=g.fn||Kc[g.type||typeof l],this._easing=qi[g.easing]||qi.linear,this._start=Math.floor(Date.now()+(g.delay||0)),this._duration=this._total=Math.floor(g.duration),this._loop=!!g.loop,this._target=I,this._prop=e,this._from=l,this._to=t,this._promises=void 0}active(){return this._active}update(g,I,e){if(this._active){this._notify(!1);const t=this._target[this._prop],C=e-this._start,l=this._duration-C;this._start=e,this._duration=Math.floor(Math.max(l,g.duration)),this._total+=C,this._loop=!!g.loop,this._to=FA([g.to,I,t,g.from]),this._from=FA([g.from,t,I])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(g){const I=g-this._start,e=this._duration,t=this._prop,C=this._from,l=this._loop,n=this._to;let o;if(this._active=C!==n&&(l||I<e),!this._active)return this._target[t]=n,void this._notify(!0);I<0?this._target[t]=C:(o=I/e%2,o=l&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[t]=this._fn(C,n,o))}wait(){const g=this._promises||(this._promises=[]);return new Promise(((I,e)=>{g.push({res:I,rej:e})}))}_notify(g){const I=g?"res":"rej",e=this._promises||[];for(let t=0;t<e.length;t++)e[t][I]()}}class Fc{constructor(g,I){this._chart=g,this._properties=new Map,this.configure(I)}configure(g){if(!Ta(g))return;const I=Object.keys(dA.animation),e=this._properties;Object.getOwnPropertyNames(g).forEach((t=>{const C=g[t];if(!Ta(C))return;const l={};for(const g of I)l[g]=C[g];(Da(C.properties)&&C.properties||[t]).forEach((g=>{g!==t&&e.has(g)||e.set(g,l)}))}))}_animateOptions(g,I){const e=I.options,t=function(g,I){if(!I)return;let e=g.options;if(!e)return void(g.options=I);e.$shared&&(g.options=e=Object.assign({},e,{$shared:!1,$animations:{}}));return e}(g,e);if(!t)return[];const C=this._createAnimations(t,e);return e.$shared&&function(g,I){const e=[],t=Object.keys(I);for(let C=0;C<t.length;C++){const I=g[t[C]];I&&I.active()&&e.push(I.wait())}return Promise.all(e)}(g.options.$animations,e).then((()=>{g.options=e}),(()=>{})),C}_createAnimations(g,I){const e=this._properties,t=[],C=g.$animations||(g.$animations={}),l=Object.keys(I),n=Date.now();let o;for(o=l.length-1;o>=0;--o){const a=l[o];if("$"===a.charAt(0))continue;if("options"===a){t.push(...this._animateOptions(g,I));continue}const i=I[a];let A=C[a];const c=e.get(a);if(A){if(c&&A.active()){A.update(c,i,n);continue}A.cancel()}c&&c.duration?(C[a]=A=new wc(c,g,a,i),t.push(A)):g[a]=i}return t}update(g,I){if(0===this._properties.size)return void Object.assign(g,I);const e=this._createAnimations(g,I);return e.length?(Hc.add(this._chart,e),!0):void 0}}function xc(g,I){const e=g&&g.options||{},t=e.reverse,C=void 0===e.min?I:0,l=void 0===e.max?I:0;return{start:t?l:C,end:t?C:l}}function zc(g,I){const e=[],t=g._getSortedDatasetMetas(I);let C,l;for(C=0,l=t.length;C<l;++C)e.push(t[C].index);return e}function Mc(g,I,e){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const C=g.keys,l="single"===t.mode;let n,o,a,i;if(null!==I){for(n=0,o=C.length;n<o;++n){if(a=+C[n],a===e){if(t.all)continue;break}i=g.values[a],ja(i)&&(l||0===I||Bi(I)===Bi(i))&&(I+=i)}return I}}function Ec(g,I){const e=g&&g.options.stacked;return e||void 0===e&&void 0!==I.stack}function Uc(g,I,e){const t=g[I]||(g[I]={});return t[e]||(t[e]={})}function Qc(g,I,e,t){for(const C of I.getMatchingVisibleMetas(t).reverse()){const I=g[C.index];if(e&&I>0||!e&&I<0)return C.index}return null}function Lc(g,I){const{chart:e,_cachedMeta:t}=g,C=e._stacks||(e._stacks={}),{iScale:l,vScale:n,index:o}=t,a=l.axis,i=n.axis,A=function(g,I,e){return"".concat(g.id,".").concat(I.id,".").concat(e.stack||e.type)}(l,n,t),c=I.length;let s;for(let d=0;d<c;++d){const g=I[d],{[a]:e,[i]:l}=g;s=(g._stacks||(g._stacks={}))[i]=Uc(C,A,e),s[o]=l,s._top=Qc(s,n,!0,t.type),s._bottom=Qc(s,n,!1,t.type);(s._visualValues||(s._visualValues={}))[o]=l}}function Dc(g,I){const e=g.scales;return Object.keys(e).filter((g=>e[g].axis===I)).shift()}function Tc(g,I){const e=g.controller.index,t=g.vScale&&g.vScale.axis;if(t){I=I||g._parsed;for(const g of I){const I=g._stacks;if(!I||void 0===I[t]||void 0===I[t][e])return;delete I[t][e],void 0!==I[t]._visualValues&&void 0!==I[t]._visualValues[e]&&delete I[t]._visualValues[e]}}}const jc=g=>"reset"===g||"none"===g,Pc=(g,I)=>I?g:Object.assign({},g);class Oc{constructor(g,I){this.chart=g,this._ctx=g.ctx,this.index=I,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const g=this._cachedMeta;this.configure(),this.linkScales(),g._stacked=Ec(g.vScale,g),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(g){this.index!==g&&Tc(this._cachedMeta),this.index=g}linkScales(){const g=this.chart,I=this._cachedMeta,e=this.getDataset(),t=(g,I,e,t)=>"x"===g?I:"r"===g?t:e,C=I.xAxisID=Oa(e.xAxisID,Dc(g,"x")),l=I.yAxisID=Oa(e.yAxisID,Dc(g,"y")),n=I.rAxisID=Oa(e.rAxisID,Dc(g,"r")),o=I.indexAxis,a=I.iAxisID=t(o,C,l,n),i=I.vAxisID=t(o,l,C,n);I.xScale=this.getScaleForId(C),I.yScale=this.getScaleForId(l),I.rScale=this.getScaleForId(n),I.iScale=this.getScaleForId(a),I.vScale=this.getScaleForId(i)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(g){return this.chart.scales[g]}_getOtherScale(g){const I=this._cachedMeta;return g===I.iScale?I.vScale:I.iScale}reset(){this._update("reset")}_destroy(){const g=this._cachedMeta;this._data&&Mi(this._data,this),g._stacked&&Tc(g)}_dataCheck(){const g=this.getDataset(),I=g.data||(g.data=[]),e=this._data;if(Ta(I)){const g=this._cachedMeta;this._data=function(g,I){const{iScale:e,vScale:t}=I,C="x"===e.axis?"x":"y",l="x"===t.axis?"x":"y",n=Object.keys(g),o=new Array(n.length);let a,i,A;for(a=0,i=n.length;a<i;++a)A=n[a],o[a]={[C]:A,[l]:g[A]};return o}(I,g)}else if(e!==I){if(e){Mi(e,this);const g=this._cachedMeta;Tc(g),g._parsed=[]}I&&Object.isExtensible(I)&&(C=this,(t=I)._chartjs?t._chartjs.listeners.push(C):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[C]}}),zi.forEach((g=>{const I="_onData"+ii(g),e=t[g];Object.defineProperty(t,g,{configurable:!0,enumerable:!1,value(){for(var g=arguments.length,C=new Array(g),l=0;l<g;l++)C[l]=arguments[l];const n=e.apply(this,C);return t._chartjs.listeners.forEach((g=>{"function"===typeof g[I]&&g[I](...C)})),n}})})))),this._syncList=[],this._data=I}var t,C}addElements(){const g=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(g.dataset=new this.datasetElementType)}buildOrUpdateElements(g){const I=this._cachedMeta,e=this.getDataset();let t=!1;this._dataCheck();const C=I._stacked;I._stacked=Ec(I.vScale,I),I.stack!==e.stack&&(t=!0,Tc(I),I.stack=e.stack),this._resyncElements(g),(t||C!==I._stacked)&&Lc(this,I._parsed)}configure(){const g=this.chart.config,I=g.datasetScopeKeys(this._type),e=g.getOptionScopes(this.getDataset(),I,!0);this.options=g.createResolver(e,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(g,I){const{_cachedMeta:e,_data:t}=this,{iScale:C,_stacked:l}=e,n=C.axis;let o,a,i,A=0===g&&I===t.length||e._sorted,c=g>0&&e._parsed[g-1];if(!1===this._parsing)e._parsed=t,e._sorted=!0,i=t;else{i=Da(t[g])?this.parseArrayData(e,t,g,I):Ta(t[g])?this.parseObjectData(e,t,g,I):this.parsePrimitiveData(e,t,g,I);const C=()=>null===a[n]||c&&a[n]<c[n];for(o=0;o<I;++o)e._parsed[o+g]=a=i[o],A&&(C()&&(A=!1),c=a);e._sorted=A}l&&Lc(this,i)}parsePrimitiveData(g,I,e,t){const{iScale:C,vScale:l}=g,n=C.axis,o=l.axis,a=C.getLabels(),i=C===l,A=new Array(t);let c,s,d;for(c=0,s=t;c<s;++c)d=c+e,A[c]={[n]:i||C.parse(a[d],d),[o]:l.parse(I[d],d)};return A}parseArrayData(g,I,e,t){const{xScale:C,yScale:l}=g,n=new Array(t);let o,a,i,A;for(o=0,a=t;o<a;++o)i=o+e,A=I[i],n[o]={x:C.parse(A[0],i),y:l.parse(A[1],i)};return n}parseObjectData(g,I,e,t){const{xScale:C,yScale:l}=g,{xAxisKey:n="x",yAxisKey:o="y"}=this._parsing,a=new Array(t);let i,A,c,s;for(i=0,A=t;i<A;++i)c=i+e,s=I[c],a[i]={x:C.parse(ai(s,n),c),y:l.parse(ai(s,o),c)};return a}getParsed(g){return this._cachedMeta._parsed[g]}getDataElement(g){return this._cachedMeta.data[g]}applyStack(g,I,e){const t=this.chart,C=this._cachedMeta,l=I[g.axis];return Mc({keys:zc(t,!0),values:I._stacks[g.axis]._visualValues},l,C.index,{mode:e})}updateRangeFromParsed(g,I,e,t){const C=e[I.axis];let l=null===C?NaN:C;const n=t&&e._stacks[I.axis];t&&n&&(t.values=n,l=Mc(t,C,this._cachedMeta.index)),g.min=Math.min(g.min,l),g.max=Math.max(g.max,l)}getMinMax(g,I){const e=this._cachedMeta,t=e._parsed,C=e._sorted&&g===e.iScale,l=t.length,n=this._getOtherScale(g),o=((g,I,e)=>g&&!I.hidden&&I._stacked&&{keys:zc(e,!0),values:null})(I,e,this.chart),a={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:i,max:A}=function(g){const{min:I,max:e,minDefined:t,maxDefined:C}=g.getUserBounds();return{min:t?I:Number.NEGATIVE_INFINITY,max:C?e:Number.POSITIVE_INFINITY}}(n);let c,s;function d(){s=t[c];const I=s[n.axis];return!ja(s[g.axis])||i>I||A<I}for(c=0;c<l&&(d()||(this.updateRangeFromParsed(a,g,s,o),!C));++c);if(C)for(c=l-1;c>=0;--c)if(!d()){this.updateRangeFromParsed(a,g,s,o);break}return a}getAllParsedValues(g){const I=this._cachedMeta._parsed,e=[];let t,C,l;for(t=0,C=I.length;t<C;++t)l=I[t][g.axis],ja(l)&&e.push(l);return e}getMaxOverflow(){return!1}getLabelAndValue(g){const I=this._cachedMeta,e=I.iScale,t=I.vScale,C=this.getParsed(g);return{label:e?""+e.getLabelForValue(C[e.axis]):"",value:t?""+t.getLabelForValue(C[t.axis]):""}}_update(g){const I=this._cachedMeta;this.update(g||"default"),I._clip=function(g){let I,e,t,C;return Ta(g)?(I=g.top,e=g.right,t=g.bottom,C=g.left):I=e=t=C=g,{top:I,right:e,bottom:t,left:C,disabled:!1===g}}(Oa(this.options.clip,function(g,I,e){if(!1===e)return!1;const t=xc(g,e),C=xc(I,e);return{top:C.end,right:t.end,bottom:C.start,left:t.start}}(I.xScale,I.yScale,this.getMaxOverflow())))}update(g){}draw(){const g=this._ctx,I=this.chart,e=this._cachedMeta,t=e.data||[],C=I.chartArea,l=[],n=this._drawStart||0,o=this._drawCount||t.length-n,a=this.options.drawActiveElementsOnTop;let i;for(e.dataset&&e.dataset.draw(g,C,n,o),i=n;i<n+o;++i){const I=t[i];I.hidden||(I.active&&a?l.push(I):I.draw(g,C))}for(i=0;i<l.length;++i)l[i].draw(g,C)}getStyle(g,I){const e=I?"active":"default";return void 0===g&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(e):this.resolveDataElementOptions(g||0,e)}getContext(g,I,e){const t=this.getDataset();let C;if(g>=0&&g<this._cachedMeta.data.length){const I=this._cachedMeta.data[g];C=I.$context||(I.$context=function(g,I,e){return xA(g,{active:!1,dataIndex:I,parsed:void 0,raw:void 0,element:e,index:I,mode:"default",type:"data"})}(this.getContext(),g,I)),C.parsed=this.getParsed(g),C.raw=t.data[g],C.index=C.dataIndex=g}else C=this.$context||(this.$context=function(g,I){return xA(g,{active:!1,dataset:void 0,datasetIndex:I,index:I,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),C.dataset=t,C.index=C.datasetIndex=this.index;return C.active=!!I,C.mode=e,C}resolveDatasetElementOptions(g){return this._resolveElementOptions(this.datasetElementType.id,g)}resolveDataElementOptions(g,I){return this._resolveElementOptions(this.dataElementType.id,I,g)}_resolveElementOptions(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",e=arguments.length>2?arguments[2]:void 0;const t="active"===I,C=this._cachedDataOpts,l=g+"-"+I,n=C[l],o=this.enableOptionSharing&&Ai(e);if(n)return Pc(n,o);const a=this.chart.config,i=a.datasetElementScopeKeys(this._type,g),A=t?["".concat(g,"Hover"),"hover",g,""]:[g,""],c=a.getOptionScopes(this.getDataset(),i),s=Object.keys(dA.elements[g]),d=a.resolveNamedOptions(c,s,(()=>this.getContext(e,t,I)),A);return d.$shared&&(d.$shared=o,C[l]=Object.freeze(Pc(d,o))),d}_resolveAnimations(g,I,e){const t=this.chart,C=this._cachedDataOpts,l="animation-".concat(I),n=C[l];if(n)return n;let o;if(!1!==t.options.animation){const t=this.chart.config,C=t.datasetAnimationScopeKeys(this._type,I),l=t.getOptionScopes(this.getDataset(),C);o=t.createResolver(l,this.getContext(g,e,I))}const a=new Fc(t,o&&o.animations);return o&&o._cacheable&&(C[l]=Object.freeze(a)),a}getSharedOptions(g){if(g.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},g))}includeOptions(g,I){return!I||jc(g)||this.chart._animationsDisabled}_getSharedOptions(g,I){const e=this.resolveDataElementOptions(g,I),t=this._sharedOptions,C=this.getSharedOptions(e),l=this.includeOptions(I,C)||C!==t;return this.updateSharedOptions(C,I,e),{sharedOptions:C,includeOptions:l}}updateElement(g,I,e,t){jc(t)?Object.assign(g,e):this._resolveAnimations(I,t).update(g,e)}updateSharedOptions(g,I,e){g&&!jc(I)&&this._resolveAnimations(void 0,I).update(g,e)}_setStyle(g,I,e,t){g.active=t;const C=this.getStyle(I,t);this._resolveAnimations(I,e,t).update(g,{options:!t&&this.getSharedOptions(C)||C})}removeHoverStyle(g,I,e){this._setStyle(g,e,"active",!1)}setHoverStyle(g,I,e){this._setStyle(g,e,"active",!0)}_removeDatasetHoverStyle(){const g=this._cachedMeta.dataset;g&&this._setStyle(g,void 0,"active",!1)}_setDatasetHoverStyle(){const g=this._cachedMeta.dataset;g&&this._setStyle(g,void 0,"active",!0)}_resyncElements(g){const I=this._data,e=this._cachedMeta.data;for(const[n,o,a]of this._syncList)this[n](o,a);this._syncList=[];const t=e.length,C=I.length,l=Math.min(C,t);l&&this.parse(0,l),C>t?this._insertElements(t,C-t,g):C<t&&this._removeElements(C,t-C)}_insertElements(g,I){let e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const t=this._cachedMeta,C=t.data,l=g+I;let n;const o=g=>{for(g.length+=I,n=g.length-1;n>=l;n--)g[n]=g[n-I]};for(o(C),n=g;n<l;++n)C[n]=new this.dataElementType;this._parsing&&o(t._parsed),this.parse(g,I),e&&this.updateElements(C,g,I,"reset")}updateElements(g,I,e,t){}_removeElements(g,I){const e=this._cachedMeta;if(this._parsing){const t=e._parsed.splice(g,I);e._stacked&&Tc(e,t)}e.data.splice(g,I)}_sync(g){if(this._parsing)this._syncList.push(g);else{const[I,e,t]=g;this[I](e,t)}this.chart._dataChanges.push([this.index,...g])}_onDataPush(){const g=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-g,g])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(g,I){I&&this._sync(["_removeElements",g,I]);const e=arguments.length-2;e&&this._sync(["_insertElements",g,e])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function _c(g){const I=g.iScale,e=function(g,I){if(!g._cache.$bar){const e=g.getMatchingVisibleMetas(I);let t=[];for(let I=0,C=e.length;I<C;I++)t=t.concat(e[I].controller.getAllParsedValues(g));g._cache.$bar=Ei(t.sort(((g,I)=>g-I)))}return g._cache.$bar}(I,g.type);let t,C,l,n,o=I._length;const a=()=>{32767!==l&&-32768!==l&&(Ai(n)&&(o=Math.min(o,Math.abs(l-n)||o)),n=l)};for(t=0,C=e.length;t<C;++t)l=I.getPixelForValue(e[t]),a();for(n=void 0,t=0,C=I.ticks.length;t<C;++t)l=I.getPixelForTick(t),a();return o}function qc(g,I,e,t){return Da(g)?function(g,I,e,t){const C=e.parse(g[0],t),l=e.parse(g[1],t),n=Math.min(C,l),o=Math.max(C,l);let a=n,i=o;Math.abs(n)>Math.abs(o)&&(a=o,i=n),I[e.axis]=i,I._custom={barStart:a,barEnd:i,start:C,end:l,min:n,max:o}}(g,I,e,t):I[e.axis]=e.parse(g,t),I}function $c(g,I,e,t){const C=g.iScale,l=g.vScale,n=C.getLabels(),o=C===l,a=[];let i,A,c,s;for(i=e,A=e+t;i<A;++i)s=I[i],c={},c[C.axis]=o||C.parse(n[i],i),a.push(qc(s,c,l,i));return a}function gs(g){return g&&void 0!==g.barStart&&void 0!==g.barEnd}function Is(g,I,e,t){let C=I.borderSkipped;const l={};if(!C)return void(g.borderSkipped=l);if(!0===C)return void(g.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:n,end:o,reverse:a,top:i,bottom:A}=function(g){let I,e,t,C,l;return g.horizontal?(I=g.base>g.x,e="left",t="right"):(I=g.base<g.y,e="bottom",t="top"),I?(C="end",l="start"):(C="start",l="end"),{start:e,end:t,reverse:I,top:C,bottom:l}}(g);"middle"===C&&e&&(g.enableBorderRadius=!0,(e._top||0)===t?C=i:(e._bottom||0)===t?C=A:(l[es(A,n,o,a)]=!0,C=i)),l[es(C,n,o,a)]=!0,g.borderSkipped=l}function es(g,I,e,t){var C,l,n;return t?(n=e,g=ts(g=(C=g)===(l=I)?n:C===n?l:C,e,I)):g=ts(g,I,e),g}function ts(g,I,e){return"start"===g?I:"end"===g?e:g}function Cs(g,I,e){let{inflateAmount:t}=I;g.inflateAmount="auto"===t?1===e?.33:0:t}ia(Oc,"defaults",{}),ia(Oc,"datasetElementType",null),ia(Oc,"dataElementType",null);class ls extends Oc{parsePrimitiveData(g,I,e,t){return $c(g,I,e,t)}parseArrayData(g,I,e,t){return $c(g,I,e,t)}parseObjectData(g,I,e,t){const{iScale:C,vScale:l}=g,{xAxisKey:n="x",yAxisKey:o="y"}=this._parsing,a="x"===C.axis?n:o,i="x"===l.axis?n:o,A=[];let c,s,d,r;for(c=e,s=e+t;c<s;++c)r=I[c],d={},d[C.axis]=C.parse(ai(r,a),c),A.push(qc(ai(r,i),d,l,c));return A}updateRangeFromParsed(g,I,e,t){super.updateRangeFromParsed(g,I,e,t);const C=e._custom;C&&I===this._cachedMeta.vScale&&(g.min=Math.min(g.min,C.min),g.max=Math.max(g.max,C.max))}getMaxOverflow(){return 0}getLabelAndValue(g){const I=this._cachedMeta,{iScale:e,vScale:t}=I,C=this.getParsed(g),l=C._custom,n=gs(l)?"["+l.start+", "+l.end+"]":""+t.getLabelForValue(C[t.axis]);return{label:""+e.getLabelForValue(C[e.axis]),value:n}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(g){const I=this._cachedMeta;this.updateElements(I.data,0,I.data.length,g)}updateElements(g,I,e,t){const C="reset"===t,{index:l,_cachedMeta:{vScale:n}}=this,o=n.getBasePixel(),a=n.isHorizontal(),i=this._getRuler(),{sharedOptions:A,includeOptions:c}=this._getSharedOptions(I,t);for(let s=I;s<I+e;s++){const I=this.getParsed(s),e=C||La(I[n.axis])?{base:o,head:o}:this._calculateBarValuePixels(s),d=this._calculateBarIndexPixels(s,i),r=(I._stacks||{})[n.axis],u={horizontal:a,base:e.base,enableBorderRadius:!r||gs(I._custom)||l===r._top||l===r._bottom,x:a?e.head:d.center,y:a?d.center:e.head,height:a?d.size:Math.abs(e.size),width:a?Math.abs(e.size):d.size};c&&(u.options=A||this.resolveDataElementOptions(s,g[s].active?"active":t));const b=u.options||g[s].options;Is(u,b,r,l),Cs(u,b,i.ratio),this.updateElement(g[s],s,u,t)}}_getStacks(g,I){const{iScale:e}=this._cachedMeta,t=e.getMatchingVisibleMetas(this._type).filter((g=>g.controller.options.grouped)),C=e.options.stacked,l=[],n=g=>{const e=g.controller.getParsed(I),t=e&&e[g.vScale.axis];if(La(t)||isNaN(t))return!0};for(const o of t)if((void 0===I||!n(o))&&((!1===C||-1===l.indexOf(o.stack)||void 0===C&&void 0===o.stack)&&l.push(o.stack),o.index===g))break;return l.length||l.push(void 0),l}_getStackCount(g){return this._getStacks(void 0,g).length}_getStackIndex(g,I,e){const t=this._getStacks(g,e),C=void 0!==I?t.indexOf(I):-1;return-1===C?t.length-1:C}_getRuler(){const g=this.options,I=this._cachedMeta,e=I.iScale,t=[];let C,l;for(C=0,l=I.data.length;C<l;++C)t.push(e.getPixelForValue(this.getParsed(C)[e.axis],C));const n=g.barThickness;return{min:n||_c(I),pixels:t,start:e._startPixel,end:e._endPixel,stackCount:this._getStackCount(),scale:e,grouped:g.grouped,ratio:n?1:g.categoryPercentage*g.barPercentage}}_calculateBarValuePixels(g){const{_cachedMeta:{vScale:I,_stacked:e,index:t},options:{base:C,minBarLength:l}}=this,n=C||0,o=this.getParsed(g),a=o._custom,i=gs(a);let A,c,s=o[I.axis],d=0,r=e?this.applyStack(I,o,e):s;r!==s&&(d=r-s,r=s),i&&(s=a.barStart,r=a.barEnd-a.barStart,0!==s&&Bi(s)!==Bi(a.barEnd)&&(d=0),d+=s);const u=La(C)||i?d:C;let b=I.getPixelForValue(u);if(A=this.chart.getDataVisibility(g)?I.getPixelForValue(d+r):b,c=A-b,Math.abs(c)<l){c=function(g,I,e){return 0!==g?Bi(g):(I.isHorizontal()?1:-1)*(I.min>=e?1:-1)}(c,I,n)*l,s===n&&(b-=c/2);const g=I.getPixelForDecimal(0),C=I.getPixelForDecimal(1),a=Math.min(g,C),d=Math.max(g,C);b=Math.max(Math.min(b,d),a),A=b+c,e&&!i&&(o._stacks[I.axis]._visualValues[t]=I.getValueForPixel(A)-I.getValueForPixel(b))}if(b===I.getPixelForValue(n)){const g=Bi(c)*I.getLineWidthForValue(n)/2;b+=g,c-=g}return{size:c,base:b,head:A,center:A+c/2}}_calculateBarIndexPixels(g,I){const e=I.scale,t=this.options,C=t.skipNull,l=Oa(t.maxBarThickness,1/0);let n,o;if(I.grouped){const e=C?this._getStackCount(g):I.stackCount,a="flex"===t.barThickness?function(g,I,e,t){const C=I.pixels,l=C[g];let n=g>0?C[g-1]:null,o=g<C.length-1?C[g+1]:null;const a=e.categoryPercentage;null===n&&(n=l-(null===o?I.end-I.start:o-l)),null===o&&(o=l+l-n);const i=l-(l-Math.min(n,o))/2*a;return{chunk:Math.abs(o-n)/2*a/t,ratio:e.barPercentage,start:i}}(g,I,t,e):function(g,I,e,t){const C=e.barThickness;let l,n;return La(C)?(l=I.min*e.categoryPercentage,n=e.barPercentage):(l=C*t,n=1),{chunk:l/t,ratio:n,start:I.pixels[g]-l/2}}(g,I,t,e),i=this._getStackIndex(this.index,this._cachedMeta.stack,C?g:void 0);n=a.start+a.chunk*i+a.chunk/2,o=Math.min(l,a.chunk*a.ratio)}else n=e.getPixelForValue(this.getParsed(g)[e.axis],g),o=Math.min(l,I.min*I.ratio);return{base:n-o/2,head:n+o/2,center:n,size:o}}draw(){const g=this._cachedMeta,I=g.vScale,e=g.data,t=e.length;let C=0;for(;C<t;++C)null===this.getParsed(C)[I.axis]||e[C].hidden||e[C].draw(this._ctx)}}ia(ls,"id","bar"),ia(ls,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ia(ls,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class ns extends Oc{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(g,I,e,t){const C=super.parsePrimitiveData(g,I,e,t);for(let l=0;l<C.length;l++)C[l]._custom=this.resolveDataElementOptions(l+e).radius;return C}parseArrayData(g,I,e,t){const C=super.parseArrayData(g,I,e,t);for(let l=0;l<C.length;l++){const g=I[e+l];C[l]._custom=Oa(g[2],this.resolveDataElementOptions(l+e).radius)}return C}parseObjectData(g,I,e,t){const C=super.parseObjectData(g,I,e,t);for(let l=0;l<C.length;l++){const g=I[e+l];C[l]._custom=Oa(g&&g.r&&+g.r,this.resolveDataElementOptions(l+e).radius)}return C}getMaxOverflow(){const g=this._cachedMeta.data;let I=0;for(let e=g.length-1;e>=0;--e)I=Math.max(I,g[e].size(this.resolveDataElementOptions(e))/2);return I>0&&I}getLabelAndValue(g){const I=this._cachedMeta,e=this.chart.data.labels||[],{xScale:t,yScale:C}=I,l=this.getParsed(g),n=t.getLabelForValue(l.x),o=C.getLabelForValue(l.y),a=l._custom;return{label:e[g]||"",value:"("+n+", "+o+(a?", "+a:"")+")"}}update(g){const I=this._cachedMeta.data;this.updateElements(I,0,I.length,g)}updateElements(g,I,e,t){const C="reset"===t,{iScale:l,vScale:n}=this._cachedMeta,{sharedOptions:o,includeOptions:a}=this._getSharedOptions(I,t),i=l.axis,A=n.axis;for(let c=I;c<I+e;c++){const I=g[c],e=!C&&this.getParsed(c),s={},d=s[i]=C?l.getPixelForDecimal(.5):l.getPixelForValue(e[i]),r=s[A]=C?n.getBasePixel():n.getPixelForValue(e[A]);s.skip=isNaN(d)||isNaN(r),a&&(s.options=o||this.resolveDataElementOptions(c,I.active?"active":t),C&&(s.options.radius=0)),this.updateElement(I,c,s,t)}}resolveDataElementOptions(g,I){const e=this.getParsed(g);let t=super.resolveDataElementOptions(g,I);t.$shared&&(t=Object.assign({},t,{$shared:!1}));const C=t.radius;return"active"!==I&&(t.radius=0),t.radius+=Oa(e&&e._custom,C),t}}ia(ns,"id","bubble"),ia(ns,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),ia(ns,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class os extends Oc{constructor(g,I){super(g,I),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(g,I){const e=this.getDataset().data,t=this._cachedMeta;if(!1===this._parsing)t._parsed=e;else{let C,l,n=g=>+e[g];if(Ta(e[g])){const{key:g="value"}=this._parsing;n=I=>+ai(e[I],g)}for(C=g,l=g+I;C<l;++C)t._parsed[C]=n(C)}}_getRotation(){return Ri(this.options.rotation-90)}_getCircumference(){return Ri(this.options.circumference)}_getRotationExtents(){let g=ri,I=-ri;for(let e=0;e<this.chart.data.datasets.length;++e)if(this.chart.isDatasetVisible(e)&&this.chart.getDatasetMeta(e).type===this._type){const t=this.chart.getDatasetMeta(e).controller,C=t._getRotation(),l=t._getCircumference();g=Math.min(g,C),I=Math.max(I,C+l)}return{rotation:g,circumference:I-g}}update(g){const I=this.chart,{chartArea:e}=I,t=this._cachedMeta,C=t.data,l=this.getMaxBorderWidth()+this.getMaxOffset(C)+this.options.spacing,n=Math.max((Math.min(e.width,e.height)-l)/2,0),o=Math.min((a=this.options.cutout,i=n,"string"===typeof a&&a.endsWith("%")?parseFloat(a)/100:+a/i),1);var a,i;const A=this._getRingWeight(this.index),{circumference:c,rotation:s}=this._getRotationExtents(),{ratioX:d,ratioY:r,offsetX:u,offsetY:b}=function(g,I,e){let t=1,C=1,l=0,n=0;if(I<ri){const o=g,a=o+I,i=Math.cos(o),A=Math.sin(o),c=Math.cos(a),s=Math.sin(a),d=(g,I,t)=>Hi(g,o,a,!0)?1:Math.max(I,I*e,t,t*e),r=(g,I,t)=>Hi(g,o,a,!0)?-1:Math.min(I,I*e,t,t*e),u=d(0,i,c),b=d(hi,A,s),m=r(di,i,c),h=r(di+hi,A,s);t=(u-m)/2,C=(b-h)/2,l=-(u+m)/2,n=-(b+h)/2}return{ratioX:t,ratioY:C,offsetX:l,offsetY:n}}(s,c,o),m=(e.width-l)/d,h=(e.height-l)/r,Z=Math.max(Math.min(m,h)/2,0),G=_a(this.options.radius,Z),p=(G-Math.max(G*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=u*G,this.offsetY=b*G,t.total=this.calculateTotal(),this.outerRadius=G-p*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-p*A,0),this.updateElements(C,0,C.length,g)}_circumference(g,I){const e=this.options,t=this._cachedMeta,C=this._getCircumference();return I&&e.animation.animateRotate||!this.chart.getDataVisibility(g)||null===t._parsed[g]||t.data[g].hidden?0:this.calculateCircumference(t._parsed[g]*C/ri)}updateElements(g,I,e,t){const C="reset"===t,l=this.chart,n=l.chartArea,o=l.options.animation,a=(n.left+n.right)/2,i=(n.top+n.bottom)/2,A=C&&o.animateScale,c=A?0:this.innerRadius,s=A?0:this.outerRadius,{sharedOptions:d,includeOptions:r}=this._getSharedOptions(I,t);let u,b=this._getRotation();for(u=0;u<I;++u)b+=this._circumference(u,C);for(u=I;u<I+e;++u){const I=this._circumference(u,C),e=g[u],l={x:a+this.offsetX,y:i+this.offsetY,startAngle:b,endAngle:b+I,circumference:I,outerRadius:s,innerRadius:c};r&&(l.options=d||this.resolveDataElementOptions(u,e.active?"active":t)),b+=I,this.updateElement(e,u,l,t)}}calculateTotal(){const g=this._cachedMeta,I=g.data;let e,t=0;for(e=0;e<I.length;e++){const C=g._parsed[e];null===C||isNaN(C)||!this.chart.getDataVisibility(e)||I[e].hidden||(t+=Math.abs(C))}return t}calculateCircumference(g){const I=this._cachedMeta.total;return I>0&&!isNaN(g)?ri*(Math.abs(g)/I):0}getLabelAndValue(g){const I=this._cachedMeta,e=this.chart,t=e.data.labels||[],C=lA(I._parsed[g],e.options.locale);return{label:t[g]||"",value:C}}getMaxBorderWidth(g){let I=0;const e=this.chart;let t,C,l,n,o;if(!g)for(t=0,C=e.data.datasets.length;t<C;++t)if(e.isDatasetVisible(t)){l=e.getDatasetMeta(t),g=l.data,n=l.controller;break}if(!g)return 0;for(t=0,C=g.length;t<C;++t)o=n.resolveDataElementOptions(t),"inner"!==o.borderAlign&&(I=Math.max(I,o.borderWidth||0,o.hoverBorderWidth||0));return I}getMaxOffset(g){let I=0;for(let e=0,t=g.length;e<t;++e){const g=this.resolveDataElementOptions(e);I=Math.max(I,g.offset||0,g.hoverOffset||0)}return I}_getRingWeightOffset(g){let I=0;for(let e=0;e<g;++e)this.chart.isDatasetVisible(e)&&(I+=this._getRingWeight(e));return I}_getRingWeight(g){return Math.max(Oa(this.chart.data.datasets[g].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ia(os,"id","doughnut"),ia(os,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ia(os,"descriptors",{_scriptable:g=>"spacing"!==g,_indexable:g=>"spacing"!==g&&!g.startsWith("borderDash")&&!g.startsWith("hoverBorderDash")}),ia(os,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(g){const I=g.data;if(I.labels.length&&I.datasets.length){const{labels:{pointStyle:e,color:t}}=g.legend.options;return I.labels.map(((I,C)=>{const l=g.getDatasetMeta(0).controller.getStyle(C);return{text:I,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:t,lineWidth:l.borderWidth,pointStyle:e,hidden:!g.getDataVisibility(C),index:C}}))}return[]}},onClick(g,I,e){e.chart.toggleDataVisibility(I.index),e.chart.update()}}}});class as extends Oc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(g){const I=this._cachedMeta,{dataset:e,data:t=[],_dataset:C}=I,l=this.chart._animationsDisabled;let{start:n,count:o}=Ti(I,t,l);this._drawStart=n,this._drawCount=o,ji(I)&&(n=0,o=t.length),e._chart=this.chart,e._datasetIndex=this.index,e._decimated=!!C._decimated,e.points=t;const a=this.resolveDatasetElementOptions(g);this.options.showLine||(a.borderWidth=0),a.segment=this.options.segment,this.updateElement(e,void 0,{animated:!l,options:a},g),this.updateElements(t,n,o,g)}updateElements(g,I,e,t){const C="reset"===t,{iScale:l,vScale:n,_stacked:o,_dataset:a}=this._cachedMeta,{sharedOptions:i,includeOptions:A}=this._getSharedOptions(I,t),c=l.axis,s=n.axis,{spanGaps:d,segment:r}=this.options,u=Vi(d)?d:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||C||"none"===t,m=I+e,h=g.length;let Z=I>0&&this.getParsed(I-1);for(let G=0;G<h;++G){const e=g[G],d=b?e:{};if(G<I||G>=m){d.skip=!0;continue}const h=this.getParsed(G),p=La(h[s]),B=d[c]=l.getPixelForValue(h[c],G),y=d[s]=C||p?n.getBasePixel():n.getPixelForValue(o?this.applyStack(n,h,o):h[s],G);d.skip=isNaN(B)||isNaN(y)||p,d.stop=G>0&&Math.abs(h[c]-Z[c])>u,r&&(d.parsed=h,d.raw=a.data[G]),A&&(d.options=i||this.resolveDataElementOptions(G,e.active?"active":t)),b||this.updateElement(e,G,d,t),Z=h}}getMaxOverflow(){const g=this._cachedMeta,I=g.dataset,e=I.options&&I.options.borderWidth||0,t=g.data||[];if(!t.length)return e;const C=t[0].size(this.resolveDataElementOptions(0)),l=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(e,C,l)/2}draw(){const g=this._cachedMeta;g.dataset.updateControlPoints(this.chart.chartArea,g.iScale.axis),super.draw()}}ia(as,"id","line"),ia(as,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ia(as,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class is extends Oc{constructor(g,I){super(g,I),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(g){const I=this._cachedMeta,e=this.chart,t=e.data.labels||[],C=lA(I._parsed[g].r,e.options.locale);return{label:t[g]||"",value:C}}parseObjectData(g,I,e,t){return $A.bind(this)(g,I,e,t)}update(g){const I=this._cachedMeta.data;this._updateRadius(),this.updateElements(I,0,I.length,g)}getMinMax(){const g=this._cachedMeta,I={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return g.data.forEach(((g,e)=>{const t=this.getParsed(e).r;!isNaN(t)&&this.chart.getDataVisibility(e)&&(t<I.min&&(I.min=t),t>I.max&&(I.max=t))})),I}_updateRadius(){const g=this.chart,I=g.chartArea,e=g.options,t=Math.min(I.right-I.left,I.bottom-I.top),C=Math.max(t/2,0),l=(C-Math.max(e.cutoutPercentage?C/100*e.cutoutPercentage:1,0))/g.getVisibleDatasetCount();this.outerRadius=C-l*this.index,this.innerRadius=this.outerRadius-l}updateElements(g,I,e,t){const C="reset"===t,l=this.chart,n=l.options.animation,o=this._cachedMeta.rScale,a=o.xCenter,i=o.yCenter,A=o.getIndexAngle(0)-.5*di;let c,s=A;const d=360/this.countVisibleElements();for(c=0;c<I;++c)s+=this._computeAngle(c,t,d);for(c=I;c<I+e;c++){const I=g[c];let e=s,r=s+this._computeAngle(c,t,d),u=l.getDataVisibility(c)?o.getDistanceFromCenterForValue(this.getParsed(c).r):0;s=r,C&&(n.animateScale&&(u=0),n.animateRotate&&(e=r=A));const b={x:a,y:i,innerRadius:0,outerRadius:u,startAngle:e,endAngle:r,options:this.resolveDataElementOptions(c,I.active?"active":t)};this.updateElement(I,c,b,t)}}countVisibleElements(){const g=this._cachedMeta;let I=0;return g.data.forEach(((g,e)=>{!isNaN(this.getParsed(e).r)&&this.chart.getDataVisibility(e)&&I++})),I}_computeAngle(g,I,e){return this.chart.getDataVisibility(g)?Ri(this.resolveDataElementOptions(g,I).angle||e):0}}ia(is,"id","polarArea"),ia(is,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),ia(is,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(g){const I=g.data;if(I.labels.length&&I.datasets.length){const{labels:{pointStyle:e,color:t}}=g.legend.options;return I.labels.map(((I,C)=>{const l=g.getDatasetMeta(0).controller.getStyle(C);return{text:I,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:t,lineWidth:l.borderWidth,pointStyle:e,hidden:!g.getDataVisibility(C),index:C}}))}return[]}},onClick(g,I,e){e.chart.toggleDataVisibility(I.index),e.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class As extends os{}ia(As,"id","pie"),ia(As,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class cs extends Oc{getLabelAndValue(g){const I=this._cachedMeta.vScale,e=this.getParsed(g);return{label:I.getLabels()[g],value:""+I.getLabelForValue(e[I.axis])}}parseObjectData(g,I,e,t){return $A.bind(this)(g,I,e,t)}update(g){const I=this._cachedMeta,e=I.dataset,t=I.data||[],C=I.iScale.getLabels();if(e.points=t,"resize"!==g){const I=this.resolveDatasetElementOptions(g);this.options.showLine||(I.borderWidth=0);const l={_loop:!0,_fullLoop:C.length===t.length,options:I};this.updateElement(e,void 0,l,g)}this.updateElements(t,0,t.length,g)}updateElements(g,I,e,t){const C=this._cachedMeta.rScale,l="reset"===t;for(let n=I;n<I+e;n++){const I=g[n],e=this.resolveDataElementOptions(n,I.active?"active":t),o=C.getPointPositionForValue(n,this.getParsed(n).r),a=l?C.xCenter:o.x,i=l?C.yCenter:o.y,A={x:a,y:i,angle:o.angle,skip:isNaN(a)||isNaN(i),options:e};this.updateElement(I,n,A,t)}}}ia(cs,"id","radar"),ia(cs,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),ia(cs,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class ss extends Oc{getLabelAndValue(g){const I=this._cachedMeta,e=this.chart.data.labels||[],{xScale:t,yScale:C}=I,l=this.getParsed(g),n=t.getLabelForValue(l.x),o=C.getLabelForValue(l.y);return{label:e[g]||"",value:"("+n+", "+o+")"}}update(g){const I=this._cachedMeta,{data:e=[]}=I,t=this.chart._animationsDisabled;let{start:C,count:l}=Ti(I,e,t);if(this._drawStart=C,this._drawCount=l,ji(I)&&(C=0,l=e.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:C,_dataset:l}=I;C._chart=this.chart,C._datasetIndex=this.index,C._decimated=!!l._decimated,C.points=e;const n=this.resolveDatasetElementOptions(g);n.segment=this.options.segment,this.updateElement(C,void 0,{animated:!t,options:n},g)}else this.datasetElementType&&(delete I.dataset,this.datasetElementType=!1);this.updateElements(e,C,l,g)}addElements(){const{showLine:g}=this.options;!this.datasetElementType&&g&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(g,I,e,t){const C="reset"===t,{iScale:l,vScale:n,_stacked:o,_dataset:a}=this._cachedMeta,i=this.resolveDataElementOptions(I,t),A=this.getSharedOptions(i),c=this.includeOptions(t,A),s=l.axis,d=n.axis,{spanGaps:r,segment:u}=this.options,b=Vi(r)?r:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||C||"none"===t;let h=I>0&&this.getParsed(I-1);for(let Z=I;Z<I+e;++Z){const I=g[Z],e=this.getParsed(Z),i=m?I:{},r=La(e[d]),G=i[s]=l.getPixelForValue(e[s],Z),p=i[d]=C||r?n.getBasePixel():n.getPixelForValue(o?this.applyStack(n,e,o):e[d],Z);i.skip=isNaN(G)||isNaN(p)||r,i.stop=Z>0&&Math.abs(e[s]-h[s])>b,u&&(i.parsed=e,i.raw=a.data[Z]),c&&(i.options=A||this.resolveDataElementOptions(Z,I.active?"active":t)),m||this.updateElement(I,Z,i,t),h=e}this.updateSharedOptions(A,t,i)}getMaxOverflow(){const g=this._cachedMeta,I=g.data||[];if(!this.options.showLine){let g=0;for(let e=I.length-1;e>=0;--e)g=Math.max(g,I[e].size(this.resolveDataElementOptions(e))/2);return g>0&&g}const e=g.dataset,t=e.options&&e.options.borderWidth||0;if(!I.length)return t;const C=I[0].size(this.resolveDataElementOptions(0)),l=I[I.length-1].size(this.resolveDataElementOptions(I.length-1));return Math.max(t,C,l)/2}}ia(ss,"id","scatter"),ia(ss,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),ia(ss,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function ds(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class rs{static override(g){Object.assign(rs.prototype,g)}constructor(g){ia(this,"options",void 0),this.options=g||{}}init(){}formats(){return ds()}parse(){return ds()}format(){return ds()}add(){return ds()}diff(){return ds()}startOf(){return ds()}endOf(){return ds()}}var us=rs;function bs(g,I,e,t){const{controller:C,data:l,_sorted:n}=g,o=C._cachedMeta.iScale;if(o&&I===o.axis&&"r"!==I&&n&&l.length){const g=o._reversePixels?xi:Fi;if(!t)return g(l,I,e);if(C._sharedOptions){const t=l[0],C="function"===typeof t.getRange&&t.getRange(I);if(C){const t=g(l,I,e-C),n=g(l,I,e+C);return{lo:t.lo,hi:n.hi}}}}return{lo:0,hi:l.length-1}}function ms(g,I,e,t,C){const l=g.getSortedVisibleDatasetMetas(),n=e[I];for(let o=0,a=l.length;o<a;++o){const{index:g,data:e}=l[o],{lo:a,hi:i}=bs(l[o],I,n,C);for(let I=a;I<=i;++I){const C=e[I];C.skip||t(C,g,I)}}}function hs(g,I,e,t,C){const l=[];if(!C&&!g.isPointInArea(I))return l;return ms(g,e,I,(function(e,n,o){(C||GA(e,g.chartArea,0))&&e.inRange(I.x,I.y,t)&&l.push({element:e,datasetIndex:n,index:o})}),!0),l}function Zs(g,I,e,t,C,l){let n=[];const o=function(g){const I=-1!==g.indexOf("x"),e=-1!==g.indexOf("y");return function(g,t){const C=I?Math.abs(g.x-t.x):0,l=e?Math.abs(g.y-t.y):0;return Math.sqrt(Math.pow(C,2)+Math.pow(l,2))}}(e);let a=Number.POSITIVE_INFINITY;return ms(g,e,I,(function(e,i,A){const c=e.inRange(I.x,I.y,C);if(t&&!c)return;const s=e.getCenterPoint(C);if(!(!!l||g.isPointInArea(s))&&!c)return;const d=o(I,s);d<a?(n=[{element:e,datasetIndex:i,index:A}],a=d):d===a&&n.push({element:e,datasetIndex:i,index:A})})),n}function Gs(g,I,e,t,C,l){return l||g.isPointInArea(I)?"r"!==e||t?Zs(g,I,e,t,C,l):function(g,I,e,t){let C=[];return ms(g,e,I,(function(g,e,l){const{startAngle:n,endAngle:o}=g.getProps(["startAngle","endAngle"],t),{angle:a}=ki(g,{x:I.x,y:I.y});Hi(a,n,o)&&C.push({element:g,datasetIndex:e,index:l})})),C}(g,I,e,C):[]}function ps(g,I,e,t,C){const l=[],n="x"===e?"inXRange":"inYRange";let o=!1;return ms(g,e,I,((g,t,a)=>{g[n](I[e],C)&&(l.push({element:g,datasetIndex:t,index:a}),o=o||g.inRange(I.x,I.y,C))})),t&&!o?[]:l}var Bs={evaluateInteractionItems:ms,modes:{index(g,I,e,t){const C=rc(I,g),l=e.axis||"x",n=e.includeInvisible||!1,o=e.intersect?hs(g,C,l,t,n):Gs(g,C,l,!1,t,n),a=[];return o.length?(g.getSortedVisibleDatasetMetas().forEach((g=>{const I=o[0].index,e=g.data[I];e&&!e.skip&&a.push({element:e,datasetIndex:g.index,index:I})})),a):[]},dataset(g,I,e,t){const C=rc(I,g),l=e.axis||"xy",n=e.includeInvisible||!1;let o=e.intersect?hs(g,C,l,t,n):Gs(g,C,l,!1,t,n);if(o.length>0){const I=o[0].datasetIndex,e=g.getDatasetMeta(I).data;o=[];for(let g=0;g<e.length;++g)o.push({element:e[g],datasetIndex:I,index:g})}return o},point:(g,I,e,t)=>hs(g,rc(I,g),e.axis||"xy",t,e.includeInvisible||!1),nearest(g,I,e,t){const C=rc(I,g),l=e.axis||"xy",n=e.includeInvisible||!1;return Gs(g,C,l,e.intersect,t,n)},x:(g,I,e,t)=>ps(g,rc(I,g),"x",e.intersect,t),y:(g,I,e,t)=>ps(g,rc(I,g),"y",e.intersect,t)}};const ys=["left","top","right","bottom"];function Ws(g,I){return g.filter((g=>g.pos===I))}function Vs(g,I){return g.filter((g=>-1===ys.indexOf(g.pos)&&g.box.axis===I))}function Ss(g,I){return g.sort(((g,e)=>{const t=I?e:g,C=I?g:e;return t.weight===C.weight?t.index-C.index:t.weight-C.weight}))}function Rs(g,I){const e=function(g){const I={};for(const e of g){const{stack:g,pos:t,stackWeight:C}=e;if(!g||!ys.includes(t))continue;const l=I[g]||(I[g]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=C}return I}(g),{vBoxMaxWidth:t,hBoxMaxHeight:C}=I;let l,n,o;for(l=0,n=g.length;l<n;++l){o=g[l];const{fullSize:n}=o.box,a=e[o.stack],i=a&&o.stackWeight/a.weight;o.horizontal?(o.width=i?i*t:n&&I.availableWidth,o.height=C):(o.width=t,o.height=i?i*C:n&&I.availableHeight)}return e}function Xs(g,I,e,t){return Math.max(g[e],I[e])+Math.max(g[t],I[t])}function Js(g,I){g.top=Math.max(g.top,I.top),g.left=Math.max(g.left,I.left),g.bottom=Math.max(g.bottom,I.bottom),g.right=Math.max(g.right,I.right)}function ks(g,I,e,t){const{pos:C,box:l}=e,n=g.maxPadding;if(!Ta(C)){e.size&&(g[C]-=e.size);const I=t[e.stack]||{size:0,count:1};I.size=Math.max(I.size,e.horizontal?l.height:l.width),e.size=I.size/I.count,g[C]+=e.size}l.getPadding&&Js(n,l.getPadding());const o=Math.max(0,I.outerWidth-Xs(n,g,"left","right")),a=Math.max(0,I.outerHeight-Xs(n,g,"top","bottom")),i=o!==g.w,A=a!==g.h;return g.w=o,g.h=a,e.horizontal?{same:i,other:A}:{same:A,other:i}}function fs(g,I){const e=I.maxPadding;function t(g){const t={left:0,top:0,right:0,bottom:0};return g.forEach((g=>{t[g]=Math.max(I[g],e[g])})),t}return t(g?["left","right"]:["top","bottom"])}function vs(g,I,e,t){const C=[];let l,n,o,a,i,A;for(l=0,n=g.length,i=0;l<n;++l){o=g[l],a=o.box,a.update(o.width||I.w,o.height||I.h,fs(o.horizontal,I));const{same:n,other:c}=ks(I,e,o,t);i|=n&&C.length,A=A||c,a.fullSize||C.push(o)}return i&&vs(C,I,e,t)||A}function Ys(g,I,e,t,C){g.top=e,g.left=I,g.right=I+t,g.bottom=e+C,g.width=t,g.height=C}function Hs(g,I,e,t){const C=e.padding;let{x:l,y:n}=I;for(const o of g){const g=o.box,a=t[o.stack]||{count:1,placed:0,weight:1},i=o.stackWeight/a.weight||1;if(o.horizontal){const t=I.w*i,l=a.size||g.height;Ai(a.start)&&(n=a.start),g.fullSize?Ys(g,C.left,n,e.outerWidth-C.right-C.left,l):Ys(g,I.left+a.placed,n,t,l),a.start=n,a.placed+=t,n=g.bottom}else{const t=I.h*i,n=a.size||g.width;Ai(a.start)&&(l=a.start),g.fullSize?Ys(g,l,C.top,n,e.outerHeight-C.bottom-C.top):Ys(g,l,I.top+a.placed,n,t),a.start=l,a.placed+=t,l=g.right}}I.x=l,I.y=n}var Ns={addBox(g,I){g.boxes||(g.boxes=[]),I.fullSize=I.fullSize||!1,I.position=I.position||"top",I.weight=I.weight||0,I._layers=I._layers||function(){return[{z:0,draw(g){I.draw(g)}}]},g.boxes.push(I)},removeBox(g,I){const e=g.boxes?g.boxes.indexOf(I):-1;-1!==e&&g.boxes.splice(e,1)},configure(g,I,e){I.fullSize=e.fullSize,I.position=e.position,I.weight=e.weight},update(g,I,e,t){if(!g)return;const C=KA(g.options.layout.padding),l=Math.max(I-C.width,0),n=Math.max(e-C.height,0),o=function(g){const I=function(g){const I=[];let e,t,C,l,n,o;for(e=0,t=(g||[]).length;e<t;++e)C=g[e],({position:l,options:{stack:n,stackWeight:o=1}}=C),I.push({index:e,box:C,pos:l,horizontal:C.isHorizontal(),weight:C.weight,stack:n&&l+n,stackWeight:o});return I}(g),e=Ss(I.filter((g=>g.box.fullSize)),!0),t=Ss(Ws(I,"left"),!0),C=Ss(Ws(I,"right")),l=Ss(Ws(I,"top"),!0),n=Ss(Ws(I,"bottom")),o=Vs(I,"x"),a=Vs(I,"y");return{fullSize:e,leftAndTop:t.concat(l),rightAndBottom:C.concat(a).concat(n).concat(o),chartArea:Ws(I,"chartArea"),vertical:t.concat(C).concat(a),horizontal:l.concat(n).concat(o)}}(g.boxes),a=o.vertical,i=o.horizontal;$a(g.boxes,(g=>{"function"===typeof g.beforeLayout&&g.beforeLayout()}));const A=a.reduce(((g,I)=>I.box.options&&!1===I.box.options.display?g:g+1),0)||1,c=Object.freeze({outerWidth:I,outerHeight:e,padding:C,availableWidth:l,availableHeight:n,vBoxMaxWidth:l/2/A,hBoxMaxHeight:n/2}),s=Object.assign({},C);Js(s,KA(t));const d=Object.assign({maxPadding:s,w:l,h:n,x:C.left,y:C.top},C),r=Rs(a.concat(i),c);vs(o.fullSize,d,c,r),vs(a,d,c,r),vs(i,d,c,r)&&vs(a,d,c,r),function(g){const I=g.maxPadding;function e(e){const t=Math.max(I[e]-g[e],0);return g[e]+=t,t}g.y+=e("top"),g.x+=e("left"),e("right"),e("bottom")}(d),Hs(o.leftAndTop,d,c,r),d.x+=d.w,d.y+=d.h,Hs(o.rightAndBottom,d,c,r),g.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},$a(o.chartArea,(I=>{const e=I.box;Object.assign(e,g.chartArea),e.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})}))}};class Ks{acquireContext(g,I){}releaseContext(g){return!1}addEventListener(g,I,e){}removeEventListener(g,I,e){}getDevicePixelRatio(){return 1}getMaximumSize(g,I,e,t){return I=Math.max(0,I||g.width),e=e||g.height,{width:I,height:Math.max(0,t?Math.floor(I/t):e)}}isAttached(g){return!0}updateConfig(g){}}class ws extends Ks{acquireContext(g){return g&&g.getContext&&g.getContext("2d")||null}updateConfig(g){g.options.animation=!1}}const Fs="$chartjs",xs={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},zs=g=>null===g||""===g;const Ms=!!hc&&{passive:!0};function Es(g,I,e){g&&g.canvas&&g.canvas.removeEventListener(I,e,Ms)}function Us(g,I){for(const e of g)if(e===I||e.contains(I))return!0}function Qs(g,I,e){const t=g.canvas,C=new MutationObserver((g=>{let I=!1;for(const e of g)I=I||Us(e.addedNodes,t),I=I&&!Us(e.removedNodes,t);I&&e()}));return C.observe(document,{childList:!0,subtree:!0}),C}function Ls(g,I,e){const t=g.canvas,C=new MutationObserver((g=>{let I=!1;for(const e of g)I=I||Us(e.removedNodes,t),I=I&&!Us(e.addedNodes,t);I&&e()}));return C.observe(document,{childList:!0,subtree:!0}),C}const Ds=new Map;let Ts=0;function js(){const g=window.devicePixelRatio;g!==Ts&&(Ts=g,Ds.forEach(((I,e)=>{e.currentDevicePixelRatio!==g&&I()})))}function Ps(g,I,e){const t=g.canvas,C=t&&ac(t);if(!C)return;const l=Qi(((g,I)=>{const t=C.clientWidth;e(g,I),t<C.clientWidth&&e()}),window),n=new ResizeObserver((g=>{const I=g[0],e=I.contentRect.width,t=I.contentRect.height;0===e&&0===t||l(e,t)}));return n.observe(C),function(g,I){Ds.size||window.addEventListener("resize",js),Ds.set(g,I)}(g,l),n}function Os(g,I,e){e&&e.disconnect(),"resize"===I&&function(g){Ds.delete(g),Ds.size||window.removeEventListener("resize",js)}(g)}function _s(g,I,e){const t=g.canvas,C=Qi((I=>{null!==g.ctx&&e(function(g,I){const e=xs[g.type]||g.type,{x:t,y:C}=rc(g,I);return{type:e,chart:I,native:g,x:void 0!==t?t:null,y:void 0!==C?C:null}}(I,g))}),g);return function(g,I,e){g&&g.addEventListener(I,e,Ms)}(t,I,C),C}class qs extends Ks{acquireContext(g,I){const e=g&&g.getContext&&g.getContext("2d");return e&&e.canvas===g?(function(g,I){const e=g.style,t=g.getAttribute("height"),C=g.getAttribute("width");if(g[Fs]={initial:{height:t,width:C,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",zs(C)){const I=Zc(g,"width");void 0!==I&&(g.width=I)}if(zs(t))if(""===g.style.height)g.height=g.width/(I||2);else{const I=Zc(g,"height");void 0!==I&&(g.height=I)}}(g,I),e):null}releaseContext(g){const I=g.canvas;if(!I[Fs])return!1;const e=I[Fs].initial;["height","width"].forEach((g=>{const t=e[g];La(t)?I.removeAttribute(g):I.setAttribute(g,t)}));const t=e.style||{};return Object.keys(t).forEach((g=>{I.style[g]=t[g]})),I.width=I.width,delete I[Fs],!0}addEventListener(g,I,e){this.removeEventListener(g,I);const t=g.$proxies||(g.$proxies={}),C={attach:Qs,detach:Ls,resize:Ps}[I]||_s;t[I]=C(g,I,e)}removeEventListener(g,I){const e=g.$proxies||(g.$proxies={}),t=e[I];if(!t)return;({attach:Os,detach:Os,resize:Os}[I]||Es)(g,I,t),e[I]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(g,I,e,t){return bc(g,I,e,t)}isAttached(g){const I=g&&ac(g);return!(!I||!I.isConnected)}}class $s{constructor(){ia(this,"x",void 0),ia(this,"y",void 0),ia(this,"active",!1),ia(this,"options",void 0),ia(this,"$animations",void 0)}tooltipPosition(g){const{x:I,y:e}=this.getProps(["x","y"],g);return{x:I,y:e}}hasValue(){return Vi(this.x)&&Vi(this.y)}getProps(g,I){const e=this.$animations;if(!I||!e)return this;const t={};return g.forEach((g=>{t[g]=e[g]&&e[g].active()?e[g]._to:this[g]})),t}}function gd(g,I){const e=g.options.ticks,t=function(g){const I=g.options.offset,e=g._tickSize(),t=g._length/e+(I?0:1),C=g._maxLength/e;return Math.floor(Math.min(t,C))}(g),C=Math.min(e.maxTicksLimit||t,t),l=e.major.enabled?function(g){const I=[];let e,t;for(e=0,t=g.length;e<t;e++)g[e].major&&I.push(e);return I}(I):[],n=l.length,o=l[0],a=l[n-1],i=[];if(n>C)return function(g,I,e,t){let C,l=0,n=e[0];for(t=Math.ceil(t),C=0;C<g.length;C++)C===n&&(I.push(g[C]),l++,n=e[l*t])}(I,i,l,n/C),i;const A=function(g,I,e){const t=function(g){const I=g.length;let e,t;if(I<2)return!1;for(t=g[0],e=1;e<I;++e)if(g[e]-g[e-1]!==t)return!1;return t}(g),C=I.length/e;if(!t)return Math.max(C,1);const l=function(g){const I=[],e=Math.sqrt(g);let t;for(t=1;t<e;t++)g%t===0&&(I.push(t),I.push(g/t));return e===(0|e)&&I.push(e),I.sort(((g,I)=>g-I)).pop(),I}(t);for(let n=0,o=l.length-1;n<o;n++){const g=l[n];if(g>C)return g}return Math.max(C,1)}(l,I,C);if(n>0){let g,e;const t=n>1?Math.round((a-o)/(n-1)):null;for(Id(I,i,A,La(t)?0:o-t,o),g=0,e=n-1;g<e;g++)Id(I,i,A,l[g],l[g+1]);return Id(I,i,A,a,La(t)?I.length:a+t),i}return Id(I,i,A),i}function Id(g,I,e,t,C){const l=Oa(t,0),n=Math.min(Oa(C,g.length),g.length);let o,a,i,A=0;for(e=Math.ceil(e),C&&(o=C-t,e=o/Math.floor(o/e)),i=l;i<0;)A++,i=Math.round(l+A*e);for(a=Math.max(l,0);a<n;a++)a===i&&(I.push(g[a]),A++,i=Math.round(l+A*e))}ia($s,"defaults",{}),ia($s,"defaultRoutes",void 0);const ed=(g,I,e)=>"top"===I||"left"===I?g[I]+e:g[I]-e,td=(g,I)=>Math.min(I||g,g);function Cd(g,I){const e=[],t=g.length/I,C=g.length;let l=0;for(;l<C;l+=t)e.push(g[Math.floor(l)]);return e}function ld(g,I,e){const t=g.ticks.length,C=Math.min(I,t-1),l=g._startPixel,n=g._endPixel,o=1e-6;let a,i=g.getPixelForTick(C);if(!(e&&(a=1===t?Math.max(i-l,n-i):0===I?(g.getPixelForTick(1)-i)/2:(i-g.getPixelForTick(C-1))/2,i+=C<I?a:-a,i<l-o||i>n+o)))return i}function nd(g){return g.drawTicks?g.tickLength:0}function od(g,I){if(!g.display)return 0;const e=wA(g.font,I),t=KA(g.padding);return(Da(g.text)?g.text.length:1)*e.lineHeight+t.height}function ad(g,I,e){let t=Li(g);return(e&&"right"!==I||!e&&"right"===I)&&(t=(g=>"left"===g?"right":"right"===g?"left":g)(t)),t}class id extends $s{constructor(g){super(),this.id=g.id,this.type=g.type,this.options=void 0,this.ctx=g.ctx,this.chart=g.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(g){this.options=g.setContext(this.getContext()),this.axis=g.axis,this._userMin=this.parse(g.min),this._userMax=this.parse(g.max),this._suggestedMin=this.parse(g.suggestedMin),this._suggestedMax=this.parse(g.suggestedMax)}parse(g,I){return g}getUserBounds(){let{_userMin:g,_userMax:I,_suggestedMin:e,_suggestedMax:t}=this;return g=Pa(g,Number.POSITIVE_INFINITY),I=Pa(I,Number.NEGATIVE_INFINITY),e=Pa(e,Number.POSITIVE_INFINITY),t=Pa(t,Number.NEGATIVE_INFINITY),{min:Pa(g,e),max:Pa(I,t),minDefined:ja(g),maxDefined:ja(I)}}getMinMax(g){let I,{min:e,max:t,minDefined:C,maxDefined:l}=this.getUserBounds();if(C&&l)return{min:e,max:t};const n=this.getMatchingVisibleMetas();for(let o=0,a=n.length;o<a;++o)I=n[o].controller.getMinMax(this,g),C||(e=Math.min(e,I.min)),l||(t=Math.max(t,I.max));return e=l&&e>t?t:e,t=C&&e>t?e:t,{min:Pa(e,Pa(t,e)),max:Pa(t,Pa(e,t))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const g=this.chart.data;return this.options.labels||(this.isHorizontal()?g.xLabels:g.yLabels)||g.labels||[]}getLabelItems(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(g))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qa(this.options.beforeUpdate,[this])}update(g,I,e){const{beginAtZero:t,grace:C,ticks:l}=this.options,n=l.sampleSize;this.beforeUpdate(),this.maxWidth=g,this.maxHeight=I,this._margins=e=Object.assign({left:0,right:0,top:0,bottom:0},e),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+e.left+e.right:this.height+e.top+e.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(g,I,e){const{min:t,max:C}=g,l=_a(I,(C-t)/2),n=(g,I)=>e&&0===g?0:g+I;return{min:n(t,-Math.abs(l)),max:n(C,l)}}(this,C,t),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=n<this.ticks.length;this._convertTicksToLabels(o?Cd(this.ticks,n):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||"auto"===l.source)&&(this.ticks=gd(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let g,I,e=this.options.reverse;this.isHorizontal()?(g=this.left,I=this.right):(g=this.top,I=this.bottom,e=!e),this._startPixel=g,this._endPixel=I,this._reversePixels=e,this._length=I-g,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qa(this.options.afterUpdate,[this])}beforeSetDimensions(){qa(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qa(this.options.afterSetDimensions,[this])}_callHooks(g){this.chart.notifyPlugins(g,this.getContext()),qa(this.options[g],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qa(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(g){const I=this.options.ticks;let e,t,C;for(e=0,t=g.length;e<t;e++)C=g[e],C.label=qa(I.callback,[C.value,e,g],this)}afterTickToLabelConversion(){qa(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qa(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const g=this.options,I=g.ticks,e=td(this.ticks.length,g.ticks.maxTicksLimit),t=I.minRotation||0,C=I.maxRotation;let l,n,o,a=t;if(!this._isVisible()||!I.display||t>=C||e<=1||!this.isHorizontal())return void(this.labelRotation=t);const i=this._getLabelSizes(),A=i.widest.width,c=i.highest.height,s=Ni(this.chart.width-A,0,this.maxWidth);l=g.offset?this.maxWidth/e:s/(e-1),A+6>l&&(l=s/(e-(g.offset?.5:1)),n=this.maxHeight-nd(g.grid)-I.padding-od(g.title,this.chart.options.font),o=Math.sqrt(A*A+c*c),a=Xi(Math.min(Math.asin(Ni((i.highest.height+6)/l,-1,1)),Math.asin(Ni(n/o,-1,1))-Math.asin(Ni(c/o,-1,1)))),a=Math.max(t,Math.min(C,a))),this.labelRotation=a}afterCalculateLabelRotation(){qa(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qa(this.options.beforeFit,[this])}fit(){const g={width:0,height:0},{chart:I,options:{ticks:e,title:t,grid:C}}=this,l=this._isVisible(),n=this.isHorizontal();if(l){const l=od(t,I.options.font);if(n?(g.width=this.maxWidth,g.height=nd(C)+l):(g.height=this.maxHeight,g.width=nd(C)+l),e.display&&this.ticks.length){const{first:I,last:t,widest:C,highest:l}=this._getLabelSizes(),o=2*e.padding,a=Ri(this.labelRotation),i=Math.cos(a),A=Math.sin(a);if(n){const I=e.mirror?0:A*C.width+i*l.height;g.height=Math.min(this.maxHeight,g.height+I+o)}else{const I=e.mirror?0:i*C.width+A*l.height;g.width=Math.min(this.maxWidth,g.width+I+o)}this._calculatePadding(I,t,A,i)}}this._handleMargins(),n?(this.width=this._length=I.width-this._margins.left-this._margins.right,this.height=g.height):(this.width=g.width,this.height=this._length=I.height-this._margins.top-this._margins.bottom)}_calculatePadding(g,I,e,t){const{ticks:{align:C,padding:l},position:n}=this.options,o=0!==this.labelRotation,a="top"!==n&&"x"===this.axis;if(this.isHorizontal()){const n=this.getPixelForTick(0)-this.left,i=this.right-this.getPixelForTick(this.ticks.length-1);let A=0,c=0;o?a?(A=t*g.width,c=e*I.height):(A=e*g.height,c=t*I.width):"start"===C?c=I.width:"end"===C?A=g.width:"inner"!==C&&(A=g.width/2,c=I.width/2),this.paddingLeft=Math.max((A-n+l)*this.width/(this.width-n),0),this.paddingRight=Math.max((c-i+l)*this.width/(this.width-i),0)}else{let e=I.height/2,t=g.height/2;"start"===C?(e=0,t=g.height):"end"===C&&(e=I.height,t=0),this.paddingTop=e+l,this.paddingBottom=t+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qa(this.options.afterFit,[this])}isHorizontal(){const{axis:g,position:I}=this.options;return"top"===I||"bottom"===I||"x"===g}isFullSize(){return this.options.fullSize}_convertTicksToLabels(g){let I,e;for(this.beforeTickToLabelConversion(),this.generateTickLabels(g),I=0,e=g.length;I<e;I++)La(g[I].label)&&(g.splice(I,1),e--,I--);this.afterTickToLabelConversion()}_getLabelSizes(){let g=this._labelSizes;if(!g){const I=this.options.ticks.sampleSize;let e=this.ticks;I<e.length&&(e=Cd(e,I)),this._labelSizes=g=this._computeLabelSizes(e,e.length,this.options.ticks.maxTicksLimit)}return g}_computeLabelSizes(g,I,e){const{ctx:t,_longestTextCache:C}=this,l=[],n=[],o=Math.floor(I/td(I,e));let a,i,A,c,s,d,r,u,b,m,h,Z=0,G=0;for(a=0;a<I;a+=o){if(c=g[a].label,s=this._resolveTickFontOptions(a),t.font=d=s.string,r=C[d]=C[d]||{data:{},gc:[]},u=s.lineHeight,b=m=0,La(c)||Da(c)){if(Da(c))for(i=0,A=c.length;i<A;++i)h=c[i],La(h)||Da(h)||(b=rA(t,r.data,r.gc,b,h),m+=u)}else b=rA(t,r.data,r.gc,b,c),m=u;l.push(b),n.push(m),Z=Math.max(b,Z),G=Math.max(m,G)}!function(g,I){$a(g,(g=>{const e=g.gc,t=e.length/2;let C;if(t>I){for(C=0;C<t;++C)delete g.data[e[C]];e.splice(0,t)}}))}(C,I);const p=l.indexOf(Z),B=n.indexOf(G),y=g=>({width:l[g]||0,height:n[g]||0});return{first:y(0),last:y(I-1),widest:y(p),highest:y(B),widths:l,heights:n}}getLabelForValue(g){return g}getPixelForValue(g,I){return NaN}getValueForPixel(g){}getPixelForTick(g){const I=this.ticks;return g<0||g>I.length-1?null:this.getPixelForValue(I[g].value)}getPixelForDecimal(g){this._reversePixels&&(g=1-g);const I=this._startPixel+g*this._length;return Ni(this._alignToPixels?bA(this.chart,I,0):I,-32768,32767)}getDecimalForPixel(g){const I=(g-this._startPixel)/this._length;return this._reversePixels?1-I:I}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:g,max:I}=this;return g<0&&I<0?I:g>0&&I>0?g:0}getContext(g){const I=this.ticks||[];if(g>=0&&g<I.length){const e=I[g];return e.$context||(e.$context=function(g,I,e){return xA(g,{tick:e,index:I,type:"tick"})}(this.getContext(),g,e))}return this.$context||(this.$context=xA(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const g=this.options.ticks,I=Ri(this.labelRotation),e=Math.abs(Math.cos(I)),t=Math.abs(Math.sin(I)),C=this._getLabelSizes(),l=g.autoSkipPadding||0,n=C?C.widest.width+l:0,o=C?C.highest.height+l:0;return this.isHorizontal()?o*e>n*t?n/e:o/t:o*t<n*e?o/e:n/t}_isVisible(){const g=this.options.display;return"auto"!==g?!!g:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(g){const I=this.axis,e=this.chart,t=this.options,{grid:C,position:l,border:n}=t,o=C.offset,a=this.isHorizontal(),i=this.ticks.length+(o?1:0),A=nd(C),c=[],s=n.setContext(this.getContext()),d=s.display?s.width:0,r=d/2,u=function(g){return bA(e,g,d)};let b,m,h,Z,G,p,B,y,W,V,S,R;if("top"===l)b=u(this.bottom),p=this.bottom-A,y=b-r,V=u(g.top)+r,R=g.bottom;else if("bottom"===l)b=u(this.top),V=g.top,R=u(g.bottom)-r,p=b+r,y=this.top+A;else if("left"===l)b=u(this.right),G=this.right-A,B=b-r,W=u(g.left)+r,S=g.right;else if("right"===l)b=u(this.left),W=g.left,S=u(g.right)-r,G=b+r,B=this.left+A;else if("x"===I){if("center"===l)b=u((g.top+g.bottom)/2+.5);else if(Ta(l)){const g=Object.keys(l)[0],I=l[g];b=u(this.chart.scales[g].getPixelForValue(I))}V=g.top,R=g.bottom,p=b+r,y=p+A}else if("y"===I){if("center"===l)b=u((g.left+g.right)/2);else if(Ta(l)){const g=Object.keys(l)[0],I=l[g];b=u(this.chart.scales[g].getPixelForValue(I))}G=b-r,B=G-A,W=g.left,S=g.right}const X=Oa(t.ticks.maxTicksLimit,i),J=Math.max(1,Math.ceil(i/X));for(m=0;m<i;m+=J){const g=this.getContext(m),I=C.setContext(g),t=n.setContext(g),l=I.lineWidth,i=I.color,A=t.dash||[],s=t.dashOffset,d=I.tickWidth,r=I.tickColor,u=I.tickBorderDash||[],b=I.tickBorderDashOffset;h=ld(this,m,o),void 0!==h&&(Z=bA(e,h,l),a?G=B=W=S=Z:p=y=V=R=Z,c.push({tx1:G,ty1:p,tx2:B,ty2:y,x1:W,y1:V,x2:S,y2:R,width:l,color:i,borderDash:A,borderDashOffset:s,tickWidth:d,tickColor:r,tickBorderDash:u,tickBorderDashOffset:b}))}return this._ticksLength=i,this._borderValue=b,c}_computeLabelItems(g){const I=this.axis,e=this.options,{position:t,ticks:C}=e,l=this.isHorizontal(),n=this.ticks,{align:o,crossAlign:a,padding:i,mirror:A}=C,c=nd(e.grid),s=c+i,d=A?-i:s,r=-Ri(this.labelRotation),u=[];let b,m,h,Z,G,p,B,y,W,V,S,R,X="middle";if("top"===t)p=this.bottom-d,B=this._getXAxisLabelAlignment();else if("bottom"===t)p=this.top+d,B=this._getXAxisLabelAlignment();else if("left"===t){const g=this._getYAxisLabelAlignment(c);B=g.textAlign,G=g.x}else if("right"===t){const g=this._getYAxisLabelAlignment(c);B=g.textAlign,G=g.x}else if("x"===I){if("center"===t)p=(g.top+g.bottom)/2+s;else if(Ta(t)){const g=Object.keys(t)[0],I=t[g];p=this.chart.scales[g].getPixelForValue(I)+s}B=this._getXAxisLabelAlignment()}else if("y"===I){if("center"===t)G=(g.left+g.right)/2-s;else if(Ta(t)){const g=Object.keys(t)[0],I=t[g];G=this.chart.scales[g].getPixelForValue(I)}B=this._getYAxisLabelAlignment(c).textAlign}"y"===I&&("start"===o?X="top":"end"===o&&(X="bottom"));const J=this._getLabelSizes();for(b=0,m=n.length;b<m;++b){h=n[b],Z=h.label;const g=C.setContext(this.getContext(b));y=this.getPixelForTick(b)+C.labelOffset,W=this._resolveTickFontOptions(b),V=W.lineHeight,S=Da(Z)?Z.length:1;const I=S/2,e=g.color,o=g.textStrokeColor,i=g.textStrokeWidth;let c,s=B;if(l?(G=y,"inner"===B&&(s=b===m-1?this.options.reverse?"left":"right":0===b?this.options.reverse?"right":"left":"center"),R="top"===t?"near"===a||0!==r?-S*V+V/2:"center"===a?-J.highest.height/2-I*V+V:-J.highest.height+V/2:"near"===a||0!==r?V/2:"center"===a?J.highest.height/2-I*V:J.highest.height-S*V,A&&(R*=-1),0===r||g.showLabelBackdrop||(G+=V/2*Math.sin(r))):(p=y,R=(1-S)*V/2),g.showLabelBackdrop){const I=KA(g.backdropPadding),e=J.heights[b],t=J.widths[b];let C=R-I.top,l=0-I.left;switch(X){case"middle":C-=e/2;break;case"bottom":C-=e}switch(B){case"center":l-=t/2;break;case"right":l-=t;break;case"inner":b===m-1?l-=t:b>0&&(l-=t/2)}c={left:l,top:C,width:t+I.width,height:e+I.height,color:g.backdropColor}}u.push({label:Z,font:W,textOffset:R,options:{rotation:r,color:e,strokeColor:o,strokeWidth:i,textAlign:s,textBaseline:X,translation:[G,p],backdrop:c}})}return u}_getXAxisLabelAlignment(){const{position:g,ticks:I}=this.options;if(-Ri(this.labelRotation))return"top"===g?"left":"right";let e="center";return"start"===I.align?e="left":"end"===I.align?e="right":"inner"===I.align&&(e="inner"),e}_getYAxisLabelAlignment(g){const{position:I,ticks:{crossAlign:e,mirror:t,padding:C}}=this.options,l=g+C,n=this._getLabelSizes().widest.width;let o,a;return"left"===I?t?(a=this.right+C,"near"===e?o="left":"center"===e?(o="center",a+=n/2):(o="right",a+=n)):(a=this.right-l,"near"===e?o="right":"center"===e?(o="center",a-=n/2):(o="left",a=this.left)):"right"===I?t?(a=this.left+C,"near"===e?o="right":"center"===e?(o="center",a-=n/2):(o="left",a-=n)):(a=this.left+l,"near"===e?o="left":"center"===e?(o="center",a+=n/2):(o="right",a=this.right)):o="right",{textAlign:o,x:a}}_computeLabelArea(){if(this.options.ticks.mirror)return;const g=this.chart,I=this.options.position;return"left"===I||"right"===I?{top:0,left:this.left,bottom:g.height,right:this.right}:"top"===I||"bottom"===I?{top:this.top,left:0,bottom:this.bottom,right:g.width}:void 0}drawBackground(){const{ctx:g,options:{backgroundColor:I},left:e,top:t,width:C,height:l}=this;I&&(g.save(),g.fillStyle=I,g.fillRect(e,t,C,l),g.restore())}getLineWidthForValue(g){const I=this.options.grid;if(!this._isVisible()||!I.display)return 0;const e=this.ticks.findIndex((I=>I.value===g));if(e>=0){return I.setContext(this.getContext(e)).lineWidth}return 0}drawGrid(g){const I=this.options.grid,e=this.ctx,t=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(g));let C,l;const n=(g,I,t)=>{t.width&&t.color&&(e.save(),e.lineWidth=t.width,e.strokeStyle=t.color,e.setLineDash(t.borderDash||[]),e.lineDashOffset=t.borderDashOffset,e.beginPath(),e.moveTo(g.x,g.y),e.lineTo(I.x,I.y),e.stroke(),e.restore())};if(I.display)for(C=0,l=t.length;C<l;++C){const g=t[C];I.drawOnChartArea&&n({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},g),I.drawTicks&&n({x:g.tx1,y:g.ty1},{x:g.tx2,y:g.ty2},{color:g.tickColor,width:g.tickWidth,borderDash:g.tickBorderDash,borderDashOffset:g.tickBorderDashOffset})}}drawBorder(){const{chart:g,ctx:I,options:{border:e,grid:t}}=this,C=e.setContext(this.getContext()),l=e.display?C.width:0;if(!l)return;const n=t.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let a,i,A,c;this.isHorizontal()?(a=bA(g,this.left,l)-l/2,i=bA(g,this.right,n)+n/2,A=c=o):(A=bA(g,this.top,l)-l/2,c=bA(g,this.bottom,n)+n/2,a=i=o),I.save(),I.lineWidth=C.width,I.strokeStyle=C.color,I.beginPath(),I.moveTo(a,A),I.lineTo(i,c),I.stroke(),I.restore()}drawLabels(g){if(!this.options.ticks.display)return;const I=this.ctx,e=this._computeLabelArea();e&&pA(I,e);const t=this.getLabelItems(g);for(const C of t){const g=C.options,e=C.font;RA(I,C.label,0,C.textOffset,e,g)}e&&BA(I)}drawTitle(){const{ctx:g,options:{position:I,title:e,reverse:t}}=this;if(!e.display)return;const C=wA(e.font),l=KA(e.padding),n=e.align;let o=C.lineHeight/2;"bottom"===I||"center"===I||Ta(I)?(o+=l.bottom,Da(e.text)&&(o+=C.lineHeight*(e.text.length-1))):o+=l.top;const{titleX:a,titleY:i,maxWidth:A,rotation:c}=function(g,I,e,t){const{top:C,left:l,bottom:n,right:o,chart:a}=g,{chartArea:i,scales:A}=a;let c,s,d,r=0;const u=n-C,b=o-l;if(g.isHorizontal()){if(s=Di(t,l,o),Ta(e)){const g=Object.keys(e)[0],t=e[g];d=A[g].getPixelForValue(t)+u-I}else d="center"===e?(i.bottom+i.top)/2+u-I:ed(g,e,I);c=o-l}else{if(Ta(e)){const g=Object.keys(e)[0],t=e[g];s=A[g].getPixelForValue(t)-b+I}else s="center"===e?(i.left+i.right)/2-b+I:ed(g,e,I);d=Di(t,n,C),r="left"===e?-hi:hi}return{titleX:s,titleY:d,maxWidth:c,rotation:r}}(this,o,I,n);RA(g,e.text,0,0,C,{color:e.color,maxWidth:A,rotation:c,textAlign:ad(n,I,t),textBaseline:"middle",translation:[a,i]})}draw(g){this._isVisible()&&(this.drawBackground(),this.drawGrid(g),this.drawBorder(),this.drawTitle(),this.drawLabels(g))}_layers(){const g=this.options,I=g.ticks&&g.ticks.z||0,e=Oa(g.grid&&g.grid.z,-1),t=Oa(g.border&&g.border.z,0);return this._isVisible()&&this.draw===id.prototype.draw?[{z:e,draw:g=>{this.drawBackground(),this.drawGrid(g),this.drawTitle()}},{z:t,draw:()=>{this.drawBorder()}},{z:I,draw:g=>{this.drawLabels(g)}}]:[{z:I,draw:g=>{this.draw(g)}}]}getMatchingVisibleMetas(g){const I=this.chart.getSortedVisibleDatasetMetas(),e=this.axis+"AxisID",t=[];let C,l;for(C=0,l=I.length;C<l;++C){const l=I[C];l[e]!==this.id||g&&l.type!==g||t.push(l)}return t}_resolveTickFontOptions(g){return wA(this.options.ticks.setContext(this.getContext(g)).font)}_maxDigits(){const g=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/g}}class Ad{constructor(g,I,e){this.type=g,this.scope=I,this.override=e,this.items=Object.create(null)}isForType(g){return Object.prototype.isPrototypeOf.call(this.type.prototype,g.prototype)}register(g){const I=Object.getPrototypeOf(g);let e;(function(g){return"id"in g&&"defaults"in g})(I)&&(e=this.register(I));const t=this.items,C=g.id,l=this.scope+"."+C;if(!C)throw new Error("class does not have id: "+g);return C in t||(t[C]=g,function(g,I,e){const t=Ci(Object.create(null),[e?dA.get(e):{},dA.get(I),g.defaults]);dA.set(I,t),g.defaultRoutes&&function(g,I){Object.keys(I).forEach((e=>{const t=e.split("."),C=t.pop(),l=[g].concat(t).join("."),n=I[e].split("."),o=n.pop(),a=n.join(".");dA.route(l,C,a,o)}))}(I,g.defaultRoutes);g.descriptors&&dA.describe(I,g.descriptors)}(g,l,e),this.override&&dA.override(g.id,g.overrides)),l}get(g){return this.items[g]}unregister(g){const I=this.items,e=g.id,t=this.scope;e in I&&delete I[e],t&&e in dA[t]&&(delete dA[t][e],this.override&&delete aA[e])}}class cd{constructor(){this.controllers=new Ad(Oc,"datasets",!0),this.elements=new Ad($s,"elements"),this.plugins=new Ad(Object,"plugins"),this.scales=new Ad(id,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("register",I)}remove(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("unregister",I)}addControllers(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("register",I,this.controllers)}addElements(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("register",I,this.elements)}addPlugins(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("register",I,this.plugins)}addScales(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("register",I,this.scales)}getController(g){return this._get(g,this.controllers,"controller")}getElement(g){return this._get(g,this.elements,"element")}getPlugin(g){return this._get(g,this.plugins,"plugin")}getScale(g){return this._get(g,this.scales,"scale")}removeControllers(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("unregister",I,this.controllers)}removeElements(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("unregister",I,this.elements)}removePlugins(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("unregister",I,this.plugins)}removeScales(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];this._each("unregister",I,this.scales)}_each(g,I,e){[...I].forEach((I=>{const t=e||this._getRegistryForType(I);e||t.isForType(I)||t===this.plugins&&I.id?this._exec(g,t,I):$a(I,(I=>{const t=e||this._getRegistryForType(I);this._exec(g,t,I)}))}))}_exec(g,I,e){const t=ii(g);qa(e["before"+t],[],e),I[g](e),qa(e["after"+t],[],e)}_getRegistryForType(g){for(let I=0;I<this._typedRegistries.length;I++){const e=this._typedRegistries[I];if(e.isForType(g))return e}return this.plugins}_get(g,I,e){const t=I.get(g);if(void 0===t)throw new Error('"'+g+'" is not a registered '+e+".");return t}}var sd=new cd;class dd{constructor(){this._init=[]}notify(g,I,e,t){"beforeInit"===I&&(this._init=this._createDescriptors(g,!0),this._notify(this._init,g,"install"));const C=t?this._descriptors(g).filter(t):this._descriptors(g),l=this._notify(C,g,I,e);return"afterDestroy"===I&&(this._notify(C,g,"stop"),this._notify(this._init,g,"uninstall")),l}_notify(g,I,e,t){t=t||{};for(const C of g){const g=C.plugin;if(!1===qa(g[e],[I,t,C.options],g)&&t.cancelable)return!1}return!0}invalidate(){La(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(g){if(this._cache)return this._cache;const I=this._cache=this._createDescriptors(g);return this._notifyStateChanges(g),I}_createDescriptors(g,I){const e=g&&g.config,t=Oa(e.options&&e.options.plugins,{}),C=function(g){const I={},e=[],t=Object.keys(sd.plugins.items);for(let l=0;l<t.length;l++)e.push(sd.getPlugin(t[l]));const C=g.plugins||[];for(let l=0;l<C.length;l++){const g=C[l];-1===e.indexOf(g)&&(e.push(g),I[g.id]=!0)}return{plugins:e,localIds:I}}(e);return!1!==t||I?function(g,I,e,t){let{plugins:C,localIds:l}=I;const n=[],o=g.getContext();for(const a of C){const I=a.id,C=rd(e[I],t);null!==C&&n.push({plugin:a,options:ud(g.config,{plugin:a,local:l[I]},C,o)})}return n}(g,C,t,I):[]}_notifyStateChanges(g){const I=this._oldCache||[],e=this._cache,t=(g,I)=>g.filter((g=>!I.some((I=>g.plugin.id===I.plugin.id))));this._notify(t(I,e),g,"stop"),this._notify(t(e,I),g,"start")}}function rd(g,I){return I||!1!==g?!0===g?{}:g:null}function ud(g,I,e,t){let{plugin:C,local:l}=I;const n=g.pluginScopeKeys(C),o=g.getOptionScopes(e,n);return l&&C.defaults&&o.push(C.defaults),g.createResolver(o,t,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function bd(g,I){const e=dA.datasets[g]||{};return((I.datasets||{})[g]||{}).indexAxis||I.indexAxis||e.indexAxis||"x"}function md(g){if("x"===g||"y"===g||"r"===g)return g}function hd(g){if(md(g))return g;for(var I=arguments.length,e=new Array(I>1?I-1:0),t=1;t<I;t++)e[t-1]=arguments[t];for(const l of e){const I=l.axis||("top"===(C=l.position)||"bottom"===C?"x":"left"===C||"right"===C?"y":void 0)||g.length>1&&md(g[0].toLowerCase());if(I)return I}var C;throw new Error("Cannot determine type of '".concat(g,"' axis. Please provide 'axis' or 'position' option."))}function Zd(g,I,e){if(e[I+"AxisID"]===g)return{axis:I}}function Gd(g,I){const e=aA[g.type]||{scales:{}},t=I.scales||{},C=bd(g.type,I),l=Object.create(null);return Object.keys(t).forEach((I=>{const n=t[I];if(!Ta(n))return console.error("Invalid scale configuration for scale: ".concat(I));if(n._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(I));const o=hd(I,n,function(g,I){if(I.data&&I.data.datasets){const e=I.data.datasets.filter((I=>I.xAxisID===g||I.yAxisID===g));if(e.length)return Zd(g,"x",e[0])||Zd(g,"y",e[0])}return{}}(I,g),dA.scales[n.type]),a=function(g,I){return g===I?"_index_":"_value_"}(o,C),i=e.scales||{};l[I]=li(Object.create(null),[{axis:o},n,i[o],i[a]])})),g.data.datasets.forEach((e=>{const C=e.type||g.type,n=e.indexAxis||bd(C,I),o=(aA[C]||{}).scales||{};Object.keys(o).forEach((g=>{const I=function(g,I){let e=g;return"_index_"===g?e=I:"_value_"===g&&(e="x"===I?"y":"x"),e}(g,n),C=e[I+"AxisID"]||I;l[C]=l[C]||Object.create(null),li(l[C],[{axis:I},t[C],o[g]])}))})),Object.keys(l).forEach((g=>{const I=l[g];li(I,[dA.scales[I.type],dA.scale])})),l}function pd(g){const I=g.options||(g.options={});I.plugins=Oa(I.plugins,{}),I.scales=Gd(g,I)}function Bd(g){return(g=g||{}).datasets=g.datasets||[],g.labels=g.labels||[],g}const yd=new Map,Wd=new Set;function Vd(g,I){let e=yd.get(g);return e||(e=I(),yd.set(g,e),Wd.add(e)),e}const Sd=(g,I,e)=>{const t=ai(I,e);void 0!==t&&g.add(t)};class Rd{constructor(g){this._config=function(g){return(g=g||{}).data=Bd(g.data),pd(g),g}(g),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(g){this._config.type=g}get data(){return this._config.data}set data(g){this._config.data=Bd(g)}get options(){return this._config.options}set options(g){this._config.options=g}get plugins(){return this._config.plugins}update(){const g=this._config;this.clearCache(),pd(g)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(g){return Vd(g,(()=>[["datasets.".concat(g),""]]))}datasetAnimationScopeKeys(g,I){return Vd("".concat(g,".transition.").concat(I),(()=>[["datasets.".concat(g,".transitions.").concat(I),"transitions.".concat(I)],["datasets.".concat(g),""]]))}datasetElementScopeKeys(g,I){return Vd("".concat(g,"-").concat(I),(()=>[["datasets.".concat(g,".elements.").concat(I),"datasets.".concat(g),"elements.".concat(I),""]]))}pluginScopeKeys(g){const I=g.id,e=this.type;return Vd("".concat(e,"-plugin-").concat(I),(()=>[["plugins.".concat(I),...g.additionalOptionScopes||[]]]))}_cachedScopes(g,I){const e=this._scopeCache;let t=e.get(g);return t&&!I||(t=new Map,e.set(g,t)),t}getOptionScopes(g,I,e){const{options:t,type:C}=this,l=this._cachedScopes(g,e),n=l.get(I);if(n)return n;const o=new Set;I.forEach((I=>{g&&(o.add(g),I.forEach((I=>Sd(o,g,I)))),I.forEach((g=>Sd(o,t,g))),I.forEach((g=>Sd(o,aA[C]||{},g))),I.forEach((g=>Sd(o,dA,g))),I.forEach((g=>Sd(o,iA,g)))}));const a=Array.from(o);return 0===a.length&&a.push(Object.create(null)),Wd.has(I)&&l.set(I,a),a}chartOptionScopes(){const{options:g,type:I}=this;return[g,aA[I]||{},dA.datasets[I]||{},{type:I},dA,iA]}resolveNamedOptions(g,I,e){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const C={$shared:!0},{resolver:l,subPrefixes:n}=Xd(this._resolverCache,g,t);let o=l;if(function(g,I){const{isScriptable:e,isIndexable:t}=EA(g);for(const C of I){const I=e(C),l=t(C),n=(l||I)&&g[C];if(I&&(ci(n)||Jd(n))||l&&Da(n))return!0}return!1}(l,I)){C.$shared=!1;o=MA(l,e=ci(e)?e():e,this.createResolver(g,e,n))}for(const a of I)C[a]=o[a];return C}createResolver(g,I){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],t=arguments.length>3?arguments[3]:void 0;const{resolver:C}=Xd(this._resolverCache,g,e);return Ta(I)?MA(C,I,void 0,t):C}}function Xd(g,I,e){let t=g.get(I);t||(t=new Map,g.set(I,t));const C=e.join();let l=t.get(C);if(!l){l={resolver:zA(I,e),subPrefixes:e.filter((g=>!g.toLowerCase().includes("hover")))},t.set(C,l)}return l}const Jd=g=>Ta(g)&&Object.getOwnPropertyNames(g).some((I=>ci(g[I])));const kd=["top","bottom","left","right","chartArea"];function fd(g,I){return"top"===g||"bottom"===g||-1===kd.indexOf(g)&&"x"===I}function vd(g,I){return function(e,t){return e[g]===t[g]?e[I]-t[I]:e[g]-t[g]}}function Yd(g){const I=g.chart,e=I.options.animation;I.notifyPlugins("afterRender"),qa(e&&e.onComplete,[g],I)}function Hd(g){const I=g.chart,e=I.options.animation;qa(e&&e.onProgress,[g],I)}function Nd(g){return oc()&&"string"===typeof g?g=document.getElementById(g):g&&g.length&&(g=g[0]),g&&g.canvas&&(g=g.canvas),g}const Kd={},wd=g=>{const I=Nd(g);return Object.values(Kd).filter((g=>g.canvas===I)).pop()};function Fd(g,I,e){const t=Object.keys(g);for(const C of t){const t=+C;if(t>=I){const l=g[C];delete g[C],(e>0||t>I)&&(g[t+e]=l)}}}function xd(g,I,e){return g.options.clip?g[e]:I[e]}class zd{static register(){sd.add(...arguments),Md()}static unregister(){sd.remove(...arguments),Md()}constructor(g,I){const e=this.config=new Rd(I),t=Nd(g),C=wd(t);if(C)throw new Error("Canvas is already in use. Chart with ID '"+C.id+"' must be destroyed before the canvas with ID '"+C.canvas.id+"' can be reused.");const l=e.createResolver(e.chartOptionScopes(),this.getContext());this.platform=new(e.platform||function(g){return!oc()||"undefined"!==typeof OffscreenCanvas&&g instanceof OffscreenCanvas?ws:qs}(t)),this.platform.updateConfig(e);const n=this.platform.acquireContext(t,l.aspectRatio),o=n&&n.canvas,a=o&&o.height,i=o&&o.width;this.id=Qa(),this.ctx=n,this.canvas=o,this.width=i,this.height=a,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new dd,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(g,I){let e;return function(){for(var t=arguments.length,C=new Array(t),l=0;l<t;l++)C[l]=arguments[l];return I?(clearTimeout(e),e=setTimeout(g,I,C)):g.apply(this,C),I}}((g=>this.update(g)),l.resizeDelay||0),this._dataChanges=[],Kd[this.id]=this,n&&o?(Hc.listen(this,"complete",Yd),Hc.listen(this,"progress",Hd),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:g,maintainAspectRatio:I},width:e,height:t,_aspectRatio:C}=this;return La(g)?I&&C?C:t?e/t:null:g}get data(){return this.config.data}set data(g){this.config.data=g}get options(){return this._options}set options(g){this.config.options=g}get registry(){return sd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():mc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return mA(this.canvas,this.ctx),this}stop(){return Hc.stop(this),this}resize(g,I){Hc.running(this)?this._resizeBeforeDraw={width:g,height:I}:this._resize(g,I)}_resize(g,I){const e=this.options,t=this.canvas,C=e.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(t,g,I,C),n=e.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,mc(this,n,!0)&&(this.notifyPlugins("resize",{size:l}),qa(e.onResize,[this,l],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){$a(this.options.scales||{},((g,I)=>{g.id=I}))}buildOrUpdateScales(){const g=this.options,I=g.scales,e=this.scales,t=Object.keys(e).reduce(((g,I)=>(g[I]=!1,g)),{});let C=[];I&&(C=C.concat(Object.keys(I).map((g=>{const e=I[g],t=hd(g,e),C="r"===t,l="x"===t;return{options:e,dposition:C?"chartArea":l?"bottom":"left",dtype:C?"radialLinear":l?"category":"linear"}})))),$a(C,(I=>{const C=I.options,l=C.id,n=hd(l,C),o=Oa(C.type,I.dtype);void 0!==C.position&&fd(C.position,n)===fd(I.dposition)||(C.position=I.dposition),t[l]=!0;let a=null;if(l in e&&e[l].type===o)a=e[l];else{a=new(sd.getScale(o))({id:l,type:o,ctx:this.ctx,chart:this}),e[a.id]=a}a.init(C,g)})),$a(t,((g,I)=>{g||delete e[I]})),$a(e,(g=>{Ns.configure(this,g,g.options),Ns.addBox(this,g)}))}_updateMetasets(){const g=this._metasets,I=this.data.datasets.length,e=g.length;if(g.sort(((g,I)=>g.index-I.index)),e>I){for(let g=I;g<e;++g)this._destroyDatasetMeta(g);g.splice(I,e-I)}this._sortedMetasets=g.slice(0).sort(vd("order","index"))}_removeUnreferencedMetasets(){const{_metasets:g,data:{datasets:I}}=this;g.length>I.length&&delete this._stacks,g.forEach(((g,e)=>{0===I.filter((I=>I===g._dataset)).length&&this._destroyDatasetMeta(e)}))}buildOrUpdateControllers(){const g=[],I=this.data.datasets;let e,t;for(this._removeUnreferencedMetasets(),e=0,t=I.length;e<t;e++){const t=I[e];let C=this.getDatasetMeta(e);const l=t.type||this.config.type;if(C.type&&C.type!==l&&(this._destroyDatasetMeta(e),C=this.getDatasetMeta(e)),C.type=l,C.indexAxis=t.indexAxis||bd(l,this.options),C.order=t.order||0,C.index=e,C.label=""+t.label,C.visible=this.isDatasetVisible(e),C.controller)C.controller.updateIndex(e),C.controller.linkScales();else{const I=sd.getController(l),{datasetElementType:t,dataElementType:n}=dA.datasets[l];Object.assign(I,{dataElementType:sd.getElement(n),datasetElementType:t&&sd.getElement(t)}),C.controller=new I(this,e),g.push(C.controller)}}return this._updateMetasets(),g}_resetElements(){$a(this.data.datasets,((g,I)=>{this.getDatasetMeta(I).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(g){const I=this.config;I.update();const e=this._options=I.createResolver(I.chartOptionScopes(),this.getContext()),t=this._animationsDisabled=!e.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:g,cancelable:!0}))return;const C=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let a=0,i=this.data.datasets.length;a<i;a++){const{controller:g}=this.getDatasetMeta(a),I=!t&&-1===C.indexOf(g);g.buildOrUpdateElements(I),l=Math.max(+g.getMaxOverflow(),l)}l=this._minPadding=e.layout.autoPadding?l:0,this._updateLayout(l),t||$a(C,(g=>{g.reset()})),this._updateDatasets(g),this.notifyPlugins("afterUpdate",{mode:g}),this._layers.sort(vd("z","_idx"));const{_active:n,_lastEvent:o}=this;o?this._eventHandler(o,!0):n.length&&this._updateHoverStyles(n,n,!0),this.render()}_updateScales(){$a(this.scales,(g=>{Ns.removeBox(this,g)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const g=this.options,I=new Set(Object.keys(this._listeners)),e=new Set(g.events);si(I,e)&&!!this._responsiveListeners===g.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:g}=this,I=this._getUniformDataChanges()||[];for(const{method:e,start:t,count:C}of I){Fd(g,t,"_removeElements"===e?-C:C)}}_getUniformDataChanges(){const g=this._dataChanges;if(!g||!g.length)return;this._dataChanges=[];const I=this.data.datasets.length,e=I=>new Set(g.filter((g=>g[0]===I)).map(((g,I)=>I+","+g.splice(1).join(",")))),t=e(0);for(let C=1;C<I;C++)if(!si(t,e(C)))return;return Array.from(t).map((g=>g.split(","))).map((g=>({method:g[1],start:+g[2],count:+g[3]})))}_updateLayout(g){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Ns.update(this,this.width,this.height,g);const I=this.chartArea,e=I.width<=0||I.height<=0;this._layers=[],$a(this.boxes,(g=>{e&&"chartArea"===g.position||(g.configure&&g.configure(),this._layers.push(...g._layers()))}),this),this._layers.forEach(((g,I)=>{g._idx=I})),this.notifyPlugins("afterLayout")}_updateDatasets(g){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:g,cancelable:!0})){for(let g=0,I=this.data.datasets.length;g<I;++g)this.getDatasetMeta(g).controller.configure();for(let I=0,e=this.data.datasets.length;I<e;++I)this._updateDataset(I,ci(g)?g({datasetIndex:I}):g);this.notifyPlugins("afterDatasetsUpdate",{mode:g})}}_updateDataset(g,I){const e=this.getDatasetMeta(g),t={meta:e,index:g,mode:I,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",t)&&(e.controller._update(I),t.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",t))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Hc.has(this)?this.attached&&!Hc.running(this)&&Hc.start(this):(this.draw(),Yd({chart:this})))}draw(){let g;if(this._resizeBeforeDraw){const{width:g,height:I}=this._resizeBeforeDraw;this._resize(g,I),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const I=this._layers;for(g=0;g<I.length&&I[g].z<=0;++g)I[g].draw(this.chartArea);for(this._drawDatasets();g<I.length;++g)I[g].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(g){const I=this._sortedMetasets,e=[];let t,C;for(t=0,C=I.length;t<C;++t){const C=I[t];g&&!C.visible||e.push(C)}return e}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const g=this.getSortedVisibleDatasetMetas();for(let I=g.length-1;I>=0;--I)this._drawDataset(g[I]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(g){const I=this.ctx,e=g._clip,t=!e.disabled,C=function(g,I){const{xScale:e,yScale:t}=g;return e&&t?{left:xd(e,I,"left"),right:xd(e,I,"right"),top:xd(t,I,"top"),bottom:xd(t,I,"bottom")}:I}(g,this.chartArea),l={meta:g,index:g.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",l)&&(t&&pA(I,{left:!1===e.left?0:C.left-e.left,right:!1===e.right?this.width:C.right+e.right,top:!1===e.top?0:C.top-e.top,bottom:!1===e.bottom?this.height:C.bottom+e.bottom}),g.controller.draw(),t&&BA(I),l.cancelable=!1,this.notifyPlugins("afterDatasetDraw",l))}isPointInArea(g){return GA(g,this.chartArea,this._minPadding)}getElementsAtEventForMode(g,I,e,t){const C=Bs.modes[I];return"function"===typeof C?C(this,g,e,t):[]}getDatasetMeta(g){const I=this.data.datasets[g],e=this._metasets;let t=e.filter((g=>g&&g._dataset===I)).pop();return t||(t={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:I&&I.order||0,index:g,_dataset:I,_parsed:[],_sorted:!1},e.push(t)),t}getContext(){return this.$context||(this.$context=xA(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(g){const I=this.data.datasets[g];if(!I)return!1;const e=this.getDatasetMeta(g);return"boolean"===typeof e.hidden?!e.hidden:!I.hidden}setDatasetVisibility(g,I){this.getDatasetMeta(g).hidden=!I}toggleDataVisibility(g){this._hiddenIndices[g]=!this._hiddenIndices[g]}getDataVisibility(g){return!this._hiddenIndices[g]}_updateVisibility(g,I,e){const t=e?"show":"hide",C=this.getDatasetMeta(g),l=C.controller._resolveAnimations(void 0,t);Ai(I)?(C.data[I].hidden=!e,this.update()):(this.setDatasetVisibility(g,e),l.update(C,{visible:e}),this.update((I=>I.datasetIndex===g?t:void 0)))}hide(g,I){this._updateVisibility(g,I,!1)}show(g,I){this._updateVisibility(g,I,!0)}_destroyDatasetMeta(g){const I=this._metasets[g];I&&I.controller&&I.controller._destroy(),delete this._metasets[g]}_stop(){let g,I;for(this.stop(),Hc.remove(this),g=0,I=this.data.datasets.length;g<I;++g)this._destroyDatasetMeta(g)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:g,ctx:I}=this;this._stop(),this.config.clearCache(),g&&(this.unbindEvents(),mA(g,I),this.platform.releaseContext(I),this.canvas=null,this.ctx=null),delete Kd[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const g=this._listeners,I=this.platform,e=(e,t)=>{I.addEventListener(this,e,t),g[e]=t},t=(g,I,e)=>{g.offsetX=I,g.offsetY=e,this._eventHandler(g)};$a(this.options.events,(g=>e(g,t)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const g=this._responsiveListeners,I=this.platform,e=(e,t)=>{I.addEventListener(this,e,t),g[e]=t},t=(e,t)=>{g[e]&&(I.removeEventListener(this,e,t),delete g[e])},C=(g,I)=>{this.canvas&&this.resize(g,I)};let l;const n=()=>{t("attach",n),this.attached=!0,this.resize(),e("resize",C),e("detach",l)};l=()=>{this.attached=!1,t("resize",C),this._stop(),this._resize(0,0),e("attach",n)},I.isAttached(this.canvas)?n():l()}unbindEvents(){$a(this._listeners,((g,I)=>{this.platform.removeEventListener(this,I,g)})),this._listeners={},$a(this._responsiveListeners,((g,I)=>{this.platform.removeEventListener(this,I,g)})),this._responsiveListeners=void 0}updateHoverStyle(g,I,e){const t=e?"set":"remove";let C,l,n,o;for("dataset"===I&&(C=this.getDatasetMeta(g[0].datasetIndex),C.controller["_"+t+"DatasetHoverStyle"]()),n=0,o=g.length;n<o;++n){l=g[n];const I=l&&this.getDatasetMeta(l.datasetIndex).controller;I&&I[t+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(g){const I=this._active||[],e=g.map((g=>{let{datasetIndex:I,index:e}=g;const t=this.getDatasetMeta(I);if(!t)throw new Error("No dataset found at index "+I);return{datasetIndex:I,element:t.data[e],index:e}}));!gi(e,I)&&(this._active=e,this._lastEvent=null,this._updateHoverStyles(e,I))}notifyPlugins(g,I,e){return this._plugins.notify(this,g,I,e)}isPluginEnabled(g){return 1===this._plugins._cache.filter((I=>I.plugin.id===g)).length}_updateHoverStyles(g,I,e){const t=this.options.hover,C=(g,I)=>g.filter((g=>!I.some((I=>g.datasetIndex===I.datasetIndex&&g.index===I.index)))),l=C(I,g),n=e?g:C(g,I);l.length&&this.updateHoverStyle(l,t.mode,!1),n.length&&t.mode&&this.updateHoverStyle(n,t.mode,!0)}_eventHandler(g,I){const e={event:g,replay:I,cancelable:!0,inChartArea:this.isPointInArea(g)},t=I=>(I.options.events||this.options.events).includes(g.native.type);if(!1===this.notifyPlugins("beforeEvent",e,t))return;const C=this._handleEvent(g,I,e.inChartArea);return e.cancelable=!1,this.notifyPlugins("afterEvent",e,t),(C||e.changed)&&this.render(),this}_handleEvent(g,I,e){const{_active:t=[],options:C}=this,l=I,n=this._getActiveElements(g,t,e,l),o=function(g){return"mouseup"===g.type||"click"===g.type||"contextmenu"===g.type}(g),a=function(g,I,e,t){return e&&"mouseout"!==g.type?t?I:g:null}(g,this._lastEvent,e,o);e&&(this._lastEvent=null,qa(C.onHover,[g,n,this],this),o&&qa(C.onClick,[g,n,this],this));const i=!gi(n,t);return(i||I)&&(this._active=n,this._updateHoverStyles(n,t,I)),this._lastEvent=a,i}_getActiveElements(g,I,e,t){if("mouseout"===g.type)return[];if(!e)return I;const C=this.options.hover;return this.getElementsAtEventForMode(g,C.mode,C,t)}}function Md(){return $a(zd.instances,(g=>g._plugins.invalidate()))}function Ed(g,I,e,t){const C=YA(g.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const l=(e-I)/2,n=Math.min(l,t*I/2),o=g=>{const I=(e-Math.min(l,g))*t/2;return Ni(g,0,Math.min(l,I))};return{outerStart:o(C.outerStart),outerEnd:o(C.outerEnd),innerStart:Ni(C.innerStart,0,n),innerEnd:Ni(C.innerEnd,0,n)}}function Ud(g,I,e,t){return{x:e+g*Math.cos(I),y:t+g*Math.sin(I)}}function Qd(g,I,e,t,C,l){const{x:n,y:o,startAngle:a,pixelMargin:i,innerRadius:A}=I,c=Math.max(I.outerRadius+t+e-i,0),s=A>0?A+t+e+i:0;let d=0;const r=C-a;if(t){const g=((A>0?A-t:0)+(c>0?c-t:0))/2;d=(r-(0!==g?r*g/(g+t):r))/2}const u=(r-Math.max(.001,r*c-e/di)/c)/2,b=a+u+d,m=C-u-d,{outerStart:h,outerEnd:Z,innerStart:G,innerEnd:p}=Ed(I,s,c,m-b),B=c-h,y=c-Z,W=b+h/B,V=m-Z/y,S=s+G,R=s+p,X=b+G/S,J=m-p/R;if(g.beginPath(),l){const I=(W+V)/2;if(g.arc(n,o,c,W,I),g.arc(n,o,c,I,V),Z>0){const I=Ud(y,V,n,o);g.arc(I.x,I.y,Z,V,m+hi)}const e=Ud(R,m,n,o);if(g.lineTo(e.x,e.y),p>0){const I=Ud(R,J,n,o);g.arc(I.x,I.y,p,m+hi,J+Math.PI)}const t=(m-p/s+(b+G/s))/2;if(g.arc(n,o,s,m-p/s,t,!0),g.arc(n,o,s,t,b+G/s,!0),G>0){const I=Ud(S,X,n,o);g.arc(I.x,I.y,G,X+Math.PI,b-hi)}const C=Ud(B,b,n,o);if(g.lineTo(C.x,C.y),h>0){const I=Ud(B,W,n,o);g.arc(I.x,I.y,h,b-hi,W)}}else{g.moveTo(n,o);const I=Math.cos(W)*c+n,e=Math.sin(W)*c+o;g.lineTo(I,e);const t=Math.cos(V)*c+n,C=Math.sin(V)*c+o;g.lineTo(t,C)}g.closePath()}function Ld(g,I,e,t,C){const{fullCircles:l,startAngle:n,circumference:o,options:a}=I,{borderWidth:i,borderJoinStyle:A,borderDash:c,borderDashOffset:s}=a,d="inner"===a.borderAlign;if(!i)return;g.setLineDash(c||[]),g.lineDashOffset=s,d?(g.lineWidth=2*i,g.lineJoin=A||"round"):(g.lineWidth=i,g.lineJoin=A||"bevel");let r=I.endAngle;if(l){Qd(g,I,e,t,r,C);for(let I=0;I<l;++I)g.stroke();isNaN(o)||(r=n+(o%ri||ri))}d&&function(g,I,e){const{startAngle:t,pixelMargin:C,x:l,y:n,outerRadius:o,innerRadius:a}=I;let i=C/o;g.beginPath(),g.arc(l,n,o,t-i,e+i),a>C?(i=C/a,g.arc(l,n,a,e+i,t-i,!0)):g.arc(l,n,C,e+hi,t-hi),g.closePath(),g.clip()}(g,I,r),l||(Qd(g,I,e,t,r,C),g.stroke())}ia(zd,"defaults",dA),ia(zd,"instances",Kd),ia(zd,"overrides",aA),ia(zd,"registry",sd),ia(zd,"version","4.4.3"),ia(zd,"getChart",wd);class Dd extends $s{constructor(g){super(),ia(this,"circumference",void 0),ia(this,"endAngle",void 0),ia(this,"fullCircles",void 0),ia(this,"innerRadius",void 0),ia(this,"outerRadius",void 0),ia(this,"pixelMargin",void 0),ia(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,g&&Object.assign(this,g)}inRange(g,I,e){const t=this.getProps(["x","y"],e),{angle:C,distance:l}=ki(t,{x:g,y:I}),{startAngle:n,endAngle:o,innerRadius:a,outerRadius:i,circumference:A}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],e),c=(this.options.spacing+this.options.borderWidth)/2,s=Oa(A,o-n)>=ri||Hi(C,n,o),d=Ki(l,a+c,i+c);return s&&d}getCenterPoint(g){const{x:I,y:e,startAngle:t,endAngle:C,innerRadius:l,outerRadius:n}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],g),{offset:o,spacing:a}=this.options,i=(t+C)/2,A=(l+n+a+o)/2;return{x:I+Math.cos(i)*A,y:e+Math.sin(i)*A}}tooltipPosition(g){return this.getCenterPoint(g)}draw(g){const{options:I,circumference:e}=this,t=(I.offset||0)/4,C=(I.spacing||0)/2,l=I.circular;if(this.pixelMargin="inner"===I.borderAlign?.33:0,this.fullCircles=e>ri?Math.floor(e/ri):0,0===e||this.innerRadius<0||this.outerRadius<0)return;g.save();const n=(this.startAngle+this.endAngle)/2;g.translate(Math.cos(n)*t,Math.sin(n)*t);const o=t*(1-Math.sin(Math.min(di,e||0)));g.fillStyle=I.backgroundColor,g.strokeStyle=I.borderColor,function(g,I,e,t,C){const{fullCircles:l,startAngle:n,circumference:o}=I;let a=I.endAngle;if(l){Qd(g,I,e,t,a,C);for(let I=0;I<l;++I)g.fill();isNaN(o)||(a=n+(o%ri||ri))}Qd(g,I,e,t,a,C),g.fill()}(g,this,o,C,l),Ld(g,this,o,C,l),g.restore()}}function Td(g,I){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I;g.lineCap=Oa(e.borderCapStyle,I.borderCapStyle),g.setLineDash(Oa(e.borderDash,I.borderDash)),g.lineDashOffset=Oa(e.borderDashOffset,I.borderDashOffset),g.lineJoin=Oa(e.borderJoinStyle,I.borderJoinStyle),g.lineWidth=Oa(e.borderWidth,I.borderWidth),g.strokeStyle=Oa(e.borderColor,I.borderColor)}function jd(g,I,e){g.lineTo(e.x,e.y)}function Pd(g,I){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const t=g.length,{start:C=0,end:l=t-1}=e,{start:n,end:o}=I,a=Math.max(C,n),i=Math.min(l,o),A=C<n&&l<n||C>o&&l>o;return{count:t,start:a,loop:I.loop,ilen:i<a&&!A?t+i-a:i-a}}function Od(g,I,e,t){const{points:C,options:l}=I,{count:n,start:o,loop:a,ilen:i}=Pd(C,e,t),A=function(g){return g.stepped?yA:g.tension||"monotone"===g.cubicInterpolationMode?WA:jd}(l);let c,s,d,{move:r=!0,reverse:u}=t||{};for(c=0;c<=i;++c)s=C[(o+(u?i-c:c))%n],s.skip||(r?(g.moveTo(s.x,s.y),r=!1):A(g,d,s,u,l.stepped),d=s);return a&&(s=C[(o+(u?i:0))%n],A(g,d,s,u,l.stepped)),!!a}function _d(g,I,e,t){const C=I.points,{count:l,start:n,ilen:o}=Pd(C,e,t),{move:a=!0,reverse:i}=t||{};let A,c,s,d,r,u,b=0,m=0;const h=g=>(n+(i?o-g:g))%l,Z=()=>{d!==r&&(g.lineTo(b,r),g.lineTo(b,d),g.lineTo(b,u))};for(a&&(c=C[h(0)],g.moveTo(c.x,c.y)),A=0;A<=o;++A){if(c=C[h(A)],c.skip)continue;const I=c.x,e=c.y,t=0|I;t===s?(e<d?d=e:e>r&&(r=e),b=(m*b+I)/++m):(Z(),g.lineTo(I,e),s=t,m=0,d=r=e),u=e}Z()}function qd(g){const I=g.options,e=I.borderDash&&I.borderDash.length;return!g._decimated&&!g._loop&&!I.tension&&"monotone"!==I.cubicInterpolationMode&&!I.stepped&&!e?_d:Od}ia(Dd,"id","arc"),ia(Dd,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),ia(Dd,"defaultRoutes",{backgroundColor:"backgroundColor"}),ia(Dd,"descriptors",{_scriptable:!0,_indexable:g=>"borderDash"!==g});const $d="function"===typeof Path2D;function gr(g,I,e,t){$d&&!I.options.segment?function(g,I,e,t){let C=I._path;C||(C=I._path=new Path2D,I.path(C,e,t)&&C.closePath()),Td(g,I.options),g.stroke(C)}(g,I,e,t):function(g,I,e,t){const{segments:C,options:l}=I,n=qd(I);for(const o of C)Td(g,l,o.style),g.beginPath(),n(g,I,o,{start:e,end:e+t-1})&&g.closePath(),g.stroke()}(g,I,e,t)}class Ir extends $s{constructor(g){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,g&&Object.assign(this,g)}updateControlPoints(g,I){const e=this.options;if((e.tension||"monotone"===e.cubicInterpolationMode)&&!e.stepped&&!this._pointsUpdated){const t=e.spanGaps?this._loop:this._fullLoop;nc(this._points,e,g,t,I),this._pointsUpdated=!0}}set points(g){this._points=g,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(g,I){const e=g.points,t=g.options.spanGaps,C=e.length;if(!C)return[];const l=!!g._loop,{start:n,end:o}=function(g,I,e,t){let C=0,l=I-1;if(e&&!t)for(;C<I&&!g[C].skip;)C++;for(;C<I&&g[C].skip;)C++;for(C%=I,e&&(l+=C);l>C&&g[l%I].skip;)l--;return l%=I,{start:C,end:l}}(e,C,l,t);return kc(g,!0===t?[{start:n,end:o,loop:l}]:function(g,I,e,t){const C=g.length,l=[];let n,o=I,a=g[I];for(n=I+1;n<=e;++n){const e=g[n%C];e.skip||e.stop?a.skip||(t=!1,l.push({start:I%C,end:(n-1)%C,loop:t}),I=o=e.stop?n:null):(o=n,a.skip&&(I=n)),a=e}return null!==o&&l.push({start:I%C,end:o%C,loop:t}),l}(e,n,o<n?o+C:o,!!g._fullLoop&&0===n&&o===C-1),e,I)}(this,this.options.segment))}first(){const g=this.segments,I=this.points;return g.length&&I[g[0].start]}last(){const g=this.segments,I=this.points,e=g.length;return e&&I[g[e-1].end]}interpolate(g,I){const e=this.options,t=g[I],C=this.points,l=Jc(this,{property:I,start:t,end:t});if(!l.length)return;const n=[],o=function(g){return g.stepped?pc:g.tension||"monotone"===g.cubicInterpolationMode?Bc:Gc}(e);let a,i;for(a=0,i=l.length;a<i;++a){const{start:i,end:A}=l[a],c=C[i],s=C[A];if(c===s){n.push(c);continue}const d=o(c,s,Math.abs((t-c[I])/(s[I]-c[I])),e.stepped);d[I]=g[I],n.push(d)}return 1===n.length?n[0]:n}pathSegment(g,I,e){return qd(this)(g,this,I,e)}path(g,I,e){const t=this.segments,C=qd(this);let l=this._loop;I=I||0,e=e||this.points.length-I;for(const n of t)l&=C(g,this,n,{start:I,end:I+e-1});return!!l}draw(g,I,e,t){const C=this.options||{};(this.points||[]).length&&C.borderWidth&&(g.save(),gr(g,this,e,t),g.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function er(g,I,e,t){const C=g.options,{[e]:l}=g.getProps([e],t);return Math.abs(I-l)<C.radius+C.hitRadius}ia(Ir,"id","line"),ia(Ir,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ia(Ir,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ia(Ir,"descriptors",{_scriptable:!0,_indexable:g=>"borderDash"!==g&&"fill"!==g});class tr extends $s{constructor(g){super(),ia(this,"parsed",void 0),ia(this,"skip",void 0),ia(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,g&&Object.assign(this,g)}inRange(g,I,e){const t=this.options,{x:C,y:l}=this.getProps(["x","y"],e);return Math.pow(g-C,2)+Math.pow(I-l,2)<Math.pow(t.hitRadius+t.radius,2)}inXRange(g,I){return er(this,g,"x",I)}inYRange(g,I){return er(this,g,"y",I)}getCenterPoint(g){const{x:I,y:e}=this.getProps(["x","y"],g);return{x:I,y:e}}size(g){let I=(g=g||this.options||{}).radius||0;I=Math.max(I,I&&g.hoverRadius||0);return 2*(I+(I&&g.borderWidth||0))}draw(g,I){const e=this.options;this.skip||e.radius<.1||!GA(this,I,this.size(e)/2)||(g.strokeStyle=e.borderColor,g.lineWidth=e.borderWidth,g.fillStyle=e.backgroundColor,hA(g,e,this.x,this.y))}getRange(){const g=this.options||{};return g.radius+g.hitRadius}}function Cr(g,I){const{x:e,y:t,base:C,width:l,height:n}=g.getProps(["x","y","base","width","height"],I);let o,a,i,A,c;return g.horizontal?(c=n/2,o=Math.min(e,C),a=Math.max(e,C),i=t-c,A=t+c):(c=l/2,o=e-c,a=e+c,i=Math.min(t,C),A=Math.max(t,C)),{left:o,top:i,right:a,bottom:A}}function lr(g,I,e,t){return g?0:Ni(I,e,t)}function nr(g){const I=Cr(g),e=I.right-I.left,t=I.bottom-I.top,C=function(g,I,e){const t=g.options.borderWidth,C=g.borderSkipped,l=HA(t);return{t:lr(C.top,l.top,0,e),r:lr(C.right,l.right,0,I),b:lr(C.bottom,l.bottom,0,e),l:lr(C.left,l.left,0,I)}}(g,e/2,t/2),l=function(g,I,e){const{enableBorderRadius:t}=g.getProps(["enableBorderRadius"]),C=g.options.borderRadius,l=NA(C),n=Math.min(I,e),o=g.borderSkipped,a=t||Ta(C);return{topLeft:lr(!a||o.top||o.left,l.topLeft,0,n),topRight:lr(!a||o.top||o.right,l.topRight,0,n),bottomLeft:lr(!a||o.bottom||o.left,l.bottomLeft,0,n),bottomRight:lr(!a||o.bottom||o.right,l.bottomRight,0,n)}}(g,e/2,t/2);return{outer:{x:I.left,y:I.top,w:e,h:t,radius:l},inner:{x:I.left+C.l,y:I.top+C.t,w:e-C.l-C.r,h:t-C.t-C.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(C.t,C.l)),topRight:Math.max(0,l.topRight-Math.max(C.t,C.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(C.b,C.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(C.b,C.r))}}}}function or(g,I,e,t){const C=null===I,l=null===e,n=g&&!(C&&l)&&Cr(g,t);return n&&(C||Ki(I,n.left,n.right))&&(l||Ki(e,n.top,n.bottom))}function ar(g,I){g.rect(I.x,I.y,I.w,I.h)}function ir(g,I){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const t=g.x!==e.x?-I:0,C=g.y!==e.y?-I:0,l=(g.x+g.w!==e.x+e.w?I:0)-t,n=(g.y+g.h!==e.y+e.h?I:0)-C;return{x:g.x+t,y:g.y+C,w:g.w+l,h:g.h+n,radius:g.radius}}ia(tr,"id","point"),ia(tr,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ia(tr,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class Ar extends $s{constructor(g){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,g&&Object.assign(this,g)}draw(g){const{inflateAmount:I,options:{borderColor:e,backgroundColor:t}}=this,{inner:C,outer:l}=nr(this),n=(o=l.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?XA:ar;var o;g.save(),l.w===C.w&&l.h===C.h||(g.beginPath(),n(g,ir(l,I,C)),g.clip(),n(g,ir(C,-I,l)),g.fillStyle=e,g.fill("evenodd")),g.beginPath(),n(g,ir(C,I)),g.fillStyle=t,g.fill(),g.restore()}inRange(g,I,e){return or(this,g,I,e)}inXRange(g,I){return or(this,g,null,I)}inYRange(g,I){return or(this,null,g,I)}getCenterPoint(g){const{x:I,y:e,base:t,horizontal:C}=this.getProps(["x","y","base","horizontal"],g);return{x:C?(I+t)/2:I,y:C?e:(e+t)/2}}getRange(g){return"x"===g?this.width/2:this.height/2}}ia(Ar,"id","bar"),ia(Ar,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ia(Ar,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const cr=(g,I)=>{let{boxHeight:e=I,boxWidth:t=I}=g;return g.usePointStyle&&(e=Math.min(e,I),t=g.pointStyleWidth||Math.min(t,I)),{boxWidth:t,boxHeight:e,itemHeight:Math.max(I,e)}};class sr extends $s{constructor(g){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=g.chart,this.options=g.options,this.ctx=g.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(g,I,e){this.maxWidth=g,this.maxHeight=I,this._margins=e,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const g=this.options.labels||{};let I=qa(g.generateLabels,[this.chart],this)||[];g.filter&&(I=I.filter((I=>g.filter(I,this.chart.data)))),g.sort&&(I=I.sort(((I,e)=>g.sort(I,e,this.chart.data)))),this.options.reverse&&I.reverse(),this.legendItems=I}fit(){const{options:g,ctx:I}=this;if(!g.display)return void(this.width=this.height=0);const e=g.labels,t=wA(e.font),C=t.size,l=this._computeTitleHeight(),{boxWidth:n,itemHeight:o}=cr(e,C);let a,i;I.font=t.string,this.isHorizontal()?(a=this.maxWidth,i=this._fitRows(l,C,n,o)+10):(i=this.maxHeight,a=this._fitCols(l,t,n,o)+10),this.width=Math.min(a,g.maxWidth||this.maxWidth),this.height=Math.min(i,g.maxHeight||this.maxHeight)}_fitRows(g,I,e,t){const{ctx:C,maxWidth:l,options:{labels:{padding:n}}}=this,o=this.legendHitBoxes=[],a=this.lineWidths=[0],i=t+n;let A=g;C.textAlign="left",C.textBaseline="middle";let c=-1,s=-i;return this.legendItems.forEach(((g,d)=>{const r=e+I/2+C.measureText(g.text).width;(0===d||a[a.length-1]+r+2*n>l)&&(A+=i,a[a.length-(d>0?0:1)]=0,s+=i,c++),o[d]={left:0,top:s,row:c,width:r,height:t},a[a.length-1]+=r+n})),A}_fitCols(g,I,e,t){const{ctx:C,maxHeight:l,options:{labels:{padding:n}}}=this,o=this.legendHitBoxes=[],a=this.columnSizes=[],i=l-g;let A=n,c=0,s=0,d=0,r=0;return this.legendItems.forEach(((g,l)=>{const{itemWidth:u,itemHeight:b}=function(g,I,e,t,C){const l=function(g,I,e,t){let C=g.text;C&&"string"!==typeof C&&(C=C.reduce(((g,I)=>g.length>I.length?g:I)));return I+e.size/2+t.measureText(C).width}(t,g,I,e),n=function(g,I,e){let t=g;"string"!==typeof I.text&&(t=dr(I,e));return t}(C,t,I.lineHeight);return{itemWidth:l,itemHeight:n}}(e,I,C,g,t);l>0&&s+b+2*n>i&&(A+=c+n,a.push({width:c,height:s}),d+=c+n,r++,c=s=0),o[l]={left:d,top:s,col:r,width:u,height:b},c=Math.max(c,u),s+=b+n})),A+=c,a.push({width:c,height:s}),A}adjustHitBoxes(){if(!this.options.display)return;const g=this._computeTitleHeight(),{legendHitBoxes:I,options:{align:e,labels:{padding:t},rtl:C}}=this,l=yc(C,this.left,this.width);if(this.isHorizontal()){let C=0,n=Di(e,this.left+t,this.right-this.lineWidths[C]);for(const o of I)C!==o.row&&(C=o.row,n=Di(e,this.left+t,this.right-this.lineWidths[C])),o.top+=this.top+g+t,o.left=l.leftForLtr(l.x(n),o.width),n+=o.width+t}else{let C=0,n=Di(e,this.top+g+t,this.bottom-this.columnSizes[C].height);for(const o of I)o.col!==C&&(C=o.col,n=Di(e,this.top+g+t,this.bottom-this.columnSizes[C].height)),o.top=n,o.left+=this.left+t,o.left=l.leftForLtr(l.x(o.left),o.width),n+=o.height+t}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const g=this.ctx;pA(g,this),this._draw(),BA(g)}}_draw(){const{options:g,columnSizes:I,lineWidths:e,ctx:t}=this,{align:C,labels:l}=g,n=dA.color,o=yc(g.rtl,this.left,this.width),a=wA(l.font),{padding:i}=l,A=a.size,c=A/2;let s;this.drawTitle(),t.textAlign=o.textAlign("left"),t.textBaseline="middle",t.lineWidth=.5,t.font=a.string;const{boxWidth:d,boxHeight:r,itemHeight:u}=cr(l,A),b=this.isHorizontal(),m=this._computeTitleHeight();s=b?{x:Di(C,this.left+i,this.right-e[0]),y:this.top+i+m,line:0}:{x:this.left+i,y:Di(C,this.top+m+i,this.bottom-I[0].height),line:0},Wc(this.ctx,g.textDirection);const h=u+i;this.legendItems.forEach(((Z,G)=>{t.strokeStyle=Z.fontColor,t.fillStyle=Z.fontColor;const p=t.measureText(Z.text).width,B=o.textAlign(Z.textAlign||(Z.textAlign=l.textAlign)),y=d+c+p;let W=s.x,V=s.y;o.setWidth(this.width),b?G>0&&W+y+i>this.right&&(V=s.y+=h,s.line++,W=s.x=Di(C,this.left+i,this.right-e[s.line])):G>0&&V+h>this.bottom&&(W=s.x=W+I[s.line].width+i,s.line++,V=s.y=Di(C,this.top+m+i,this.bottom-I[s.line].height));if(function(g,I,e){if(isNaN(d)||d<=0||isNaN(r)||r<0)return;t.save();const C=Oa(e.lineWidth,1);if(t.fillStyle=Oa(e.fillStyle,n),t.lineCap=Oa(e.lineCap,"butt"),t.lineDashOffset=Oa(e.lineDashOffset,0),t.lineJoin=Oa(e.lineJoin,"miter"),t.lineWidth=C,t.strokeStyle=Oa(e.strokeStyle,n),t.setLineDash(Oa(e.lineDash,[])),l.usePointStyle){const n={radius:r*Math.SQRT2/2,pointStyle:e.pointStyle,rotation:e.rotation,borderWidth:C},a=o.xPlus(g,d/2);ZA(t,n,a,I+c,l.pointStyleWidth&&d)}else{const l=I+Math.max((A-r)/2,0),n=o.leftForLtr(g,d),a=NA(e.borderRadius);t.beginPath(),Object.values(a).some((g=>0!==g))?XA(t,{x:n,y:l,w:d,h:r,radius:a}):t.rect(n,l,d,r),t.fill(),0!==C&&t.stroke()}t.restore()}(o.x(W),V,Z),W=((g,I,e,t)=>g===(t?"left":"right")?e:"center"===g?(I+e)/2:I)(B,W+d+c,b?W+y:this.right,g.rtl),function(g,I,e){RA(t,e.text,g,I+u/2,a,{strikethrough:e.hidden,textAlign:o.textAlign(e.textAlign)})}(o.x(W),V,Z),b)s.x+=y+i;else if("string"!==typeof Z.text){const g=a.lineHeight;s.y+=dr(Z,g)+i}else s.y+=h})),Vc(this.ctx,g.textDirection)}drawTitle(){const g=this.options,I=g.title,e=wA(I.font),t=KA(I.padding);if(!I.display)return;const C=yc(g.rtl,this.left,this.width),l=this.ctx,n=I.position,o=e.size/2,a=t.top+o;let i,A=this.left,c=this.width;if(this.isHorizontal())c=Math.max(...this.lineWidths),i=this.top+a,A=Di(g.align,A,this.right-c);else{const I=this.columnSizes.reduce(((g,I)=>Math.max(g,I.height)),0);i=a+Di(g.align,this.top,this.bottom-I-g.labels.padding-this._computeTitleHeight())}const s=Di(n,A,A+c);l.textAlign=C.textAlign(Li(n)),l.textBaseline="middle",l.strokeStyle=I.color,l.fillStyle=I.color,l.font=e.string,RA(l,I.text,s,i,e)}_computeTitleHeight(){const g=this.options.title,I=wA(g.font),e=KA(g.padding);return g.display?I.lineHeight+e.height:0}_getLegendItemAt(g,I){let e,t,C;if(Ki(g,this.left,this.right)&&Ki(I,this.top,this.bottom))for(C=this.legendHitBoxes,e=0;e<C.length;++e)if(t=C[e],Ki(g,t.left,t.left+t.width)&&Ki(I,t.top,t.top+t.height))return this.legendItems[e];return null}handleEvent(g){const I=this.options;if(!function(g,I){if(("mousemove"===g||"mouseout"===g)&&(I.onHover||I.onLeave))return!0;if(I.onClick&&("click"===g||"mouseup"===g))return!0;return!1}(g.type,I))return;const e=this._getLegendItemAt(g.x,g.y);if("mousemove"===g.type||"mouseout"===g.type){const l=this._hoveredItem,n=(C=e,null!==(t=l)&&null!==C&&t.datasetIndex===C.datasetIndex&&t.index===C.index);l&&!n&&qa(I.onLeave,[g,l,this],this),this._hoveredItem=e,e&&!n&&qa(I.onHover,[g,e,this],this)}else e&&qa(I.onClick,[g,e,this],this);var t,C}}function dr(g,I){return I*(g.text?g.text.length:0)}var rr={id:"legend",_element:sr,start(g,I,e){const t=g.legend=new sr({ctx:g.ctx,options:e,chart:g});Ns.configure(g,t,e),Ns.addBox(g,t)},stop(g){Ns.removeBox(g,g.legend),delete g.legend},beforeUpdate(g,I,e){const t=g.legend;Ns.configure(g,t,e),t.options=e},afterUpdate(g){const I=g.legend;I.buildLabels(),I.adjustHitBoxes()},afterEvent(g,I){I.replay||g.legend.handleEvent(I.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(g,I,e){const t=I.datasetIndex,C=e.chart;C.isDatasetVisible(t)?(C.hide(t),I.hidden=!0):(C.show(t),I.hidden=!1)},onHover:null,onLeave:null,labels:{color:g=>g.chart.options.color,boxWidth:40,padding:10,generateLabels(g){const I=g.data.datasets,{labels:{usePointStyle:e,pointStyle:t,textAlign:C,color:l,useBorderRadius:n,borderRadius:o}}=g.legend.options;return g._getSortedDatasetMetas().map((g=>{const a=g.controller.getStyle(e?0:void 0),i=KA(a.borderWidth);return{text:I[g.index].label,fillStyle:a.backgroundColor,fontColor:l,hidden:!g.visible,lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:(i.width+i.height)/4,strokeStyle:a.borderColor,pointStyle:t||a.pointStyle,rotation:a.rotation,textAlign:C||a.textAlign,borderRadius:n&&(o||a.borderRadius),datasetIndex:g.index}}),this)}},title:{color:g=>g.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:g=>!g.startsWith("on"),labels:{_scriptable:g=>!["generateLabels","filter","sort"].includes(g)}}};class ur extends $s{constructor(g){super(),this.chart=g.chart,this.options=g.options,this.ctx=g.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(g,I){const e=this.options;if(this.left=0,this.top=0,!e.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=g,this.height=this.bottom=I;const t=Da(e.text)?e.text.length:1;this._padding=KA(e.padding);const C=t*wA(e.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=C:this.width=C}isHorizontal(){const g=this.options.position;return"top"===g||"bottom"===g}_drawArgs(g){const{top:I,left:e,bottom:t,right:C,options:l}=this,n=l.align;let o,a,i,A=0;return this.isHorizontal()?(a=Di(n,e,C),i=I+g,o=C-e):("left"===l.position?(a=e+g,i=Di(n,t,I),A=-.5*di):(a=C-g,i=Di(n,I,t),A=.5*di),o=t-I),{titleX:a,titleY:i,maxWidth:o,rotation:A}}draw(){const g=this.ctx,I=this.options;if(!I.display)return;const e=wA(I.font),t=e.lineHeight/2+this._padding.top,{titleX:C,titleY:l,maxWidth:n,rotation:o}=this._drawArgs(t);RA(g,I.text,0,0,e,{color:I.color,maxWidth:n,rotation:o,textAlign:Li(I.align),textBaseline:"middle",translation:[C,l]})}}var br={id:"title",_element:ur,start(g,I,e){!function(g,I){const e=new ur({ctx:g.ctx,options:I,chart:g});Ns.configure(g,e,I),Ns.addBox(g,e),g.titleBlock=e}(g,e)},stop(g){const I=g.titleBlock;Ns.removeBox(g,I),delete g.titleBlock},beforeUpdate(g,I,e){const t=g.titleBlock;Ns.configure(g,t,e),t.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const mr={average(g){if(!g.length)return!1;let I,e,t=new Set,C=0,l=0;for(I=0,e=g.length;I<e;++I){const e=g[I].element;if(e&&e.hasValue()){const g=e.tooltipPosition();t.add(g.x),C+=g.y,++l}}return{x:[...t].reduce(((g,I)=>g+I))/t.size,y:C/l}},nearest(g,I){if(!g.length)return!1;let e,t,C,l=I.x,n=I.y,o=Number.POSITIVE_INFINITY;for(e=0,t=g.length;e<t;++e){const t=g[e].element;if(t&&t.hasValue()){const g=fi(I,t.getCenterPoint());g<o&&(o=g,C=t)}}if(C){const g=C.tooltipPosition();l=g.x,n=g.y}return{x:l,y:n}}};function hr(g,I){return I&&(Da(I)?Array.prototype.push.apply(g,I):g.push(I)),g}function Zr(g){return("string"===typeof g||g instanceof String)&&g.indexOf("\n")>-1?g.split("\n"):g}function Gr(g,I){const{element:e,datasetIndex:t,index:C}=I,l=g.getDatasetMeta(t).controller,{label:n,value:o}=l.getLabelAndValue(C);return{chart:g,label:n,parsed:l.getParsed(C),raw:g.data.datasets[t].data[C],formattedValue:o,dataset:l.getDataset(),dataIndex:C,datasetIndex:t,element:e}}function pr(g,I){const e=g.chart.ctx,{body:t,footer:C,title:l}=g,{boxWidth:n,boxHeight:o}=I,a=wA(I.bodyFont),i=wA(I.titleFont),A=wA(I.footerFont),c=l.length,s=C.length,d=t.length,r=KA(I.padding);let u=r.height,b=0,m=t.reduce(((g,I)=>g+I.before.length+I.lines.length+I.after.length),0);if(m+=g.beforeBody.length+g.afterBody.length,c&&(u+=c*i.lineHeight+(c-1)*I.titleSpacing+I.titleMarginBottom),m){u+=d*(I.displayColors?Math.max(o,a.lineHeight):a.lineHeight)+(m-d)*a.lineHeight+(m-1)*I.bodySpacing}s&&(u+=I.footerMarginTop+s*A.lineHeight+(s-1)*I.footerSpacing);let h=0;const Z=function(g){b=Math.max(b,e.measureText(g).width+h)};return e.save(),e.font=i.string,$a(g.title,Z),e.font=a.string,$a(g.beforeBody.concat(g.afterBody),Z),h=I.displayColors?n+2+I.boxPadding:0,$a(t,(g=>{$a(g.before,Z),$a(g.lines,Z),$a(g.after,Z)})),h=0,e.font=A.string,$a(g.footer,Z),e.restore(),b+=r.width,{width:b,height:u}}function Br(g,I,e,t){const{x:C,width:l}=e,{width:n,chartArea:{left:o,right:a}}=g;let i="center";return"center"===t?i=C<=(o+a)/2?"left":"right":C<=l/2?i="left":C>=n-l/2&&(i="right"),function(g,I,e,t){const{x:C,width:l}=t,n=e.caretSize+e.caretPadding;return"left"===g&&C+l+n>I.width||"right"===g&&C-l-n<0||void 0}(i,g,I,e)&&(i="center"),i}function yr(g,I,e){const t=e.yAlign||I.yAlign||function(g,I){const{y:e,height:t}=I;return e<t/2?"top":e>g.height-t/2?"bottom":"center"}(g,e);return{xAlign:e.xAlign||I.xAlign||Br(g,I,e,t),yAlign:t}}function Wr(g,I,e,t){const{caretSize:C,caretPadding:l,cornerRadius:n}=g,{xAlign:o,yAlign:a}=e,i=C+l,{topLeft:A,topRight:c,bottomLeft:s,bottomRight:d}=NA(n);let r=function(g,I){let{x:e,width:t}=g;return"right"===I?e-=t:"center"===I&&(e-=t/2),e}(I,o);const u=function(g,I,e){let{y:t,height:C}=g;return"top"===I?t+=e:t-="bottom"===I?C+e:C/2,t}(I,a,i);return"center"===a?"left"===o?r+=i:"right"===o&&(r-=i):"left"===o?r-=Math.max(A,s)+C:"right"===o&&(r+=Math.max(c,d)+C),{x:Ni(r,0,t.width-I.width),y:Ni(u,0,t.height-I.height)}}function Vr(g,I,e){const t=KA(e.padding);return"center"===I?g.x+g.width/2:"right"===I?g.x+g.width-t.right:g.x+t.left}function Sr(g){return hr([],Zr(g))}function Rr(g,I){const e=I&&I.dataset&&I.dataset.tooltip&&I.dataset.tooltip.callbacks;return e?g.override(e):g}const Xr={beforeTitle:Ua,title(g){if(g.length>0){const I=g[0],e=I.chart.data.labels,t=e?e.length:0;if(this&&this.options&&"dataset"===this.options.mode)return I.dataset.label||"";if(I.label)return I.label;if(t>0&&I.dataIndex<t)return e[I.dataIndex]}return""},afterTitle:Ua,beforeBody:Ua,beforeLabel:Ua,label(g){if(this&&this.options&&"dataset"===this.options.mode)return g.label+": "+g.formattedValue||g.formattedValue;let I=g.dataset.label||"";I&&(I+=": ");const e=g.formattedValue;return La(e)||(I+=e),I},labelColor(g){const I=g.chart.getDatasetMeta(g.datasetIndex).controller.getStyle(g.dataIndex);return{borderColor:I.borderColor,backgroundColor:I.backgroundColor,borderWidth:I.borderWidth,borderDash:I.borderDash,borderDashOffset:I.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(g){const I=g.chart.getDatasetMeta(g.datasetIndex).controller.getStyle(g.dataIndex);return{pointStyle:I.pointStyle,rotation:I.rotation}},afterLabel:Ua,afterBody:Ua,beforeFooter:Ua,footer:Ua,afterFooter:Ua};function Jr(g,I,e,t){const C=g[I].call(e,t);return"undefined"===typeof C?Xr[I].call(e,t):C}class kr extends $s{constructor(g){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=g.chart,this.options=g.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(g){this.options=g,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const g=this._cachedAnimations;if(g)return g;const I=this.chart,e=this.options.setContext(this.getContext()),t=e.enabled&&I.options.animation&&e.animations,C=new Fc(this.chart,t);return t._cacheable&&(this._cachedAnimations=Object.freeze(C)),C}getContext(){return this.$context||(this.$context=(g=this.chart.getContext(),I=this,e=this._tooltipItems,xA(g,{tooltip:I,tooltipItems:e,type:"tooltip"})));var g,I,e}getTitle(g,I){const{callbacks:e}=I,t=Jr(e,"beforeTitle",this,g),C=Jr(e,"title",this,g),l=Jr(e,"afterTitle",this,g);let n=[];return n=hr(n,Zr(t)),n=hr(n,Zr(C)),n=hr(n,Zr(l)),n}getBeforeBody(g,I){return Sr(Jr(I.callbacks,"beforeBody",this,g))}getBody(g,I){const{callbacks:e}=I,t=[];return $a(g,(g=>{const I={before:[],lines:[],after:[]},C=Rr(e,g);hr(I.before,Zr(Jr(C,"beforeLabel",this,g))),hr(I.lines,Jr(C,"label",this,g)),hr(I.after,Zr(Jr(C,"afterLabel",this,g))),t.push(I)})),t}getAfterBody(g,I){return Sr(Jr(I.callbacks,"afterBody",this,g))}getFooter(g,I){const{callbacks:e}=I,t=Jr(e,"beforeFooter",this,g),C=Jr(e,"footer",this,g),l=Jr(e,"afterFooter",this,g);let n=[];return n=hr(n,Zr(t)),n=hr(n,Zr(C)),n=hr(n,Zr(l)),n}_createItems(g){const I=this._active,e=this.chart.data,t=[],C=[],l=[];let n,o,a=[];for(n=0,o=I.length;n<o;++n)a.push(Gr(this.chart,I[n]));return g.filter&&(a=a.filter(((I,t,C)=>g.filter(I,t,C,e)))),g.itemSort&&(a=a.sort(((I,t)=>g.itemSort(I,t,e)))),$a(a,(I=>{const e=Rr(g.callbacks,I);t.push(Jr(e,"labelColor",this,I)),C.push(Jr(e,"labelPointStyle",this,I)),l.push(Jr(e,"labelTextColor",this,I))})),this.labelColors=t,this.labelPointStyles=C,this.labelTextColors=l,this.dataPoints=a,a}update(g,I){const e=this.options.setContext(this.getContext()),t=this._active;let C,l=[];if(t.length){const g=mr[e.position].call(this,t,this._eventPosition);l=this._createItems(e),this.title=this.getTitle(l,e),this.beforeBody=this.getBeforeBody(l,e),this.body=this.getBody(l,e),this.afterBody=this.getAfterBody(l,e),this.footer=this.getFooter(l,e);const I=this._size=pr(this,e),n=Object.assign({},g,I),o=yr(this.chart,e,n),a=Wr(e,n,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,C={opacity:1,x:a.x,y:a.y,width:I.width,height:I.height,caretX:g.x,caretY:g.y}}else 0!==this.opacity&&(C={opacity:0});this._tooltipItems=l,this.$context=void 0,C&&this._resolveAnimations().update(this,C),g&&e.external&&e.external.call(this,{chart:this.chart,tooltip:this,replay:I})}drawCaret(g,I,e,t){const C=this.getCaretPosition(g,e,t);I.lineTo(C.x1,C.y1),I.lineTo(C.x2,C.y2),I.lineTo(C.x3,C.y3)}getCaretPosition(g,I,e){const{xAlign:t,yAlign:C}=this,{caretSize:l,cornerRadius:n}=e,{topLeft:o,topRight:a,bottomLeft:i,bottomRight:A}=NA(n),{x:c,y:s}=g,{width:d,height:r}=I;let u,b,m,h,Z,G;return"center"===C?(Z=s+r/2,"left"===t?(u=c,b=u-l,h=Z+l,G=Z-l):(u=c+d,b=u+l,h=Z-l,G=Z+l),m=u):(b="left"===t?c+Math.max(o,i)+l:"right"===t?c+d-Math.max(a,A)-l:this.caretX,"top"===C?(h=s,Z=h-l,u=b-l,m=b+l):(h=s+r,Z=h+l,u=b+l,m=b-l),G=h),{x1:u,x2:b,x3:m,y1:h,y2:Z,y3:G}}drawTitle(g,I,e){const t=this.title,C=t.length;let l,n,o;if(C){const a=yc(e.rtl,this.x,this.width);for(g.x=Vr(this,e.titleAlign,e),I.textAlign=a.textAlign(e.titleAlign),I.textBaseline="middle",l=wA(e.titleFont),n=e.titleSpacing,I.fillStyle=e.titleColor,I.font=l.string,o=0;o<C;++o)I.fillText(t[o],a.x(g.x),g.y+l.lineHeight/2),g.y+=l.lineHeight+n,o+1===C&&(g.y+=e.titleMarginBottom-n)}}_drawColorBox(g,I,e,t,C){const l=this.labelColors[e],n=this.labelPointStyles[e],{boxHeight:o,boxWidth:a}=C,i=wA(C.bodyFont),A=Vr(this,"left",C),c=t.x(A),s=o<i.lineHeight?(i.lineHeight-o)/2:0,d=I.y+s;if(C.usePointStyle){const I={radius:Math.min(a,o)/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:1},e=t.leftForLtr(c,a)+a/2,i=d+o/2;g.strokeStyle=C.multiKeyBackground,g.fillStyle=C.multiKeyBackground,hA(g,I,e,i),g.strokeStyle=l.borderColor,g.fillStyle=l.backgroundColor,hA(g,I,e,i)}else{g.lineWidth=Ta(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,g.strokeStyle=l.borderColor,g.setLineDash(l.borderDash||[]),g.lineDashOffset=l.borderDashOffset||0;const I=t.leftForLtr(c,a),e=t.leftForLtr(t.xPlus(c,1),a-2),n=NA(l.borderRadius);Object.values(n).some((g=>0!==g))?(g.beginPath(),g.fillStyle=C.multiKeyBackground,XA(g,{x:I,y:d,w:a,h:o,radius:n}),g.fill(),g.stroke(),g.fillStyle=l.backgroundColor,g.beginPath(),XA(g,{x:e,y:d+1,w:a-2,h:o-2,radius:n}),g.fill()):(g.fillStyle=C.multiKeyBackground,g.fillRect(I,d,a,o),g.strokeRect(I,d,a,o),g.fillStyle=l.backgroundColor,g.fillRect(e,d+1,a-2,o-2))}g.fillStyle=this.labelTextColors[e]}drawBody(g,I,e){const{body:t}=this,{bodySpacing:C,bodyAlign:l,displayColors:n,boxHeight:o,boxWidth:a,boxPadding:i}=e,A=wA(e.bodyFont);let c=A.lineHeight,s=0;const d=yc(e.rtl,this.x,this.width),r=function(e){I.fillText(e,d.x(g.x+s),g.y+c/2),g.y+=c+C},u=d.textAlign(l);let b,m,h,Z,G,p,B;for(I.textAlign=l,I.textBaseline="middle",I.font=A.string,g.x=Vr(this,u,e),I.fillStyle=e.bodyColor,$a(this.beforeBody,r),s=n&&"right"!==u?"center"===l?a/2+i:a+2+i:0,Z=0,p=t.length;Z<p;++Z){for(b=t[Z],m=this.labelTextColors[Z],I.fillStyle=m,$a(b.before,r),h=b.lines,n&&h.length&&(this._drawColorBox(I,g,Z,d,e),c=Math.max(A.lineHeight,o)),G=0,B=h.length;G<B;++G)r(h[G]),c=A.lineHeight;$a(b.after,r)}s=0,c=A.lineHeight,$a(this.afterBody,r),g.y-=C}drawFooter(g,I,e){const t=this.footer,C=t.length;let l,n;if(C){const o=yc(e.rtl,this.x,this.width);for(g.x=Vr(this,e.footerAlign,e),g.y+=e.footerMarginTop,I.textAlign=o.textAlign(e.footerAlign),I.textBaseline="middle",l=wA(e.footerFont),I.fillStyle=e.footerColor,I.font=l.string,n=0;n<C;++n)I.fillText(t[n],o.x(g.x),g.y+l.lineHeight/2),g.y+=l.lineHeight+e.footerSpacing}}drawBackground(g,I,e,t){const{xAlign:C,yAlign:l}=this,{x:n,y:o}=g,{width:a,height:i}=e,{topLeft:A,topRight:c,bottomLeft:s,bottomRight:d}=NA(t.cornerRadius);I.fillStyle=t.backgroundColor,I.strokeStyle=t.borderColor,I.lineWidth=t.borderWidth,I.beginPath(),I.moveTo(n+A,o),"top"===l&&this.drawCaret(g,I,e,t),I.lineTo(n+a-c,o),I.quadraticCurveTo(n+a,o,n+a,o+c),"center"===l&&"right"===C&&this.drawCaret(g,I,e,t),I.lineTo(n+a,o+i-d),I.quadraticCurveTo(n+a,o+i,n+a-d,o+i),"bottom"===l&&this.drawCaret(g,I,e,t),I.lineTo(n+s,o+i),I.quadraticCurveTo(n,o+i,n,o+i-s),"center"===l&&"left"===C&&this.drawCaret(g,I,e,t),I.lineTo(n,o+A),I.quadraticCurveTo(n,o,n+A,o),I.closePath(),I.fill(),t.borderWidth>0&&I.stroke()}_updateAnimationTarget(g){const I=this.chart,e=this.$animations,t=e&&e.x,C=e&&e.y;if(t||C){const e=mr[g.position].call(this,this._active,this._eventPosition);if(!e)return;const l=this._size=pr(this,g),n=Object.assign({},e,this._size),o=yr(I,g,n),a=Wr(g,n,o,I);t._to===a.x&&C._to===a.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=l.width,this.height=l.height,this.caretX=e.x,this.caretY=e.y,this._resolveAnimations().update(this,a))}}_willRender(){return!!this.opacity}draw(g){const I=this.options.setContext(this.getContext());let e=this.opacity;if(!e)return;this._updateAnimationTarget(I);const t={width:this.width,height:this.height},C={x:this.x,y:this.y};e=Math.abs(e)<.001?0:e;const l=KA(I.padding),n=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;I.enabled&&n&&(g.save(),g.globalAlpha=e,this.drawBackground(C,g,t,I),Wc(g,I.textDirection),C.y+=l.top,this.drawTitle(C,g,I),this.drawBody(C,g,I),this.drawFooter(C,g,I),Vc(g,I.textDirection),g.restore())}getActiveElements(){return this._active||[]}setActiveElements(g,I){const e=this._active,t=g.map((g=>{let{datasetIndex:I,index:e}=g;const t=this.chart.getDatasetMeta(I);if(!t)throw new Error("Cannot find a dataset at index "+I);return{datasetIndex:I,element:t.data[e],index:e}})),C=!gi(e,t),l=this._positionChanged(t,I);(C||l)&&(this._active=t,this._eventPosition=I,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(g,I){let e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(I&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const t=this.options,C=this._active||[],l=this._getActiveElements(g,C,I,e),n=this._positionChanged(l,g),o=I||!gi(l,C)||n;return o&&(this._active=l,(t.enabled||t.external)&&(this._eventPosition={x:g.x,y:g.y},this.update(!0,I))),o}_getActiveElements(g,I,e,t){const C=this.options;if("mouseout"===g.type)return[];if(!t)return I.filter((g=>this.chart.data.datasets[g.datasetIndex]&&void 0!==this.chart.getDatasetMeta(g.datasetIndex).controller.getParsed(g.index)));const l=this.chart.getElementsAtEventForMode(g,C.mode,C,e);return C.reverse&&l.reverse(),l}_positionChanged(g,I){const{caretX:e,caretY:t,options:C}=this,l=mr[C.position].call(this,g,I);return!1!==l&&(e!==l.x||t!==l.y)}}ia(kr,"positioners",mr);var fr={id:"tooltip",_element:kr,positioners:mr,afterInit(g,I,e){e&&(g.tooltip=new kr({chart:g,options:e}))},beforeUpdate(g,I,e){g.tooltip&&g.tooltip.initialize(e)},reset(g,I,e){g.tooltip&&g.tooltip.initialize(e)},afterDraw(g){const I=g.tooltip;if(I&&I._willRender()){const e={tooltip:I};if(!1===g.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0}))return;I.draw(g.ctx),g.notifyPlugins("afterTooltipDraw",e)}},afterEvent(g,I){if(g.tooltip){const e=I.replay;g.tooltip.handleEvent(I.event,e,I.inChartArea)&&(I.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(g,I)=>I.bodyFont.size,boxWidth:(g,I)=>I.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Xr},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:g=>"filter"!==g&&"itemSort"!==g&&"external"!==g,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function vr(g,I,e,t){const C=g.indexOf(I);if(-1===C)return((g,I,e,t)=>("string"===typeof I?(e=g.push(I)-1,t.unshift({index:e,label:I})):isNaN(I)&&(e=null),e))(g,I,e,t);return C!==g.lastIndexOf(I)?e:C}function Yr(g){const I=this.getLabels();return g>=0&&g<I.length?I[g]:g}class Hr extends id{constructor(g){super(g),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(g){const I=this._addedLabels;if(I.length){const g=this.getLabels();for(const{index:e,label:t}of I)g[e]===t&&g.splice(e,1);this._addedLabels=[]}super.init(g)}parse(g,I){if(La(g))return null;const e=this.getLabels();return((g,I)=>null===g?null:Ni(Math.round(g),0,I))(I=isFinite(I)&&e[I]===g?I:vr(e,g,Oa(I,g),this._addedLabels),e.length-1)}determineDataLimits(){const{minDefined:g,maxDefined:I}=this.getUserBounds();let{min:e,max:t}=this.getMinMax(!0);"ticks"===this.options.bounds&&(g||(e=0),I||(t=this.getLabels().length-1)),this.min=e,this.max=t}buildTicks(){const g=this.min,I=this.max,e=this.options.offset,t=[];let C=this.getLabels();C=0===g&&I===C.length-1?C:C.slice(g,I+1),this._valueRange=Math.max(C.length-(e?0:1),1),this._startValue=this.min-(e?.5:0);for(let l=g;l<=I;l++)t.push({value:l});return t}getLabelForValue(g){return Yr.call(this,g)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(g){return"number"!==typeof g&&(g=this.parse(g)),null===g?NaN:this.getPixelForDecimal((g-this._startValue)/this._valueRange)}getPixelForTick(g){const I=this.ticks;return g<0||g>I.length-1?null:this.getPixelForValue(I[g].value)}getValueForPixel(g){return Math.round(this._startValue+this.getDecimalForPixel(g)*this._valueRange)}getBasePixel(){return this.bottom}}function Nr(g,I){const e=[],{bounds:t,step:C,min:l,max:n,precision:o,count:a,maxTicks:i,maxDigits:A,includeBounds:c}=g,s=C||1,d=i-1,{min:r,max:u}=I,b=!La(l),m=!La(n),h=!La(a),Z=(u-r)/(A+1);let G,p,B,y,W=Wi((u-r)/d/s)*s;if(W<1e-14&&!b&&!m)return[{value:r},{value:u}];y=Math.ceil(u/W)-Math.floor(r/W),y>d&&(W=Wi(y*W/d/s)*s),La(o)||(G=Math.pow(10,o),W=Math.ceil(W*G)/G),"ticks"===t?(p=Math.floor(r/W)*W,B=Math.ceil(u/W)*W):(p=r,B=u),b&&m&&C&&function(g,I){const e=Math.round(g);return e-I<=g&&e+I>=g}((n-l)/C,W/1e3)?(y=Math.round(Math.min((n-l)/W,i)),W=(n-l)/y,p=l,B=n):h?(p=b?l:p,B=m?n:B,y=a-1,W=(B-p)/y):(y=(B-p)/W,y=yi(y,Math.round(y),W/1e3)?Math.round(y):Math.ceil(y));const V=Math.max(Ji(W),Ji(p));G=Math.pow(10,La(o)?V:o),p=Math.round(p*G)/G,B=Math.round(B*G)/G;let S=0;for(b&&(c&&p!==l?(e.push({value:l}),p<l&&S++,yi(Math.round((p+S*W)*G)/G,l,Kr(l,Z,g))&&S++):p<l&&S++);S<y;++S){const g=Math.round((p+S*W)*G)/G;if(m&&g>n)break;e.push({value:g})}return m&&c&&B!==n?e.length&&yi(e[e.length-1].value,n,Kr(n,Z,g))?e[e.length-1].value=n:e.push({value:n}):m&&B!==n||e.push({value:B}),e}function Kr(g,I,e){let{horizontal:t,minRotation:C}=e;const l=Ri(C),n=(t?Math.sin(l):Math.cos(l))||.001,o=.75*I*(""+g).length;return Math.min(I/n,o)}ia(Hr,"id","category"),ia(Hr,"defaults",{ticks:{callback:Yr}});class wr extends id{constructor(g){super(g),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(g,I){return La(g)||("number"===typeof g||g instanceof Number)&&!isFinite(+g)?null:+g}handleTickRangeOptions(){const{beginAtZero:g}=this.options,{minDefined:I,maxDefined:e}=this.getUserBounds();let{min:t,max:C}=this;const l=g=>t=I?t:g,n=g=>C=e?C:g;if(g){const g=Bi(t),I=Bi(C);g<0&&I<0?n(0):g>0&&I>0&&l(0)}if(t===C){let I=0===C?1:Math.abs(.05*C);n(C+I),g||l(t-I)}this.min=t,this.max=C}getTickLimit(){const g=this.options.ticks;let I,{maxTicksLimit:e,stepSize:t}=g;return t?(I=Math.ceil(this.max/t)-Math.floor(this.min/t)+1,I>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(t," would result generating up to ").concat(I," ticks. Limiting to 1000.")),I=1e3)):(I=this.computeTickLimit(),e=e||11),e&&(I=Math.min(e,I)),I}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const g=this.options,I=g.ticks;let e=this.getTickLimit();e=Math.max(2,e);const t=Nr({maxTicks:e,bounds:g.bounds,min:g.min,max:g.max,precision:I.precision,step:I.stepSize,count:I.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:I.minRotation||0,includeBounds:!1!==I.includeBounds},this._range||this);return"ticks"===g.bounds&&Si(t,this,"value"),g.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}configure(){const g=this.ticks;let I=this.min,e=this.max;if(super.configure(),this.options.offset&&g.length){const t=(e-I)/Math.max(g.length-1,1)/2;I-=t,e+=t}this._startValue=I,this._endValue=e,this._valueRange=e-I}getLabelForValue(g){return lA(g,this.chart.options.locale,this.options.ticks.format)}}class Fr extends wr{determineDataLimits(){const{min:g,max:I}=this.getMinMax(!0);this.min=ja(g)?g:0,this.max=ja(I)?I:1,this.handleTickRangeOptions()}computeTickLimit(){const g=this.isHorizontal(),I=g?this.width:this.height,e=Ri(this.options.ticks.minRotation),t=(g?Math.sin(e):Math.cos(e))||.001,C=this._resolveTickFontOptions(0);return Math.ceil(I/Math.min(40,C.lineHeight/t))}getPixelForValue(g){return null===g?NaN:this.getPixelForDecimal((g-this._startValue)/this._valueRange)}getValueForPixel(g){return this._startValue+this.getDecimalForPixel(g)*this._valueRange}}ia(Fr,"id","linear"),ia(Fr,"defaults",{ticks:{callback:oA.formatters.numeric}});const xr=g=>Math.floor(pi(g)),zr=(g,I)=>Math.pow(10,xr(g)+I);function Mr(g){return 1===g/Math.pow(10,xr(g))}function Er(g,I,e){const t=Math.pow(10,e),C=Math.floor(g/t);return Math.ceil(I/t)-C}function Ur(g,I){let{min:e,max:t}=I;e=Pa(g.min,e);const C=[],l=xr(e);let n=function(g,I){let e=xr(I-g);for(;Er(g,I,e)>10;)e++;for(;Er(g,I,e)<10;)e--;return Math.min(e,xr(g))}(e,t),o=n<0?Math.pow(10,Math.abs(n)):1;const a=Math.pow(10,n),i=l>n?Math.pow(10,l):0,A=Math.round((e-i)*o)/o,c=Math.floor((e-i)/a/10)*a*10;let s=Math.floor((A-c)/Math.pow(10,n)),d=Pa(g.min,Math.round((i+c+s*Math.pow(10,n))*o)/o);for(;d<t;)C.push({value:d,major:Mr(d),significand:s}),s>=10?s=s<15?15:20:s++,s>=20&&(n++,s=2,o=n>=0?1:o),d=Math.round((i+c+s*Math.pow(10,n))*o)/o;const r=Pa(g.max,d);return C.push({value:r,major:Mr(r),significand:s}),C}class Qr extends id{constructor(g){super(g),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(g,I){const e=wr.prototype.parse.apply(this,[g,I]);if(0!==e)return ja(e)&&e>0?e:null;this._zero=!0}determineDataLimits(){const{min:g,max:I}=this.getMinMax(!0);this.min=ja(g)?Math.max(0,g):null,this.max=ja(I)?Math.max(0,I):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ja(this._userMin)&&(this.min=g===zr(this.min,0)?zr(this.min,-1):zr(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:g,maxDefined:I}=this.getUserBounds();let e=this.min,t=this.max;const C=I=>e=g?e:I,l=g=>t=I?t:g;e===t&&(e<=0?(C(1),l(10)):(C(zr(e,-1)),l(zr(t,1)))),e<=0&&C(zr(t,-1)),t<=0&&l(zr(e,1)),this.min=e,this.max=t}buildTicks(){const g=this.options,I=Ur({min:this._userMin,max:this._userMax},this);return"ticks"===g.bounds&&Si(I,this,"value"),g.reverse?(I.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),I}getLabelForValue(g){return void 0===g?"0":lA(g,this.chart.options.locale,this.options.ticks.format)}configure(){const g=this.min;super.configure(),this._startValue=pi(g),this._valueRange=pi(this.max)-pi(g)}getPixelForValue(g){return void 0!==g&&0!==g||(g=this.min),null===g||isNaN(g)?NaN:this.getPixelForDecimal(g===this.min?0:(pi(g)-this._startValue)/this._valueRange)}getValueForPixel(g){const I=this.getDecimalForPixel(g);return Math.pow(10,this._startValue+I*this._valueRange)}}function Lr(g){const I=g.ticks;if(I.display&&g.display){const g=KA(I.backdropPadding);return Oa(I.font&&I.font.size,dA.font.size)+g.height}return 0}function Dr(g,I,e,t,C){return g===t||g===C?{start:I-e/2,end:I+e/2}:g<t||g>C?{start:I-e,end:I}:{start:I,end:I+e}}function Tr(g){const I={l:g.left+g._padding.left,r:g.right-g._padding.right,t:g.top+g._padding.top,b:g.bottom-g._padding.bottom},e=Object.assign({},I),t=[],C=[],l=g._pointLabels.length,n=g.options.pointLabels,o=n.centerPointLabels?di/l:0;for(let c=0;c<l;c++){const l=n.setContext(g.getPointLabelContext(c));C[c]=l.padding;const s=g.getPointPosition(c,g.drawingArea+C[c],o),d=wA(l.font),r=(a=g.ctx,i=d,A=Da(A=g._pointLabels[c])?A:[A],{w:uA(a,i.string,A),h:A.length*i.lineHeight});t[c]=r;const u=Yi(g.getIndexAngle(c)+o),b=Math.round(Xi(u));jr(e,I,u,Dr(b,s.x,r.w,0,180),Dr(b,s.y,r.h,90,270))}var a,i,A;g.setCenterPoint(I.l-e.l,e.r-I.r,I.t-e.t,e.b-I.b),g._pointLabelItems=function(g,I,e){const t=[],C=g._pointLabels.length,l=g.options,{centerPointLabels:n,display:o}=l.pointLabels,a={extra:Lr(l)/2,additionalAngle:n?di/C:0};let i;for(let A=0;A<C;A++){a.padding=e[A],a.size=I[A];const C=Pr(g,A,a);t.push(C),"auto"===o&&(C.visible=Or(C,i),C.visible&&(i=C))}return t}(g,t,C)}function jr(g,I,e,t,C){const l=Math.abs(Math.sin(e)),n=Math.abs(Math.cos(e));let o=0,a=0;t.start<I.l?(o=(I.l-t.start)/l,g.l=Math.min(g.l,I.l-o)):t.end>I.r&&(o=(t.end-I.r)/l,g.r=Math.max(g.r,I.r+o)),C.start<I.t?(a=(I.t-C.start)/n,g.t=Math.min(g.t,I.t-a)):C.end>I.b&&(a=(C.end-I.b)/n,g.b=Math.max(g.b,I.b+a))}function Pr(g,I,e){const t=g.drawingArea,{extra:C,additionalAngle:l,padding:n,size:o}=e,a=g.getPointPosition(I,t+C+n,l),i=Math.round(Xi(Yi(a.angle+hi))),A=function(g,I,e){90===e||270===e?g-=I/2:(e>270||e<90)&&(g-=I);return g}(a.y,o.h,i),c=function(g){if(0===g||180===g)return"center";if(g<180)return"left";return"right"}(i),s=function(g,I,e){"right"===e?g-=I:"center"===e&&(g-=I/2);return g}(a.x,o.w,c);return{visible:!0,x:a.x,y:A,textAlign:c,left:s,top:A,right:s+o.w,bottom:A+o.h}}function Or(g,I){if(!I)return!0;const{left:e,top:t,right:C,bottom:l}=g;return!(GA({x:e,y:t},I)||GA({x:e,y:l},I)||GA({x:C,y:t},I)||GA({x:C,y:l},I))}function _r(g,I,e){const{left:t,top:C,right:l,bottom:n}=e,{backdropColor:o}=I;if(!La(o)){const e=NA(I.borderRadius),a=KA(I.backdropPadding);g.fillStyle=o;const i=t-a.left,A=C-a.top,c=l-t+a.width,s=n-C+a.height;Object.values(e).some((g=>0!==g))?(g.beginPath(),XA(g,{x:i,y:A,w:c,h:s,radius:e}),g.fill()):g.fillRect(i,A,c,s)}}function qr(g,I,e,t){const{ctx:C}=g;if(e)C.arc(g.xCenter,g.yCenter,I,0,ri);else{let e=g.getPointPosition(0,I);C.moveTo(e.x,e.y);for(let l=1;l<t;l++)e=g.getPointPosition(l,I),C.lineTo(e.x,e.y)}}ia(Qr,"id","logarithmic"),ia(Qr,"defaults",{ticks:{callback:oA.formatters.logarithmic,major:{enabled:!0}}});class $r extends wr{constructor(g){super(g),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const g=this._padding=KA(Lr(this.options)/2),I=this.width=this.maxWidth-g.width,e=this.height=this.maxHeight-g.height;this.xCenter=Math.floor(this.left+I/2+g.left),this.yCenter=Math.floor(this.top+e/2+g.top),this.drawingArea=Math.floor(Math.min(I,e)/2)}determineDataLimits(){const{min:g,max:I}=this.getMinMax(!1);this.min=ja(g)&&!isNaN(g)?g:0,this.max=ja(I)&&!isNaN(I)?I:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Lr(this.options))}generateTickLabels(g){wr.prototype.generateTickLabels.call(this,g),this._pointLabels=this.getLabels().map(((g,I)=>{const e=qa(this.options.pointLabels.callback,[g,I],this);return e||0===e?e:""})).filter(((g,I)=>this.chart.getDataVisibility(I)))}fit(){const g=this.options;g.display&&g.pointLabels.display?Tr(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(g,I,e,t){this.xCenter+=Math.floor((g-I)/2),this.yCenter+=Math.floor((e-t)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(g,I,e,t))}getIndexAngle(g){return Yi(g*(ri/(this._pointLabels.length||1))+Ri(this.options.startAngle||0))}getDistanceFromCenterForValue(g){if(La(g))return NaN;const I=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-g)*I:(g-this.min)*I}getValueForDistanceFromCenter(g){if(La(g))return NaN;const I=g/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-I:this.min+I}getPointLabelContext(g){const I=this._pointLabels||[];if(g>=0&&g<I.length){const e=I[g];return function(g,I,e){return xA(g,{label:e,index:I,type:"pointLabel"})}(this.getContext(),g,e)}}getPointPosition(g,I){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const t=this.getIndexAngle(g)-hi+e;return{x:Math.cos(t)*I+this.xCenter,y:Math.sin(t)*I+this.yCenter,angle:t}}getPointPositionForValue(g,I){return this.getPointPosition(g,this.getDistanceFromCenterForValue(I))}getBasePosition(g){return this.getPointPositionForValue(g||0,this.getBaseValue())}getPointLabelPosition(g){const{left:I,top:e,right:t,bottom:C}=this._pointLabelItems[g];return{left:I,top:e,right:t,bottom:C}}drawBackground(){const{backgroundColor:g,grid:{circular:I}}=this.options;if(g){const e=this.ctx;e.save(),e.beginPath(),qr(this,this.getDistanceFromCenterForValue(this._endValue),I,this._pointLabels.length),e.closePath(),e.fillStyle=g,e.fill(),e.restore()}}drawGrid(){const g=this.ctx,I=this.options,{angleLines:e,grid:t,border:C}=I,l=this._pointLabels.length;let n,o,a;if(I.pointLabels.display&&function(g,I){const{ctx:e,options:{pointLabels:t}}=g;for(let C=I-1;C>=0;C--){const I=g._pointLabelItems[C];if(!I.visible)continue;const l=t.setContext(g.getPointLabelContext(C));_r(e,l,I);const n=wA(l.font),{x:o,y:a,textAlign:i}=I;RA(e,g._pointLabels[C],o,a+n.lineHeight/2,n,{color:l.color,textAlign:i,textBaseline:"middle"})}}(this,l),t.display&&this.ticks.forEach(((g,I)=>{if(0!==I||0===I&&this.min<0){o=this.getDistanceFromCenterForValue(g.value);const e=this.getContext(I),n=t.setContext(e),a=C.setContext(e);!function(g,I,e,t,C){const l=g.ctx,n=I.circular,{color:o,lineWidth:a}=I;!n&&!t||!o||!a||e<0||(l.save(),l.strokeStyle=o,l.lineWidth=a,l.setLineDash(C.dash),l.lineDashOffset=C.dashOffset,l.beginPath(),qr(g,e,n,t),l.closePath(),l.stroke(),l.restore())}(this,n,o,l,a)}})),e.display){for(g.save(),n=l-1;n>=0;n--){const t=e.setContext(this.getPointLabelContext(n)),{color:C,lineWidth:l}=t;l&&C&&(g.lineWidth=l,g.strokeStyle=C,g.setLineDash(t.borderDash),g.lineDashOffset=t.borderDashOffset,o=this.getDistanceFromCenterForValue(I.ticks.reverse?this.min:this.max),a=this.getPointPosition(n,o),g.beginPath(),g.moveTo(this.xCenter,this.yCenter),g.lineTo(a.x,a.y),g.stroke())}g.restore()}}drawBorder(){}drawLabels(){const g=this.ctx,I=this.options,e=I.ticks;if(!e.display)return;const t=this.getIndexAngle(0);let C,l;g.save(),g.translate(this.xCenter,this.yCenter),g.rotate(t),g.textAlign="center",g.textBaseline="middle",this.ticks.forEach(((t,n)=>{if(0===n&&this.min>=0&&!I.reverse)return;const o=e.setContext(this.getContext(n)),a=wA(o.font);if(C=this.getDistanceFromCenterForValue(this.ticks[n].value),o.showLabelBackdrop){g.font=a.string,l=g.measureText(t.label).width,g.fillStyle=o.backdropColor;const I=KA(o.backdropPadding);g.fillRect(-l/2-I.left,-C-a.size/2-I.top,l+I.width,a.size+I.height)}RA(g,t.label,0,-C,a,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})})),g.restore()}drawTitle(){}}ia($r,"id","radialLinear"),ia($r,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:oA.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:g=>g,padding:5,centerPointLabels:!1}}),ia($r,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),ia($r,"descriptors",{angleLines:{_fallback:"grid"}});const gu={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Iu=Object.keys(gu);function eu(g,I){return g-I}function tu(g,I){if(La(I))return null;const e=g._adapter,{parser:t,round:C,isoWeekday:l}=g._parseOpts;let n=I;return"function"===typeof t&&(n=t(n)),ja(n)||(n="string"===typeof t?e.parse(n,t):e.parse(n)),null===n?null:(C&&(n="week"!==C||!Vi(l)&&!0!==l?e.startOf(n,C):e.startOf(n,"isoWeek",l)),+n)}function Cu(g,I,e,t){const C=Iu.length;for(let l=Iu.indexOf(g);l<C-1;++l){const g=gu[Iu[l]],C=g.steps?g.steps:Number.MAX_SAFE_INTEGER;if(g.common&&Math.ceil((e-I)/(C*g.size))<=t)return Iu[l]}return Iu[C-1]}function lu(g,I,e){if(e){if(e.length){const{lo:t,hi:C}=wi(e,I);g[e[t]>=I?e[t]:e[C]]=!0}}else g[I]=!0}function nu(g,I,e){const t=[],C={},l=I.length;let n,o;for(n=0;n<l;++n)o=I[n],C[o]=n,t.push({value:o,major:!1});return 0!==l&&e?function(g,I,e,t){const C=g._adapter,l=+C.startOf(I[0].value,t),n=I[I.length-1].value;let o,a;for(o=l;o<=n;o=+C.add(o,1,t))a=e[o],a>=0&&(I[a].major=!0);return I}(g,t,C,e):t}class ou extends id{constructor(g){super(g),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const e=g.time||(g.time={}),t=this._adapter=new us(g.adapters.date);t.init(I),li(e.displayFormats,t.formats()),this._parseOpts={parser:e.parser,round:e.round,isoWeekday:e.isoWeekday},super.init(g),this._normalized=I.normalized}parse(g,I){return void 0===g?null:tu(this,g)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const g=this.options,I=this._adapter,e=g.time.unit||"day";let{min:t,max:C,minDefined:l,maxDefined:n}=this.getUserBounds();function o(g){l||isNaN(g.min)||(t=Math.min(t,g.min)),n||isNaN(g.max)||(C=Math.max(C,g.max))}l&&n||(o(this._getLabelBounds()),"ticks"===g.bounds&&"labels"===g.ticks.source||o(this.getMinMax(!1))),t=ja(t)&&!isNaN(t)?t:+I.startOf(Date.now(),e),C=ja(C)&&!isNaN(C)?C:+I.endOf(Date.now(),e)+1,this.min=Math.min(t,C-1),this.max=Math.max(t+1,C)}_getLabelBounds(){const g=this.getLabelTimestamps();let I=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY;return g.length&&(I=g[0],e=g[g.length-1]),{min:I,max:e}}buildTicks(){const g=this.options,I=g.time,e=g.ticks,t="labels"===e.source?this.getLabelTimestamps():this._generate();"ticks"===g.bounds&&t.length&&(this.min=this._userMin||t[0],this.max=this._userMax||t[t.length-1]);const C=this.min,l=function(g,I,e){let t=0,C=g.length;for(;t<C&&g[t]<I;)t++;for(;C>t&&g[C-1]>e;)C--;return t>0||C<g.length?g.slice(t,C):g}(t,C,this.max);return this._unit=I.unit||(e.autoSkip?Cu(I.minUnit,this.min,this.max,this._getLabelCapacity(C)):function(g,I,e,t,C){for(let l=Iu.length-1;l>=Iu.indexOf(e);l--){const e=Iu[l];if(gu[e].common&&g._adapter.diff(C,t,e)>=I-1)return e}return Iu[e?Iu.indexOf(e):0]}(this,l.length,I.minUnit,this.min,this.max)),this._majorUnit=e.major.enabled&&"year"!==this._unit?function(g){for(let I=Iu.indexOf(g)+1,e=Iu.length;I<e;++I)if(gu[Iu[I]].common)return Iu[I]}(this._unit):void 0,this.initOffsets(t),g.reverse&&l.reverse(),nu(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((g=>+g.value)))}initOffsets(){let g,I,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0,C=0;this.options.offset&&e.length&&(g=this.getDecimalForValue(e[0]),t=1===e.length?1-g:(this.getDecimalForValue(e[1])-g)/2,I=this.getDecimalForValue(e[e.length-1]),C=1===e.length?I:(I-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=Ni(t,0,l),C=Ni(C,0,l),this._offsets={start:t,end:C,factor:1/(t+1+C)}}_generate(){const g=this._adapter,I=this.min,e=this.max,t=this.options,C=t.time,l=C.unit||Cu(C.minUnit,I,e,this._getLabelCapacity(I)),n=Oa(t.ticks.stepSize,1),o="week"===l&&C.isoWeekday,a=Vi(o)||!0===o,i={};let A,c,s=I;if(a&&(s=+g.startOf(s,"isoWeek",o)),s=+g.startOf(s,a?"day":l),g.diff(e,I,l)>1e5*n)throw new Error(I+" and "+e+" are too far apart with stepSize of "+n+" "+l);const d="data"===t.ticks.source&&this.getDataTimestamps();for(A=s,c=0;A<e;A=+g.add(A,n,l),c++)lu(i,A,d);return A!==e&&"ticks"!==t.bounds&&1!==c||lu(i,A,d),Object.keys(i).sort(eu).map((g=>+g))}getLabelForValue(g){const I=this._adapter,e=this.options.time;return e.tooltipFormat?I.format(g,e.tooltipFormat):I.format(g,e.displayFormats.datetime)}format(g,I){const e=this.options.time.displayFormats,t=this._unit,C=I||e[t];return this._adapter.format(g,C)}_tickFormatFunction(g,I,e,t){const C=this.options,l=C.ticks.callback;if(l)return qa(l,[g,I,e],this);const n=C.time.displayFormats,o=this._unit,a=this._majorUnit,i=o&&n[o],A=a&&n[a],c=e[I],s=a&&A&&c&&c.major;return this._adapter.format(g,t||(s?A:i))}generateTickLabels(g){let I,e,t;for(I=0,e=g.length;I<e;++I)t=g[I],t.label=this._tickFormatFunction(t.value,I,g)}getDecimalForValue(g){return null===g?NaN:(g-this.min)/(this.max-this.min)}getPixelForValue(g){const I=this._offsets,e=this.getDecimalForValue(g);return this.getPixelForDecimal((I.start+e)*I.factor)}getValueForPixel(g){const I=this._offsets,e=this.getDecimalForPixel(g)/I.factor-I.end;return this.min+e*(this.max-this.min)}_getLabelSize(g){const I=this.options.ticks,e=this.ctx.measureText(g).width,t=Ri(this.isHorizontal()?I.maxRotation:I.minRotation),C=Math.cos(t),l=Math.sin(t),n=this._resolveTickFontOptions(0).size;return{w:e*C+n*l,h:e*l+n*C}}_getLabelCapacity(g){const I=this.options.time,e=I.displayFormats,t=e[I.unit]||e.millisecond,C=this._tickFormatFunction(g,0,nu(this,[g],this._majorUnit),t),l=this._getLabelSize(C),n=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return n>0?n:1}getDataTimestamps(){let g,I,e=this._cache.data||[];if(e.length)return e;const t=this.getMatchingVisibleMetas();if(this._normalized&&t.length)return this._cache.data=t[0].controller.getAllParsedValues(this);for(g=0,I=t.length;g<I;++g)e=e.concat(t[g].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const g=this._cache.labels||[];let I,e;if(g.length)return g;const t=this.getLabels();for(I=0,e=t.length;I<e;++I)g.push(tu(this,t[I]));return this._cache.labels=this._normalized?g:this.normalize(g)}normalize(g){return Ei(g.sort(eu))}}function au(g,I,e){let t,C,l,n,o=0,a=g.length-1;e?(I>=g[o].pos&&I<=g[a].pos&&({lo:o,hi:a}=Fi(g,"pos",I)),({pos:t,time:l}=g[o]),({pos:C,time:n}=g[a])):(I>=g[o].time&&I<=g[a].time&&({lo:o,hi:a}=Fi(g,"time",I)),({time:t,pos:l}=g[o]),({time:C,pos:n}=g[a]));const i=C-t;return i?l+(n-l)*(I-t)/i:l}ia(ou,"id","time"),ia(ou,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class iu extends ou{constructor(g){super(g),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const g=this._getTimestampsForTable(),I=this._table=this.buildLookupTable(g);this._minPos=au(I,this.min),this._tableRange=au(I,this.max)-this._minPos,super.initOffsets(g)}buildLookupTable(g){const{min:I,max:e}=this,t=[],C=[];let l,n,o,a,i;for(l=0,n=g.length;l<n;++l)a=g[l],a>=I&&a<=e&&t.push(a);if(t.length<2)return[{time:I,pos:0},{time:e,pos:1}];for(l=0,n=t.length;l<n;++l)i=t[l+1],o=t[l-1],a=t[l],Math.round((i+o)/2)!==a&&C.push({time:a,pos:l/(n-1)});return C}_generate(){const g=this.min,I=this.max;let e=super.getDataTimestamps();return e.includes(g)&&e.length||e.splice(0,0,g),e.includes(I)&&1!==e.length||e.push(I),e.sort(((g,I)=>g-I))}_getTimestampsForTable(){let g=this._cache.all||[];if(g.length)return g;const I=this.getDataTimestamps(),e=this.getLabelTimestamps();return g=I.length&&e.length?this.normalize(I.concat(e)):I.length?I:e,g=this._cache.all=g,g}getDecimalForValue(g){return(au(this._table,g)-this._minPos)/this._tableRange}getValueForPixel(g){const I=this._offsets,e=this.getDecimalForPixel(g)/I.factor-I.end;return au(this._table,e*this._tableRange+this._minPos,!0)}}ia(iu,"id","timeseries"),ia(iu,"defaults",ou.defaults);function Au(g,I){return function(){return g.apply(I,arguments)}}const{toString:cu}=Object.prototype,{getPrototypeOf:su}=Object,du=(ru=Object.create(null),g=>{const I=cu.call(g);return ru[I]||(ru[I]=I.slice(8,-1).toLowerCase())});var ru;const uu=g=>(g=g.toLowerCase(),I=>du(I)===g),bu=g=>I=>typeof I===g,{isArray:mu}=Array,hu=bu("undefined");const Zu=uu("ArrayBuffer");const Gu=bu("string"),pu=bu("function"),Bu=bu("number"),yu=g=>null!==g&&"object"===typeof g,Wu=g=>{if("object"!==du(g))return!1;const I=su(g);return(null===I||I===Object.prototype||null===Object.getPrototypeOf(I))&&!(Symbol.toStringTag in g)&&!(Symbol.iterator in g)},Vu=uu("Date"),Su=uu("File"),Ru=uu("Blob"),Xu=uu("FileList"),Ju=uu("URLSearchParams");function ku(g,I){let e,t,{allOwnKeys:C=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==g&&"undefined"!==typeof g)if("object"!==typeof g&&(g=[g]),mu(g))for(e=0,t=g.length;e<t;e++)I.call(null,g[e],e,g);else{const t=C?Object.getOwnPropertyNames(g):Object.keys(g),l=t.length;let n;for(e=0;e<l;e++)n=t[e],I.call(null,g[n],n,g)}}function fu(g,I){I=I.toLowerCase();const e=Object.keys(g);let t,C=e.length;for(;C-- >0;)if(t=e[C],I===t.toLowerCase())return t;return null}const vu="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Yu=g=>!hu(g)&&g!==vu;const Hu=(Nu="undefined"!==typeof Uint8Array&&su(Uint8Array),g=>Nu&&g instanceof Nu);var Nu;const Ku=uu("HTMLFormElement"),wu=(g=>{let{hasOwnProperty:I}=g;return(g,e)=>I.call(g,e)})(Object.prototype),Fu=uu("RegExp"),xu=(g,I)=>{const e=Object.getOwnPropertyDescriptors(g),t={};ku(e,((e,C)=>{let l;!1!==(l=I(e,C,g))&&(t[C]=l||e)})),Object.defineProperties(g,t)},zu="abcdefghijklmnopqrstuvwxyz",Mu="0123456789",Eu={DIGIT:Mu,ALPHA:zu,ALPHA_DIGIT:zu+zu.toUpperCase()+Mu};const Uu=uu("AsyncFunction"),Qu={isArray:mu,isArrayBuffer:Zu,isBuffer:function(g){return null!==g&&!hu(g)&&null!==g.constructor&&!hu(g.constructor)&&pu(g.constructor.isBuffer)&&g.constructor.isBuffer(g)},isFormData:g=>{let I;return g&&("function"===typeof FormData&&g instanceof FormData||pu(g.append)&&("formdata"===(I=du(g))||"object"===I&&pu(g.toString)&&"[object FormData]"===g.toString()))},isArrayBufferView:function(g){let I;return I="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(g):g&&g.buffer&&Zu(g.buffer),I},isString:Gu,isNumber:Bu,isBoolean:g=>!0===g||!1===g,isObject:yu,isPlainObject:Wu,isUndefined:hu,isDate:Vu,isFile:Su,isBlob:Ru,isRegExp:Fu,isFunction:pu,isStream:g=>yu(g)&&pu(g.pipe),isURLSearchParams:Ju,isTypedArray:Hu,isFileList:Xu,forEach:ku,merge:function g(){const{caseless:I}=Yu(this)&&this||{},e={},t=(t,C)=>{const l=I&&fu(e,C)||C;Wu(e[l])&&Wu(t)?e[l]=g(e[l],t):Wu(t)?e[l]=g({},t):mu(t)?e[l]=t.slice():e[l]=t};for(let C=0,l=arguments.length;C<l;C++)arguments[C]&&ku(arguments[C],t);return e},extend:function(g,I,e){let{allOwnKeys:t}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return ku(I,((I,t)=>{e&&pu(I)?g[t]=Au(I,e):g[t]=I}),{allOwnKeys:t}),g},trim:g=>g.trim?g.trim():g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:g=>(65279===g.charCodeAt(0)&&(g=g.slice(1)),g),inherits:(g,I,e,t)=>{g.prototype=Object.create(I.prototype,t),g.prototype.constructor=g,Object.defineProperty(g,"super",{value:I.prototype}),e&&Object.assign(g.prototype,e)},toFlatObject:(g,I,e,t)=>{let C,l,n;const o={};if(I=I||{},null==g)return I;do{for(C=Object.getOwnPropertyNames(g),l=C.length;l-- >0;)n=C[l],t&&!t(n,g,I)||o[n]||(I[n]=g[n],o[n]=!0);g=!1!==e&&su(g)}while(g&&(!e||e(g,I))&&g!==Object.prototype);return I},kindOf:du,kindOfTest:uu,endsWith:(g,I,e)=>{g=String(g),(void 0===e||e>g.length)&&(e=g.length),e-=I.length;const t=g.indexOf(I,e);return-1!==t&&t===e},toArray:g=>{if(!g)return null;if(mu(g))return g;let I=g.length;if(!Bu(I))return null;const e=new Array(I);for(;I-- >0;)e[I]=g[I];return e},forEachEntry:(g,I)=>{const e=(g&&g[Symbol.iterator]).call(g);let t;for(;(t=e.next())&&!t.done;){const e=t.value;I.call(g,e[0],e[1])}},matchAll:(g,I)=>{let e;const t=[];for(;null!==(e=g.exec(I));)t.push(e);return t},isHTMLForm:Ku,hasOwnProperty:wu,hasOwnProp:wu,reduceDescriptors:xu,freezeMethods:g=>{xu(g,((I,e)=>{if(pu(g)&&-1!==["arguments","caller","callee"].indexOf(e))return!1;const t=g[e];pu(t)&&(I.enumerable=!1,"writable"in I?I.writable=!1:I.set||(I.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")}))}))},toObjectSet:(g,I)=>{const e={},t=g=>{g.forEach((g=>{e[g]=!0}))};return mu(g)?t(g):t(String(g).split(I)),e},toCamelCase:g=>g.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(g,I,e){return I.toUpperCase()+e})),noop:()=>{},toFiniteNumber:(g,I)=>(g=+g,Number.isFinite(g)?g:I),findKey:fu,global:vu,isContextDefined:Yu,ALPHABET:Eu,generateString:function(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Eu.ALPHA_DIGIT,e="";const{length:t}=I;for(;g--;)e+=I[Math.random()*t|0];return e},isSpecCompliantForm:function(g){return!!(g&&pu(g.append)&&"FormData"===g[Symbol.toStringTag]&&g[Symbol.iterator])},toJSONObject:g=>{const I=new Array(10),e=(g,t)=>{if(yu(g)){if(I.indexOf(g)>=0)return;if(!("toJSON"in g)){I[t]=g;const C=mu(g)?[]:{};return ku(g,((g,I)=>{const l=e(g,t+1);!hu(l)&&(C[I]=l)})),I[t]=void 0,C}}return g};return e(g,0)},isAsyncFn:Uu,isThenable:g=>g&&(yu(g)||pu(g))&&pu(g.then)&&pu(g.catch)};function Lu(g,I,e,t,C){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=g,this.name="AxiosError",I&&(this.code=I),e&&(this.config=e),t&&(this.request=t),C&&(this.response=C)}Qu.inherits(Lu,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Qu.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Du=Lu.prototype,Tu={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((g=>{Tu[g]={value:g}})),Object.defineProperties(Lu,Tu),Object.defineProperty(Du,"isAxiosError",{value:!0}),Lu.from=(g,I,e,t,C,l)=>{const n=Object.create(Du);return Qu.toFlatObject(g,n,(function(g){return g!==Error.prototype}),(g=>"isAxiosError"!==g)),Lu.call(n,g.message,I,e,t,C),n.cause=g,n.name=g.name,l&&Object.assign(n,l),n};const ju=Lu;function Pu(g){return Qu.isPlainObject(g)||Qu.isArray(g)}function Ou(g){return Qu.endsWith(g,"[]")?g.slice(0,-2):g}function _u(g,I,e){return g?g.concat(I).map((function(g,I){return g=Ou(g),!e&&I?"["+g+"]":g})).join(e?".":""):I}const qu=Qu.toFlatObject(Qu,{},null,(function(g){return/^is[A-Z]/.test(g)}));const $u=function(g,I,e){if(!Qu.isObject(g))throw new TypeError("target must be an object");I=I||new FormData;const t=(e=Qu.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(g,I){return!Qu.isUndefined(I[g])}))).metaTokens,C=e.visitor||i,l=e.dots,n=e.indexes,o=(e.Blob||"undefined"!==typeof Blob&&Blob)&&Qu.isSpecCompliantForm(I);if(!Qu.isFunction(C))throw new TypeError("visitor must be a function");function a(g){if(null===g)return"";if(Qu.isDate(g))return g.toISOString();if(!o&&Qu.isBlob(g))throw new ju("Blob is not supported. Use a Buffer instead.");return Qu.isArrayBuffer(g)||Qu.isTypedArray(g)?o&&"function"===typeof Blob?new Blob([g]):Buffer.from(g):g}function i(g,e,C){let o=g;if(g&&!C&&"object"===typeof g)if(Qu.endsWith(e,"{}"))e=t?e:e.slice(0,-2),g=JSON.stringify(g);else if(Qu.isArray(g)&&function(g){return Qu.isArray(g)&&!g.some(Pu)}(g)||(Qu.isFileList(g)||Qu.endsWith(e,"[]"))&&(o=Qu.toArray(g)))return e=Ou(e),o.forEach((function(g,t){!Qu.isUndefined(g)&&null!==g&&I.append(!0===n?_u([e],t,l):null===n?e:e+"[]",a(g))})),!1;return!!Pu(g)||(I.append(_u(C,e,l),a(g)),!1)}const A=[],c=Object.assign(qu,{defaultVisitor:i,convertValue:a,isVisitable:Pu});if(!Qu.isObject(g))throw new TypeError("data must be an object");return function g(e,t){if(!Qu.isUndefined(e)){if(-1!==A.indexOf(e))throw Error("Circular reference detected in "+t.join("."));A.push(e),Qu.forEach(e,(function(e,l){!0===(!(Qu.isUndefined(e)||null===e)&&C.call(I,e,Qu.isString(l)?l.trim():l,t,c))&&g(e,t?t.concat(l):[l])})),A.pop()}}(g),I};function gb(g){const I={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(g).replace(/[!'()~]|%20|%00/g,(function(g){return I[g]}))}function Ib(g,I){this._pairs=[],g&&$u(g,this,I)}const eb=Ib.prototype;eb.append=function(g,I){this._pairs.push([g,I])},eb.toString=function(g){const I=g?function(I){return g.call(this,I,gb)}:gb;return this._pairs.map((function(g){return I(g[0])+"="+I(g[1])}),"").join("&")};const tb=Ib;function Cb(g){return encodeURIComponent(g).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function lb(g,I,e){if(!I)return g;const t=e&&e.encode||Cb,C=e&&e.serialize;let l;if(l=C?C(I,e):Qu.isURLSearchParams(I)?I.toString():new tb(I,e).toString(t),l){const I=g.indexOf("#");-1!==I&&(g=g.slice(0,I)),g+=(-1===g.indexOf("?")?"?":"&")+l}return g}const nb=class{constructor(){this.handlers=[]}use(g,I,e){return this.handlers.push({fulfilled:g,rejected:I,synchronous:!!e&&e.synchronous,runWhen:e?e.runWhen:null}),this.handlers.length-1}eject(g){this.handlers[g]&&(this.handlers[g]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(g){Qu.forEach(this.handlers,(function(I){null!==I&&g(I)}))}},ob={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ab={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:tb,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ib="undefined"!==typeof window&&"undefined"!==typeof document,Ab=(cb="undefined"!==typeof navigator&&navigator.product,ib&&["ReactNative","NativeScript","NS"].indexOf(cb)<0);var cb;const sb="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,db={...g,...ab};const rb=function(g){function I(g,e,t,C){let l=g[C++];if("__proto__"===l)return!0;const n=Number.isFinite(+l),o=C>=g.length;if(l=!l&&Qu.isArray(t)?t.length:l,o)return Qu.hasOwnProp(t,l)?t[l]=[t[l],e]:t[l]=e,!n;t[l]&&Qu.isObject(t[l])||(t[l]=[]);return I(g,e,t[l],C)&&Qu.isArray(t[l])&&(t[l]=function(g){const I={},e=Object.keys(g);let t;const C=e.length;let l;for(t=0;t<C;t++)l=e[t],I[l]=g[l];return I}(t[l])),!n}if(Qu.isFormData(g)&&Qu.isFunction(g.entries)){const e={};return Qu.forEachEntry(g,((g,t)=>{I(function(g){return Qu.matchAll(/\w+|\[(\w*)]/g,g).map((g=>"[]"===g[0]?"":g[1]||g[0]))}(g),t,e,0)})),e}return null};const ub={transitional:ob,adapter:["xhr","http"],transformRequest:[function(g,I){const e=I.getContentType()||"",t=e.indexOf("application/json")>-1,C=Qu.isObject(g);C&&Qu.isHTMLForm(g)&&(g=new FormData(g));if(Qu.isFormData(g))return t?JSON.stringify(rb(g)):g;if(Qu.isArrayBuffer(g)||Qu.isBuffer(g)||Qu.isStream(g)||Qu.isFile(g)||Qu.isBlob(g))return g;if(Qu.isArrayBufferView(g))return g.buffer;if(Qu.isURLSearchParams(g))return I.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),g.toString();let l;if(C){if(e.indexOf("application/x-www-form-urlencoded")>-1)return function(g,I){return $u(g,new db.classes.URLSearchParams,Object.assign({visitor:function(g,I,e,t){return db.isNode&&Qu.isBuffer(g)?(this.append(I,g.toString("base64")),!1):t.defaultVisitor.apply(this,arguments)}},I))}(g,this.formSerializer).toString();if((l=Qu.isFileList(g))||e.indexOf("multipart/form-data")>-1){const I=this.env&&this.env.FormData;return $u(l?{"files[]":g}:g,I&&new I,this.formSerializer)}}return C||t?(I.setContentType("application/json",!1),function(g,I,e){if(Qu.isString(g))try{return(I||JSON.parse)(g),Qu.trim(g)}catch(xG){if("SyntaxError"!==xG.name)throw xG}return(e||JSON.stringify)(g)}(g)):g}],transformResponse:[function(g){const I=this.transitional||ub.transitional,e=I&&I.forcedJSONParsing,t="json"===this.responseType;if(g&&Qu.isString(g)&&(e&&!this.responseType||t)){const e=!(I&&I.silentJSONParsing)&&t;try{return JSON.parse(g)}catch(xG){if(e){if("SyntaxError"===xG.name)throw ju.from(xG,ju.ERR_BAD_RESPONSE,this,null,this.response);throw xG}}}return g}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:db.classes.FormData,Blob:db.classes.Blob},validateStatus:function(g){return g>=200&&g<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Qu.forEach(["delete","get","head","post","put","patch"],(g=>{ub.headers[g]={}}));const bb=ub,mb=Qu.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),hb=Symbol("internals");function Zb(g){return g&&String(g).trim().toLowerCase()}function Gb(g){return!1===g||null==g?g:Qu.isArray(g)?g.map(Gb):String(g)}function pb(g,I,e,t,C){return Qu.isFunction(t)?t.call(this,I,e):(C&&(I=e),Qu.isString(I)?Qu.isString(t)?-1!==I.indexOf(t):Qu.isRegExp(t)?t.test(I):void 0:void 0)}class Bb{constructor(g){g&&this.set(g)}set(g,I,e){const t=this;function C(g,I,e){const C=Zb(I);if(!C)throw new Error("header name must be a non-empty string");const l=Qu.findKey(t,C);(!l||void 0===t[l]||!0===e||void 0===e&&!1!==t[l])&&(t[l||I]=Gb(g))}const l=(g,I)=>Qu.forEach(g,((g,e)=>C(g,e,I)));return Qu.isPlainObject(g)||g instanceof this.constructor?l(g,I):Qu.isString(g)&&(g=g.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(g.trim())?l((g=>{const I={};let e,t,C;return g&&g.split("\n").forEach((function(g){C=g.indexOf(":"),e=g.substring(0,C).trim().toLowerCase(),t=g.substring(C+1).trim(),!e||I[e]&&mb[e]||("set-cookie"===e?I[e]?I[e].push(t):I[e]=[t]:I[e]=I[e]?I[e]+", "+t:t)})),I})(g),I):null!=g&&C(I,g,e),this}get(g,I){if(g=Zb(g)){const e=Qu.findKey(this,g);if(e){const g=this[e];if(!I)return g;if(!0===I)return function(g){const I=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let t;for(;t=e.exec(g);)I[t[1]]=t[2];return I}(g);if(Qu.isFunction(I))return I.call(this,g,e);if(Qu.isRegExp(I))return I.exec(g);throw new TypeError("parser must be boolean|regexp|function")}}}has(g,I){if(g=Zb(g)){const e=Qu.findKey(this,g);return!(!e||void 0===this[e]||I&&!pb(0,this[e],e,I))}return!1}delete(g,I){const e=this;let t=!1;function C(g){if(g=Zb(g)){const C=Qu.findKey(e,g);!C||I&&!pb(0,e[C],C,I)||(delete e[C],t=!0)}}return Qu.isArray(g)?g.forEach(C):C(g),t}clear(g){const I=Object.keys(this);let e=I.length,t=!1;for(;e--;){const C=I[e];g&&!pb(0,this[C],C,g,!0)||(delete this[C],t=!0)}return t}normalize(g){const I=this,e={};return Qu.forEach(this,((t,C)=>{const l=Qu.findKey(e,C);if(l)return I[l]=Gb(t),void delete I[C];const n=g?function(g){return g.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((g,I,e)=>I.toUpperCase()+e))}(C):String(C).trim();n!==C&&delete I[C],I[n]=Gb(t),e[n]=!0})),this}concat(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];return this.constructor.concat(this,...I)}toJSON(g){const I=Object.create(null);return Qu.forEach(this,((e,t)=>{null!=e&&!1!==e&&(I[t]=g&&Qu.isArray(e)?e.join(", "):e)})),I}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((g=>{let[I,e]=g;return I+": "+e})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(g){return g instanceof this?g:new this(g)}static concat(g){const I=new this(g);for(var e=arguments.length,t=new Array(e>1?e-1:0),C=1;C<e;C++)t[C-1]=arguments[C];return t.forEach((g=>I.set(g))),I}static accessor(g){const I=(this[hb]=this[hb]={accessors:{}}).accessors,e=this.prototype;function t(g){const t=Zb(g);I[t]||(!function(g,I){const e=Qu.toCamelCase(" "+I);["get","set","has"].forEach((t=>{Object.defineProperty(g,t+e,{value:function(g,e,C){return this[t].call(this,I,g,e,C)},configurable:!0})}))}(e,g),I[t]=!0)}return Qu.isArray(g)?g.forEach(t):t(g),this}}Bb.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Qu.reduceDescriptors(Bb.prototype,((g,I)=>{let{value:e}=g,t=I[0].toUpperCase()+I.slice(1);return{get:()=>e,set(g){this[t]=g}}})),Qu.freezeMethods(Bb);const yb=Bb;function Wb(g,I){const e=this||bb,t=I||e,C=yb.from(t.headers);let l=t.data;return Qu.forEach(g,(function(g){l=g.call(e,l,C.normalize(),I?I.status:void 0)})),C.normalize(),l}function Vb(g){return!(!g||!g.__CANCEL__)}function Sb(g,I,e){ju.call(this,null==g?"canceled":g,ju.ERR_CANCELED,I,e),this.name="CanceledError"}Qu.inherits(Sb,ju,{__CANCEL__:!0});const Rb=Sb;const Xb=db.hasStandardBrowserEnv?{write(g,I,e,t,C,l){const n=[g+"="+encodeURIComponent(I)];Qu.isNumber(e)&&n.push("expires="+new Date(e).toGMTString()),Qu.isString(t)&&n.push("path="+t),Qu.isString(C)&&n.push("domain="+C),!0===l&&n.push("secure"),document.cookie=n.join("; ")},read(g){const I=document.cookie.match(new RegExp("(^|;\\s*)("+g+")=([^;]*)"));return I?decodeURIComponent(I[3]):null},remove(g){this.write(g,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Jb(g,I){return g&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(I)?function(g,I){return I?g.replace(/\/?\/$/,"")+"/"+I.replace(/^\/+/,""):g}(g,I):I}const kb=db.hasStandardBrowserEnv?function(){const g=/(msie|trident)/i.test(navigator.userAgent),I=document.createElement("a");let e;function t(e){let t=e;return g&&(I.setAttribute("href",t),t=I.href),I.setAttribute("href",t),{href:I.href,protocol:I.protocol?I.protocol.replace(/:$/,""):"",host:I.host,search:I.search?I.search.replace(/^\?/,""):"",hash:I.hash?I.hash.replace(/^#/,""):"",hostname:I.hostname,port:I.port,pathname:"/"===I.pathname.charAt(0)?I.pathname:"/"+I.pathname}}return e=t(window.location.href),function(g){const I=Qu.isString(g)?t(g):g;return I.protocol===e.protocol&&I.host===e.host}}():function(){return!0};const fb=function(g,I){g=g||10;const e=new Array(g),t=new Array(g);let C,l=0,n=0;return I=void 0!==I?I:1e3,function(o){const a=Date.now(),i=t[n];C||(C=a),e[l]=o,t[l]=a;let A=n,c=0;for(;A!==l;)c+=e[A++],A%=g;if(l=(l+1)%g,l===n&&(n=(n+1)%g),a-C<I)return;const s=i&&a-i;return s?Math.round(1e3*c/s):void 0}};function vb(g,I){let e=0;const t=fb(50,250);return C=>{const l=C.loaded,n=C.lengthComputable?C.total:void 0,o=l-e,a=t(o);e=l;const i={loaded:l,total:n,progress:n?l/n:void 0,bytes:o,rate:a||void 0,estimated:a&&n&&l<=n?(n-l)/a:void 0,event:C};i[I?"download":"upload"]=!0,g(i)}}const Yb="undefined"!==typeof XMLHttpRequest&&function(g){return new Promise((function(I,e){let t=g.data;const C=yb.from(g.headers).normalize();let l,n,{responseType:o,withXSRFToken:a}=g;function i(){g.cancelToken&&g.cancelToken.unsubscribe(l),g.signal&&g.signal.removeEventListener("abort",l)}if(Qu.isFormData(t))if(db.hasStandardBrowserEnv||db.hasStandardBrowserWebWorkerEnv)C.setContentType(!1);else if(!1!==(n=C.getContentType())){const[g,...I]=n?n.split(";").map((g=>g.trim())).filter(Boolean):[];C.setContentType([g||"multipart/form-data",...I].join("; "))}let A=new XMLHttpRequest;if(g.auth){const I=g.auth.username||"",e=g.auth.password?unescape(encodeURIComponent(g.auth.password)):"";C.set("Authorization","Basic "+btoa(I+":"+e))}const c=Jb(g.baseURL,g.url);function s(){if(!A)return;const t=yb.from("getAllResponseHeaders"in A&&A.getAllResponseHeaders());!function(g,I,e){const t=e.config.validateStatus;e.status&&t&&!t(e.status)?I(new ju("Request failed with status code "+e.status,[ju.ERR_BAD_REQUEST,ju.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e)):g(e)}((function(g){I(g),i()}),(function(g){e(g),i()}),{data:o&&"text"!==o&&"json"!==o?A.response:A.responseText,status:A.status,statusText:A.statusText,headers:t,config:g,request:A}),A=null}if(A.open(g.method.toUpperCase(),lb(c,g.params,g.paramsSerializer),!0),A.timeout=g.timeout,"onloadend"in A?A.onloadend=s:A.onreadystatechange=function(){A&&4===A.readyState&&(0!==A.status||A.responseURL&&0===A.responseURL.indexOf("file:"))&&setTimeout(s)},A.onabort=function(){A&&(e(new ju("Request aborted",ju.ECONNABORTED,g,A)),A=null)},A.onerror=function(){e(new ju("Network Error",ju.ERR_NETWORK,g,A)),A=null},A.ontimeout=function(){let I=g.timeout?"timeout of "+g.timeout+"ms exceeded":"timeout exceeded";const t=g.transitional||ob;g.timeoutErrorMessage&&(I=g.timeoutErrorMessage),e(new ju(I,t.clarifyTimeoutError?ju.ETIMEDOUT:ju.ECONNABORTED,g,A)),A=null},db.hasStandardBrowserEnv&&(a&&Qu.isFunction(a)&&(a=a(g)),a||!1!==a&&kb(c))){const I=g.xsrfHeaderName&&g.xsrfCookieName&&Xb.read(g.xsrfCookieName);I&&C.set(g.xsrfHeaderName,I)}void 0===t&&C.setContentType(null),"setRequestHeader"in A&&Qu.forEach(C.toJSON(),(function(g,I){A.setRequestHeader(I,g)})),Qu.isUndefined(g.withCredentials)||(A.withCredentials=!!g.withCredentials),o&&"json"!==o&&(A.responseType=g.responseType),"function"===typeof g.onDownloadProgress&&A.addEventListener("progress",vb(g.onDownloadProgress,!0)),"function"===typeof g.onUploadProgress&&A.upload&&A.upload.addEventListener("progress",vb(g.onUploadProgress)),(g.cancelToken||g.signal)&&(l=I=>{A&&(e(!I||I.type?new Rb(null,g,A):I),A.abort(),A=null)},g.cancelToken&&g.cancelToken.subscribe(l),g.signal&&(g.signal.aborted?l():g.signal.addEventListener("abort",l)));const d=function(g){const I=/^([-+\w]{1,25})(:?\/\/|:)/.exec(g);return I&&I[1]||""}(c);d&&-1===db.protocols.indexOf(d)?e(new ju("Unsupported protocol "+d+":",ju.ERR_BAD_REQUEST,g)):A.send(t||null)}))},Hb={http:null,xhr:Yb};Qu.forEach(Hb,((g,I)=>{if(g){try{Object.defineProperty(g,"name",{value:I})}catch(xG){}Object.defineProperty(g,"adapterName",{value:I})}}));const Nb=g=>"- ".concat(g),Kb=g=>Qu.isFunction(g)||null===g||!1===g,wb=g=>{g=Qu.isArray(g)?g:[g];const{length:I}=g;let e,t;const C={};for(let l=0;l<I;l++){let I;if(e=g[l],t=e,!Kb(e)&&(t=Hb[(I=String(e)).toLowerCase()],void 0===t))throw new ju("Unknown adapter '".concat(I,"'"));if(t)break;C[I||"#"+l]=t}if(!t){const g=Object.entries(C).map((g=>{let[I,e]=g;return"adapter ".concat(I," ")+(!1===e?"is not supported by the environment":"is not available in the build")}));let e=I?g.length>1?"since :\n"+g.map(Nb).join("\n"):" "+Nb(g[0]):"as no adapter specified";throw new ju("There is no suitable adapter to dispatch the request "+e,"ERR_NOT_SUPPORT")}return t};function Fb(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new Rb(null,g)}function xb(g){Fb(g),g.headers=yb.from(g.headers),g.data=Wb.call(g,g.transformRequest),-1!==["post","put","patch"].indexOf(g.method)&&g.headers.setContentType("application/x-www-form-urlencoded",!1);return wb(g.adapter||bb.adapter)(g).then((function(I){return Fb(g),I.data=Wb.call(g,g.transformResponse,I),I.headers=yb.from(I.headers),I}),(function(I){return Vb(I)||(Fb(g),I&&I.response&&(I.response.data=Wb.call(g,g.transformResponse,I.response),I.response.headers=yb.from(I.response.headers))),Promise.reject(I)}))}const zb=g=>g instanceof yb?{...g}:g;function Mb(g,I){I=I||{};const e={};function t(g,I,e){return Qu.isPlainObject(g)&&Qu.isPlainObject(I)?Qu.merge.call({caseless:e},g,I):Qu.isPlainObject(I)?Qu.merge({},I):Qu.isArray(I)?I.slice():I}function C(g,I,e){return Qu.isUndefined(I)?Qu.isUndefined(g)?void 0:t(void 0,g,e):t(g,I,e)}function l(g,I){if(!Qu.isUndefined(I))return t(void 0,I)}function n(g,I){return Qu.isUndefined(I)?Qu.isUndefined(g)?void 0:t(void 0,g):t(void 0,I)}function o(e,C,l){return l in I?t(e,C):l in g?t(void 0,e):void 0}const a={url:l,method:l,data:l,baseURL:n,transformRequest:n,transformResponse:n,paramsSerializer:n,timeout:n,timeoutMessage:n,withCredentials:n,withXSRFToken:n,adapter:n,responseType:n,xsrfCookieName:n,xsrfHeaderName:n,onUploadProgress:n,onDownloadProgress:n,decompress:n,maxContentLength:n,maxBodyLength:n,beforeRedirect:n,transport:n,httpAgent:n,httpsAgent:n,cancelToken:n,socketPath:n,responseEncoding:n,validateStatus:o,headers:(g,I)=>C(zb(g),zb(I),!0)};return Qu.forEach(Object.keys(Object.assign({},g,I)),(function(t){const l=a[t]||C,n=l(g[t],I[t],t);Qu.isUndefined(n)&&l!==o||(e[t]=n)})),e}const Eb="1.6.8",Ub={};["object","boolean","number","function","string","symbol"].forEach(((g,I)=>{Ub[g]=function(e){return typeof e===g||"a"+(I<1?"n ":" ")+g}}));const Qb={};Ub.transitional=function(g,I,e){function t(g,I){return"[Axios v1.6.8] Transitional option '"+g+"'"+I+(e?". "+e:"")}return(e,C,l)=>{if(!1===g)throw new ju(t(C," has been removed"+(I?" in "+I:"")),ju.ERR_DEPRECATED);return I&&!Qb[C]&&(Qb[C]=!0,console.warn(t(C," has been deprecated since v"+I+" and will be removed in the near future"))),!g||g(e,C,l)}};const Lb={assertOptions:function(g,I,e){if("object"!==typeof g)throw new ju("options must be an object",ju.ERR_BAD_OPTION_VALUE);const t=Object.keys(g);let C=t.length;for(;C-- >0;){const l=t[C],n=I[l];if(n){const I=g[l],e=void 0===I||n(I,l,g);if(!0!==e)throw new ju("option "+l+" must be "+e,ju.ERR_BAD_OPTION_VALUE)}else if(!0!==e)throw new ju("Unknown option "+l,ju.ERR_BAD_OPTION)}},validators:Ub},Db=Lb.validators;class Tb{constructor(g){this.defaults=g,this.interceptors={request:new nb,response:new nb}}async request(g,I){try{return await this._request(g,I)}catch(e){if(e instanceof Error){let g;Error.captureStackTrace?Error.captureStackTrace(g={}):g=new Error;const I=g.stack?g.stack.replace(/^.+\n/,""):"";e.stack?I&&!String(e.stack).endsWith(I.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+I):e.stack=I}throw e}}_request(g,I){"string"===typeof g?(I=I||{}).url=g:I=g||{},I=Mb(this.defaults,I);const{transitional:e,paramsSerializer:t,headers:C}=I;void 0!==e&&Lb.assertOptions(e,{silentJSONParsing:Db.transitional(Db.boolean),forcedJSONParsing:Db.transitional(Db.boolean),clarifyTimeoutError:Db.transitional(Db.boolean)},!1),null!=t&&(Qu.isFunction(t)?I.paramsSerializer={serialize:t}:Lb.assertOptions(t,{encode:Db.function,serialize:Db.function},!0)),I.method=(I.method||this.defaults.method||"get").toLowerCase();let l=C&&Qu.merge(C.common,C[I.method]);C&&Qu.forEach(["delete","get","head","post","put","patch","common"],(g=>{delete C[g]})),I.headers=yb.concat(l,C);const n=[];let o=!0;this.interceptors.request.forEach((function(g){"function"===typeof g.runWhen&&!1===g.runWhen(I)||(o=o&&g.synchronous,n.unshift(g.fulfilled,g.rejected))}));const a=[];let i;this.interceptors.response.forEach((function(g){a.push(g.fulfilled,g.rejected)}));let A,c=0;if(!o){const g=[xb.bind(this),void 0];for(g.unshift.apply(g,n),g.push.apply(g,a),A=g.length,i=Promise.resolve(I);c<A;)i=i.then(g[c++],g[c++]);return i}A=n.length;let s=I;for(c=0;c<A;){const g=n[c++],I=n[c++];try{s=g(s)}catch(d){I.call(this,d);break}}try{i=xb.call(this,s)}catch(d){return Promise.reject(d)}for(c=0,A=a.length;c<A;)i=i.then(a[c++],a[c++]);return i}getUri(g){return lb(Jb((g=Mb(this.defaults,g)).baseURL,g.url),g.params,g.paramsSerializer)}}Qu.forEach(["delete","get","head","options"],(function(g){Tb.prototype[g]=function(I,e){return this.request(Mb(e||{},{method:g,url:I,data:(e||{}).data}))}})),Qu.forEach(["post","put","patch"],(function(g){function I(I){return function(e,t,C){return this.request(Mb(C||{},{method:g,headers:I?{"Content-Type":"multipart/form-data"}:{},url:e,data:t}))}}Tb.prototype[g]=I(),Tb.prototype[g+"Form"]=I(!0)}));const jb=Tb;class Pb{constructor(g){if("function"!==typeof g)throw new TypeError("executor must be a function.");let I;this.promise=new Promise((function(g){I=g}));const e=this;this.promise.then((g=>{if(!e._listeners)return;let I=e._listeners.length;for(;I-- >0;)e._listeners[I](g);e._listeners=null})),this.promise.then=g=>{let I;const t=new Promise((g=>{e.subscribe(g),I=g})).then(g);return t.cancel=function(){e.unsubscribe(I)},t},g((function(g,t,C){e.reason||(e.reason=new Rb(g,t,C),I(e.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(g){this.reason?g(this.reason):this._listeners?this._listeners.push(g):this._listeners=[g]}unsubscribe(g){if(!this._listeners)return;const I=this._listeners.indexOf(g);-1!==I&&this._listeners.splice(I,1)}static source(){let g;return{token:new Pb((function(I){g=I})),cancel:g}}}const Ob=Pb;const _b={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_b).forEach((g=>{let[I,e]=g;_b[e]=I}));const qb=_b;const $b=function g(I){const e=new jb(I),t=Au(jb.prototype.request,e);return Qu.extend(t,jb.prototype,e,{allOwnKeys:!0}),Qu.extend(t,e,null,{allOwnKeys:!0}),t.create=function(e){return g(Mb(I,e))},t}(bb);$b.Axios=jb,$b.CanceledError=Rb,$b.CancelToken=Ob,$b.isCancel=Vb,$b.VERSION=Eb,$b.toFormData=$u,$b.AxiosError=ju,$b.Cancel=$b.CanceledError,$b.all=function(g){return Promise.all(g)},$b.spread=function(g){return function(I){return g.apply(null,I)}},$b.isAxiosError=function(g){return Qu.isObject(g)&&!0===g.isAxiosError},$b.mergeConfig=Mb,$b.AxiosHeaders=yb,$b.formToJSON=g=>rb(Qu.isHTMLForm(g)?new FormData(g):g),$b.getAdapter=wb,$b.HttpStatusCode=qb,$b.default=$b;const gm={url:{API_BASE_URL:"http://139.59.106.250:8080"}};function Im(g){if(!g)return;const I=g.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(I))}const em=g=>{g.response?console.log(g.response.data):g.request?console.log(g.request):console.log(g.message)},tm={authenticate:function(g,I){return Cm.post("/auth/authenticate",{username:g,password:I},{headers:{"Content-type":"application/json"}})},signup:function(g){return Cm.post("/auth/signup",g,{headers:{"Content-type":"application/json"}})},numberOfUsers:function(){return Cm.get("/public/numberOfUsers")},getUserMe:function(g){return Cm.get("/api/users/me",{headers:{Authorization:lm(g)}})},getCurrentExchangeRates:function(){return Cm.get("/api/exchange-rates/current")},transferCurrency:function(g,I,e,t){return Cm.post("/api/wallets/transfer",{fromCurrency:I,toCurrency:e,amount:t},{headers:{"Content-type":"application/json",Authorization:lm(g)}})},getAllTransactions:function(g){return Cm.get("/api/transactions",{headers:{Authorization:lm(g)}})},createTransaction:function(g,I){return Cm.post("/api/transactions",g,{headers:{"Content-type":"application/json",Authorization:lm(I)}})},getTransactionById:function(g,I){return Cm.get("/api/transactions/".concat(g),{headers:{Authorization:lm(I)}})},deleteTransaction:function(g,I){return Cm.delete("/api/transactions/".concat(g),{headers:{Authorization:lm(I)}})},getUserById:function(g,I){return Cm.get("/api/users/".concat(g),{headers:{Authorization:lm(I)}})},updateUser:function(g,I,e){return Cm.put("/api/users/".concat(g),I,{headers:{"Content-type":"application/json",Authorization:lm(e)}})},deleteUser:function(g,I){return Cm.delete("/api/users/".concat(g),{headers:{Authorization:lm(I)}})},getWalletById:function(g){return Cm.get("/api/wallets",{headers:{Authorization:lm(g)}})},getBankCardForCurrentUser:function(g){return Cm.get("/api/card",{headers:{Authorization:lm(g)}})}};const Cm=$b.create({baseURL:gm.url.API_BASE_URL});function lm(g){return"Bearer ".concat(g.accessToken)}function nm(g){var I=g.children,e=g.className,C=g.content,l=VC("sub header",e),n=NC(nm,g),o=KC(nm,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}Cm.interceptors.request.use((function(g){if(g.headers.Authorization){const I=Im(g.headers.Authorization.split(" ")[1]);Date.now()>1e3*I.exp&&(window.location.href="/login")}return g}),(function(g){return Promise.reject(g)})),nm.handledProps=["as","children","className","content"],nm.propTypes={},nm.create=sl(nm,(function(g){return{content:g}}));const om=nm;function am(g){var I=g.children,e=g.className,C=g.content,l=VC("content",e),n=NC(am,g),o=KC(am,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}am.handledProps=["as","children","className","content"],am.propTypes={};const im=am;function Am(g){var I=g.attached,e=g.block,C=g.children,l=g.className,n=g.color,o=g.content,a=g.disabled,i=g.dividing,A=g.floated,c=g.icon,s=g.image,d=g.inverted,r=g.size,u=g.sub,b=g.subheader,m=g.textAlign,h=VC("ui",n,r,XC(e,"block"),XC(a,"disabled"),XC(i,"dividing"),JC(A,"floated"),XC(!0===c,"icon"),XC(!0===s,"image"),XC(d,"inverted"),XC(u,"sub"),kC(I,"attached"),vC(m),"header",l),Z=NC(Am,g),G=KC(Am,g);if(!zC(C))return t.createElement(G,Fg({},Z,{className:h}),C);var p=Wn.create(c,{autoGenerateKey:!1}),B=na.create(s,{autoGenerateKey:!1}),y=om.create(b,{autoGenerateKey:!1});return p||B?t.createElement(G,Fg({},Z,{className:h}),p||B,(o||y)&&t.createElement(im,null,o,y)):t.createElement(G,Fg({},Z,{className:h}),o,y)}Am.handledProps=["as","attached","block","children","className","color","content","disabled","dividing","floated","icon","image","inverted","size","sub","subheader","textAlign"],Am.propTypes={},Am.Content=im,Am.Subheader=om;const cm=Am,sm=()=>(0,Yg.jsx)(Fn,{vertical:!0,style:{padding:"2em 0em",backgroundColor:"white",textAlign:"center"},children:(0,Yg.jsx)(fn,{children:(0,Yg.jsxs)(cm,{as:"h4",style:{color:"grey"},children:["\xa9 ",(new Date).getFullYear()," Crypto Exchange. All Rights Reserved."]})})});zd.register(Hr,Fr,tr,Ir,br,fr,rr);const dm=function(){const[g,I]=(0,t.useState)(0),[e,C]=(0,t.useState)(!0),[l,n]=(0,t.useState)([]);return(0,t.useEffect)((()=>{!async function(){try{const g=(await tm.numberOfUsers()).data;I(g);const e=await fetch("https://api.coindesk.com/v1/bpi/historical/close.json"),t=await e.json();n(Object.entries(t.bpi))}catch(g){em(g)}finally{C(!1)}}()}),[]),e?(0,Yg.jsx)(Fn,{basic:!0,style:{marginTop:window.innerHeight/2},children:(0,Yg.jsx)(yo,{active:!0,inverted:!0,children:(0,Yg.jsx)(Vo,{inverted:!0,size:"huge",children:"Loading"})})}):(l.map((g=>{let[I]=g;return I})),l.map((g=>{let[,I]=g;return I})),(0,Yg.jsxs)(fn,{text:!0,children:[(0,Yg.jsx)(fo,{stackable:!0,columns:1,children:(0,Yg.jsx)(fo.Row,{children:(0,Yg.jsx)(fo.Column,{textAlign:"center",children:(0,Yg.jsx)(Fn,{color:"violet",children:(0,Yg.jsxs)(xo,{children:[(0,Yg.jsxs)(xo.Value,{children:[(0,Yg.jsx)(Wn,{name:"user",color:"grey"}),g]}),(0,Yg.jsx)(xo.Label,{children:"Users"})]})})})})}),(0,Yg.jsx)(na,{src:"https://react.semantic-ui.com/images/wireframe/media-paragraph.png",style:{marginTop:"2em"}}),(0,Yg.jsx)(na,{src:"https://react.semantic-ui.com/images/wireframe/paragraph.png",style:{marginTop:"2em"}}),(0,Yg.jsx)(sm,{})]}))};function rm(g){var I=g.children,e=g.className,C=g.content,l=g.hidden,n=g.visible,o=VC(XC(n,"visible"),XC(l,"hidden"),"content",e),a=NC(rm,g),i=KC(rm,g);return t.createElement(i,Fg({},a,{className:o}),zC(I)?C:I)}rm.handledProps=["as","children","className","content","hidden","visible"],rm.propTypes={};const um=rm;function bm(g){var I=g.attached,e=g.basic,C=g.buttons,l=g.children,n=g.className,o=g.color,a=g.compact,i=g.content,A=g.floated,c=g.fluid,s=g.icon,d=g.inverted,r=g.labeled,u=g.negative,b=g.positive,m=g.primary,h=g.secondary,Z=g.size,G=g.toggle,p=g.vertical,B=g.widths,y=VC("ui",o,Z,XC(e,"basic"),XC(a,"compact"),XC(c,"fluid"),XC(s,"icon"),XC(d,"inverted"),XC(r,"labeled"),XC(u,"negative"),XC(b,"positive"),XC(m,"primary"),XC(h,"secondary"),XC(G,"toggle"),XC(p,"vertical"),kC(I,"attached"),JC(A,"floated"),HC(B),"buttons",n),W=NC(bm,g),V=KC(bm,g);return Al(C)?t.createElement(V,Fg({},W,{className:y}),zC(l)?i:l):t.createElement(V,Fg({},W,{className:y}),iC(C,(function(g){return pm.create(g)})))}bm.handledProps=["as","attached","basic","buttons","children","className","color","compact","content","floated","fluid","icon","inverted","labeled","negative","positive","primary","secondary","size","toggle","vertical","widths"],bm.propTypes={};const mm=bm;function hm(g){var I=g.className,e=g.text,C=VC("or",I),l=NC(hm,g),n=KC(hm,g);return t.createElement(n,Fg({},l,{className:C,"data-text":e}))}hm.handledProps=["as","className","text"],hm.propTypes={};const Zm=hm;var Gm=function(g){function I(){for(var I,e=arguments.length,C=new Array(e),l=0;l<e;l++)C[l]=arguments[l];return(I=g.call.apply(g,[this].concat(C))||this).ref=(0,t.createRef)(),I.computeElementType=function(){var g=I.props,e=g.attached,t=g.label;if(!Al(e)||!Al(t))return"div"},I.computeTabIndex=function(g){var e=I.props,t=e.disabled,C=e.tabIndex;return Al(C)?t?-1:"div"===g?0:void 0:C},I.focus=function(g){return yC(I.ref.current,"focus",g)},I.handleClick=function(g){I.props.disabled?g.preventDefault():yC(I.props,"onClick",g,I.props)},I.hasIconClass=function(){var g=I.props,e=g.labelPosition,t=g.children,C=g.content,l=g.icon;return!0===l||l&&(e||zC(t)&&Al(C))},I}zg(I,g);var e=I.prototype;return e.computeButtonAriaRole=function(g){var I=this.props.role;return Al(I)?"button"!==g?"button":void 0:I},e.render=function(){var g=this.props,e=g.active,C=g.animated,l=g.attached,n=g.basic,o=g.children,a=g.circular,i=g.className,A=g.color,c=g.compact,s=g.content,d=g.disabled,r=g.floated,u=g.fluid,b=g.icon,m=g.inverted,h=g.label,Z=g.labelPosition,G=g.loading,p=g.negative,B=g.positive,y=g.primary,W=g.secondary,V=g.size,S=g.toggle,R=g.type,X=VC(A,V,XC(e,"active"),XC(n,"basic"),XC(a,"circular"),XC(c,"compact"),XC(u,"fluid"),XC(this.hasIconClass(),"icon"),XC(m,"inverted"),XC(G,"loading"),XC(p,"negative"),XC(B,"positive"),XC(y,"primary"),XC(W,"secondary"),XC(S,"toggle"),kC(C,"animated"),kC(l,"attached")),J=VC(kC(Z||!!h,"labeled")),k=VC(XC(d,"disabled"),JC(r,"floated")),f=NC(I,this.props),v=KC(I,this.props,this.computeElementType),Y=this.computeTabIndex(v);if(!Al(h)){var H=VC("ui",X,"button",i),N=VC("ui",J,"button",i,k),K=ea.create(h,{defaultProps:{basic:!0,pointing:"left"===Z?"right":"left"},autoGenerateKey:!1});return t.createElement(v,Fg({},f,{className:N,onClick:this.handleClick}),"left"===Z&&K,t.createElement(Pn,{innerRef:this.ref},t.createElement("button",{className:H,"aria-pressed":S?!!e:void 0,disabled:d,type:R,tabIndex:Y},Wn.create(b,{autoGenerateKey:!1})," ",s)),("right"===Z||!Z)&&K)}var w=VC("ui",X,k,J,"button",i),F=!zC(o),x=this.computeButtonAriaRole(v);return t.createElement(Pn,{innerRef:this.ref},t.createElement(v,Fg({},f,{className:w,"aria-pressed":S?!!e:void 0,disabled:d&&"button"===v||void 0,onClick:this.handleClick,role:x,type:R,tabIndex:Y}),F&&o,!F&&Wn.create(b,{autoGenerateKey:!1}),!F&&s))},I}(t.Component);Gm.handledProps=["active","animated","as","attached","basic","children","circular","className","color","compact","content","disabled","floated","fluid","icon","inverted","label","labelPosition","loading","negative","onClick","positive","primary","role","secondary","size","tabIndex","toggle","type"],Gm.propTypes={},Gm.defaultProps={as:"button"},Gm.Content=um,Gm.Group=mm,Gm.Or=Zm,Gm.create=sl(Gm,(function(g){return{content:g}}));const pm=Gm;const Bm=function(g,I,e){"__proto__"==I&&hC?hC(g,I,{configurable:!0,enumerable:!0,value:e,writable:!0}):g[I]=e};var ym=Object.prototype.hasOwnProperty;const Wm=function(g,I,e){var t=g[I];ym.call(g,I)&&Ug(t,e)&&(void 0!==e||I in g)||Bm(g,I,e)};const Vm=function(g,I,e,t){if(!uI(g))return g;for(var C=-1,l=(I=Lt(I,g)).length,n=l-1,o=g;null!=o&&++C<l;){var a=Dt(I[C]),i=e;if("__proto__"===a||"constructor"===a||"prototype"===a)return g;if(C!=n){var A=o[a];void 0===(i=t?t(A,a,o):void 0)&&(i=uI(A)?A:He(I[C+1])?[]:{})}Wm(o,a,i),o=o[a]}return g};const Sm=function(g,I,e){return null==g?g:Vm(g,I,e)};var Rm=function(g){function I(){for(var I,e=arguments.length,C=new Array(e),l=0;l<e;l++)C[l]=arguments[l];return(I=g.call.apply(g,[this].concat(C))||this).inputRef=(0,t.createRef)(),I.labelRef=(0,t.createRef)(),I.canToggle=function(){var g=I.props,e=g.disabled,t=g.radio,C=g.readOnly,l=I.state.checked;return!e&&!C&&!(t&&l)},I.computeTabIndex=function(){var g=I.props,e=g.disabled,t=g.tabIndex;return Al(t)?e?-1:0:t},I.handleClick=function(g){var e=I.props.id,t=I.state,C=t.checked,l=t.indeterminate,n=yC(I.inputRef.current,"contains",g.target),o=yC(I.labelRef.current,"contains",g.target),a=!o&&!n,i=!Al(e);o&&i||yC(I.props,"onClick",g,Fg({},I.props,{checked:!C,indeterminate:!!l})),I.isClickFromMouse&&(I.isClickFromMouse=!1,o&&!i&&I.handleChange(g),a&&I.handleChange(g),o&&i&&g.stopPropagation())},I.handleChange=function(g){var e=I.state.checked;I.canToggle()&&(yC(I.props,"onChange",g,Fg({},I.props,{checked:!e,indeterminate:!1})),I.setState({checked:!e,indeterminate:!1}))},I.handleMouseDown=function(g){var e=I.state,t=e.checked,C=e.indeterminate;yC(I.props,"onMouseDown",g,Fg({},I.props,{checked:!!t,indeterminate:!!C})),g.defaultPrevented||yC(I.inputRef.current,"focus"),g.preventDefault()},I.handleMouseUp=function(g){var e=I.state,t=e.checked,C=e.indeterminate;I.isClickFromMouse=!0,yC(I.props,"onMouseUp",g,Fg({},I.props,{checked:!!t,indeterminate:!!C}))},I.setIndeterminate=function(){var g=I.state.indeterminate;Sm(I.inputRef,"current.indeterminate",!!g)},I}zg(I,g);var e=I.prototype;return e.componentDidMount=function(){this.setIndeterminate()},e.componentDidUpdate=function(){this.setIndeterminate()},e.render=function(){var g=this.props,e=g.className,C=g.disabled,l=g.label,n=g.id,o=g.name,a=g.radio,i=g.readOnly,A=g.slider,c=g.toggle,s=g.type,d=g.value,r=this.state,u=r.checked,b=r.indeterminate,m=VC("ui",XC(u,"checked"),XC(C,"disabled"),XC(b,"indeterminate"),XC(Al(l),"fitted"),XC(a,"radio"),XC(i,"read-only"),XC(A,"slider"),XC(c,"toggle"),"checkbox",e),h=NC(I,this.props),Z=KC(I,this.props),G=_o(h,{htmlProps:jo}),p=G[0],B=G[1],y=rl(l,{defaultProps:{htmlFor:n},autoGenerateKey:!1})||t.createElement("label",{htmlFor:n});return t.createElement(Z,Fg({},B,{className:m,onClick:this.handleClick,onChange:this.handleChange,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp}),t.createElement(Pn,{innerRef:this.inputRef},t.createElement("input",Fg({},p,{checked:u,className:"hidden",disabled:C,id:n,name:o,readOnly:!0,tabIndex:this.computeTabIndex(),type:s,value:d}))),t.createElement(Pn,{innerRef:this.labelRef},y))},I}(EC);function Xm(g){var I=g.slider,e=g.toggle,C=g.type,l=NC(Xm,g),n=!(I||e)||void 0;return t.createElement(Rm,Fg({},l,{type:C,radio:n,slider:I,toggle:e}))}Rm.handledProps=["as","checked","className","defaultChecked","defaultIndeterminate","disabled","fitted","id","indeterminate","label","name","onChange","onClick","onMouseDown","onMouseUp","radio","readOnly","slider","tabIndex","toggle","type","value"],Rm.propTypes={},Rm.defaultProps={type:"checkbox"},Rm.autoControlledProps=["checked","indeterminate"],Xm.handledProps=["slider","toggle","type"],Xm.propTypes={},Xm.defaultProps={type:"radio"};const Jm=Xm;function km(g){var I=g.children,e=g.className,C=g.content,l=g.control,n=g.disabled,o=g.error,a=g.inline,i=g.label,A=g.required,c=g.type,s=g.width,d=g.id,r=VC(XC(n,"disabled"),XC(o,"error"),XC(a,"inline"),XC(A,"required"),HC(s,"wide"),"field",e),u=NC(km,g),b=KC(km,g),m=jt(o,"pointing","above"),h=ea.create(o,{autoGenerateKey:!1,defaultProps:{prompt:!0,pointing:m,id:d?d+"-error-message":void 0,role:"alert","aria-atomic":!0}}),Z=("below"===m||"right"===m)&&h,G=("above"===m||"left"===m)&&h;if(Al(l))return Al(i)?t.createElement(b,Fg({},u,{className:r,id:d}),zC(I)?C:I):t.createElement(b,Fg({},u,{className:r,id:d}),Z,rl(i,{autoGenerateKey:!1}),G);var p={"aria-describedby":d&&o?d+"-error-message":null,"aria-invalid":!!o||void 0},B=Fg({},u,{content:C,children:I,disabled:n,required:A,type:c,id:d});return"input"!==l||"checkbox"!==c&&"radio"!==c?l===Rm||l===Jm?t.createElement(b,{className:r},Z,(0,t.createElement)(l,Fg({},p,B,{label:i})),G):t.createElement(b,{className:r},rl(i,{defaultProps:{htmlFor:d},autoGenerateKey:!1}),Z,(0,t.createElement)(l,Fg({},p,B)),G):t.createElement(b,{className:r},t.createElement("label",null,Z,(0,t.createElement)(l,Fg({},p,B))," ",i,G))}km.handledProps=["as","children","className","content","control","disabled","error","id","inline","label","required","type","width"],km.propTypes={};const fm=km;function vm(g){var I=g.control,e=NC(vm,g),C=KC(vm,g);return t.createElement(C,Fg({},e,{control:I}))}vm.handledProps=["as","control"],vm.propTypes={},vm.defaultProps={as:fm,control:pm};const Ym=vm;function Hm(g){var I=g.control,e=NC(Hm,g),C=KC(Hm,g);return t.createElement(C,Fg({},e,{control:I}))}Hm.handledProps=["as","control"],Hm.propTypes={},Hm.defaultProps={as:fm,control:Rm};const Nm=Hm;const Km=function(g){for(var I=-1,e=null==g?0:g.length,t=0,C=[];++I<e;){var l=g[I];l&&(C[t++]=l)}return C};const wm=function(g,I){for(var e=-1,t=null==g?0:g.length;++e<t;)if(!I(g[e],e,g))return!1;return!0};const Fm=function(g,I){var e=!0;return oC(g,(function(g,t,C){return e=!!I(g,t,C)})),e};const xm=function(g,I,e){var t=re(g)?wm:Fm;return e&&FC(g,I,e)&&(I=void 0),t(g,tC(I,3))};const zm=function(g,I,e,t){var C=-1,l=TC,n=!0,o=g.length,a=[],i=I.length;if(!o)return a;e&&(I=Mg(I,Fe(e))),t?(l=jC,n=!1):I.length>=200&&(l=le,n=!1,I=new te(I));g:for(;++C<o;){var A=g[C],c=null==e?A:e(A);if(A=t||0!==A?A:0,n&&c===c){for(var s=i;s--;)if(I[s]===c)continue g;a.push(A)}else l(I,c,t)||a.push(A)}return a};const Mm=function(g){return Be(g)&&$e(g)};var Em=BC((function(g,I){return Mm(g)?zm(g,I):[]}));const Um=Em;const Qm=function(g){return function(I,e,t){var C=Object(I);if(!$e(I)){var l=tC(e,3);I=gt(I),e=function(g){return l(C[g],g,C)}}var n=g(I,e,t);return n>-1?C[l?I[n]:n]:void 0}};var Lm=Math.max;const Dm=function(g,I,e){var t=null==g?0:g.length;if(!t)return-1;var C=null==e?0:zo(e);return C<0&&(C=Lm(t+C,0)),UC(g,tC(I,3),C)};const Tm=Qm(Dm);const jm=function(g,I,e){var t=null==g?0:g.length;return t?(I=e||void 0===I?1:zo(I),sC(g,0,(I=t-I)<0?0:I)):[]};var Pm=Object.prototype.hasOwnProperty;const Om=function(g){if(null==g)return!0;if($e(g)&&(re(g)||"string"==typeof g||"function"==typeof g.splice||ve(g)||Qe(g)||Re(g)))return!g.length;var I=Zt(g);if("[object Map]"==I||"[object Set]"==I)return!g.size;if(je(g))return!qe(g).length;for(var e in g)if(Pm.call(g,e))return!1;return!0};const _m=gC("length");var qm="\\ud800-\\udfff",$m="["+qm+"]",gh="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ih="\\ud83c[\\udffb-\\udfff]",eh="[^"+qm+"]",th="(?:\\ud83c[\\udde6-\\uddff]){2}",Ch="[\\ud800-\\udbff][\\udc00-\\udfff]",lh="(?:"+gh+"|"+Ih+")"+"?",nh="[\\ufe0e\\ufe0f]?",oh=nh+lh+("(?:\\u200d(?:"+[eh,th,Ch].join("|")+")"+nh+lh+")*"),ah="(?:"+[eh+gh+"?",gh,th,Ch,$m].join("|")+")",ih=RegExp(Ih+"(?="+Ih+")|"+ah+oh,"g");const Ah=function(g){for(var I=ih.lastIndex=0;ih.test(g);)++I;return I};const ch=function(g){return In(g)?Ah(g):_m(g)};const sh=function(g){if(null==g)return 0;if($e(g))return al(g)?ch(g):g.length;var I=Zt(g);return"[object Map]"==I||"[object Set]"==I?g.size:qe(g).length};var dh=lI?lI.isConcatSpreadable:void 0;const rh=function(g){return re(g)||Re(g)||!!(dh&&g&&g[dh])};const uh=function g(I,e,t,C,l){var n=-1,o=I.length;for(t||(t=rh),l||(l=[]);++n<o;){var a=I[n];e>0&&t(a)?e>1?g(a,e-1,t,C,l):de(l,a):C||(l[l.length]=a)}return l};var bh=BC((function(g,I){return Mm(g)?zm(g,uh(I,1,Mm,!0)):[]}));const mh=bh;const hh=BC((function(g){return qC(uh(g,1,Mm,!0))}));const Zh=function(g,I){return Vt(g,I)};const Gh=function(g,I,e){for(var t=-1,C=I.length,l={};++t<C;){var n=I[t],o=Tt(g,n);e(o,n)&&Vm(l,Lt(n,g),o)}return l};const ph=function(g,I){return Gh(g,I,(function(I,e){return _t(g,e)}))};const Bh=function(g){return(null==g?0:g.length)?uh(g,1):[]};const yh=function(g){return pC(bC(g,void 0,Bh),g+"")}((function(g,I){return null==g?{}:ph(g,I)}));var Wh=e(324),Vh=e.n(Wh),Sh=function(g){function I(){return g.apply(this,arguments)||this}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.className,C=g.name,l=VC(C,"flag",e),n=NC(I,this.props),o=KC(I,this.props);return t.createElement(o,Fg({},n,{className:l}))},I}(t.PureComponent);Sh.handledProps=["as","className","name"],Sh.propTypes={},Sh.defaultProps={as:"i"},Sh.create=sl(Sh,(function(g){return{name:g}}));const Rh=Sh;function Xh(g){var I=g.className,e=VC("divider",I),C=NC(Xh,g),l=KC(Xh,g);return t.createElement(l,Fg({},C,{className:e}))}Xh.handledProps=["as","className"],Xh.propTypes={};const Jh=Xh;var kh=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleClick=function(g){yC(I.props,"onClick",g,I.props)},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.active,C=g.children,l=g.className,n=g.content,o=g.disabled,a=g.description,i=g.flag,A=g.icon,c=g.image,s=g.label,d=g.selected,r=g.text,u=VC(XC(e,"active"),XC(o,"disabled"),XC(d,"selected"),"item",l),b=Al(A)?function(g,I){return xC(t.Children.toArray(g),{type:I})}(C,"DropdownMenu")&&"dropdown":A,m=NC(I,this.props),h=KC(I,this.props),Z={role:"option","aria-disabled":o,"aria-checked":e,"aria-selected":d};if(!zC(C))return t.createElement(h,Fg({},m,Z,{className:u,onClick:this.handleClick}),C);var G=Rh.create(i,{autoGenerateKey:!1}),p=Wn.create(b,{autoGenerateKey:!1}),B=na.create(c,{autoGenerateKey:!1}),y=ea.create(s,{autoGenerateKey:!1}),W=cl("span",(function(g){return{children:g}}),a,{defaultProps:{className:"description"},autoGenerateKey:!1}),V=cl("span",(function(g){return{children:g}}),zC(n)?r:n,{defaultProps:{className:"text"},autoGenerateKey:!1});return t.createElement(h,Fg({},m,Z,{className:u,onClick:this.handleClick}),B,p,G,y,W,V)},I}(t.Component);kh.handledProps=["active","as","children","className","content","description","disabled","flag","icon","image","label","onClick","selected","text","value"],kh.propTypes={},kh.create=sl(kh,(function(g){return g}));const fh=kh;function vh(g){var I=g.children,e=g.className,C=g.content,l=g.icon,n=VC("header",e),o=NC(vh,g),a=KC(vh,g);return zC(I)?t.createElement(a,Fg({},o,{className:n}),Wn.create(l,{autoGenerateKey:!1}),C):t.createElement(a,Fg({},o,{className:n}),I)}vh.handledProps=["as","children","className","content","icon"],vh.propTypes={},vh.create=sl(vh,(function(g){return{content:g}}));const Yh=vh;function Hh(g){var I=g.children,e=g.className,C=g.content,l=g.direction,n=g.open,o=g.scrolling,a=VC(l,XC(n,"visible"),XC(o,"scrolling"),"menu transition",e),i=NC(Hh,g),A=KC(Hh,g);return t.createElement(A,Fg({},i,{className:a}),zC(I)?C:I)}Hh.handledProps=["as","children","className","content","direction","open","scrolling"],Hh.propTypes={};const Nh=Hh;var Kh=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleChange=function(g){var e=jt(g,"target.value");yC(I.props,"onChange",g,Fg({},I.props,{value:e}))},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.autoComplete,C=g.className,l=g.tabIndex,n=g.type,o=g.value,a=VC("search",C),i=NC(I,this.props);return t.createElement("input",Fg({},i,{"aria-autocomplete":"list",autoComplete:e,className:a,onChange:this.handleChange,tabIndex:l,type:n,value:o}))},I}(t.Component);Kh.handledProps=["as","autoComplete","className","tabIndex","type","value"],Kh.propTypes={},Kh.defaultProps={autoComplete:"off",type:"text"},Kh.create=sl(Kh,(function(g){return{type:g}}));const wh=Kh;function Fh(g){var I=g.children,e=g.className,C=g.content,l=VC("divider",e),n=NC(Fh,g),o=KC(Fh,g);return t.createElement(o,Fg({"aria-atomic":!0,"aria-live":"polite",role:"alert"},n,{className:l}),zC(I)?C:I)}Fh.handledProps=["as","children","className","content"],Fh.propTypes={},Fh.create=sl(Fh,(function(g){return{content:g}}));const xh=Fh;var zh=/[\\^$.*+?()[\]{}|]/g,Mh=RegExp(zh.source);const Eh=function(g){return(g=Qt(g))&&Mh.test(g)?g.replace(zh,"\\$&"):g};const Uh=function(g,I){var e=[];return oC(g,(function(g,t,C){I(g,t,C)&&e.push(g)})),e};const Qh=function(g,I){return(re(g)?be:Uh)(g,tC(I,3))};function Lh(g){var I=g.additionLabel,e=g.additionPosition,C=g.allowAdditions,l=g.deburr,n=g.multiple,o=g.options,a=g.search,i=g.searchQuery,A=g.value,c=o;if(n&&(c=Qh(c,(function(g){return!Qo(A,g.value)}))),a&&i)if(bI(a))c=a(c,i);else{var s=l?Bl(i):i,d=new RegExp(Eh(s),"i");c=Qh(c,(function(g){return d.test(l?Bl(g.text):g.text)}))}if(C&&a&&i&&!xC(c,{text:i})){var r={key:"addition",text:[t.isValidElement(I)?t.cloneElement(I,{key:"addition-label"}):I||"",t.createElement("b",{key:"addition-query"},i)],value:i,className:"addition","data-additional":!0};"top"===e?c.unshift(r):c.push(r)}return c}Lh.handledProps=[];const Dh=function(g,I,e,t,C){return C(g,(function(g,C,l){e=t?(t=!1,g):I(e,g,C,l)})),e};const Th=function(g,I,e){var t=re(g)?hl:Dh,C=arguments.length<3;return t(g,tC(I,4),e,C,oC)};function jh(g){var I,e=g.additionLabel,t=g.additionPosition,C=g.allowAdditions,l=g.deburr,n=g.multiple,o=g.options,a=g.search,i=g.searchQuery,A=g.selectedIndex,c=g.value,s=Lh({value:c,options:o,searchQuery:i,additionLabel:e,additionPosition:t,allowAdditions:C,deburr:l,multiple:n,search:a}),d=Th(s,(function(g,I,e){return I.disabled||g.push(e),g}),[]);if(!A||A<0){var r=d[0];I=n?r:Dm(s,["value",c])||d[0]}else if(n)I=Tm(d,(function(g){return g>=A})),A>=s.length-1&&(I=d[d.length-1]);else{var u=Dm(s,["value",c]);I=Qo(d,u)?u:void 0}return(!I||I<0)&&(I=d[0]),I}var Ph=function(g,I){return Al(g)?I:g},Oh=function(g){return g?g.map((function(g){return yh(g,["key","value"])})):g};function _h(g){var I=g.flag,e=g.image,C=g.text;return bI(C)?C:{content:t.createElement(t.Fragment,null,Rh.create(I),na.create(e),C)}}var qh=function(g){function I(){for(var I,e=arguments.length,C=new Array(e),l=0;l<e;l++)C[l]=arguments[l];return(I=g.call.apply(g,[this].concat(C))||this).searchRef=(0,t.createRef)(),I.sizerRef=(0,t.createRef)(),I.ref=(0,t.createRef)(),I.handleChange=function(g,e){yC(I.props,"onChange",g,Fg({},I.props,{value:e}))},I.closeOnChange=function(g){var e=I.props,t=e.closeOnChange,C=e.multiple;(MC(t)?!C:t)&&I.close(g,PC)},I.closeOnEscape=function(g){I.props.closeOnEscape&&_n().getCode(g)===_n().Escape&&(g.preventDefault(),I.close(g))},I.moveSelectionOnKeyDown=function(g){var e,t=I.props,C=t.multiple,l=t.selectOnNavigation;if(I.state.open){var n=((e={})[_n().ArrowDown]=1,e[_n().ArrowUp]=-1,e)[_n().getCode(g)];if(void 0!==n){g.preventDefault();var o=I.getSelectedIndexAfterMove(n);!C&&l&&I.makeSelectedItemActive(g,o),I.setState({selectedIndex:o})}}},I.openOnSpace=function(g){var e,t,C,l=I.state.focus&&!I.state.open&&_n().getCode(g)===_n().Spacebar,n="INPUT"!==(null==(e=g.target)?void 0:e.tagName)&&"TEXTAREA"!==(null==(t=g.target)?void 0:t.tagName)&&!0!==(null==(C=g.target)?void 0:C.isContentEditable);l&&(n&&g.preventDefault(),I.open(g))},I.openOnArrow=function(g){var e=I.state,t=e.focus,C=e.open;if(t&&!C){var l=_n().getCode(g);l!==_n().ArrowDown&&l!==_n().ArrowUp||(g.preventDefault(),I.open(g))}},I.makeSelectedItemActive=function(g,e){var t=I.state,C=t.open,l=t.value,n=I.props.multiple,o=I.getSelectedItem(e),a=jt(o,"value"),i=jt(o,"disabled");if(Al(a)||!C||i)return l;var A=n?hh(l,[a]):a;return(n?!!mh(A,l).length:A!==l)&&(I.setState({value:A}),I.handleChange(g,A),o["data-additional"]&&yC(I.props,"onAddItem",g,Fg({},I.props,{value:a}))),l},I.selectItemOnEnter=function(g){var e=I.props.search,t=I.state,C=t.open,l=t.selectedIndex;if(C&&(_n().getCode(g)===_n().Enter||!e&&_n().getCode(g)===_n().Spacebar)){g.preventDefault();var n=sh(Lh({value:I.state.value,options:I.props.options,searchQuery:I.state.searchQuery,additionLabel:I.props.additionLabel,additionPosition:I.props.additionPosition,allowAdditions:I.props.allowAdditions,deburr:I.props.deburr,multiple:I.props.multiple,search:I.props.search}));if(!e||0!==n){var o=I.makeSelectedItemActive(g,l);I.setState({selectedIndex:jh({additionLabel:I.props.additionLabel,additionPosition:I.props.additionPosition,allowAdditions:I.props.allowAdditions,deburr:I.props.deburr,multiple:I.props.multiple,search:I.props.search,selectedIndex:l,value:o,options:I.props.options,searchQuery:""})}),I.closeOnChange(g),I.clearSearchQuery(),e&&yC(I.searchRef.current,"focus")}}},I.removeItemOnBackspace=function(g){var e=I.props,t=e.multiple,C=e.search,l=I.state,n=l.searchQuery,o=l.value;if(_n().getCode(g)===_n().Backspace&&!n&&C&&t&&!Om(o)){g.preventDefault();var a=jm(o);I.setState({value:a}),I.handleChange(g,a)}},I.closeOnDocumentClick=function(g){I.props.closeOnBlur&&(I.ref.current&&uo(I.ref.current,g)||I.close())},I.handleMouseDown=function(g){I.isMouseDown=!0,yC(I.props,"onMouseDown",g,I.props),document.addEventListener("mouseup",I.handleDocumentMouseUp)},I.handleDocumentMouseUp=function(){I.isMouseDown=!1,document.removeEventListener("mouseup",I.handleDocumentMouseUp)},I.handleClick=function(g){var e=I.props,t=e.minCharacters,C=e.search,l=I.state,n=l.open,o=l.searchQuery;if(yC(I.props,"onClick",g,I.props),g.stopPropagation(),!C)return I.toggle(g);n?yC(I.searchRef.current,"focus"):o.length>=t||1===t?I.open(g):yC(I.searchRef.current,"focus")},I.handleIconClick=function(g){var e=I.props.clearable,t=I.hasValue();yC(I.props,"onClick",g,I.props),g.stopPropagation(),e&&t?I.clearValue(g):I.toggle(g)},I.handleItemClick=function(g,e){var t=I.props,C=t.multiple,l=t.search,n=I.state.value,o=e.value;if(g.stopPropagation(),(C||e.disabled)&&g.nativeEvent.stopImmediatePropagation(),!e.disabled){var a=e["data-additional"],i=C?hh(I.state.value,[o]):o;(C?!!mh(i,n).length:i!==n)&&(I.setState({value:i}),I.handleChange(g,i)),I.clearSearchQuery(),yC(l?I.searchRef.current:I.ref.current,"focus"),I.closeOnChange(g),a&&yC(I.props,"onAddItem",g,Fg({},I.props,{value:o}))}},I.handleFocus=function(g){I.state.focus||(yC(I.props,"onFocus",g,I.props),I.setState({focus:!0}))},I.handleBlur=function(g){var e=jt(g,"currentTarget");if(!e||!e.contains(document.activeElement)){var t=I.props,C=t.closeOnBlur,l=t.multiple,n=t.selectOnBlur;I.isMouseDown||(yC(I.props,"onBlur",g,I.props),n&&!l&&(I.makeSelectedItemActive(g,I.state.selectedIndex),C&&I.close()),I.setState({focus:!1}),I.clearSearchQuery())}},I.handleSearchChange=function(g,e){var t=e.value;g.stopPropagation();var C=I.props.minCharacters,l=I.state.open,n=t;yC(I.props,"onSearchChange",g,Fg({},I.props,{searchQuery:n})),I.setState({searchQuery:n,selectedIndex:0}),!l&&n.length>=C?I.open():l&&1!==C&&n.length<C&&I.close()},I.handleKeyDown=function(g){I.moveSelectionOnKeyDown(g),I.openOnArrow(g),I.openOnSpace(g),I.selectItemOnEnter(g),yC(I.props,"onKeyDown",g)},I.getSelectedItem=function(g){var e=Lh({value:I.state.value,options:I.props.options,searchQuery:I.state.searchQuery,additionLabel:I.props.additionLabel,additionPosition:I.props.additionPosition,allowAdditions:I.props.allowAdditions,deburr:I.props.deburr,multiple:I.props.multiple,search:I.props.search});return jt(e,"["+g+"]")},I.getItemByValue=function(g){var e=I.props.options;return Tm(e,{value:g})},I.getDropdownAriaOptions=function(){var g=I.props,e=g.loading,t=g.disabled,C=g.search,l=g.multiple,n={role:C?"combobox":"listbox","aria-busy":e,"aria-disabled":t,"aria-expanded":!!I.state.open};return"listbox"===n.role&&(n["aria-multiselectable"]=l),n},I.clearSearchQuery=function(){var g=I.state.searchQuery;void 0!==g&&""!==g&&I.setState({searchQuery:""})},I.handleLabelClick=function(g,e){g.stopPropagation(),I.setState({selectedLabel:e.value}),yC(I.props,"onLabelClick",g,e)},I.handleLabelRemove=function(g,e){g.stopPropagation();var t=I.state.value,C=Um(t,e.value);I.setState({value:C}),I.handleChange(g,C)},I.getSelectedIndexAfterMove=function(g,e){void 0===e&&(e=I.state.selectedIndex);var t=Lh({value:I.state.value,options:I.props.options,searchQuery:I.state.searchQuery,additionLabel:I.props.additionLabel,additionPosition:I.props.additionPosition,allowAdditions:I.props.allowAdditions,deburr:I.props.deburr,multiple:I.props.multiple,search:I.props.search});if(void 0!==t&&!xm(t,"disabled")){var C=t.length-1,l=e+g;return!I.props.wrapSelection&&(l>C||l<0)?l=e:l>C?l=0:l<0&&(l=C),t[l].disabled?I.getSelectedIndexAfterMove(g,l):l}},I.handleIconOverrides=function(g){var e=I.props.clearable;return{className:VC(e&&I.hasValue()&&"clear",g.className),onClick:function(e){yC(g,"onClick",e,g),I.handleIconClick(e)}}},I.clearValue=function(g){var e=I.props.multiple?[]:"";I.setState({value:e}),I.handleChange(g,e)},I.computeSearchInputTabIndex=function(){var g=I.props,e=g.disabled,t=g.tabIndex;return Al(t)?e?-1:0:t},I.computeSearchInputWidth=function(){var g=I.state.searchQuery;if(I.sizerRef.current&&g){I.sizerRef.current.style.display="inline",I.sizerRef.current.textContent=g;var e=Math.ceil(I.sizerRef.current.getBoundingClientRect().width);return I.sizerRef.current.style.removeProperty("display"),e}},I.computeTabIndex=function(){var g=I.props,e=g.disabled,t=g.search,C=g.tabIndex;if(!t)return e?-1:Al(C)?0:C},I.handleSearchInputOverrides=function(g){return{onChange:function(e,t){yC(g,"onChange",e,t),I.handleSearchChange(e,t)}}},I.hasValue=function(){var g=I.props.multiple,e=I.state.value;return g?!Om(e):!Al(e)&&""!==e},I.scrollSelectedItemIntoView=function(){if(I.ref.current){var g=I.ref.current.querySelector(".menu.visible");if(g){var e=g.querySelector(".item.selected");if(e){var t=e.offsetTop<g.scrollTop,C=e.offsetTop+e.clientHeight>g.scrollTop+g.clientHeight;t?g.scrollTop=e.offsetTop:C&&(g.scrollTop=e.offsetTop+e.clientHeight-g.clientHeight)}}}},I.setOpenDirection=function(){if(I.ref.current){var g=I.ref.current.querySelector(".menu.visible");if(g){var e=I.ref.current.getBoundingClientRect(),t=g.clientHeight,C=document.documentElement.clientHeight-e.top-e.height-t,l=e.top-t,n=C<0&&l>C;!n!==!I.state.upward&&I.setState({upward:n})}}},I.open=function(g,e){void 0===g&&(g=null),void 0===e&&(e=!0);var t=I.props,C=t.disabled,l=t.search;C||(l&&yC(I.searchRef.current,"focus"),yC(I.props,"onOpen",g,I.props),e&&I.setState({open:!0}),I.scrollSelectedItemIntoView())},I.close=function(g,e){void 0===e&&(e=I.handleClose),I.state.open&&(yC(I.props,"onClose",g,I.props),I.setState({open:!1},e))},I.handleClose=function(){var g=document.activeElement===I.searchRef.current;!g&&I.ref.current&&I.ref.current.blur();var e=document.activeElement===I.ref.current,t=g||e;I.setState({focus:t})},I.toggle=function(g){return I.state.open?I.close(g):I.open(g)},I.renderText=function(){var g,e=I.props,t=e.multiple,C=e.placeholder,l=e.search,n=e.text,o=I.state,a=o.searchQuery,i=o.selectedIndex,A=o.value,c=o.open,s=I.hasValue(),d=VC(C&&!s&&"default","text",l&&a&&"filtered"),r=C;return n?r=n:c&&!t?g=I.getSelectedItem(i):s&&(g=I.getItemByValue(A)),xh.create(g?_h(g):r,{defaultProps:{className:d}})},I.renderSearchInput=function(){var g=I.props,e=g.search,C=g.searchInput,l=I.state.searchQuery;return e&&t.createElement(Pn,{innerRef:I.searchRef},wh.create(C,{defaultProps:{style:{width:I.computeSearchInputWidth()},tabIndex:I.computeSearchInputTabIndex(),value:l},overrideProps:I.handleSearchInputOverrides}))},I.renderSearchSizer=function(){var g=I.props,e=g.search,C=g.multiple;return e&&C&&t.createElement("span",{className:"sizer",ref:I.sizerRef})},I.renderLabels=function(){var g=I.props,e=g.multiple,t=g.renderLabel,C=I.state,l=C.selectedLabel,n=C.value;if(e&&!Om(n)){var o=iC(n,I.getItemByValue);return iC(Km(o),(function(g,e){var C={active:g.value===l,as:"a",key:Ph(g.key,g.value),onClick:I.handleLabelClick,onRemove:I.handleLabelRemove,value:g.value};return ea.create(t(g,e,C),{defaultProps:C})}))}},I.renderOptions=function(){var g=I.props,e=g.lazyLoad,C=g.multiple,l=g.search,n=g.noResultsMessage,o=I.state,a=o.open,i=o.selectedIndex,A=o.value;if(e&&!a)return null;var c=Lh({value:I.state.value,options:I.props.options,searchQuery:I.state.searchQuery,additionLabel:I.props.additionLabel,additionPosition:I.props.additionPosition,allowAdditions:I.props.allowAdditions,deburr:I.props.deburr,multiple:I.props.multiple,search:I.props.search});if(null!==n&&l&&Om(c))return t.createElement("div",{className:"message"},n);var s=C?function(g){return Qo(A,g)}:function(g){return g===A};return iC(c,(function(g,e){return fh.create(Fg({active:s(g.value),selected:i===e},g,{key:Ph(g.key,g.value),style:Fg({},g.style,{pointerEvents:"all"})}),{generateKey:!1,overrideProps:function(g){return{onClick:function(e,t){null==g.onClick||g.onClick(e,t),I.handleItemClick(e,t)}}}})}))},I.renderMenu=function(){var g=I.props,e=g.children,C=g.direction,l=g.header,n=I.state.open,o=I.getDropdownMenuAriaOptions();if(!zC(e)){var a=t.Children.only(e),i=VC(C,XC(n,"visible"),a.props.className);return(0,t.cloneElement)(a,Fg({className:i},o))}return t.createElement(Nh,Fg({},o,{direction:C,open:n}),Yh.create(l,{autoGenerateKey:!1}),I.renderOptions())},I}zg(I,g);var e=I.prototype;return e.getInitialAutoControlledState=function(){return{focus:!1,searchQuery:""}},I.getAutoControlledStateFromProps=function(g,I,e){var t={__options:g.options,__value:I.value};return(!Vh()(e.__value,I.value)||!Zh(Oh(g.options),Oh(e.__options)))&&(t.selectedIndex=jh({additionLabel:g.additionLabel,additionPosition:g.additionPosition,allowAdditions:g.allowAdditions,deburr:g.deburr,multiple:g.multiple,search:g.search,selectedIndex:I.selectedIndex,value:I.value,options:g.options,searchQuery:I.searchQuery})),t},e.componentDidMount=function(){this.state.open&&this.open(null,!1)},e.shouldComponentUpdate=function(g,I){return!Vh()(g,this.props)||!Vh()(I,this.state)},e.componentDidUpdate=function(g,I){var e=this.props,t=e.closeOnBlur,C=e.minCharacters,l=e.openOnFocus,n=e.search;if(!I.focus&&this.state.focus){if(!this.isMouseDown){var o=!n||n&&1===C&&!this.state.open;l&&o&&this.open()}}else I.focus&&!this.state.focus&&!this.isMouseDown&&t&&this.close();!I.open&&this.state.open?(this.setOpenDirection(),this.scrollSelectedItemIntoView()):I.open&&this.state.open,I.selectedIndex!==this.state.selectedIndex&&this.scrollSelectedItemIntoView()},e.getDropdownMenuAriaOptions=function(){var g=this.props,I=g.search,e=g.multiple,t={};return I&&(t["aria-multiselectable"]=e,t.role="listbox"),t},e.render=function(){var g=this.props,e=g.basic,C=g.button,l=g.className,n=g.compact,o=g.disabled,a=g.error,i=g.fluid,A=g.floating,c=g.icon,s=g.inline,d=g.item,r=g.labeled,u=g.loading,b=g.multiple,m=g.pointing,h=g.search,Z=g.selection,G=g.scrolling,p=g.simple,B=g.trigger,y=this.state,W=y.focus,V=y.open,S=y.upward,R=VC("ui",XC(V,"active visible"),XC(o,"disabled"),XC(a,"error"),XC(u,"loading"),XC(e,"basic"),XC(C,"button"),XC(n,"compact"),XC(i,"fluid"),XC(A,"floating"),XC(s,"inline"),XC(r,"labeled"),XC(d,"item"),XC(b,"multiple"),XC(h,"search"),XC(Z,"selection"),XC(p,"simple"),XC(G,"scrolling"),XC(S,"upward"),kC(m,"pointing"),"dropdown",l),X=NC(I,this.props),J=KC(I,this.props),k=this.getDropdownAriaOptions(J,this.props);return t.createElement(Pn,{innerRef:this.ref},t.createElement(J,Fg({},X,k,{className:R,onBlur:this.handleBlur,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onChange:this.handleChange,tabIndex:this.computeTabIndex()}),this.renderLabels(),this.renderSearchInput(),this.renderSearchSizer(),B||this.renderText(),Wn.create(c,{overrideProps:this.handleIconOverrides,autoGenerateKey:!1}),this.renderMenu(),V&&t.createElement(Un(),{name:"keydown",on:this.closeOnEscape}),V&&t.createElement(Un(),{name:"click",on:this.closeOnDocumentClick}),W&&t.createElement(Un(),{name:"keydown",on:this.removeItemOnBackspace})))},I}(EC);function $h(g){var I=g.control,e=NC($h,g),C=KC($h,g);return t.createElement(C,Fg({},e,{control:I}))}qh.handledProps=["additionLabel","additionPosition","allowAdditions","as","basic","button","children","className","clearable","closeOnBlur","closeOnChange","closeOnEscape","compact","deburr","defaultOpen","defaultSearchQuery","defaultSelectedLabel","defaultUpward","defaultValue","direction","disabled","error","floating","fluid","header","icon","inline","item","labeled","lazyLoad","loading","minCharacters","multiple","noResultsMessage","onAddItem","onBlur","onChange","onClick","onClose","onFocus","onLabelClick","onMouseDown","onOpen","onSearchChange","open","openOnFocus","options","placeholder","pointing","renderLabel","scrolling","search","searchInput","searchQuery","selectOnBlur","selectOnNavigation","selectedLabel","selection","simple","tabIndex","text","trigger","upward","value","wrapSelection"],qh.propTypes={},qh.defaultProps={additionLabel:"Add ",additionPosition:"top",closeOnBlur:!0,closeOnEscape:!0,deburr:!1,icon:"dropdown",minCharacters:1,noResultsMessage:"No results found.",openOnFocus:!0,renderLabel:_h,searchInput:"text",selectOnBlur:!0,selectOnNavigation:!0,wrapSelection:!0},qh.autoControlledProps=["open","searchQuery","selectedLabel","value","upward"],qh.Divider=Jh,qh.Header=Yh,qh.Item=fh,qh.Menu=Nh,qh.SearchInput=wh,qh.Text=xh,$h.handledProps=["as","control"],$h.propTypes={},$h.defaultProps={as:fm,control:qh};const gZ=$h;function IZ(g){var I=g.children,e=g.className,C=g.grouped,l=g.inline,n=g.unstackable,o=g.widths,a=VC(XC(C,"grouped"),XC(l,"inline"),XC(n,"unstackable"),HC(o,null,!0),"fields",e),i=NC(IZ,g),A=KC(IZ,g);return t.createElement(A,Fg({},i,{className:a}),I)}IZ.handledProps=["as","children","className","grouped","inline","unstackable","widths"],IZ.propTypes={};const eZ=IZ;var tZ=function(g){function I(){for(var e,C=arguments.length,l=new Array(C),n=0;n<C;n++)l[n]=arguments[n];return(e=g.call.apply(g,[this].concat(l))||this).inputRef=(0,t.createRef)(),e.computeIcon=function(){var g=e.props,I=g.loading,t=g.icon;return Al(t)?I?"spinner":void 0:t},e.computeTabIndex=function(){var g=e.props,I=g.disabled,t=g.tabIndex;return Al(t)?I?-1:void 0:t},e.focus=function(g){return e.inputRef.current.focus(g)},e.select=function(){return e.inputRef.current.select()},e.handleChange=function(g){var I=jt(g,"target.value");yC(e.props,"onChange",g,Fg({},e.props,{value:I}))},e.handleChildOverrides=function(g,I){return Fg({},I,g.props,{ref:function(I){Qn(g.ref,I),e.inputRef.current=I}})},e.partitionProps=function(){var g=e.props,t=g.disabled,C=g.type,l=e.computeTabIndex(),n=NC(I,e.props),o=_o(n),a=o[0],i=o[1];return[Fg({},a,{disabled:t,type:C,tabIndex:l,onChange:e.handleChange,ref:e.inputRef}),i]},e}return zg(I,g),I.prototype.render=function(){var g=this,e=this.props,C=e.action,l=e.actionPosition,n=e.children,o=e.className,a=e.disabled,i=e.error,A=e.fluid,c=e.focus,s=e.icon,d=e.iconPosition,r=e.input,u=e.inverted,b=e.label,m=e.labelPosition,h=e.loading,Z=e.size,G=e.transparent,p=e.type,B=VC("ui",Z,XC(a,"disabled"),XC(i,"error"),XC(A,"fluid"),XC(c,"focus"),XC(u,"inverted"),XC(h,"loading"),XC(G,"transparent"),JC(l,"action")||XC(C,"action"),JC(d,"icon")||XC(s||h,"icon"),JC(m,"labeled")||XC(b,"labeled"),"input",o),y=KC(I,this.props),W=this.partitionProps(),V=W[0],S=W[1];if(!zC(n)){var R=iC(t.Children.toArray(n),(function(I){return"input"!==I.type?I:(0,t.cloneElement)(I,g.handleChildOverrides(I,V))}));return t.createElement(y,Fg({},S,{className:B}),R)}var X=pm.create(C,{autoGenerateKey:!1}),J=ea.create(b,{defaultProps:{className:VC("label",Qo(m,"corner")&&m)},autoGenerateKey:!1});return t.createElement(y,Fg({},S,{className:B}),"left"===l&&X,"right"!==m&&J,dl(r||p,{defaultProps:V,autoGenerateKey:!1}),Wn.create(this.computeIcon(),{autoGenerateKey:!1}),"left"!==l&&X,"right"===m&&J)},I}(t.Component);tZ.handledProps=["action","actionPosition","as","children","className","disabled","error","fluid","focus","icon","iconPosition","input","inverted","label","labelPosition","loading","onChange","size","tabIndex","transparent","type"],tZ.propTypes={},tZ.defaultProps={type:"text"},tZ.create=sl(tZ,(function(g){return{type:g}}));const CZ=tZ;function lZ(g){var I=g.control,e=NC(lZ,g),C=KC(lZ,g);return t.createElement(C,Fg({},e,{control:I}))}lZ.handledProps=["as","control"],lZ.propTypes={},lZ.defaultProps={as:fm,control:CZ};const nZ=lZ;function oZ(g){var I=g.control,e=NC(oZ,g),C=KC(oZ,g);return t.createElement(C,Fg({},e,{control:I}))}oZ.handledProps=["as","control"],oZ.propTypes={},oZ.defaultProps={as:fm,control:Jm};const aZ=oZ;function iZ(g){return t.createElement(qh,Fg({},g,{selection:!0}))}iZ.handledProps=["options"],iZ.propTypes={},iZ.Divider=qh.Divider,iZ.Header=qh.Header,iZ.Item=qh.Item,iZ.Menu=qh.Menu;const AZ=iZ;function cZ(g){var I=g.control,e=g.options,C=NC(cZ,g),l=KC(cZ,g);return t.createElement(l,Fg({},C,{control:I,options:e}))}cZ.handledProps=["as","control","options"],cZ.propTypes={},cZ.defaultProps={as:fm,control:AZ};const sZ=cZ;var dZ=function(g){function I(){for(var I,e=arguments.length,C=new Array(e),l=0;l<e;l++)C[l]=arguments[l];return(I=g.call.apply(g,[this].concat(C))||this).ref=(0,t.createRef)(),I.focus=function(){return I.ref.current.focus()},I.handleChange=function(g){var e=jt(g,"target.value");yC(I.props,"onChange",g,Fg({},I.props,{value:e}))},I.handleInput=function(g){var e=jt(g,"target.value");yC(I.props,"onInput",g,Fg({},I.props,{value:e}))},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.rows,C=g.value,l=NC(I,this.props),n=KC(I,this.props);return t.createElement(Pn,{innerRef:this.ref},t.createElement(n,Fg({},l,{onChange:this.handleChange,onInput:this.handleInput,rows:e,value:C})))},I}(t.Component);dZ.handledProps=["as","onChange","onInput","rows","value"],dZ.propTypes={},dZ.defaultProps={as:"textarea",rows:3};const rZ=dZ;function uZ(g){var I=g.control,e=NC(uZ,g),C=KC(uZ,g);return t.createElement(C,Fg({},e,{control:I}))}uZ.handledProps=["as","control"],uZ.propTypes={},uZ.defaultProps={as:fm,control:rZ};const bZ=uZ;var mZ=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleSubmit=function(g){"string"!==typeof I.props.action&&yC(g,"preventDefault");for(var e=arguments.length,t=new Array(e>1?e-1:0),C=1;C<e;C++)t[C-1]=arguments[C];yC.apply(void 0,[I.props,"onSubmit",g,I.props].concat(t))},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.action,C=g.children,l=g.className,n=g.error,o=g.inverted,a=g.loading,i=g.reply,A=g.size,c=g.success,s=g.unstackable,d=g.warning,r=g.widths,u=VC("ui",A,XC(n,"error"),XC(o,"inverted"),XC(a,"loading"),XC(i,"reply"),XC(c,"success"),XC(s,"unstackable"),XC(d,"warning"),HC(r,null,!0),"form",l),b=NC(I,this.props),m=KC(I,this.props);return t.createElement(m,Fg({},b,{action:e,className:u,onSubmit:this.handleSubmit}),C)},I}(t.Component);mZ.handledProps=["action","as","children","className","error","inverted","loading","onSubmit","reply","size","success","unstackable","warning","widths"],mZ.propTypes={},mZ.defaultProps={as:"form"},mZ.Field=fm,mZ.Button=Ym,mZ.Checkbox=Nm,mZ.Dropdown=gZ,mZ.Group=eZ,mZ.Input=nZ,mZ.Radio=aZ,mZ.Select=sZ,mZ.TextArea=bZ;const hZ=mZ;function ZZ(g){var I=g.children,e=g.className,C=g.content,l=VC("content",e),n=NC(ZZ,g),o=KC(ZZ,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}ZZ.handledProps=["as","children","className","content"],ZZ.propTypes={};const GZ=ZZ;function pZ(g){var I=g.children,e=g.className,C=g.content,l=VC("header",e),n=NC(pZ,g),o=KC(pZ,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}pZ.handledProps=["as","children","className","content"],pZ.propTypes={},pZ.create=sl(pZ,(function(g){return{content:g}}));const BZ=pZ;function yZ(g){var I=g.children,e=g.className,C=g.content,l=VC("content",e),n=NC(yZ,g),o=KC(yZ,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}yZ.handledProps=["as","children","className","content"],yZ.propTypes={},yZ.defaultProps={as:"li"},yZ.create=sl(yZ,(function(g){return{content:g}}));const WZ=yZ;function VZ(g){var I=g.children,e=g.className,C=g.items,l=VC("list",e),n=NC(VZ,g),o=KC(VZ,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?iC(C,WZ.create):I)}VZ.handledProps=["as","children","className","items"],VZ.propTypes={},VZ.defaultProps={as:"ul"},VZ.create=sl(VZ,(function(g){return{items:g}}));const SZ=VZ;var RZ=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleDismiss=function(g){var e=I.props.onDismiss;e&&e(g,I.props)},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.attached,C=g.children,l=g.className,n=g.color,o=g.compact,a=g.content,i=g.error,A=g.floating,c=g.header,s=g.hidden,d=g.icon,r=g.info,u=g.list,b=g.negative,m=g.onDismiss,h=g.positive,Z=g.size,G=g.success,p=g.visible,B=g.warning,y=VC("ui",n,Z,XC(o,"compact"),XC(i,"error"),XC(A,"floating"),XC(s,"hidden"),XC(d,"icon"),XC(r,"info"),XC(b,"negative"),XC(h,"positive"),XC(G,"success"),XC(p,"visible"),XC(B,"warning"),kC(e,"attached"),"message",l),W=m&&t.createElement(Wn,{name:"close",onClick:this.handleDismiss}),V=NC(I,this.props),S=KC(I,this.props);return zC(C)?t.createElement(S,Fg({},V,{className:y}),W,Wn.create(d,{autoGenerateKey:!1}),(!Al(c)||!Al(a)||!Al(u))&&t.createElement(GZ,null,BZ.create(c,{autoGenerateKey:!1}),SZ.create(u,{autoGenerateKey:!1}),ul(a,{autoGenerateKey:!1}))):t.createElement(S,Fg({},V,{className:y}),W,C)},I}(t.Component);RZ.handledProps=["as","attached","children","className","color","compact","content","error","floating","header","hidden","icon","info","list","negative","onDismiss","positive","size","success","visible","warning"],RZ.propTypes={},RZ.Content=GZ,RZ.Header=BZ,RZ.List=SZ,RZ.Item=WZ;const XZ=function(){const g=Kg(),I=g.userIsAuthenticated(),[e,C]=(0,t.useState)(""),[l,n]=(0,t.useState)(""),[o,a]=(0,t.useState)(!1),i=(g,I)=>{let{name:e,value:t}=I;"username"===e?C(t):"password"===e&&n(t)};return I?(0,Yg.jsx)(rg,{to:"/"}):(0,Yg.jsxs)(fn,{children:[(0,Yg.jsx)(fo,{textAlign:"center",children:(0,Yg.jsxs)(fo.Column,{style:{maxWidth:450,marginTop:"2em"},children:[(0,Yg.jsx)(hZ,{size:"large",onSubmit:async I=>{if(I.preventDefault(),e&&l)try{const I=await tm.authenticate(e,l),{accessToken:t}=I.data,o={data:Im(t),accessToken:t};g.userLogin(o),C(""),n(""),a(!1)}catch(t){em(t),a(!0)}else a(!0)},children:(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(hZ.Input,{fluid:!0,autoFocus:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",value:e,onChange:i}),(0,Yg.jsx)(hZ.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:l,onChange:i}),(0,Yg.jsx)(pm,{color:"violet",fluid:!0,size:"large",children:"Login"})]})}),(0,Yg.jsxs)(RZ,{children:["Don't have already an account? ",(0,Yg.jsx)(Jg,{to:"/signup",color:"violet",as:Jg,children:"Sign Up"})]}),o&&(0,Yg.jsx)(RZ,{negative:!0,children:"The username or password provided are incorrect!"})]})}),(0,Yg.jsx)(sm,{})]})};const JZ=function(){const g=Kg(),I=g.userIsAuthenticated(),[e,C]=(0,t.useState)(""),[l,n]=(0,t.useState)(""),[o,a]=(0,t.useState)(""),[i,A]=(0,t.useState)(""),[c,s]=(0,t.useState)(!1),[d,r]=(0,t.useState)(""),u=(g,I)=>{let{name:e,value:t}=I;"username"===e?C(t):"password"===e?n(t):"name"===e?a(t):"email"===e&&A(t)};return I?(0,Yg.jsx)(rg,{to:"/"}):(0,Yg.jsx)(fo,{textAlign:"center",children:(0,Yg.jsxs)(fo.Column,{style:{maxWidth:450},children:[(0,Yg.jsx)(hZ,{size:"large",onSubmit:async I=>{if(I.preventDefault(),!(e&&l&&o&&i))return s(!0),void r("Please, inform all fields!");const t={username:e,password:l,name:o,email:i};try{const I=await tm.signup(t),{accessToken:e}=I.data,l={data:Im(e),accessToken:e};g.userLogin(l),C(""),n(""),a(""),A(""),s(!1),r("")}catch(c){if(em(c),c.response&&c.response.data){const g=c.response.data;let I="Invalid fields";409===g.status?I=g.message:400===g.status&&(I=g.errors[0].defaultMessage),s(!0),r(I)}}},children:(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(hZ.Input,{fluid:!0,autoFocus:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",value:e,onChange:u}),(0,Yg.jsx)(hZ.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:l,onChange:u}),(0,Yg.jsx)(hZ.Input,{fluid:!0,name:"name",icon:"address card",iconPosition:"left",placeholder:"Name",value:o,onChange:u}),(0,Yg.jsx)(hZ.Input,{fluid:!0,name:"email",icon:"at",iconPosition:"left",placeholder:"Email",value:i,onChange:u}),(0,Yg.jsx)(pm,{color:"violet",fluid:!0,size:"large",children:"Signup"})]})}),(0,Yg.jsxs)(RZ,{children:["Already have an account? ",(0,Yg.jsx)(Jg,{to:"/login",color:"violet",as:Jg,children:"Login"})]}),c&&(0,Yg.jsx)(RZ,{negative:!0,children:d})]})})};function kZ(g){var I=g.children,e=g.className,C=g.content,l=VC(e,"description"),n=NC(kZ,g),o=KC(kZ,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}kZ.handledProps=["as","children","className","content"],kZ.propTypes={},kZ.create=sl(kZ,(function(g){return{content:g}}));const fZ=kZ;function vZ(g){var I=g.children,e=g.className,C=g.content,l=VC("header",e),n=NC(vZ,g),o=KC(vZ,g);return t.createElement(o,Fg({},n,{className:l}),zC(I)?C:I)}vZ.handledProps=["as","children","className","content"],vZ.propTypes={},vZ.create=sl(vZ,(function(g){return{content:g}}));const YZ=vZ;function HZ(g){var I=g.children,e=g.className,C=g.content,l=g.description,n=g.floated,o=g.header,a=g.verticalAlign,i=VC(JC(n,"floated"),YC(a),"content",e),A=NC(HZ,g),c=KC(HZ,g);return zC(I)?t.createElement(c,Fg({},A,{className:i}),YZ.create(o),fZ.create(l),C):t.createElement(c,Fg({},A,{className:i}),I)}HZ.handledProps=["as","children","className","content","description","floated","header","verticalAlign"],HZ.propTypes={},HZ.create=sl(HZ,(function(g){return{content:g}}));const NZ=HZ;function KZ(g){var I=g.className,e=g.verticalAlign,C=VC(YC(e),I),l=NC(KZ,g);return t.createElement(Wn,Fg({},l,{className:C}))}KZ.handledProps=["className","verticalAlign"],KZ.propTypes={},KZ.create=sl(KZ,(function(g){return{name:g}}));const wZ=KZ;var FZ=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleClick=function(g){I.props.disabled||yC(I.props,"onClick",g,I.props)},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.active,C=g.children,l=g.className,n=g.content,o=g.description,a=g.disabled,i=g.header,A=g.icon,c=g.image,s=g.value,d=KC(I,this.props),r=VC(XC(e,"active"),XC(a,"disabled"),XC("li"!==d,"item"),l),u=NC(I,this.props),b="li"===d?{value:s}:{"data-value":s};if(!zC(C))return t.createElement(d,Fg({},b,{role:"listitem",className:r,onClick:this.handleClick},u),C);var m=wZ.create(A,{autoGenerateKey:!1}),h=na.create(c,{autoGenerateKey:!1});if(!(0,t.isValidElement)(n)&&nl(n))return t.createElement(d,Fg({},b,{role:"listitem",className:r,onClick:this.handleClick},u),m||h,NZ.create(n,{autoGenerateKey:!1,defaultProps:{header:i,description:o}}));var Z=YZ.create(i,{autoGenerateKey:!1}),G=fZ.create(o,{autoGenerateKey:!1});return m||h?t.createElement(d,Fg({},b,{role:"listitem",className:r,onClick:this.handleClick},u),m||h,(n||Z||G)&&t.createElement(NZ,null,Z,G,n)):t.createElement(d,Fg({},b,{role:"listitem",className:r,onClick:this.handleClick},u),Z,G,n)},I}(t.Component);FZ.handledProps=["active","as","children","className","content","description","disabled","header","icon","image","onClick","value"],FZ.propTypes={},FZ.create=sl(FZ,(function(g){return{content:g}}));const xZ=FZ;function zZ(g){var I=g.children,e=g.className,C=g.content,l=NC(zZ,g),n=KC(zZ,g),o=VC(XC("ul"!==n&&"ol"!==n,"list"),e);return t.createElement(n,Fg({},l,{className:o}),zC(I)?C:I)}zZ.handledProps=["as","children","className","content"],zZ.propTypes={};const MZ=zZ;var EZ=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleItemOverrides=function(g){return{onClick:function(e,t){yC(g,"onClick",e,t),yC(I.props,"onItemClick",e,t)}}},I}return zg(I,g),I.prototype.render=function(){var g=this,e=this.props,C=e.animated,l=e.bulleted,n=e.celled,o=e.children,a=e.className,i=e.content,A=e.divided,c=e.floated,s=e.horizontal,d=e.inverted,r=e.items,u=e.link,b=e.ordered,m=e.relaxed,h=e.selection,Z=e.size,G=e.verticalAlign,p=VC("ui",Z,XC(C,"animated"),XC(l,"bulleted"),XC(n,"celled"),XC(A,"divided"),XC(s,"horizontal"),XC(d,"inverted"),XC(u,"link"),XC(b,"ordered"),XC(h,"selection"),kC(m,"relaxed"),JC(c,"floated"),YC(G),"list",a),B=NC(I,this.props),y=KC(I,this.props);return zC(o)?zC(i)?t.createElement(y,Fg({role:"list",className:p},B),iC(r,(function(I){return xZ.create(I,{overrideProps:g.handleItemOverrides})}))):t.createElement(y,Fg({role:"list",className:p},B),i):t.createElement(y,Fg({role:"list",className:p},B),o)},I}(t.Component);EZ.handledProps=["animated","as","bulleted","celled","children","className","content","divided","floated","horizontal","inverted","items","link","onItemClick","ordered","relaxed","selection","size","verticalAlign"],EZ.propTypes={},EZ.Content=NZ,EZ.Description=fZ,EZ.Header=YZ,EZ.Icon=wZ,EZ.Item=xZ,EZ.List=MZ;const UZ=EZ,QZ=()=>{const[g,I]=(0,t.useState)({}),[e,C]=(0,t.useState)(!0),[l,n]=(0,t.useState)(null);if((0,t.useEffect)((()=>{(async()=>{try{const g=await tm.getCurrentExchangeRates();I(g.data),C(!1)}catch(g){n(g.message),C(!1)}})()}),[]),e)return(0,Yg.jsx)(RZ,{children:"Loading..."});if(l)return(0,Yg.jsxs)(RZ,{negative:!0,children:["Error: ",l]});const o=Object.keys(g).filter((g=>!g.startsWith("usd")&&!g.startsWith("kzt")&&!g.endsWith("kzt"))),a={usd_to_kzt:g.usd_to_kzt},i=[...o.map((I=>({[I]:g[I]}))),a];return(0,Yg.jsxs)(fn,{children:[(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h1",children:"Current Exchange Rates"}),(0,Yg.jsx)(UZ,{divided:!0,relaxed:!0,children:i.map((g=>{const I=Object.keys(g)[0];return(0,Yg.jsx)(UZ.Item,{children:(0,Yg.jsxs)(UZ.Content,{children:[(0,Yg.jsx)(UZ.Header,{children:I.replace(/_/g," ").toUpperCase()}),(0,Yg.jsx)(UZ.Description,{children:(0,Yg.jsx)(cm,{as:"h2",color:"violet",children:g[I]})})]})},I)}))})]}),(0,Yg.jsx)(sm,{})]})},LZ=()=>{const{getUser:g}=Kg(),[I,e]=(0,t.useState)(null),[C,l]=(0,t.useState)(null),[n,o]=(0,t.useState)(""),[a,i]=(0,t.useState)(""),[A,c]=(0,t.useState)(""),[s,d]=(0,t.useState)(null);(0,t.useEffect)((()=>{(async()=>{try{const I=g();e(I);const t=await tm.getWalletById(I);l(t.data)}catch(I){em(I)}})()}),[g]);if(!I||!C)return(0,Yg.jsx)(RZ,{children:"Loading..."});const r=[{key:"usd",value:"usd",text:"USD"},{key:"bitcoin",value:"bitcoin",text:"Bitcoin"},{key:"ethereum",value:"ethereum",text:"Ethereum"},{key:"binancecoin",value:"binancecoin",text:"BinanceCoin"},{key:"solana",value:"solana",text:"Solana"},{key:"ripple",value:"ripple",text:"Ripple"},{key:"tether",value:"tether",text:"Tether"},{key:"kzt",value:"kzt",text:"KZT"}];return(0,Yg.jsxs)(fn,{children:[(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h2",children:"Wallet"}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Email:"})," ",I.data.email]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Username:"})," ",I.data.username]})]}),(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h3",children:"Balance"}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"USD:"})," ",C.usd]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Bitcoin:"})," ",C.bitcoin]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Ethereum:"})," ",C.ethereum]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"BinanceCoin:"})," ",C.binancecoin]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Solana:"})," ",C.solana]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Ripple:"})," ",C.ripple]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Tether:"})," ",C.tether]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"KZT:"})," ",C.kzt]})]}),(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h3",children:"Exchange Currency"}),(0,Yg.jsxs)(hZ,{onSubmit:async()=>{try{await tm.transferCurrency(I,n,a,A);const g=await tm.getWalletById(I);l(g.data),d(null)}catch(g){em(g),d(g.message)}},children:[(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"From Currency"}),(0,Yg.jsx)(qh,{placeholder:"Select Currency",fluid:!0,selection:!0,options:r,value:n,onChange:(g,I)=>{let{value:e}=I;return o(e)}})]}),(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"To Currency"}),(0,Yg.jsx)(qh,{placeholder:"Select Currency",fluid:!0,selection:!0,options:r,value:a,onChange:(g,I)=>{let{value:e}=I;return i(e)}})]}),(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"Amount"}),(0,Yg.jsx)("input",{placeholder:"Amount",type:"number",value:A,onChange:g=>c(g.target.value)})]}),(0,Yg.jsx)(pm,{type:"submit",color:"violet",children:"Exchange"})]}),s&&(0,Yg.jsx)(RZ,{negative:!0,children:s})]}),(0,Yg.jsx)(sm,{})]})},DZ=()=>{const g=gg();return(0,Yg.jsx)(fn,{className:"transactions-buttons-container",style:{maxWidth:"400px",margin:"0 auto"},children:(0,Yg.jsxs)(fo,{centered:!0,columns:1,children:[(0,Yg.jsx)(cm,{style:{marginTop:"100px"},children:"Options"}),(0,Yg.jsx)(fo.Row,{children:(0,Yg.jsx)(fo.Column,{children:(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,Yg.jsx)(pm,{color:"violet",style:{width:"300px"},onClick:()=>g("/transactions/transfer"),children:"DIRECT TRANSFER TO USER"})})})}),(0,Yg.jsx)(fo.Row,{children:(0,Yg.jsx)(fo.Column,{children:(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,Yg.jsx)(pm,{color:"violet",style:{width:"300px"},onClick:()=>g("/transactions/qr-request"),children:"QR-CODE REQUEST"})})})}),(0,Yg.jsx)(fo.Row,{children:(0,Yg.jsx)(fo.Column,{children:(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,Yg.jsx)(pm,{color:"violet",style:{width:"300px"},onClick:()=>g("/transactions/scan-qr"),children:"SCAN QR-CODE REQUEST"})})})}),(0,Yg.jsx)(fo.Row,{children:(0,Yg.jsx)(fo.Column,{children:(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,Yg.jsx)(pm,{color:"violet",style:{width:"300px"},onClick:()=>g("/transactions/history"),children:"TRANSACTIONS LIST"})})})}),(0,Yg.jsx)(fo.Row,{children:(0,Yg.jsx)(fo.Column,{children:(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"100px"},children:(0,Yg.jsx)(pm,{color:"violet",style:{width:"300px"},onClick:()=>g("/transactions/card"),children:"MY BANK CARD"})})})}),(0,Yg.jsx)(sm,{})]})})},TZ=()=>{const{getUser:g}=Kg(),I=gg(),[e,C]=(0,t.useState)(""),[l,n]=(0,t.useState)(""),[o,a]=(0,t.useState)(""),[i,A]=(0,t.useState)(null);return(0,Yg.jsx)(fn,{children:(0,Yg.jsxs)(hZ,{onSubmit:()=>{I("/confirm-transaction",{state:{transactionDetails:{toUsername:e,amount:o,currency:l,transactionType:"DIRECT_TRANSFER_TO_WALLET"}}})},style:{maxWidth:"400px",margin:"0 auto"},children:[(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"Recipient Username"}),(0,Yg.jsx)("input",{placeholder:"Username",value:e,onChange:g=>C(g.target.value),required:!0})]}),(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"Currency"}),(0,Yg.jsx)(qh,{placeholder:"Select Currency",fluid:!0,selection:!0,options:[{key:"usd",value:"usd",text:"USD"},{key:"bitcoin",value:"bitcoin",text:"Bitcoin"},{key:"ethereum",value:"ethereum",text:"Ethereum"},{key:"binancecoin",value:"binancecoin",text:"BinanceCoin"},{key:"solana",value:"solana",text:"Solana"},{key:"ripple",value:"ripple",text:"Ripple"},{key:"tether",value:"tether",text:"Tether"},{key:"kzt",value:"kzt",text:"KZT"}],value:l,onChange:(g,I)=>{let{value:e}=I;return n(e)},required:!0})]}),(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"Amount"}),(0,Yg.jsx)("input",{placeholder:"Amount",type:"number",value:o,onChange:g=>a(g.target.value),required:!0})]}),(0,Yg.jsx)(pm,{type:"submit",color:"violet",fluid:!0,children:"Send"}),i&&(0,Yg.jsx)(RZ,{negative:!0,children:i})]})})};var jZ,PZ=Object.defineProperty,OZ=Object.getOwnPropertySymbols,_Z=Object.prototype.hasOwnProperty,qZ=Object.prototype.propertyIsEnumerable,$Z=(g,I,e)=>I in g?PZ(g,I,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[I]=e,gG=(g,I)=>{for(var e in I||(I={}))_Z.call(I,e)&&$Z(g,e,I[e]);if(OZ)for(var e of OZ(I))qZ.call(I,e)&&$Z(g,e,I[e]);return g},IG=(g,I)=>{var e={};for(var t in g)_Z.call(g,t)&&I.indexOf(t)<0&&(e[t]=g[t]);if(null!=g&&OZ)for(var t of OZ(g))I.indexOf(t)<0&&qZ.call(g,t)&&(e[t]=g[t]);return e};(g=>{const I=class{constructor(g,e,t,C){if(this.version=g,this.errorCorrectionLevel=e,this.modules=[],this.isFunction=[],g<I.MIN_VERSION||g>I.MAX_VERSION)throw new RangeError("Version value out of range");if(C<-1||C>7)throw new RangeError("Mask value out of range");this.size=4*g+17;let n=[];for(let I=0;I<this.size;I++)n.push(!1);for(let I=0;I<this.size;I++)this.modules.push(n.slice()),this.isFunction.push(n.slice());this.drawFunctionPatterns();const o=this.addEccAndInterleave(t);if(this.drawCodewords(o),-1==C){let g=1e9;for(let I=0;I<8;I++){this.applyMask(I),this.drawFormatBits(I);const e=this.getPenaltyScore();e<g&&(C=I,g=e),this.applyMask(I)}}l(0<=C&&C<=7),this.mask=C,this.applyMask(C),this.drawFormatBits(C),this.isFunction=[]}static encodeText(e,t){const C=g.QrSegment.makeSegments(e);return I.encodeSegments(C,t)}static encodeBinary(e,t){const C=g.QrSegment.makeBytes(e);return I.encodeSegments([C],t)}static encodeSegments(g,e){let C,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(I.MIN_VERSION<=a&&a<=i&&i<=I.MAX_VERSION)||A<-1||A>7)throw new RangeError("Invalid value");for(C=a;;C++){const t=8*I.getNumDataCodewords(C,e),l=o.getTotalBits(g,C);if(l<=t){n=l;break}if(C>=i)throw new RangeError("Data too long")}for(const t of[I.Ecc.MEDIUM,I.Ecc.QUARTILE,I.Ecc.HIGH])c&&n<=8*I.getNumDataCodewords(C,t)&&(e=t);let s=[];for(const I of g){t(I.mode.modeBits,4,s),t(I.numChars,I.mode.numCharCountBits(C),s);for(const g of I.getData())s.push(g)}l(s.length==n);const d=8*I.getNumDataCodewords(C,e);l(s.length<=d),t(0,Math.min(4,d-s.length),s),t(0,(8-s.length%8)%8,s),l(s.length%8==0);for(let I=236;s.length<d;I^=253)t(I,8,s);let r=[];for(;8*r.length<s.length;)r.push(0);return s.forEach(((g,I)=>r[I>>>3]|=g<<7-(7&I))),new I(C,e,r,A)}getModule(g,I){return 0<=g&&g<this.size&&0<=I&&I<this.size&&this.modules[I][g]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const g=this.getAlignmentPatternPositions(),I=g.length;for(let e=0;e<I;e++)for(let t=0;t<I;t++)0==e&&0==t||0==e&&t==I-1||e==I-1&&0==t||this.drawAlignmentPattern(g[e],g[t]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(g){const I=this.errorCorrectionLevel.formatBits<<3|g;let e=I;for(let C=0;C<10;C++)e=e<<1^1335*(e>>>9);const t=21522^(I<<10|e);l(t>>>15==0);for(let l=0;l<=5;l++)this.setFunctionModule(8,l,C(t,l));this.setFunctionModule(8,7,C(t,6)),this.setFunctionModule(8,8,C(t,7)),this.setFunctionModule(7,8,C(t,8));for(let l=9;l<15;l++)this.setFunctionModule(14-l,8,C(t,l));for(let l=0;l<8;l++)this.setFunctionModule(this.size-1-l,8,C(t,l));for(let l=8;l<15;l++)this.setFunctionModule(8,this.size-15+l,C(t,l));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let g=this.version;for(let e=0;e<12;e++)g=g<<1^7973*(g>>>11);const I=this.version<<12|g;l(I>>>18==0);for(let e=0;e<18;e++){const g=C(I,e),t=this.size-11+e%3,l=Math.floor(e/3);this.setFunctionModule(t,l,g),this.setFunctionModule(l,t,g)}}drawFinderPattern(g,I){for(let e=-4;e<=4;e++)for(let t=-4;t<=4;t++){const C=Math.max(Math.abs(t),Math.abs(e)),l=g+t,n=I+e;0<=l&&l<this.size&&0<=n&&n<this.size&&this.setFunctionModule(l,n,2!=C&&4!=C)}}drawAlignmentPattern(g,I){for(let e=-2;e<=2;e++)for(let t=-2;t<=2;t++)this.setFunctionModule(g+t,I+e,1!=Math.max(Math.abs(t),Math.abs(e)))}setFunctionModule(g,I,e){this.modules[I][g]=e,this.isFunction[I][g]=!0}addEccAndInterleave(g){const e=this.version,t=this.errorCorrectionLevel;if(g.length!=I.getNumDataCodewords(e,t))throw new RangeError("Invalid argument");const C=I.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][e],n=I.ECC_CODEWORDS_PER_BLOCK[t.ordinal][e],o=Math.floor(I.getNumRawDataModules(e)/8),a=C-o%C,i=Math.floor(o/C);let A=[];const c=I.reedSolomonComputeDivisor(n);for(let l=0,d=0;l<C;l++){let e=g.slice(d,d+i-n+(l<a?0:1));d+=e.length;const t=I.reedSolomonComputeRemainder(e,c);l<a&&e.push(0),A.push(e.concat(t))}let s=[];for(let I=0;I<A[0].length;I++)A.forEach(((g,e)=>{(I!=i-n||e>=a)&&s.push(g[I])}));return l(s.length==o),s}drawCodewords(g){if(g.length!=Math.floor(I.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let e=0;for(let I=this.size-1;I>=1;I-=2){6==I&&(I=5);for(let t=0;t<this.size;t++)for(let l=0;l<2;l++){const n=I-l,o=0==(I+1&2)?this.size-1-t:t;!this.isFunction[o][n]&&e<8*g.length&&(this.modules[o][n]=C(g[e>>>3],7-(7&e)),e++)}}l(e==8*g.length)}applyMask(g){if(g<0||g>7)throw new RangeError("Mask value out of range");for(let I=0;I<this.size;I++)for(let e=0;e<this.size;e++){let t;switch(g){case 0:t=(e+I)%2==0;break;case 1:t=I%2==0;break;case 2:t=e%3==0;break;case 3:t=(e+I)%3==0;break;case 4:t=(Math.floor(e/3)+Math.floor(I/2))%2==0;break;case 5:t=e*I%2+e*I%3==0;break;case 6:t=(e*I%2+e*I%3)%2==0;break;case 7:t=((e+I)%2+e*I%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[I][e]&&t&&(this.modules[I][e]=!this.modules[I][e])}}getPenaltyScore(){let g=0;for(let l=0;l<this.size;l++){let e=!1,t=0,C=[0,0,0,0,0,0,0];for(let n=0;n<this.size;n++)this.modules[l][n]==e?(t++,5==t?g+=I.PENALTY_N1:t>5&&g++):(this.finderPenaltyAddHistory(t,C),e||(g+=this.finderPenaltyCountPatterns(C)*I.PENALTY_N3),e=this.modules[l][n],t=1);g+=this.finderPenaltyTerminateAndCount(e,t,C)*I.PENALTY_N3}for(let l=0;l<this.size;l++){let e=!1,t=0,C=[0,0,0,0,0,0,0];for(let n=0;n<this.size;n++)this.modules[n][l]==e?(t++,5==t?g+=I.PENALTY_N1:t>5&&g++):(this.finderPenaltyAddHistory(t,C),e||(g+=this.finderPenaltyCountPatterns(C)*I.PENALTY_N3),e=this.modules[n][l],t=1);g+=this.finderPenaltyTerminateAndCount(e,t,C)*I.PENALTY_N3}for(let l=0;l<this.size-1;l++)for(let e=0;e<this.size-1;e++){const t=this.modules[l][e];t==this.modules[l][e+1]&&t==this.modules[l+1][e]&&t==this.modules[l+1][e+1]&&(g+=I.PENALTY_N2)}let e=0;for(const I of this.modules)e=I.reduce(((g,I)=>g+(I?1:0)),e);const t=this.size*this.size,C=Math.ceil(Math.abs(20*e-10*t)/t)-1;return l(0<=C&&C<=9),g+=C*I.PENALTY_N4,l(0<=g&&g<=2568888),g}getAlignmentPatternPositions(){if(1==this.version)return[];{const g=Math.floor(this.version/7)+2,I=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*g-2));let e=[6];for(let t=this.size-7;e.length<g;t-=I)e.splice(1,0,t);return e}}static getNumRawDataModules(g){if(g<I.MIN_VERSION||g>I.MAX_VERSION)throw new RangeError("Version number out of range");let e=(16*g+128)*g+64;if(g>=2){const I=Math.floor(g/7)+2;e-=(25*I-10)*I-55,g>=7&&(e-=36)}return l(208<=e&&e<=29648),e}static getNumDataCodewords(g,e){return Math.floor(I.getNumRawDataModules(g)/8)-I.ECC_CODEWORDS_PER_BLOCK[e.ordinal][g]*I.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][g]}static reedSolomonComputeDivisor(g){if(g<1||g>255)throw new RangeError("Degree out of range");let e=[];for(let I=0;I<g-1;I++)e.push(0);e.push(1);let t=1;for(let C=0;C<g;C++){for(let g=0;g<e.length;g++)e[g]=I.reedSolomonMultiply(e[g],t),g+1<e.length&&(e[g]^=e[g+1]);t=I.reedSolomonMultiply(t,2)}return e}static reedSolomonComputeRemainder(g,e){let t=e.map((g=>0));for(const C of g){const g=C^t.shift();t.push(0),e.forEach(((e,C)=>t[C]^=I.reedSolomonMultiply(e,g)))}return t}static reedSolomonMultiply(g,I){if(g>>>8!=0||I>>>8!=0)throw new RangeError("Byte out of range");let e=0;for(let t=7;t>=0;t--)e=e<<1^285*(e>>>7),e^=(I>>>t&1)*g;return l(e>>>8==0),e}finderPenaltyCountPatterns(g){const I=g[1];l(I<=3*this.size);const e=I>0&&g[2]==I&&g[3]==3*I&&g[4]==I&&g[5]==I;return(e&&g[0]>=4*I&&g[6]>=I?1:0)+(e&&g[6]>=4*I&&g[0]>=I?1:0)}finderPenaltyTerminateAndCount(g,I,e){return g&&(this.finderPenaltyAddHistory(I,e),I=0),I+=this.size,this.finderPenaltyAddHistory(I,e),this.finderPenaltyCountPatterns(e)}finderPenaltyAddHistory(g,I){0==I[0]&&(g+=this.size),I.pop(),I.unshift(g)}};let e=I;function t(g,I,e){if(I<0||I>31||g>>>I!=0)throw new RangeError("Value out of range");for(let t=I-1;t>=0;t--)e.push(g>>>t&1)}function C(g,I){return 0!=(g>>>I&1)}function l(g){if(!g)throw new Error("Assertion error")}e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],g.QrCode=e;const n=class{constructor(g,I,e){if(this.mode=g,this.numChars=I,this.bitData=e,I<0)throw new RangeError("Invalid argument");this.bitData=e.slice()}static makeBytes(g){let I=[];for(const e of g)t(e,8,I);return new n(n.Mode.BYTE,g.length,I)}static makeNumeric(g){if(!n.isNumeric(g))throw new RangeError("String contains non-numeric characters");let I=[];for(let e=0;e<g.length;){const C=Math.min(g.length-e,3);t(parseInt(g.substr(e,C),10),3*C+1,I),e+=C}return new n(n.Mode.NUMERIC,g.length,I)}static makeAlphanumeric(g){if(!n.isAlphanumeric(g))throw new RangeError("String contains unencodable characters in alphanumeric mode");let I,e=[];for(I=0;I+2<=g.length;I+=2){let C=45*n.ALPHANUMERIC_CHARSET.indexOf(g.charAt(I));C+=n.ALPHANUMERIC_CHARSET.indexOf(g.charAt(I+1)),t(C,11,e)}return I<g.length&&t(n.ALPHANUMERIC_CHARSET.indexOf(g.charAt(I)),6,e),new n(n.Mode.ALPHANUMERIC,g.length,e)}static makeSegments(g){return""==g?[]:n.isNumeric(g)?[n.makeNumeric(g)]:n.isAlphanumeric(g)?[n.makeAlphanumeric(g)]:[n.makeBytes(n.toUtf8ByteArray(g))]}static makeEci(g){let I=[];if(g<0)throw new RangeError("ECI assignment value out of range");if(g<128)t(g,8,I);else if(g<16384)t(2,2,I),t(g,14,I);else{if(!(g<1e6))throw new RangeError("ECI assignment value out of range");t(6,3,I),t(g,21,I)}return new n(n.Mode.ECI,0,I)}static isNumeric(g){return n.NUMERIC_REGEX.test(g)}static isAlphanumeric(g){return n.ALPHANUMERIC_REGEX.test(g)}getData(){return this.bitData.slice()}static getTotalBits(g,I){let e=0;for(const t of g){const g=t.mode.numCharCountBits(I);if(t.numChars>=1<<g)return 1/0;e+=4+g+t.bitData.length}return e}static toUtf8ByteArray(g){g=encodeURI(g);let I=[];for(let e=0;e<g.length;e++)"%"!=g.charAt(e)?I.push(g.charCodeAt(e)):(I.push(parseInt(g.substr(e+1,2),16)),e+=2);return I}};let o=n;o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",g.QrSegment=o})(jZ||(jZ={})),(g=>{let I;(g=>{const I=class{constructor(g,I){this.ordinal=g,this.formatBits=I}};let e=I;e.LOW=new I(0,1),e.MEDIUM=new I(1,0),e.QUARTILE=new I(2,3),e.HIGH=new I(3,2),g.Ecc=e})(I=g.QrCode||(g.QrCode={}))})(jZ||(jZ={})),(g=>{let I;(g=>{const I=class{constructor(g,I){this.modeBits=g,this.numBitsCharCount=I}numCharCountBits(g){return this.numBitsCharCount[Math.floor((g+7)/17)]}};let e=I;e.NUMERIC=new I(1,[10,12,14]),e.ALPHANUMERIC=new I(2,[9,11,13]),e.BYTE=new I(4,[8,16,16]),e.KANJI=new I(8,[8,10,12]),e.ECI=new I(7,[0,0,0]),g.Mode=e})(I=g.QrSegment||(g.QrSegment={}))})(jZ||(jZ={}));var eG=jZ,tG={L:eG.QrCode.Ecc.LOW,M:eG.QrCode.Ecc.MEDIUM,Q:eG.QrCode.Ecc.QUARTILE,H:eG.QrCode.Ecc.HIGH},CG=128,lG="L",nG="#FFFFFF",oG="#000000",aG=!1,iG=4,AG=.1;function cG(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const e=[];return g.forEach((function(g,t){let C=null;g.forEach((function(l,n){if(!l&&null!==C)return e.push("M".concat(C+I," ").concat(t+I,"h").concat(n-C,"v1H").concat(C+I,"z")),void(C=null);if(n!==g.length-1)l&&null===C&&(C=n);else{if(!l)return;null===C?e.push("M".concat(n+I,",").concat(t+I," h1v1H").concat(n+I,"z")):e.push("M".concat(C+I,",").concat(t+I," h").concat(n+1-C,"v1H").concat(C+I,"z"))}}))})),e.join("")}function sG(g,I){return g.slice().map(((g,e)=>e<I.y||e>=I.y+I.h?g:g.map(((g,e)=>(e<I.x||e>=I.x+I.w)&&g))))}function dG(g,I,e,t){if(null==t)return null;const C=e?iG:0,l=g.length+2*C,n=Math.floor(I*AG),o=l/I,a=(t.width||n)*o,i=(t.height||n)*o,A=null==t.x?g.length/2-a/2:t.x*o,c=null==t.y?g.length/2-i/2:t.y*o;let s=null;if(t.excavate){let g=Math.floor(A),I=Math.floor(c);s={x:g,y:I,w:Math.ceil(a+A-g),h:Math.ceil(i+c-I)}}return{x:A,y:c,h:i,w:a,excavation:s}}var rG=function(){try{(new Path2D).addPath(new Path2D)}catch(xG){return!1}return!0}();function uG(g){const I=g,{value:e,size:C=CG,level:l=lG,bgColor:n=nG,fgColor:o=oG,includeMargin:a=aG,style:i,imageSettings:A}=I,c=IG(I,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),s=null==A?void 0:A.src,d=(0,t.useRef)(null),r=(0,t.useRef)(null),[u,b]=(0,t.useState)(!1);(0,t.useEffect)((()=>{if(null!=d.current){const g=d.current,I=g.getContext("2d");if(!I)return;let t=eG.QrCode.encodeText(e,tG[l]).getModules();const i=a?iG:0,c=t.length+2*i,s=dG(t,C,a,A),u=r.current,b=null!=s&&null!==u&&u.complete&&0!==u.naturalHeight&&0!==u.naturalWidth;b&&null!=s.excavation&&(t=sG(t,s.excavation));const m=window.devicePixelRatio||1;g.height=g.width=C*m;const h=C/c*m;I.scale(h,h),I.fillStyle=n,I.fillRect(0,0,c,c),I.fillStyle=o,rG?I.fill(new Path2D(cG(t,i))):t.forEach((function(g,e){g.forEach((function(g,t){g&&I.fillRect(t+i,e+i,1,1)}))})),b&&I.drawImage(u,s.x+i,s.y+i,s.w,s.h)}})),(0,t.useEffect)((()=>{b(!1)}),[s]);const m=gG({height:C,width:C},i);let h=null;return null!=s&&(h=t.createElement("img",{src:s,key:s,style:{display:"none"},onLoad:()=>{b(!0)},ref:r})),t.createElement(t.Fragment,null,t.createElement("canvas",gG({style:m,height:C,width:C,ref:d},c)),h)}function bG(g){const I=g,{value:e,size:C=CG,level:l=lG,bgColor:n=nG,fgColor:o=oG,includeMargin:a=aG,imageSettings:i}=I,A=IG(I,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let c=eG.QrCode.encodeText(e,tG[l]).getModules();const s=a?iG:0,d=c.length+2*s,r=dG(c,C,a,i);let u=null;null!=i&&null!=r&&(null!=r.excavation&&(c=sG(c,r.excavation)),u=t.createElement("image",{xlinkHref:i.src,height:r.h,width:r.w,x:r.x+s,y:r.y+s,preserveAspectRatio:"none"}));const b=cG(c,s);return t.createElement("svg",gG({height:C,width:C,viewBox:"0 0 ".concat(d," ").concat(d)},A),t.createElement("path",{fill:n,d:"M0,0 h".concat(d,"v").concat(d,"H0z"),shapeRendering:"crispEdges"}),t.createElement("path",{fill:o,d:b,shapeRendering:"crispEdges"}),u)}var mG=g=>{const I=g,{renderAs:e}=I,C=IG(I,["renderAs"]);return"svg"===e?t.createElement(bG,gG({},C)):t.createElement(uG,gG({},C))};const hG=()=>{const{getUser:g}=Kg(),[I,e]=(0,t.useState)(""),[C,l]=(0,t.useState)(""),[n,o]=(0,t.useState)(null),[a,i]=(0,t.useState)("");return(0,Yg.jsxs)(fn,{children:[(0,Yg.jsxs)(hZ,{onSubmit:()=>{try{const e={toUsername:g().data.username,amount:C,currency:I,transactionType:"QR_TRANSFER"};i(JSON.stringify(e)),o(null)}catch(n){em(n),o(n.message)}},style:{maxWidth:"400px",margin:"0 auto",marginTop:"30px"},children:[(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"Currency"}),(0,Yg.jsx)(qh,{placeholder:"Select Currency",fluid:!0,selection:!0,options:[{key:"usd",value:"usd",text:"USD"},{key:"bitcoin",value:"bitcoin",text:"Bitcoin"},{key:"ethereum",value:"ethereum",text:"Ethereum"},{key:"binancecoin",value:"binancecoin",text:"BinanceCoin"},{key:"solana",value:"solana",text:"Solana"},{key:"ripple",value:"ripple",text:"Ripple"},{key:"tether",value:"tether",text:"Tether"},{key:"kzt",value:"kzt",text:"KZT"}],value:I,onChange:(g,I)=>{let{value:t}=I;return e(t)},required:!0})]}),(0,Yg.jsxs)(hZ.Field,{children:[(0,Yg.jsx)("label",{children:"Amount"}),(0,Yg.jsx)("input",{placeholder:"Amount",type:"number",value:C,onChange:g=>l(g.target.value),required:!0})]}),(0,Yg.jsx)(pm,{type:"submit",color:"violet",fluid:!0,children:"Generate QR"}),n&&(0,Yg.jsx)(RZ,{negative:!0,children:n})]}),a&&(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",marginTop:"10px"},children:(0,Yg.jsx)("div",{style:{border:"2px solid #7F00FF",padding:"25px",borderRadius:"15px"},children:(0,Yg.jsx)(mG,{value:a,size:256})})})]})};var ZG=e(309),GG=e.n(ZG);const pG=()=>{const{getUser:g}=Kg(),I=gg(),[e,C]=(0,t.useState)(null),[l,n]=(0,t.useState)(null),[o,a]=(0,t.useState)(!0);return(0,Yg.jsxs)(fn,{children:[(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"auto"},children:o&&(0,Yg.jsx)("div",{style:{border:"2px solid #7F00FF",padding:"25px",borderRadius:"15px"},children:(0,Yg.jsx)(GG(),{delay:300,onError:g=>{C(g.message)},onScan:g=>{if(g)try{const e=JSON.parse(g.text);n(e),a(!1),I("/confirm-transaction",{state:{transactionDetails:e}})}catch(xG){C("Failed to parse QR code data")}},style:{width:"400px",height:"auto",borderRadius:"10px"}})})}),(0,Yg.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px"},children:(0,Yg.jsx)(pm,{color:"violet",onClick:()=>{I(-1)},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"})}),e&&(0,Yg.jsx)(RZ,{negative:!0,children:e}),l&&(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h3",children:"Transaction Details"}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"To Username:"})," ",l.toUsername]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Amount:"})," ",l.amount]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Currency:"})," ",l.currency]}),(0,Yg.jsx)(pm,{color:"violet",onClick:()=>I("/confirm-transaction",{state:{transactionDetails:l}}),children:"Confirm Transaction"})]})]})},BG=()=>{var g;const I=gg(),e=q(),{getUser:C}=Kg(),[l,n]=(0,t.useState)(null),o=null===(g=e.state)||void 0===g?void 0:g.transactionDetails;return o?(0,Yg.jsx)(fn,{children:(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h3",children:"Transaction Details"}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"To Username:"})," ",o.toUsername]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Amount:"})," ",o.amount]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Currency:"})," ",o.currency]}),l&&(0,Yg.jsx)(RZ,{negative:!0,children:l}),(0,Yg.jsx)(pm,{color:"violet",onClick:async()=>{try{const g=C();await tm.createTransaction(o,g),I("/transactions/success")}catch(l){em(l),n(l.message)}},children:"Confirm Transaction"})]})}):(0,Yg.jsx)(RZ,{negative:!0,children:"No transaction details found."})},yG=()=>(0,Yg.jsxs)(fn,{textAlign:"center",style:{minHeight:"50vh",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Yg.jsxs)(Fn,{basic:!0,children:[(0,Yg.jsxs)(cm,{as:"h2",icon:!0,children:[(0,Yg.jsx)(Wn,{name:"check circle",color:"green"}),"Transaction Successful",(0,Yg.jsx)(cm.Subheader,{children:"Your transaction to User was successful!"})]}),(0,Yg.jsx)("div",{style:{marginTop:"20px"},children:(0,Yg.jsx)(pm,{as:Xg,to:"/",color:"violet",children:"Back to Home"})})]}),(0,Yg.jsx)(sm,{})]}),WG=()=>{const{getUser:g}=Kg(),[I,e]=(0,t.useState)([]),[C,l]=(0,t.useState)({}),[n,o]=(0,t.useState)(null),[a,i]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{(async()=>{try{const I=g(),t=await tm.getAllTransactions(I);e(t.data);const C={};for(const g of t.data){if(!C[g.fromWalletId]){const e=await tm.getUserById(g.fromWalletId,I);C[g.fromWalletId]=e.data.username}if(!C[g.toWalletId]){const e=await tm.getUserById(g.toWalletId,I);C[g.toWalletId]=e.data.username}}l(C)}catch(n){em(n),o(n.message)}finally{i(!1)}})()}),[g]),a?(0,Yg.jsx)(RZ,{children:"Loading..."}):n?(0,Yg.jsxs)(RZ,{negative:!0,children:["Error: ",n]}):(0,Yg.jsx)(fn,{children:(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h3",children:"All Transactions"}),0===I.length?(0,Yg.jsx)(RZ,{children:"No transactions found."}):(0,Yg.jsx)(UZ,{divided:!0,relaxed:!0,children:I.map((g=>(0,Yg.jsxs)(UZ.Item,{children:[(0,Yg.jsx)(Wn,{name:"exchange",color:"red"}),(0,Yg.jsxs)(UZ.Content,{children:[(0,Yg.jsxs)(UZ.Header,{children:["From: ",C[g.fromWalletId]]}),(0,Yg.jsxs)(UZ.Header,{children:["To: ",C[g.toWalletId]]}),(0,Yg.jsxs)(UZ.Description,{children:["Amount: ",g.amount," ",g.currency]}),(0,Yg.jsxs)(UZ.Description,{children:["Type: ",g.transactionType]}),(0,Yg.jsxs)(UZ.Description,{children:["Date: ",new Date(g.timestamp).toLocaleString()]})]})]},g.id)))})]})})};function VG(g){var I=g.children,e=g.className,C=g.content,l=g.textAlign,n=VC(vC(l),"description",e),o=NC(VG,g),a=KC(VG,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}VG.handledProps=["as","children","className","content","textAlign"],VG.propTypes={};const SG=VG;function RG(g){var I=g.children,e=g.className,C=g.content,l=g.textAlign,n=VC(vC(l),"header",e),o=NC(RG,g),a=KC(RG,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}RG.handledProps=["as","children","className","content","textAlign"],RG.propTypes={};const XG=RG;function JG(g){var I=g.children,e=g.className,C=g.content,l=g.textAlign,n=VC(vC(l),"meta",e),o=NC(JG,g),a=KC(JG,g);return t.createElement(a,Fg({},o,{className:n}),zC(I)?C:I)}JG.handledProps=["as","children","className","content","textAlign"],JG.propTypes={};const kG=JG;function fG(g){var I=g.children,e=g.className,C=g.content,l=g.description,n=g.extra,o=g.header,a=g.meta,i=g.textAlign,A=VC(XC(n,"extra"),vC(i),"content",e),c=NC(fG,g),s=KC(fG,g);return zC(I)?zC(C)?t.createElement(s,Fg({},c,{className:A}),cl(XG,(function(g){return{content:g}}),o,{autoGenerateKey:!1}),cl(kG,(function(g){return{content:g}}),a,{autoGenerateKey:!1}),cl(SG,(function(g){return{content:g}}),l,{autoGenerateKey:!1})):t.createElement(s,Fg({},c,{className:A}),C):t.createElement(s,Fg({},c,{className:A}),I)}fG.handledProps=["as","children","className","content","description","extra","header","meta","textAlign"],fG.propTypes={};const vG=fG;function YG(g){var I=g.centered,e=g.children,C=g.className,l=g.content,n=g.doubling,o=g.items,a=g.itemsPerRow,i=g.stackable,A=g.textAlign,c=VC("ui",XC(I,"centered"),XC(n,"doubling"),XC(i,"stackable"),vC(A),HC(a),"cards",C),s=NC(YG,g),d=KC(YG,g);if(!zC(e))return t.createElement(d,Fg({},s,{className:c}),e);if(!zC(l))return t.createElement(d,Fg({},s,{className:c}),l);var r=iC(o,(function(g){var I,e=null!=(I=g.key)?I:[g.header,g.description].join("-");return t.createElement(NG,Fg({key:e},g))}));return t.createElement(d,Fg({},s,{className:c}),r)}YG.handledProps=["as","centered","children","className","content","doubling","items","itemsPerRow","stackable","textAlign"],YG.propTypes={};const HG=YG;var NG=function(g){function I(){for(var I,e=arguments.length,t=new Array(e),C=0;C<e;C++)t[C]=arguments[C];return(I=g.call.apply(g,[this].concat(t))||this).handleClick=function(g){var e=I.props.onClick;e&&e(g,I.props)},I}return zg(I,g),I.prototype.render=function(){var g=this.props,e=g.centered,C=g.children,l=g.className,n=g.color,o=g.content,a=g.description,i=g.extra,A=g.fluid,c=g.header,s=g.href,d=g.image,r=g.link,u=g.meta,b=g.onClick,m=g.raised,h=VC("ui",n,XC(e,"centered"),XC(A,"fluid"),XC(r,"link"),XC(m,"raised"),"card",l),Z=NC(I,this.props),G=KC(I,this.props,(function(){if(b)return"a"}));return zC(C)?zC(o)?t.createElement(G,Fg({},Z,{className:h,href:s,onClick:this.handleClick}),na.create(d,{autoGenerateKey:!1,defaultProps:{ui:!1,wrapped:!0}}),(a||c||u)&&t.createElement(vG,{description:a,header:c,meta:u}),i&&t.createElement(vG,{extra:!0},i)):t.createElement(G,Fg({},Z,{className:h,href:s,onClick:this.handleClick}),o):t.createElement(G,Fg({},Z,{className:h,href:s,onClick:this.handleClick}),C)},I}(t.Component);NG.handledProps=["as","centered","children","className","color","content","description","extra","fluid","header","href","image","link","meta","onClick","raised"],NG.propTypes={},NG.Content=vG,NG.Description=SG,NG.Group=HG,NG.Header=XG,NG.Meta=kG;const KG=()=>{const{getUser:g}=Kg(),[I,e]=(0,t.useState)(null),[C,l]=(0,t.useState)(null),[n,o]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{(async()=>{try{const I=g(),t=await tm.getBankCardForCurrentUser(I);e(t.data)}catch(C){em(C),l(C.message)}finally{o(!1)}})()}),[g]),n?(0,Yg.jsx)(RZ,{children:"Loading..."}):C?(0,Yg.jsxs)(RZ,{negative:!0,children:["Error: ",C]}):I?(0,Yg.jsx)(fn,{children:(0,Yg.jsxs)(Fn,{children:[(0,Yg.jsx)(cm,{as:"h3",children:"Your Bank Card"}),(0,Yg.jsx)(NG,{centered:!0,children:(0,Yg.jsxs)(NG.Content,{children:[(0,Yg.jsx)(Wn,{name:"credit card",size:"large"}),(0,Yg.jsx)(NG.Header,{children:I.cardHolderName}),(0,Yg.jsx)(NG.Meta,{children:(0,Yg.jsxs)("span",{className:"date",children:["Expires ",I.expiryDate]})}),(0,Yg.jsxs)(NG.Description,{children:[(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"Card Number:"})," ",I.cardNumber]}),(0,Yg.jsxs)("p",{children:[(0,Yg.jsx)("strong",{children:"CVV:"})," ",I.cvv]})]})]})})]})}):(0,Yg.jsx)(RZ,{children:"No bank card found."})};const wG=function(){return(0,Yg.jsx)(Ng,{children:(0,Yg.jsxs)(Vg,{children:[(0,Yg.jsx)(vn,{}),(0,Yg.jsxs)(mg,{children:[(0,Yg.jsx)(ug,{path:"/",element:(0,Yg.jsx)(dm,{})}),(0,Yg.jsx)(ug,{path:"/login",element:(0,Yg.jsx)(XZ,{})}),(0,Yg.jsx)(ug,{path:"/signup",element:(0,Yg.jsx)(JZ,{})}),(0,Yg.jsx)(ug,{path:"/exchange-rates",element:(0,Yg.jsx)(QZ,{})}),(0,Yg.jsx)(ug,{path:"/wallet",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(LZ,{})})})," ",(0,Yg.jsx)(ug,{path:"/transactions",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(DZ,{})})}),(0,Yg.jsx)(ug,{path:"/transactions/transfer",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(TZ,{})})}),(0,Yg.jsx)(ug,{path:"/transactions/qr-request",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(hG,{})})}),(0,Yg.jsx)(ug,{path:"/transactions/success",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(yG,{})})}),(0,Yg.jsx)(ug,{path:"/transactions/scan-qr",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(pG,{})})}),(0,Yg.jsx)(ug,{path:"/transactions/history",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(WG,{})})}),(0,Yg.jsx)(ug,{path:"/transactions/card",element:(0,Yg.jsx)(wg,{children:(0,Yg.jsx)(KG,{})})}),(0,Yg.jsx)(ug,{path:"/confirm-transaction",element:(0,Yg.jsx)(BG,{})}),(0,Yg.jsx)(ug,{path:"*",element:(0,Yg.jsx)(rg,{to:"/"})})]})]})})},FG=g=>{g&&g instanceof Function&&e.e(488).then(e.bind(e,488)).then((I=>{let{getCLS:e,getFID:t,getFCP:C,getLCP:l,getTTFB:n}=I;e(g),t(g),C(g),l(g),n(g)}))};l.createRoot(document.getElementById("root")).render((0,Yg.jsx)(wG,{})),FG()})()})();
//# sourceMappingURL=main.6d1e7f32.js.map