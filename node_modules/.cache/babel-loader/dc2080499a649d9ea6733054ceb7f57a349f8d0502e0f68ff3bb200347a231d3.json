{"ast":null,"code":"var _jsxFileName = \"/Users/timurinamkhojayev/Desktop/demo-crypto/order-ui/src/components/user/ScanQR.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Container, Message, Segment, Header, Button } from 'semantic-ui-react';\nimport jsQR from 'jsqr';\nimport { useAuth } from '../context/AuthContext';\nimport { backApi } from '../misc/BackApi';\nimport { handleLogError } from '../misc/Helpers';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ScanQR = () => {\n  _s();\n  const {\n    getUser\n  } = useAuth();\n  const navigate = useNavigate();\n  const [error, setError] = useState(null);\n  const [transactionDetails, setTransactionDetails] = useState(null);\n  const [scanning, setScanning] = useState(false);\n  const videoRef = useRef(null);\n  const handleScanQR = () => {\n    setScanning(true);\n    setError(null);\n    setTransactionDetails(null);\n  };\n  useEffect(() => {\n    handleScanQR();\n  }, []);\n  useEffect(() => {\n    if (scanning) {\n      const canvas = document.createElement('canvas');\n      const context = canvas.getContext('2d');\n      const video = videoRef.current;\n      navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment'\n        }\n      }).then(stream => {\n        video.srcObject = stream;\n        video.setAttribute('playsinline', true);\n        video.play();\n        const scan = () => {\n          if (video.readyState === video.HAVE_ENOUGH_DATA) {\n            canvas.height = video.videoHeight;\n            canvas.width = video.videoWidth;\n            context.drawImage(video, 0, 0, canvas.width, canvas.height);\n            const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n            const code = jsQR(imageData.data, imageData.width, imageData.height);\n            if (code) {\n              try {\n                const transactionData = JSON.parse(code.data);\n                setTransactionDetails(transactionData);\n                stream.getTracks().forEach(track => track.stop());\n                setScanning(false);\n                navigate('/confirm-transaction', {\n                  state: {\n                    transactionDetails: transactionData\n                  }\n                });\n              } catch (e) {\n                setError('Failed to parse QR code data');\n              }\n            }\n          }\n          if (scanning) {\n            requestAnimationFrame(scan);\n          }\n        };\n        scan();\n      }).catch(err => setError(err.message));\n    }\n  }, [scanning, navigate]);\n  const handleBack = () => {\n    navigate(-1); // Go back to the previous page\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: 'auto'\n      },\n      children: scanning && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          border: '2px solid #7F00FF',\n          padding: '25px',\n          borderRadius: '15px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          style: {\n            width: '400px',\n            height: 'auto',\n            borderRadius: '10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        marginTop: '10px'\n      },\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        color: \"violet\",\n        onClick: handleBack,\n        children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(Message, {\n      negative: true,\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 23\n    }, this), transactionDetails && /*#__PURE__*/_jsxDEV(Segment, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        as: \"h3\",\n        children: \"Transaction Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"To Username:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 24\n        }, this), \" \", transactionDetails.toUsername]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Amount:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 24\n        }, this), \" \", transactionDetails.amount]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Currency:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 24\n        }, this), \" \", transactionDetails.currency]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        color: \"violet\",\n        onClick: () => navigate('/confirm-transaction', {\n          state: {\n            transactionDetails\n          }\n        }),\n        children: \"Confirm Transaction\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 9\n  }, this);\n};\n_s(ScanQR, \"8BGYguBniM+QixIuRN/xi5gGB4Q=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = ScanQR;\nexport default ScanQR;\nvar _c;\n$RefreshReg$(_c, \"ScanQR\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Container","Message","Segment","Header","Button","jsQR","useAuth","backApi","handleLogError","useNavigate","jsxDEV","_jsxDEV","ScanQR","_s","getUser","navigate","error","setError","transactionDetails","setTransactionDetails","scanning","setScanning","videoRef","handleScanQR","canvas","document","createElement","context","getContext","video","current","navigator","mediaDevices","getUserMedia","facingMode","then","stream","srcObject","setAttribute","play","scan","readyState","HAVE_ENOUGH_DATA","height","videoHeight","width","videoWidth","drawImage","imageData","getImageData","code","data","transactionData","JSON","parse","getTracks","forEach","track","stop","state","e","requestAnimationFrame","catch","err","message","handleBack","children","style","display","justifyContent","alignItems","border","padding","borderRadius","ref","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","color","onClick","negative","as","toUsername","amount","currency","_c","$RefreshReg$"],"sources":["/Users/timurinamkhojayev/Desktop/demo-crypto/order-ui/src/components/user/ScanQR.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Container, Message, Segment, Header, Button } from 'semantic-ui-react';\nimport jsQR from 'jsqr';\nimport { useAuth } from '../context/AuthContext';\nimport { backApi } from '../misc/BackApi';\nimport { handleLogError } from '../misc/Helpers';\nimport { useNavigate } from 'react-router-dom';\n\nconst ScanQR = () => {\n    const { getUser } = useAuth();\n    const navigate = useNavigate();\n    const [error, setError] = useState(null);\n    const [transactionDetails, setTransactionDetails] = useState(null);\n    const [scanning, setScanning] = useState(false);\n    const videoRef = useRef(null);\n\n    const handleScanQR = () => {\n        setScanning(true);\n        setError(null);\n        setTransactionDetails(null);\n    };\n\n    useEffect(() => {\n        handleScanQR();\n    }, []);\n\n    useEffect(() => {\n        if (scanning) {\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n            const video = videoRef.current;\n\n            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } }).then(stream => {\n                video.srcObject = stream;\n                video.setAttribute('playsinline', true);\n                video.play();\n\n                const scan = () => {\n                    if (video.readyState === video.HAVE_ENOUGH_DATA) {\n                        canvas.height = video.videoHeight;\n                        canvas.width = video.videoWidth;\n                        context.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n                        const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n                        const code = jsQR(imageData.data, imageData.width, imageData.height);\n\n                        if (code) {\n                            try {\n                                const transactionData = JSON.parse(code.data);\n                                setTransactionDetails(transactionData);\n                                stream.getTracks().forEach(track => track.stop());\n                                setScanning(false);\n                                navigate('/confirm-transaction', { state: { transactionDetails: transactionData } });\n                            } catch (e) {\n                                setError('Failed to parse QR code data');\n                            }\n                        }\n                    }\n                    if (scanning) {\n                        requestAnimationFrame(scan);\n                    }\n                };\n                scan();\n            }).catch(err => setError(err.message));\n        }\n    }, [scanning, navigate]);\n\n    const handleBack = () => {\n        navigate(-1); // Go back to the previous page\n    };\n\n    return (\n        <Container>\n            <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: 'auto' }}>\n                {scanning && (\n                    <div style={{ border: '2px solid #7F00FF', padding: '25px', borderRadius: '15px' }}>\n                        <video ref={videoRef} style={{ width: '400px', height: 'auto', borderRadius: '10px' }} />\n                    </div>\n                )}\n            </div>\n            <div style={{ display: 'flex', justifyContent: 'center', marginTop: '10px' }}>\n                <Button color='violet' onClick={handleBack}>Отменить</Button>\n            </div>\n            {error && <Message negative>{error}</Message>}\n            {transactionDetails && (\n                <Segment>\n                    <Header as=\"h3\">Transaction Details</Header>\n                    <p><strong>To Username:</strong> {transactionDetails.toUsername}</p>\n                    <p><strong>Amount:</strong> {transactionDetails.amount}</p>\n                    <p><strong>Currency:</strong> {transactionDetails.currency}</p>\n                    <Button color='violet' onClick={() => navigate('/confirm-transaction', { state: { transactionDetails } })}>Confirm Transaction</Button>\n                </Segment>\n            )}\n        </Container>\n    );\n};\n\nexport default ScanQR;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}